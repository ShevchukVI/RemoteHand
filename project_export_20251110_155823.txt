================================================================================
–ï–ö–°–ü–û–†–¢ –ü–†–û–Ñ–ö–¢–£: RemoteHand
–î–∞—Ç–∞: 2025-11-10 15:58:23
–®–ª—è—Ö: D:\Python Projects\Prego\RemoteHand
================================================================================

üìÇ –°–¢–†–£–ö–¢–£–†–ê –ü–†–û–Ñ–ö–¢–£
--------------------------------------------------------------------------------
RemoteHand/
‚îú‚îÄ‚îÄ assets/
‚îÇ   ‚îî‚îÄ‚îÄ icon.ico
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ anydesk_manager.py
‚îÇ   ‚îú‚îÄ‚îÄ config.py
‚îÇ   ‚îú‚îÄ‚îÄ config_manager.py
‚îÇ   ‚îú‚îÄ‚îÄ main.py
‚îÇ   ‚îú‚îÄ‚îÄ network_test.py
‚îÇ   ‚îú‚îÄ‚îÄ rdp_manager.py
‚îÇ   ‚îú‚îÄ‚îÄ setup_wizard.py
‚îÇ   ‚îú‚îÄ‚îÄ telegram_api.py
‚îÇ   ‚îú‚îÄ‚îÄ updater.py
‚îÇ   ‚îî‚îÄ‚îÄ utils.py
‚îú‚îÄ‚îÄ .env.example
‚îú‚îÄ‚îÄ 23.88.7.196_admin_session.rdp
‚îú‚îÄ‚îÄ dev_run.py
‚îú‚îÄ‚îÄ export.py
‚îú‚îÄ‚îÄ GitCommitTool.py
‚îú‚îÄ‚îÄ project_export_20251110_104446.txt
‚îú‚îÄ‚îÄ project_export_20251110_151306.txt
‚îú‚îÄ‚îÄ project_export_20251110_155823.txt
‚îú‚îÄ‚îÄ README.md
‚îú‚îÄ‚îÄ RemoteHand.spec
‚îú‚îÄ‚îÄ requirements.txt
‚îú‚îÄ‚îÄ version.txt
‚îú‚îÄ‚îÄ version_info.txt
‚îî‚îÄ‚îÄ –ê–∫—Ç–∏–≤–∞—Ü—ñ—è —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞.txt

üìÑ –í–ú–Ü–°–¢ –§–ê–ô–õ–Ü–í (21 —Ñ–∞–π–ª—ñ–≤)
================================================================================


================================================================================
–§–∞–π–ª 1/21: dev_run.py
--------------------------------------------------------------------------------
"""
DEV_RUN.PY - –õ–æ–∫–∞–ª—å–Ω–µ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è
"""

import sys
import os

# –í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ DEV —Ä–µ–∂–∏–º
os.environ['REMOTEHAND_DEV_MODE'] = '1'

# –î–æ–¥–∞—Ç–∏ src –≤ path
sys.path.insert(0, os.path.join(os.path.dirname(__file__), 'src'))

print("–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π...")
import subprocess
subprocess.run([sys.executable, "-m", "pip", "install", "-r", "requirements.txt", "-q"],
               capture_output=True)

print("üîß –ó–∞–ø—É—Å–∫ —É DEV —Ä–µ–∂–∏–º—ñ...")

# –ü—Ä—è–º–æ –∑–∞–ø—É—Å—Ç–∏—Ç–∏ main
if __name__ == "__main__":
    import main
    main.main()


================================================================================
–§–∞–π–ª 2/21: export.py
--------------------------------------------------------------------------------
#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Project Structure Exporter
–°—Ç–≤–æ—Ä—é—î –¥–µ—Ç–∞–ª—å–Ω–∏–π –æ–ø–∏—Å —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ –ø—Ä–æ—î–∫—Ç—É —Ç–∞ –≤–º—ñ—Å—Ç —Ñ–∞–π–ª—ñ–≤ —É –æ–¥–∏–Ω —Ñ–∞–π–ª
"""

import os
from pathlib import Path
from datetime import datetime

# –§–∞–π–ª–∏ —Ç–∞ –ø–∞–ø–∫–∏, —è–∫—ñ —Ç—Ä–µ–±–∞ —ñ–≥–Ω–æ—Ä—É–≤–∞—Ç–∏
IGNORE_PATTERNS = {
    # –ü–∞–ø–∫–∏
    '__pycache__', '.git', '.idea', '.vscode', 'node_modules',
    'venv', 'env', '.env', 'dist', 'build', '.pytest_cache',
    '.mypy_cache', 'htmlcov', '.coverage', 'logs', 'tmp',
    # –§–∞–π–ª–∏
    '.pyc', '.pyo', '.pyd', '.so', '.dll', '.dylib', '.exe',
    '.log', '.sqlite', '.db', '.pkl', '.pickle', '.DS_Store',
    'Thumbs.db', '.env', '.env.local', '.gitignore'
}

# –†–æ–∑—à–∏—Ä–µ–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤ –¥–ª—è —á–∏—Ç–∞–Ω–Ω—è (—Ç–µ–∫—Å—Ç–æ–≤—ñ —Ñ–∞–π–ª–∏)
TEXT_EXTENSIONS = {
    '.py', '.js', '.ts', '.jsx', '.tsx', '.html', '.css', '.scss',
    '.json', '.yaml', '.yml', '.toml', '.ini', '.cfg', '.conf',
    '.txt', '.md', '.rst', '.xml', '.sql', '.sh', '.bash',
    '.env.example', '.gitignore', 'Dockerfile', 'Makefile',
    '.java', '.c', '.cpp', '.h', '.go', '.rs', '.php', '.rb'
}

# –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∏–π —Ä–æ–∑–º—ñ—Ä —Ñ–∞–π–ª—É (1 MB)
MAX_FILE_SIZE = 1024 * 1024


def should_ignore(path: Path) -> bool:
    """–ü–µ—Ä–µ–≤—ñ—Ä—è—î, —á–∏ —Ç—Ä–µ–±–∞ —ñ–≥–Ω–æ—Ä—É–≤–∞—Ç–∏ —Ñ–∞–π–ª/–ø–∞–ø–∫—É"""
    name = path.name

    # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ç–æ—á–Ω–æ–≥–æ –∑–±—ñ–≥—É
    if name in IGNORE_PATTERNS:
        return True

    # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è
    if path.suffix in IGNORE_PATTERNS:
        return True

    # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø—Ä–∏—Ö–æ–≤–∞–Ω–∏—Ö —Ñ–∞–π–ª—ñ–≤ (–∫—Ä—ñ–º .env.example)
    if name.startswith('.') and name != '.env.example':
        return True

    return False


def is_text_file(path: Path) -> bool:
    """–ü–µ—Ä–µ–≤—ñ—Ä—è—î, —á–∏ —î —Ñ–∞–π–ª —Ç–µ–∫—Å—Ç–æ–≤–∏–º"""
    # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è
    if path.suffix.lower() in TEXT_EXTENSIONS:
        return True

    # –§–∞–π–ª–∏ –±–µ–∑ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è, —è–∫—ñ –∑–∞–∑–≤–∏—á–∞–π —Ç–µ–∫—Å—Ç–æ–≤—ñ
    if path.suffix == '' and path.name in {'Dockerfile', 'Makefile', 'README', 'LICENSE'}:
        return True

    return False


def get_tree_structure(root_path: Path, prefix: str = "", is_last: bool = True) -> list:
    """–ì–µ–Ω–µ—Ä—É—î –¥–µ—Ä–µ–≤–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ –ø—Ä–æ—î–∫—Ç—É"""
    lines = []

    try:
        items = sorted(root_path.iterdir(), key=lambda x: (not x.is_dir(), x.name.lower()))
        items = [item for item in items if not should_ignore(item)]

        for i, item in enumerate(items):
            is_last_item = i == len(items) - 1
            current_prefix = "‚îî‚îÄ‚îÄ " if is_last_item else "‚îú‚îÄ‚îÄ "
            lines.append(f"{prefix}{current_prefix}{item.name}{'/' if item.is_dir() else ''}")

            if item.is_dir():
                extension = "    " if is_last_item else "‚îÇ   "
                lines.extend(get_tree_structure(item, prefix + extension, is_last_item))

    except PermissionError:
        pass

    return lines


def read_file_content(file_path: Path) -> str:
    """–ß–∏—Ç–∞—î –≤–º—ñ—Å—Ç —Ñ–∞–π–ª—É"""
    try:
        # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ä–æ–∑–º—ñ—Ä—É
        if file_path.stat().st_size > MAX_FILE_SIZE:
            return f"[–§–∞–π–ª –∑–∞–Ω–∞–¥—Ç–æ –≤–µ–ª–∏–∫–∏–π: {file_path.stat().st_size / 1024:.1f} KB]"

        # –°–ø—Ä–æ–±–∞ –ø—Ä–æ—á–∏—Ç–∞—Ç–∏ —è–∫ —Ç–µ–∫—Å—Ç
        with open(file_path, 'r', encoding='utf-8') as f:
            return f.read()
    except UnicodeDecodeError:
        # –Ø–∫—â–æ –Ω–µ –≤–¥–∞–ª–æ—Å—è –ø—Ä–æ—á–∏—Ç–∞—Ç–∏ —è–∫ UTF-8
        try:
            with open(file_path, 'r', encoding='cp1251') as f:
                return f.read()
        except:
            return "[–ù–µ –≤–¥–∞–ª–æ—Å—è –ø—Ä–æ—á–∏—Ç–∞—Ç–∏ —Ñ–∞–π–ª - –±—ñ–Ω–∞—Ä–Ω–∏–π –∞–±–æ –Ω–µ–≤—ñ–¥–æ–º–µ –∫–æ–¥—É–≤–∞–Ω–Ω—è]"
    except Exception as e:
        return f"[–ü–æ–º–∏–ª–∫–∞ —á–∏—Ç–∞–Ω–Ω—è: {str(e)}]"


def collect_files(root_path: Path) -> list:
    """–ó–±–∏—Ä–∞—î –≤—Å—ñ —Ç–µ–∫—Å—Ç–æ–≤—ñ —Ñ–∞–π–ª–∏ –ø—Ä–æ—î–∫—Ç—É"""
    files = []

    for item in root_path.rglob('*'):
        if item.is_file() and not should_ignore(item) and is_text_file(item):
            # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞, —â–æ –≤—Å—ñ –±–∞—Ç—å–∫—ñ–≤—Å—å–∫—ñ –ø–∞–ø–∫–∏ –Ω–µ —ñ–≥–Ω–æ—Ä—É—é—Ç—å—Å—è
            if not any(should_ignore(parent) for parent in item.parents):
                files.append(item)

    return sorted(files)


def generate_project_export(project_path: str, output_file: str = None):
    """–ì–µ–Ω–µ—Ä—É—î –ø–æ–≤–Ω–∏–π –µ–∫—Å–ø–æ—Ä—Ç –ø—Ä–æ—î–∫—Ç—É"""
    root = Path(project_path).resolve()

    if not root.exists():
        print(f"‚ùå –ü–æ–º–∏–ª–∫–∞: –®–ª—è—Ö '{project_path}' –Ω–µ —ñ—Å–Ω—É—î!")
        return

    if output_file is None:
        timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
        output_file = f"project_export_{timestamp}.txt"

    print(f"üìÅ –ê–Ω–∞–ª—ñ–∑ –ø—Ä–æ—î–∫—Ç—É: {root.name}")
    print(f"üìù –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –µ–∫—Å–ø–æ—Ä—Ç—É...")

    with open(output_file, 'w', encoding='utf-8') as f:
        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        f.write("=" * 80 + "\n")
        f.write(f"–ï–ö–°–ü–û–†–¢ –ü–†–û–Ñ–ö–¢–£: {root.name}\n")
        f.write(f"–î–∞—Ç–∞: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}\n")
        f.write(f"–®–ª—è—Ö: {root}\n")
        f.write("=" * 80 + "\n\n")

        # –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ—î–∫—Ç—É
        f.write("üìÇ –°–¢–†–£–ö–¢–£–†–ê –ü–†–û–Ñ–ö–¢–£\n")
        f.write("-" * 80 + "\n")
        f.write(f"{root.name}/\n")
        tree_lines = get_tree_structure(root)
        f.write("\n".join(tree_lines))
        f.write("\n\n")

        # –ó–±—ñ—Ä —Ñ–∞–π–ª—ñ–≤
        files = collect_files(root)

        f.write(f"üìÑ –í–ú–Ü–°–¢ –§–ê–ô–õ–Ü–í ({len(files)} —Ñ–∞–π–ª—ñ–≤)\n")
        f.write("=" * 80 + "\n\n")

        # –í–º—ñ—Å—Ç –∫–æ–∂–Ω–æ–≥–æ —Ñ–∞–π–ª—É
        for i, file_path in enumerate(files, 1):
            relative_path = file_path.relative_to(root)

            print(f"  [{i}/{len(files)}] {relative_path}")

            f.write("\n" + "=" * 80 + "\n")
            f.write(f"–§–∞–π–ª {i}/{len(files)}: {relative_path}\n")
            f.write("-" * 80 + "\n")

            content = read_file_content(file_path)
            f.write(content)
            f.write("\n")

        # –ü—ñ–¥—Å—É–º–æ–∫
        f.write("\n" + "=" * 80 + "\n")
        f.write("–ö–Ü–ù–ï–¶–¨ –ï–ö–°–ü–û–†–¢–£\n")
        f.write("=" * 80 + "\n")

    file_size = Path(output_file).stat().st_size
    print(f"\n‚úÖ –ï–∫—Å–ø–æ—Ä—Ç –∑–∞–≤–µ—Ä—à–µ–Ω–æ!")
    print(f"üìÑ –§–∞–π–ª: {output_file}")
    print(f"üìä –†–æ–∑–º—ñ—Ä: {file_size / 1024:.1f} KB")
    print(f"üìÅ –§–∞–π–ª—ñ–≤ –æ–±—Ä–æ–±–ª–µ–Ω–æ: {len(files)}")


if __name__ == "__main__":
    import sys

    # –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è: python export_project.py [—à–ª—è—Ö_–¥–æ_–ø—Ä–æ—î–∫—Ç—É] [–≤–∏—Ö—ñ–¥–Ω–∏–π_—Ñ–∞–π–ª]
    project_path = sys.argv[1] if len(sys.argv) > 1 else "."
    output_file = sys.argv[2] if len(sys.argv) > 2 else None

    generate_project_export(project_path, output_file)


================================================================================
–§–∞–π–ª 3/21: GitCommitTool.py
--------------------------------------------------------------------------------
import customtkinter as ctk
from tkinter import messagebox, scrolledtext
import subprocess
import os
import re
from pathlib import Path
from datetime import datetime
from packaging.version import parse as parse_version


class GitCommitTool(ctk.CTk):
    def __init__(self):
        super().__init__()

        self.title("Git Commit Tool")
        self.geometry("600x750")
        self.resizable(False, False)
        self.is_running = False  # –ü—Ä–∞–ø–æ—Ä–µ—Ü—å –¥–ª—è –±–ª–æ–∫—É–≤–∞–Ω–Ω—è UI

        # –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç–µ–º–∏
        ctk.set_appearance_mode("dark")  # –ó–º—ñ–Ω–µ–Ω–æ –Ω–∞ —Ç–µ–º–Ω—É
        ctk.set_default_color_theme("blue")

        # –û—Ç—Ä–∏–º–∞–Ω–Ω—è –ø–æ—Ç–æ—á–Ω–æ—ó –≤–µ—Ä—Å—ñ—ó
        self.current_version = self.get_current_version()

        # –°–ø–∏—Å–æ–∫ –µ–ª–µ–º–µ–Ω—Ç—ñ–≤ UI –¥–ª—è –±–ª–æ–∫—É–≤–∞–Ω–Ω—è
        self.interactive_widgets = []

        self.setup_ui()
        self.toggle_version_fields()  # –ü–æ—á–∞—Ç–∫–æ–≤–µ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —Å—Ç–∞–Ω—É UI

    def setup_ui(self):
        """(–û–ù–û–í–õ–ï–ù–û) –°—Ç–≤–æ—Ä–µ–Ω–Ω—è UI"""

        main_frame = ctk.CTkFrame(self, fg_color="transparent")
        main_frame.pack(fill="both", expand=True, padx=20, pady=15)

        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        title_label = ctk.CTkLabel(
            main_frame,
            text="Git Commit Tool",
            font=ctk.CTkFont(size=24, weight="bold")
        )
        title_label.pack(pady=10)

        # –ü–æ—Ç–æ—á–Ω–∞ –≤–µ—Ä—Å—ñ—è
        version_frame = ctk.CTkFrame(main_frame)
        version_frame.pack(pady=10, fill="x")

        ctk.CTkLabel(
            version_frame,
            text="–ü–æ—Ç–æ—á–Ω–∞ –≤–µ—Ä—Å—ñ—è:",
            font=ctk.CTkFont(size=12, weight="bold")
        ).pack(side="left", padx=(10, 0))

        self.current_version_label = ctk.CTkLabel(
            version_frame,
            text=f"v{self.current_version}",
            font=ctk.CTkFont(size=12),
            text_color="gray"
        )
        self.current_version_label.pack(side="left", padx=10)

        # –ö–æ–º–µ–Ω—Ç–∞—Ä
        ctk.CTkLabel(
            main_frame,
            text="–ö–æ–º–µ–Ω—Ç–∞—Ä (commit message):",
            font=ctk.CTkFont(size=12, weight="bold")
        ).pack(anchor="w", pady=(10, 5))

        self.comment_entry = ctk.CTkEntry(
            main_frame,
            placeholder_text="–û–ø–∏—à—ñ—Ç—å –≤–∞—à—ñ –∑–º—ñ–Ω–∏...",
            height=40,
            font=ctk.CTkFont(size=11)
        )
        self.comment_entry.pack(fill="x", pady=(0, 15))
        self.interactive_widgets.append(self.comment_entry)

        # --- –ë–ª–æ–∫ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –≤–µ—Ä—Å—ñ—ó ---

        # –ß–µ–∫–±–æ–∫—Å –¥–ª—è —Ç–∞–≥—É
        self.tag_checkbox = ctk.CTkCheckBox(
            main_frame,
            text="–°—Ç–≤–æ—Ä–∏—Ç–∏ –Ω–æ–≤–∏–π —Ç–µ–≥ –≤–µ—Ä—Å—ñ—ó",
            font=ctk.CTkFont(size=11),
            command=self.toggle_version_fields
        )
        self.tag_checkbox.pack(anchor="w", pady=(0, 10))
        self.tag_checkbox.select()
        self.interactive_widgets.append(self.tag_checkbox)

        # –ù–æ–≤–∞ –≤–µ—Ä—Å—ñ—è
        self.version_frame_new = ctk.CTkFrame(main_frame)
        self.version_frame_new.pack(fill="x", pady=(0, 15))

        ctk.CTkLabel(
            self.version_frame_new,
            text="–ù–æ–≤–∞ –≤–µ—Ä—Å—ñ—è (–¥–ª—è —Ç–∞–≥—É):",
            font=ctk.CTkFont(size=12, weight="bold")
        ).pack(anchor="w", pady=(0, 5), padx=10)

        version_entry_frame = ctk.CTkFrame(self.version_frame_new, fg_color="transparent")
        version_entry_frame.pack(fill="x", padx=10)

        ctk.CTkLabel(
            version_entry_frame,
            text="v",
            font=ctk.CTkFont(size=11)
        ).pack(side="left", padx=(0, 5))

        self.version_entry = ctk.CTkEntry(
            version_entry_frame,
            placeholder_text="1.1.0",
            height=35,
            font=ctk.CTkFont(size=11)
        )
        self.version_entry.pack(side="left", fill="x", expand=True)
        self.version_entry.insert(0, self.current_version)  # –ü–æ–ø–µ—Ä–µ–¥–Ω—å–æ –∑–∞–ø–æ–≤–Ω—é—î–º–æ
        self.interactive_widgets.append(self.version_entry)

        # (–ù–û–í–ï) –ö–Ω–æ–ø–∫–∏ –¥–ª—è "–±–∞–º–ø—É" –≤–µ—Ä—Å—ñ—ó
        self.bump_button_frame = ctk.CTkFrame(self.version_frame_new, fg_color="transparent")
        self.bump_button_frame.pack(fill="x", padx=10, pady=10)

        bump_patch_btn = ctk.CTkButton(
            self.bump_button_frame, text="Patch (+0.0.1)",
            command=lambda: self.bump_version('patch'),
            font=ctk.CTkFont(size=10, weight="bold"), height=25
        )
        bump_patch_btn.pack(side="left", fill="x", expand=True, padx=2)

        bump_minor_btn = ctk.CTkButton(
            self.bump_button_frame, text="Minor (+0.1.0)",
            command=lambda: self.bump_version('minor'),
            font=ctk.CTkFont(size=10, weight="bold"), height=25
        )
        bump_minor_btn.pack(side="left", fill="x", expand=True, padx=2)

        bump_major_btn = ctk.CTkButton(
            self.bump_button_frame, text="Major (+1.0.0)",
            command=lambda: self.bump_version('major'),
            font=ctk.CTkFont(size=10, weight="bold"), height=25
        )
        bump_major_btn.pack(side="left", fill="x", expand=True, padx=2)

        self.interactive_widgets.extend([bump_patch_btn, bump_minor_btn, bump_major_btn])

        # –ö–Ω–æ–ø–∫–∏
        button_frame = ctk.CTkFrame(main_frame, fg_color="transparent")
        button_frame.pack(fill="x", pady=(0, 15))

        self.commit_btn = ctk.CTkButton(
            button_frame,
            text="‚úÖ Commit & Push",
            command=self.commit_and_push_thread,
            font=ctk.CTkFont(size=12, weight="bold"),
            height=45,
            corner_radius=10
        )
        self.commit_btn.pack(side="left", fill="both", expand=True, padx=(0, 5))
        self.interactive_widgets.append(self.commit_btn)

        clear_btn = ctk.CTkButton(
            button_frame,
            text="üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç–∏",
            command=self.clear_fields,
            font=ctk.CTkFont(size=12),
            height=45,
            corner_radius=10,
            fg_color="gray30",
            hover_color="gray50"
        )
        clear_btn.pack(side="left", fill="both", expand=True, padx=(5, 0))
        self.interactive_widgets.append(clear_btn)

        # –õ–æ–≥–∏
        ctk.CTkLabel(
            main_frame,
            text="–õ–æ–≥–∏ –æ–ø–µ—Ä–∞—Ü—ñ–π:",
            font=ctk.CTkFont(size=11, weight="bold")
        ).pack(anchor="w", pady=(10, 5))

        log_frame = ctk.CTkFrame(main_frame, fg_color="transparent")
        log_frame.pack(fill="both", expand=True)

        self.log_text = scrolledtext.ScrolledText(
            log_frame,
            height=10,
            width=70,
            font=("Courier", 10),
            bg="#2B2B2B",  # –¢–µ–º–Ω–∏–π —Ñ–æ–Ω
            fg="#E0E0E0",  # –°–≤—ñ—Ç–ª–∏–π —Ç–µ–∫—Å—Ç
            relief="solid",
            borderwidth=1,
            bd=0
        )
        self.log_text.pack(fill="both", expand=True)
        # (–ù–û–í–ï) –¢–µ–≥–∏ –¥–ª—è –∫–æ–ª—å–æ—Ä—ñ–≤
        self.log_text.tag_config("info", foreground="#89CFF0")
        self.log_text.tag_config("success", foreground="#7FFF7F")
        self.log_text.tag_config("error", foreground="#FF6B6B")
        self.log_text.tag_config("warning", foreground="#FFA500")

        # –°—Ç–∞—Ç—É—Å
        self.status_label = ctk.CTkLabel(
            main_frame,
            text="–ì–æ—Ç–æ–≤–æ –¥–æ —Ä–æ–±–æ—Ç–∏",
            font=ctk.CTkFont(size=10),
            text_color="gray"
        )
        self.status_label.pack(pady=(10, 0))

    def get_current_version(self):
        """–û—Ç—Ä–∏–º–∞–Ω–Ω—è –ø–æ—Ç–æ—á–Ω–æ—ó –≤–µ—Ä—Å—ñ—ó –∑ version.txt"""
        try:
            with open("version.txt", "r") as f:
                version = f.read().strip()
                # (–ù–û–í–ï) –í–∞–ª—ñ–¥–∞—Ü—ñ—è –≤–µ—Ä—Å—ñ—ó
                if re.match(r"^\d+\.\d+\.\d+$", version):
                    return version
                else:
                    return "1.0.0"  # Fallback
        except:
            return "1.0.0"

    def toggle_version_fields(self):
        """(–ù–û–í–ï) –í–º–∏–∫–∞—î/–≤–∏–º–∏–∫–∞—î –±–ª–æ–∫ –≤–µ—Ä—Å—ñ—ó"""
        is_enabled = self.tag_checkbox.get()
        state = "normal" if is_enabled else "disabled"

        self.version_entry.configure(state=state)
        for btn in self.bump_button_frame.winfo_children():
            btn.configure(state=state)

        # (–ù–û–í–ï) –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –ø—Ä–æ–ø–æ–Ω—É—î–º–æ patch-bump
        if is_enabled:
            self.bump_version('patch', auto_fill=True)

    def bump_version(self, part="patch", auto_fill=False):
        """(–ù–û–í–ï) –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∑–±—ñ–ª—å—à—É—î –≤–µ—Ä—Å—ñ—é"""
        try:
            current_v = parse_version(self.get_current_version())
            parts = list(current_v.release)

            if part == 'major':
                parts[0] += 1
                parts[1] = 0
                parts[2] = 0
            elif part == 'minor':
                parts[1] += 1
                parts[2] = 0
            else:  # patch
                parts[2] += 1

            new_version = f"{parts[0]}.{parts[1]}.{parts[2]}"

            if not auto_fill or self.version_entry.get() != new_version:
                self.version_entry.delete(0, "end")
                self.version_entry.insert(0, new_version)

        except Exception as e:
            self.log_message(f"‚ùå –ü–æ–º–∏–ª–∫–∞ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –≤–µ—Ä—Å—ñ—ó: {str(e)}", "error")

    def log_message(self, message, tag="info"):
        """(–û–ù–û–í–õ–ï–ù–û) –î–æ–¥–∞–Ω–Ω—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –¥–æ –ª–æ–≥—ñ–≤ –∑ —Ç–µ–≥–æ–º"""
        timestamp = datetime.now().strftime("%H:%M:%S")
        self.log_text.configure(state="normal")
        self.log_text.insert("end", f"[{timestamp}] {message}\n", tag)
        self.log_text.configure(state="disabled")
        self.log_text.see("end")
        self.update_idletasks()

    def set_ui_state(self, is_enabled):
        """(–ù–û–í–ï) –í–º–∏–∫–∞—î/–≤–∏–º–∏–∫–∞—î –≤–µ—Å—å UI"""
        state = "normal" if is_enabled else "disabled"
        for widget in self.interactive_widgets:
            widget.configure(state=state)
        self.is_running = not is_enabled
        if is_enabled:
            self.toggle_version_fields()  # –ü–æ–≤–µ—Ä—Ç–∞—î–º–æ –∫–æ—Ä–µ–∫—Ç–Ω–∏–π —Å—Ç–∞–Ω –ø–æ–ª—ñ–≤ –≤–µ—Ä—Å—ñ—ó

    def run_git_command(self, command, log_output=True):
        """(–û–ù–û–í–õ–ï–ù–û) –í–∏–∫–æ–Ω–∞–Ω–Ω—è git –∫–æ–º–∞–Ω–¥–∏, –ø–æ–≤–µ—Ä—Ç–∞—î (success, output)"""
        self.log_message(f"$ {command}", "info")
        try:
            result = subprocess.run(
                command,
                shell=True,
                capture_output=True,
                text=True,
                encoding='utf-8',  # –í—Å—Ç–∞–Ω–æ–≤–ª—é—î–º–æ –∫–æ–¥—É–≤–∞–Ω–Ω—è
                cwd=os.getcwd()
            )

            if result.returncode == 0:
                if result.stdout and log_output:
                    self.log_message(f"{result.stdout.strip()}", "success")
                return True, result.stdout.strip()
            else:
                error_msg = result.stderr.strip() if result.stderr else "–ù–µ–≤—ñ–¥–æ–º–∞ –ø–æ–º–∏–ª–∫–∞"
                if log_output:
                    self.log_message(f"‚ùå –ü–æ–º–∏–ª–∫–∞: {error_msg}", "error")
                return False, error_msg
        except Exception as e:
            self.log_message(f"‚ùå –í–∏–Ω—è—Ç–æ–∫: {str(e)}", "error")
            return False, str(e)

    def get_current_branch(self):
        """(–ù–û–í–ï) –û—Ç—Ä–∏–º—É—î –ø–æ—Ç–æ—á–Ω—É –≥—ñ–ª–∫—É git"""
        success, output = self.run_git_command("git rev-parse --abbrev-ref HEAD", log_output=False)
        if success:
            return output
        return "main"  # Fallback

    def commit_and_push_thread(self):
        """(–ù–û–í–ï) –ó–∞–ø—É—Å–∫–∞—î –ø—Ä–æ—Ü–µ—Å –≤ –æ–∫—Ä–µ–º–æ–º—É –ø–æ—Ç–æ—Ü—ñ, —â–æ–± UI –Ω–µ "–∑–∞–≤–∏—Å–∞–≤" """
        if self.is_running:
            self.log_message("‚è≥ –û–ø–µ—Ä–∞—Ü—ñ—è –≤–∂–µ –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è...", "warning")
            return

        # –ó–∞–ø—É—Å–∫–∞—î–º–æ –≤ –æ–∫—Ä–µ–º–æ–º—É –ø–æ—Ç–æ—Ü—ñ
        import threading
        threading.Thread(target=self.commit_and_push, daemon=True).start()

    def commit_and_push(self):
        """(–û–ù–û–í–õ–ï–ù–û) –û—Å–Ω–æ–≤–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è - commit, tag —ñ push"""

        self.set_ui_state(False)
        self.status_label.configure(text="‚è≥ –û–±—Ä–æ–±–∫–∞...")

        try:
            comment = self.comment_entry.get().strip()
            new_version = self.version_entry.get().strip()
            create_tag = self.tag_checkbox.get()

            # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∏
            if not comment:
                messagebox.showwarning("–ü–æ–º–∏–ª–∫–∞", "–ù–∞–ø–∏—à—ñ—Ç—å –∫–æ–º–µ–Ω—Ç–∞—Ä –¥–æ –∫–æ–º—ñ—Ç—é!")
                self.log_message("‚ùå –ö–æ–º–µ–Ω—Ç–∞—Ä –Ω–µ –º–æ–∂–µ –±—É—Ç–∏ –ø–æ—Ä–æ–∂–Ω—ñ–º", "error")
                return

            if create_tag and not new_version:
                messagebox.showwarning("–ü–æ–º–∏–ª–∫–∞", "–ù–∞–ø–∏—à—ñ—Ç—å –Ω–æ–≤—É –≤–µ—Ä—Å—ñ—é –¥–ª—è —Ç–∞–≥—É!")
                self.log_message("‚ùå –ù–æ–º–µ—Ä –≤–µ—Ä—Å—ñ—ó –Ω–µ –º–æ–∂–µ –±—É—Ç–∏ –ø–æ—Ä–æ–∂–Ω—ñ–º", "error")
                return

            self.log_message("=" * 50, "info")
            self.log_message("üöÄ –†–æ–∑–ø–æ—á–∏–Ω–∞—î–º–æ commit & push –ø—Ä–æ—Ü–µ—Å...", "info")
            self.log_message("=" * 50, "info")

            # –ö—Ä–æ–∫ 1: –û—Ç—Ä–∏–º–∞–Ω–Ω—è –ø–æ—Ç–æ—á–Ω–æ—ó –≥—ñ–ª–∫–∏
            self.log_message("\nüìã –ö—Ä–æ–∫ 1: –í–∏–∑–Ω–∞—á–µ–Ω–Ω—è –ø–æ—Ç–æ—á–Ω–æ—ó –≥—ñ–ª–∫–∏...", "info")
            current_branch = self.get_current_branch()
            self.log_message(f"–ü–æ—Ç–æ—á–Ω–∞ –≥—ñ–ª–∫–∞: {current_branch}", "success")

            # –ö—Ä–æ–∫ 2: –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å—É
            self.log_message("\nüìã –ö—Ä–æ–∫ 2: –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å—É —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—é...", "info")
            success, status_output = self.run_git_command("git status --short")
            if not status_output:
                self.log_message("‚úÖ –ù–µ–º–∞—î –∑–º—ñ–Ω –¥–ª—è –∫–æ–º—ñ—Ç—É. –í—Å–µ —á–∏—Å—Ç–æ!", "success")
                self.status_label.configure(text="‚úÖ –ù–µ–º–∞—î –∑–º—ñ–Ω")
                return

            # –ö—Ä–æ–∫ 3: –î–æ–¥–∞–≤–∞–Ω–Ω—è –≤—Å—ñ—Ö —Ñ–∞–π–ª—ñ–≤
            self.log_message("\nüì¶ –ö—Ä–æ–∫ 3: –î–æ–¥–∞–≤–∞–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤ (git add .)...", "info")
            if not self.run_git_command("git add .")[0]:
                self.status_label.configure(text="‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ 'git add'")
                messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–ù–µ –≤–¥–∞–ª–æ—Å—è –¥–æ–¥–∞—Ç–∏ —Ñ–∞–π–ª–∏!")
                return

            # –ö—Ä–æ–∫ 4: –ö–æ–º—ñ—Ç
            self.log_message("\nüíæ –ö—Ä–æ–∫ 4: –ö–æ–º—ñ—Ç—É–≤–∞–Ω–Ω—è –∑–º—ñ–Ω...", "info")
            if not self.run_git_command(f'git commit -m "{comment}"')[0]:
                self.status_label.configure(text="‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –∫–æ–º—ñ—Ç—É–≤–∞–Ω–Ω—ñ")
                # (–º–æ–∂–ª–∏–≤–æ, –Ω–µ –±—É–ª–æ –∑–º—ñ–Ω)
                return

            # –ö—Ä–æ–∫ 5: Push
            self.log_message(f"\n‚¨ÜÔ∏è  –ö—Ä–æ–∫ 5: –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –Ω–∞ GitHub (git push origin {current_branch})...", "info")
            if not self.run_git_command(f"git push origin {current_branch}")[0]:
                self.status_label.configure(text="‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ 'git push'")
                messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–ù–µ –≤–¥–∞–ª–æ—Å—è –≤—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ –Ω–∞ GitHub!")
                return

            # –ö—Ä–æ–∫ 6: –¢–µ–≥ (—è–∫—â–æ –ø–æ—Ç—Ä—ñ–±–µ–Ω)
            if create_tag:
                self.log_message(f"\nüè∑Ô∏è  –ö—Ä–æ–∫ 6: –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–∞–≥—É v{new_version}...", "info")
                if not self.run_git_command(f"git tag v{new_version}")[0]:
                    self.status_label.configure(text="‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—ñ —Ç–∞–≥—É")
                    messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–ù–µ –≤–¥–∞–ª–æ—Å—è —Å—Ç–≤–æ—Ä–∏—Ç–∏ —Ç–µ–≥! –ú–æ–∂–ª–∏–≤–æ, –≤—ñ–Ω –≤–∂–µ —ñ—Å–Ω—É—î.")
                    return

                self.log_message(f"\n‚¨ÜÔ∏è  –ö—Ä–æ–∫ 7: –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ç–∞–≥—É –Ω–∞ GitHub...", "info")
                if not self.run_git_command(f"git push origin v{new_version}")[0]:
                    self.status_label.configure(text="‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ 'git push' —Ç–∞–≥—É")
                    messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–ù–µ –≤–¥–∞–ª–æ—Å—è –≤—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ —Ç–µ–≥!")
                    return

                # –û–Ω–æ–≤–ª–µ–Ω–Ω—è version.txt
                self.log_message("\nüìù –ö—Ä–æ–∫ 8: –û–Ω–æ–≤–ª–µ–Ω–Ω—è version.txt...", "info")
                try:
                    with open("version.txt", "w") as f:
                        f.write(new_version)
                    self.log_message("‚úÖ version.txt –æ–Ω–æ–≤–ª–µ–Ω–æ", "success")
                    self.current_version = new_version
                    self.current_version_label.configure(text=f"v{self.current_version}")
                except Exception as e:
                    self.log_message(f"‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –æ–Ω–æ–≤–ª–µ–Ω–Ω—ñ version.txt: {str(e)}", "error")

            self.log_message("\n" + "=" * 50, "success")
            self.log_message("‚úÖ –í–°–ï –£–°–ü–Ü–®–ù–û! GitHub Actions –ø–æ—á–Ω–µ –∫–æ–º–ø—ñ–ª—é–≤–∞—Ç–∏...", "success")
            self.log_message("=" * 50, "success")

            self.status_label.configure(text="‚úÖ –£—Å–ø—ñ—à–Ω–æ! GitHub Actions –∑–∞–ø—É—â–µ–Ω–æ")
            messagebox.showinfo(
                "–£—Å–ø—ñ—Ö",
                f"‚úÖ –ö–æ–º—ñ—Ç —É—Å–ø—ñ—à–Ω–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ!\n\n"
                f"–ö–æ–º–µ–Ω—Ç–∞—Ä: {comment}\n"
                + (f"–í–µ—Ä—Å—ñ—è: v{new_version}\n\nGitHub Actions –ø–æ—á–Ω–µ –∫–æ–º–ø—ñ–ª—é–≤–∞—Ç–∏ EXE..." if create_tag else "")
            )

            self.clear_fields()

        finally:
            # (–ù–û–í–ï) –ó–∞–≤–∂–¥–∏ –≤–º–∏–∫–∞—î–º–æ UI –Ω–∞–∑–∞–¥, –Ω–∞–≤—ñ—Ç—å —è–∫—â–æ –±—É–ª–∞ –ø–æ–º–∏–ª–∫–∞
            self.set_ui_state(True)
            if '–ü–æ–º–∏–ª–∫–∞' not in self.status_label.cget("text"):
                self.status_label.configure(text="–ì–æ—Ç–æ–≤–æ –¥–æ —Ä–æ–±–æ—Ç–∏")

    def clear_fields(self):
        """–û—á–∏—Å—Ç–∫–∞ –ø–æ–ª—ñ–≤"""
        self.comment_entry.delete(0, "end")
        self.version_entry.delete(0, "end")
        self.tag_checkbox.select()
        self.toggle_version_fields()  # –û–Ω–æ–≤–ª—é—î–º–æ —Å—Ç–∞–Ω –ø–æ–ª—ñ–≤ –≤–µ—Ä—Å—ñ—ó
        self.status_label.configure(text="–ì–æ—Ç–æ–≤–æ –¥–æ —Ä–æ–±–æ—Ç–∏")


def main():
    app = GitCommitTool()
    app.mainloop()


if __name__ == "__main__":
    main()

================================================================================
–§–∞–π–ª 4/21: project_export_20251110_104446.txt
--------------------------------------------------------------------------------
================================================================================
–ï–ö–°–ü–û–†–¢ –ü–†–û–Ñ–ö–¢–£: RemoteHand
–î–∞—Ç–∞: 2025-11-10 10:44:46
–®–ª—è—Ö: D:\Python Projects\Prego\RemoteHand
================================================================================

üìÇ –°–¢–†–£–ö–¢–£–†–ê –ü–†–û–Ñ–ö–¢–£
--------------------------------------------------------------------------------
RemoteHand/
‚îú‚îÄ‚îÄ assets/
‚îÇ   ‚îî‚îÄ‚îÄ icon.ico
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ anydesk_manager.py
‚îÇ   ‚îú‚îÄ‚îÄ config.py
‚îÇ   ‚îú‚îÄ‚îÄ config_manager.py
‚îÇ   ‚îú‚îÄ‚îÄ main.py
‚îÇ   ‚îú‚îÄ‚îÄ network_test.py
‚îÇ   ‚îú‚îÄ‚îÄ rdp_manager.py
‚îÇ   ‚îú‚îÄ‚îÄ set_anydesk_password.py
‚îÇ   ‚îú‚îÄ‚îÄ setup_wizard.py
‚îÇ   ‚îú‚îÄ‚îÄ telegram_api.py
‚îÇ   ‚îú‚îÄ‚îÄ telegram_helper.py
‚îÇ   ‚îú‚îÄ‚îÄ update.bat
‚îÇ   ‚îú‚îÄ‚îÄ updater.py
‚îÇ   ‚îî‚îÄ‚îÄ utils.py
‚îú‚îÄ‚îÄ .env.example
‚îú‚îÄ‚îÄ 23.88.7.196_admin_session.rdp
‚îú‚îÄ‚îÄ dev_run.py
‚îú‚îÄ‚îÄ export.py
‚îú‚îÄ‚îÄ GitCommitTool.py
‚îú‚îÄ‚îÄ project_export_20251110_104446.txt
‚îú‚îÄ‚îÄ README.md
‚îú‚îÄ‚îÄ RemoteHand.spec
‚îú‚îÄ‚îÄ requirements.txt
‚îú‚îÄ‚îÄ version.txt
‚îú‚îÄ‚îÄ version_info.txt
‚îî‚îÄ‚îÄ –ê–∫—Ç–∏–≤–∞—Ü—ñ—è —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞.txt

üìÑ –í–ú–Ü–°–¢ –§–ê–ô–õ–Ü–í (21 —Ñ–∞–π–ª—ñ–≤)
================================================================================


================================================================================
–§–∞–π–ª 1/21: dev_run.py
--------------------------------------------------------------------------------
"""
DEV_RUN.PY - –õ–æ–∫–∞–ª—å–Ω–µ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è
"""

import sys
import os

# –í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ DEV —Ä–µ–∂–∏–º
os.environ['REMOTEHAND_DEV_MODE'] = '1'

# –î–æ–¥–∞—Ç–∏ src –≤ path
sys.path.insert(0, os.path.join(os.path.dirname(__file__), 'src'))

print("–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π...")
import subprocess
subprocess.run([sys.executable, "-m", "pip", "install", "-r", "requirements.txt", "-q"],
               capture_output=True)

print("üîß –ó–∞–ø—É—Å–∫ —É DEV —Ä–µ–∂–∏–º—ñ...")

# –ü—Ä—è–º–æ –∑–∞–ø—É—Å—Ç–∏—Ç–∏ main
if __name__ == "__main__":
    import main
    main.main()


================================================================================
–§–∞–π–ª 2/21: export.py
--------------------------------------------------------------------------------
#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Project Structure Exporter
–°—Ç–≤–æ—Ä—é—î –¥–µ—Ç–∞–ª—å–Ω–∏–π –æ–ø–∏—Å —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ –ø—Ä–æ—î–∫—Ç—É —Ç–∞ –≤–º—ñ—Å—Ç —Ñ–∞–π–ª—ñ–≤ —É –æ–¥–∏–Ω —Ñ–∞–π–ª
"""

import os
from pathlib import Path
from datetime import datetime

# –§–∞–π–ª–∏ —Ç–∞ –ø–∞–ø–∫–∏, —è–∫—ñ —Ç—Ä–µ–±–∞ —ñ–≥–Ω–æ—Ä—É–≤–∞—Ç–∏
IGNORE_PATTERNS = {
    # –ü–∞–ø–∫–∏
    '__pycache__', '.git', '.idea', '.vscode', 'node_modules',
    'venv', 'env', '.env', 'dist', 'build', '.pytest_cache',
    '.mypy_cache', 'htmlcov', '.coverage', 'logs', 'tmp',
    # –§–∞–π–ª–∏
    '.pyc', '.pyo', '.pyd', '.so', '.dll', '.dylib', '.exe',
    '.log', '.sqlite', '.db', '.pkl', '.pickle', '.DS_Store',
    'Thumbs.db', '.env', '.env.local', '.gitignore'
}

# –†–æ–∑—à–∏—Ä–µ–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤ –¥–ª—è —á–∏—Ç–∞–Ω–Ω—è (—Ç–µ–∫—Å—Ç–æ–≤—ñ —Ñ–∞–π–ª–∏)
TEXT_EXTENSIONS = {
    '.py', '.js', '.ts', '.jsx', '.tsx', '.html', '.css', '.scss',
    '.json', '.yaml', '.yml', '.toml', '.ini', '.cfg', '.conf',
    '.txt', '.md', '.rst', '.xml', '.sql', '.sh', '.bash',
    '.env.example', '.gitignore', 'Dockerfile', 'Makefile',
    '.java', '.c', '.cpp', '.h', '.go', '.rs', '.php', '.rb'
}

# –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∏–π —Ä–æ–∑–º—ñ—Ä —Ñ–∞–π–ª—É (1 MB)
MAX_FILE_SIZE = 1024 * 1024


def should_ignore(path: Path) -> bool:
    """–ü–µ—Ä–µ–≤—ñ—Ä—è—î, —á–∏ —Ç—Ä–µ–±–∞ —ñ–≥–Ω–æ—Ä—É–≤–∞—Ç–∏ —Ñ–∞–π–ª/–ø–∞–ø–∫—É"""
    name = path.name

    # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ç–æ—á–Ω–æ–≥–æ –∑–±—ñ–≥—É
    if name in IGNORE_PATTERNS:
        return True

    # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è
    if path.suffix in IGNORE_PATTERNS:
        return True

    # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø—Ä–∏—Ö–æ–≤–∞–Ω–∏—Ö —Ñ–∞–π–ª—ñ–≤ (–∫—Ä—ñ–º .env.example)
    if name.startswith('.') and name != '.env.example':
        return True

    return False


def is_text_file(path: Path) -> bool:
    """–ü–µ—Ä–µ–≤—ñ—Ä—è—î, —á–∏ —î —Ñ–∞–π–ª —Ç–µ–∫—Å—Ç–æ–≤–∏–º"""
    # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è
    if path.suffix.lower() in TEXT_EXTENSIONS:
        return True

    # –§–∞–π–ª–∏ –±–µ–∑ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è, —è–∫—ñ –∑–∞–∑–≤–∏—á–∞–π —Ç–µ–∫—Å—Ç–æ–≤—ñ
    if path.suffix == '' and path.name in {'Dockerfile', 'Makefile', 'README', 'LICENSE'}:
        return True

    return False


def get_tree_structure(root_path: Path, prefix: str = "", is_last: bool = True) -> list:
    """–ì–µ–Ω–µ—Ä—É—î –¥–µ—Ä–µ–≤–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ –ø—Ä–æ—î–∫—Ç—É"""
    lines = []

    try:
        items = sorted(root_path.iterdir(), key=lambda x: (not x.is_dir(), x.name.lower()))
        items = [item for item in items if not should_ignore(item)]

        for i, item in enumerate(items):
            is_last_item = i == len(items) - 1
            current_prefix = "‚îî‚îÄ‚îÄ " if is_last_item else "‚îú‚îÄ‚îÄ "
            lines.append(f"{prefix}{current_prefix}{item.name}{'/' if item.is_dir() else ''}")

            if item.is_dir():
                extension = "    " if is_last_item else "‚îÇ   "
                lines.extend(get_tree_structure(item, prefix + extension, is_last_item))

    except PermissionError:
        pass

    return lines


def read_file_content(file_path: Path) -> str:
    """–ß–∏—Ç–∞—î –≤–º—ñ—Å—Ç —Ñ–∞–π–ª—É"""
    try:
        # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ä–æ–∑–º—ñ—Ä—É
        if file_path.stat().st_size > MAX_FILE_SIZE:
            return f"[–§–∞–π–ª –∑–∞–Ω–∞–¥—Ç–æ –≤–µ–ª–∏–∫–∏–π: {file_path.stat().st_size / 1024:.1f} KB]"

        # –°–ø—Ä–æ–±–∞ –ø—Ä–æ—á–∏—Ç–∞—Ç–∏ —è–∫ —Ç–µ–∫—Å—Ç
        with open(file_path, 'r', encoding='utf-8') as f:
            return f.read()
    except UnicodeDecodeError:
        # –Ø–∫—â–æ –Ω–µ –≤–¥–∞–ª–æ—Å—è –ø—Ä–æ—á–∏—Ç–∞—Ç–∏ —è–∫ UTF-8
        try:
            with open(file_path, 'r', encoding='cp1251') as f:
                return f.read()
        except:
            return "[–ù–µ –≤–¥–∞–ª–æ—Å—è –ø—Ä–æ—á–∏—Ç–∞—Ç–∏ —Ñ–∞–π–ª - –±—ñ–Ω–∞—Ä–Ω–∏–π –∞–±–æ –Ω–µ–≤—ñ–¥–æ–º–µ –∫–æ–¥—É–≤–∞–Ω–Ω—è]"
    except Exception as e:
        return f"[–ü–æ–º–∏–ª–∫–∞ —á–∏—Ç–∞–Ω–Ω—è: {str(e)}]"


def collect_files(root_path: Path) -> list:
    """–ó–±–∏—Ä–∞—î –≤—Å—ñ —Ç–µ–∫—Å—Ç–æ–≤—ñ —Ñ–∞–π–ª–∏ –ø—Ä–æ—î–∫—Ç—É"""
    files = []

    for item in root_path.rglob('*'):
        if item.is_file() and not should_ignore(item) and is_text_file(item):
            # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞, —â–æ –≤—Å—ñ –±–∞—Ç—å–∫—ñ–≤—Å—å–∫—ñ –ø–∞–ø–∫–∏ –Ω–µ —ñ–≥–Ω–æ—Ä—É—é—Ç—å—Å—è
            if not any(should_ignore(parent) for parent in item.parents):
                files.append(item)

    return sorted(files)


def generate_project_export(project_path: str, output_file: str = None):
    """–ì–µ–Ω–µ—Ä—É—î –ø–æ–≤–Ω–∏–π –µ–∫—Å–ø–æ—Ä—Ç –ø—Ä–æ—î–∫—Ç—É"""
    root = Path(project_path).resolve()

    if not root.exists():
        print(f"‚ùå –ü–æ–º–∏–ª–∫–∞: –®–ª—è—Ö '{project_path}' –Ω–µ —ñ—Å–Ω—É—î!")
        return

    if output_file is None:
        timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
        output_file = f"project_export_{timestamp}.txt"

    print(f"üìÅ –ê–Ω–∞–ª—ñ–∑ –ø—Ä–æ—î–∫—Ç—É: {root.name}")
    print(f"üìù –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –µ–∫—Å–ø–æ—Ä—Ç—É...")

    with open(output_file, 'w', encoding='utf-8') as f:
        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        f.write("=" * 80 + "\n")
        f.write(f"–ï–ö–°–ü–û–†–¢ –ü–†–û–Ñ–ö–¢–£: {root.name}\n")
        f.write(f"–î–∞—Ç–∞: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}\n")
        f.write(f"–®–ª—è—Ö: {root}\n")
        f.write("=" * 80 + "\n\n")

        # –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ—î–∫—Ç—É
        f.write("üìÇ –°–¢–†–£–ö–¢–£–†–ê –ü–†–û–Ñ–ö–¢–£\n")
        f.write("-" * 80 + "\n")
        f.write(f"{root.name}/\n")
        tree_lines = get_tree_structure(root)
        f.write("\n".join(tree_lines))
        f.write("\n\n")

        # –ó–±—ñ—Ä —Ñ–∞–π–ª—ñ–≤
        files = collect_files(root)

        f.write(f"üìÑ –í–ú–Ü–°–¢ –§–ê–ô–õ–Ü–í ({len(files)} —Ñ–∞–π–ª—ñ–≤)\n")
        f.write("=" * 80 + "\n\n")

        # –í–º—ñ—Å—Ç –∫–æ–∂–Ω–æ–≥–æ —Ñ–∞–π–ª—É
        for i, file_path in enumerate(files, 1):
            relative_path = file_path.relative_to(root)

            print(f"  [{i}/{len(files)}] {relative_path}")

            f.write("\n" + "=" * 80 + "\n")
            f.write(f"–§–∞–π–ª {i}/{len(files)}: {relative_path}\n")
            f.write("-" * 80 + "\n")

            content = read_file_content(file_path)
            f.write(content)
            f.write("\n")

        # –ü—ñ–¥—Å—É–º–æ–∫
        f.write("\n" + "=" * 80 + "\n")
        f.write("–ö–Ü–ù–ï–¶–¨ –ï–ö–°–ü–û–†–¢–£\n")
        f.write("=" * 80 + "\n")

    file_size = Path(output_file).stat().st_size
    print(f"\n‚úÖ –ï–∫—Å–ø–æ—Ä—Ç –∑–∞–≤–µ—Ä—à–µ–Ω–æ!")
    print(f"üìÑ –§–∞–π–ª: {output_file}")
    print(f"üìä –†–æ–∑–º—ñ—Ä: {file_size / 1024:.1f} KB")
    print(f"üìÅ –§–∞–π–ª—ñ–≤ –æ–±—Ä–æ–±–ª–µ–Ω–æ: {len(files)}")


if __name__ == "__main__":
    import sys

    # –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è: python export_project.py [—à–ª—è—Ö_–¥–æ_–ø—Ä–æ—î–∫—Ç—É] [–≤–∏—Ö—ñ–¥–Ω–∏–π_—Ñ–∞–π–ª]
    project_path = sys.argv[1] if len(sys.argv) > 1 else "."
    output_file = sys.argv[2] if len(sys.argv) > 2 else None

    generate_project_export(project_path, output_file)


================================================================================
–§–∞–π–ª 3/21: GitCommitTool.py
--------------------------------------------------------------------------------
import customtkinter as ctk
from tkinter import messagebox, scrolledtext
import subprocess
import os
from pathlib import Path
from datetime import datetime


class GitCommitTool(ctk.CTk):
    def __init__(self):
        super().__init__()

        self.title("Git Commit Tool")
        self.geometry("600x700")
        self.resizable(False, False)

        # –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç–µ–º–∏
        ctk.set_appearance_mode("light")
        ctk.set_default_color_theme("blue")

        # –û—Ç—Ä–∏–º–∞–Ω–Ω—è –ø–æ—Ç–æ—á–Ω–æ—ó –≤–µ—Ä—Å—ñ—ó
        self.current_version = self.get_current_version()

        self.setup_ui()

    def setup_ui(self):
        """–°—Ç–≤–æ—Ä–µ–Ω–Ω—è UI"""

        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        title_label = ctk.CTkLabel(
            self,
            text="Git Commit Tool",
            font=ctk.CTkFont(size=24, weight="bold")
        )
        title_label.pack(pady=15)

        # –ü–æ—Ç–æ—á–Ω–∞ –≤–µ—Ä—Å—ñ—è
        version_frame = ctk.CTkFrame(self)
        version_frame.pack(pady=10, padx=20, fill="x")

        ctk.CTkLabel(
            version_frame,
            text="–ü–æ—Ç–æ—á–Ω–∞ –≤–µ—Ä—Å—ñ—è:",
            font=ctk.CTkFont(size=12, weight="bold")
        ).pack(side="left")

        ctk.CTkLabel(
            version_frame,
            text=f"v{self.current_version}",
            font=ctk.CTkFont(size=12),
            text_color="gray"
        ).pack(side="left", padx=10)

        # –ö–æ–º–µ–Ω—Ç–∞—Ä
        ctk.CTkLabel(
            self,
            text="–ö–æ–º–µ–Ω—Ç–∞—Ä (commit message):",
            font=ctk.CTkFont(size=12, weight="bold")
        ).pack(anchor="w", padx=20, pady=(10, 5))

        self.comment_entry = ctk.CTkEntry(
            self,
            placeholder_text="–û–ø–∏—à—ñ—Ç—å –≤–∞—à—ñ –∑–º—ñ–Ω–∏...",
            height=40,
            font=ctk.CTkFont(size=11)
        )
        self.comment_entry.pack(padx=20, fill="x", pady=(0, 15))

        # –ù–æ–≤–∞ –≤–µ—Ä—Å—ñ—è
        ctk.CTkLabel(
            self,
            text="–ù–æ–≤–∞ –≤–µ—Ä—Å—ñ—è (–¥–ª—è —Ç–∞–≥—É):",
            font=ctk.CTkFont(size=12, weight="bold")
        ).pack(anchor="w", padx=20, pady=(10, 5))

        version_frame2 = ctk.CTkFrame(self)
        version_frame2.pack(padx=20, fill="x", pady=(0, 15))

        ctk.CTkLabel(
            version_frame2,
            text="v",
            font=ctk.CTkFont(size=11)
        ).pack(side="left", padx=(0, 5))

        self.version_entry = ctk.CTkEntry(
            version_frame2,
            placeholder_text="1.1.0",
            height=35,
            font=ctk.CTkFont(size=11)
        )
        self.version_entry.pack(side="left", fill="x", expand=True)

        # –ß–µ–∫–±–æ–∫—Å –¥–ª—è —Ç–∞–≥—É
        self.tag_checkbox = ctk.CTkCheckBox(
            self,
            text="–°—Ç–≤–æ—Ä–∏—Ç–∏ —Ç–µ–≥ –≤–µ—Ä—Å—ñ—ó",
            font=ctk.CTkFont(size=11)
        )
        self.tag_checkbox.pack(anchor="w", padx=20, pady=(0, 20))
        self.tag_checkbox.select()

        # –ö–Ω–æ–ø–∫–∏
        button_frame = ctk.CTkFrame(self)
        button_frame.pack(padx=20, fill="x", pady=(0, 15))

        commit_btn = ctk.CTkButton(
            button_frame,
            text="‚úÖ Commit & Push",
            command=self.commit_and_push,
            font=ctk.CTkFont(size=12, weight="bold"),
            height=45,
            corner_radius=10
        )
        commit_btn.pack(side="left", fill="both", expand=True, padx=(0, 5))

        clear_btn = ctk.CTkButton(
            button_frame,
            text="üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç–∏",
            command=self.clear_fields,
            font=ctk.CTkFont(size=12),
            height=45,
            corner_radius=10,
            fg_color="gray30",
            hover_color="gray50"
        )
        clear_btn.pack(side="left", fill="both", expand=True, padx=(5, 0))

        # –õ–æ–≥–∏
        ctk.CTkLabel(
            self,
            text="–õ–æ–≥–∏ –æ–ø–µ—Ä–∞—Ü—ñ–π:",
            font=ctk.CTkFont(size=11, weight="bold")
        ).pack(anchor="w", padx=20, pady=(10, 5))

        self.log_text = scrolledtext.ScrolledText(
            self,
            height=10,
            width=70,
            font=("Courier", 9),
            bg="#f0f0f0",
            fg="#333333",
            relief="solid",
            borderwidth=1
        )
        self.log_text.pack(padx=20, pady=(0, 15), fill="both", expand=True)

        # –°—Ç–∞—Ç—É—Å
        self.status_label = ctk.CTkLabel(
            self,
            text="–ì–æ—Ç–æ–≤–æ –¥–æ —Ä–æ–±–æ—Ç–∏",
            font=ctk.CTkFont(size=10),
            text_color="gray"
        )
        self.status_label.pack(pady=(0, 10))

    def get_current_version(self):
        """–û—Ç—Ä–∏–º–∞–Ω–Ω—è –ø–æ—Ç–æ—á–Ω–æ—ó –≤–µ—Ä—Å—ñ—ó –∑ version.txt"""
        try:
            with open("version.txt", "r") as f:
                return f.read().strip()
        except:
            return "1.0.0"

    def log_message(self, message):
        """–î–æ–¥–∞–Ω–Ω—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –¥–æ –ª–æ–≥—ñ–≤"""
        timestamp = datetime.now().strftime("%H:%M:%S")
        self.log_text.insert("end", f"[{timestamp}] {message}\n")
        self.log_text.see("end")
        self.update()

    def run_git_command(self, command):
        """–í–∏–∫–æ–Ω–∞–Ω–Ω—è git –∫–æ–º–∞–Ω–¥–∏"""
        try:
            result = subprocess.run(
                command,
                shell=True,
                capture_output=True,
                text=True,
                cwd=os.getcwd()
            )

            if result.returncode == 0:
                if result.stdout:
                    self.log_message(f"‚úÖ {result.stdout.strip()}")
                return True
            else:
                error_msg = result.stderr.strip() if result.stderr else "–ù–µ–≤—ñ–¥–æ–º–∞ –ø–æ–º–∏–ª–∫–∞"
                self.log_message(f"‚ùå –ü–æ–º–∏–ª–∫–∞: {error_msg}")
                return False
        except Exception as e:
            self.log_message(f"‚ùå –ò—Å–∫–ª—é—á–µ–Ω–∏–µ: {str(e)}")
            return False

    def commit_and_push(self):
        """–û—Å–Ω–æ–≤–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è - commit, tag —ñ push"""

        comment = self.comment_entry.get().strip()
        new_version = self.version_entry.get().strip()
        create_tag = self.tag_checkbox.get()

        # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∏
        if not comment:
            messagebox.showwarning("–ü–æ–º–∏–ª–∫–∞", "–ù–∞–ø–∏—à—ñ—Ç—å –∫–æ–º–µ–Ω—Ç–∞—Ä –¥–æ –∫–æ–º—ñ—Ç—é!")
            return

        if create_tag and not new_version:
            messagebox.showwarning("–ü–æ–º–∏–ª–∫–∞", "–ù–∞–ø–∏—à—ñ—Ç—å –Ω–æ–≤—É –≤–µ—Ä—Å—ñ—é –¥–ª—è —Ç–∞–≥—É!")
            return

        self.status_label.configure(text="‚è≥ –û–±—Ä–æ–±–∫–∞...")
        self.update()

        self.log_message("=" * 50)
        self.log_message("üöÄ –†–æ–∑–ø–æ—á–∏–Ω–∞—î–º–æ commit & push –ø—Ä–æ—Ü–µ—Å...")
        self.log_message("=" * 50)

        # –ö—Ä–æ–∫ 1: –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å—É
        self.log_message("\nüìã –ö—Ä–æ–∫ 1: –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å—É —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—é...")
        self.run_git_command("git status --short")

        # –ö—Ä–æ–∫ 2: –î–æ–±–∞–≤–ª–µ–Ω–Ω—è –≤—Å—ñ—Ö —Ñ–∞–π–ª—ñ–≤
        self.log_message("\nüì¶ –ö—Ä–æ–∫ 2: –î–æ–¥–∞–≤–∞–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤...")
        if not self.run_git_command("git add ."):
            self.status_label.configure(text="‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –¥–æ–¥–∞–≤–∞–Ω–Ω—ñ —Ñ–∞–π–ª—ñ–≤")
            messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–ù–µ –≤–¥–∞–ª–æ—Å—è –¥–æ–¥–∞—Ç–∏ —Ñ–∞–π–ª–∏!")
            return

        # –ö—Ä–æ–∫ 3: –ö–æ–º—ñ—Ç
        self.log_message("\nüíæ –ö—Ä–æ–∫ 3: –ö–æ–º—ñ—Ç—É–≤–∞–Ω–Ω—è –∑–º—ñ–Ω...")
        if not self.run_git_command(f'git commit -m "{comment}"'):
            self.status_label.configure(text="‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –∫–æ–º—ñ—Ç—É–≤–∞–Ω–Ω—ñ")
            messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–ù–µ –≤–¥–∞–ª–æ—Å—è –∑–∞–∫–æ–º—ñ—Ç–∏—Ç–∏!")
            return

        # –ö—Ä–æ–∫ 4: Push
        self.log_message("\n‚¨ÜÔ∏è  –ö—Ä–æ–∫ 4: –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –Ω–∞ GitHub...")
        if not self.run_git_command("git push origin main"):
            self.status_label.configure(text="‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ push")
            messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–ù–µ –≤–¥–∞–ª–æ—Å—è –≤—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ –Ω–∞ GitHub!")
            return

        # –ö—Ä–æ–∫ 5: –¢–µ–≥ (—è–∫—â–æ –ø–æ—Ç—Ä—ñ–±–µ–Ω)
        if create_tag:
            self.log_message("\nüè∑Ô∏è  –ö—Ä–æ–∫ 5: –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–∞–≥—É...")
            if not self.run_git_command(f"git tag v{new_version}"):
                self.status_label.configure(text="‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—ñ —Ç–∞–≥—É")
                messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–ù–µ –≤–¥–∞–ª–æ—Å—è —Å—Ç–≤–æ—Ä–∏—Ç–∏ —Ç–µ–≥!")
                return

            self.log_message("\n‚¨ÜÔ∏è  –ö—Ä–æ–∫ 6: –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ç–∞–≥—É –Ω–∞ GitHub...")
            if not self.run_git_command(f"git push origin v{new_version}"):
                self.status_label.configure(text="‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ push —Ç–∞–≥—É")
                messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–ù–µ –≤–¥–∞–ª–æ—Å—è –≤—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ —Ç–µ–≥!")
                return

            # –û–Ω–æ–≤–ª–µ–Ω–Ω—è version.txt
            self.log_message("\nüìù –ö—Ä–æ–∫ 7: –û–Ω–æ–≤–ª–µ–Ω–Ω—è version.txt...")
            try:
                with open("version.txt", "w") as f:
                    f.write(new_version)
                self.log_message("‚úÖ version.txt –æ–Ω–æ–≤–ª–µ–Ω–æ")
                self.current_version = new_version
            except Exception as e:
                self.log_message(f"‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –æ–Ω–æ–≤–ª–µ–Ω–Ω—ñ version.txt: {str(e)}")

        self.log_message("\n" + "=" * 50)
        self.log_message("‚úÖ –í–°–ï –£–°–ü–Ü–®–ù–û! GitHub Actions –ø–æ—á–Ω–µ –∫–æ–º–ø—ñ–ª—é–≤–∞—Ç–∏...")
        self.log_message("=" * 50)

        self.status_label.configure(text="‚úÖ –£—Å–ø—ñ—à–Ω–æ! GitHub Actions –∑–∞–ø—É—â–µ–Ω–æ")
        messagebox.showinfo(
            "–£—Å–ø—ñ—Ö",
            f"‚úÖ –ö–æ–º—ñ—Ç —É—Å–ø—ñ—à–Ω–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ!\n\n"
            f"–ö–æ–º–µ–Ω—Ç–∞—Ä: {comment}\n"
            + (f"–í–µ—Ä—Å—ñ—è: v{new_version}\n\nGitHub Actions –ø–æ—á–Ω–µ –∫–æ–º–ø—ñ–ª—é–≤–∞—Ç–∏ EXE..." if create_tag else "")
        )

        self.clear_fields()

    def clear_fields(self):
        """–û—á–∏—Å—Ç–∫–∞ –ø–æ–ª—ñ–≤"""
        self.comment_entry.delete(0, "end")
        self.version_entry.delete(0, "end")
        self.tag_checkbox.select()
        self.status_label.configure(text="–ì–æ—Ç–æ–≤–æ –¥–æ —Ä–æ–±–æ—Ç–∏")


def main():
    app = GitCommitTool()
    app.mainloop()


if __name__ == "__main__":
    main()


================================================================================
–§–∞–π–ª 4/21: project_export_20251110_104446.txt
--------------------------------------------------------------------------------
================================================================================
–ï–ö–°–ü–û–†–¢ –ü–†–û–Ñ–ö–¢–£: RemoteHand
–î–∞—Ç–∞: 2025-11-10 10:44:46
–®–ª—è—Ö: D:\Python Projects\Prego\RemoteHand
================================================================================

üìÇ –°–¢–†–£–ö–¢–£–†–ê –ü–†–û–Ñ–ö–¢–£
--------------------------------------------------------------------------------
RemoteHand/
‚îú‚îÄ‚îÄ assets/
‚îÇ   ‚îî‚îÄ‚îÄ icon.ico
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ anydesk_manager.py
‚îÇ   ‚îú‚îÄ‚îÄ config.py
‚îÇ   ‚îú‚îÄ‚îÄ config_manager.py
‚îÇ   ‚îú‚îÄ‚îÄ main.py
‚îÇ   ‚îú‚îÄ‚îÄ network_test.py
‚îÇ   ‚îú‚îÄ‚îÄ rdp_manager.py
‚îÇ   ‚îú‚îÄ‚îÄ set_anydesk_password.py
‚îÇ   ‚îú‚îÄ‚îÄ setup_wizard.py
‚îÇ   ‚îú‚îÄ‚îÄ telegram_api.py
‚îÇ   ‚îú‚îÄ‚îÄ telegram_helper.py
‚îÇ   ‚îú‚îÄ‚îÄ update.bat
‚îÇ   ‚îú‚îÄ‚îÄ updater.py
‚îÇ   ‚îî‚îÄ‚îÄ utils.py
‚îú‚îÄ‚îÄ .env.example
‚îú‚îÄ‚îÄ 23.88.7.196_admin_session.rdp
‚îú‚îÄ‚îÄ dev_run.py
‚îú‚îÄ‚îÄ export.py
‚îú‚îÄ‚îÄ GitCommitTool.py
‚îú‚îÄ‚îÄ project_export_20251110_104446.txt
‚îú‚îÄ‚îÄ README.md
‚îú‚îÄ‚îÄ RemoteHand.spec
‚îú‚îÄ‚îÄ requirements.txt
‚îú‚îÄ‚îÄ version.txt
‚îú‚îÄ‚îÄ version_info.txt
‚îî‚îÄ‚îÄ –ê–∫—Ç–∏–≤–∞—Ü—ñ—è —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞.txt

üìÑ –í–ú–Ü–°–¢ –§–ê–ô–õ–Ü–í (21 —Ñ–∞–π–ª—ñ–≤)
================================================================================


================================================================================
–§–∞–π–ª 1/21: dev_run.py
--------------------------------------------------------------------------------
"""
DEV_RUN.PY - –õ–æ–∫–∞–ª—å–Ω–µ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è
"""

import sys
import os

# –í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ DEV —Ä–µ–∂–∏–º
os.environ['REMOTEHAND_DEV_MODE'] = '1'

# –î–æ–¥–∞—Ç–∏ src –≤ path
sys.path.insert(0, os.path.join(os.path.dirname(__file__), 'src'))

print("–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π...")
import subprocess
subprocess.run([sys.executable, "-m", "pip", "install", "-r", "requirements.txt", "-q"],
               capture_output=True)

print("üîß –ó–∞–ø—É—Å–∫ —É DEV —Ä–µ–∂–∏–º—ñ...")

# –ü—Ä—è–º–æ –∑–∞–ø—É—Å—Ç–∏—Ç–∏ main
if __name__ == "__main__":
    import main
    main.main()


================================================================================
–§–∞–π–ª 2/21: export.py
--------------------------------------------------------------------------------
#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Project Structure Exporter
–°—Ç–≤–æ—Ä—é—î –¥–µ—Ç–∞–ª—å–Ω–∏–π –æ–ø–∏—Å —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ –ø—Ä–æ—î–∫—Ç—É —Ç–∞ –≤–º—ñ—Å—Ç —Ñ–∞–π–ª—ñ–≤ —É –æ–¥–∏–Ω —Ñ–∞–π–ª
"""

import os
from pathlib import Path
from datetime import datetime

# –§–∞–π–ª–∏ —Ç–∞ –ø–∞–ø–∫–∏, —è–∫—ñ —Ç—Ä–µ–±–∞ —ñ–≥–Ω–æ—Ä—É–≤–∞—Ç–∏
IGNORE_PATTERNS = {
    # –ü–∞–ø–∫–∏
    '__pycache__', '.git', '.idea', '.vscode', 'node_modules',
    'venv', 'env', '.env', 'dist', 'build', '.pytest_cache',
    '.mypy_cache', 'htmlcov', '.coverage', 'logs', 'tmp',
    # –§–∞–π–ª–∏
    '.pyc', '.pyo', '.pyd', '.so', '.dll', '.dylib', '.exe',
    '.log', '.sqlite', '.db', '.pkl', '.pickle', '.DS_Store',
    'Thumbs.db', '.env', '.env.local', '.gitignore'
}

# –†–æ–∑—à–∏—Ä–µ–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤ –¥–ª—è —á–∏—Ç–∞–Ω–Ω—è (—Ç–µ–∫—Å—Ç–æ–≤—ñ —Ñ–∞–π–ª–∏)
TEXT_EXTENSIONS = {
    '.py', '.js', '.ts', '.jsx', '.tsx', '.html', '.css', '.scss',
    '.json', '.yaml', '.yml', '.toml', '.ini', '.cfg', '.conf',
    '.txt', '.md', '.rst', '.xml', '.sql', '.sh', '.bash',
    '.env.example', '.gitignore', 'Dockerfile', 'Makefile',
    '.java', '.c', '.cpp', '.h', '.go', '.rs', '.php', '.rb'
}

# –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∏–π —Ä–æ–∑–º—ñ—Ä —Ñ–∞–π–ª—É (1 MB)
MAX_FILE_SIZE = 1024 * 1024


def should_ignore(path: Path) -> bool:
    """–ü–µ—Ä–µ–≤—ñ—Ä—è—î, —á–∏ —Ç—Ä–µ–±–∞ —ñ–≥–Ω–æ—Ä—É–≤–∞—Ç–∏ —Ñ–∞–π–ª/–ø–∞–ø–∫—É"""
    name = path.name

    # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ç–æ—á–Ω–æ–≥–æ –∑–±—ñ–≥—É
    if name in IGNORE_PATTERNS:
        return True

    # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è
    if path.suffix in IGNORE_PATTERNS:
        return True

    # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø—Ä–∏—Ö–æ–≤–∞–Ω–∏—Ö —Ñ–∞–π–ª—ñ–≤ (–∫—Ä—ñ–º .env.example)
    if name.startswith('.') and name != '.env.example':
        return True

    return False


def is_text_file(path: Path) -> bool:
    """–ü–µ—Ä–µ–≤—ñ—Ä—è—î, —á–∏ —î —Ñ–∞–π–ª —Ç–µ–∫—Å—Ç–æ–≤–∏–º"""
    # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è
    if path.suffix.lower() in TEXT_EXTENSIONS:
        return True

    # –§–∞–π–ª–∏ –±–µ–∑ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è, —è–∫—ñ –∑–∞–∑–≤–∏—á–∞–π —Ç–µ–∫—Å—Ç–æ–≤—ñ
    if path.suffix == '' and path.name in {'Dockerfile', 'Makefile', 'README', 'LICENSE'}:
        return True

    return False


def get_tree_structure(root_path: Path, prefix: str = "", is_last: bool = True) -> list:
    """–ì–µ–Ω–µ—Ä—É—î –¥–µ—Ä–µ–≤–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ –ø—Ä–æ—î–∫—Ç—É"""
    lines = []

    try:
        items = sorted(root_path.iterdir(), key=lambda x: (not x.is_dir(), x.name.lower()))
        items = [item for item in items if not should_ignore(item)]

        for i, item in enumerate(items):
            is_last_item = i == len(items) - 1
            current_prefix = "‚îî‚îÄ‚îÄ " if is_last_item else "‚îú‚îÄ‚îÄ "
            lines.append(f"{prefix}{current_prefix}{item.name}{'/' if item.is_dir() else ''}")

            if item.is_dir():
                extension = "    " if is_last_item else "‚îÇ   "
                lines.extend(get_tree_structure(item, prefix + extension, is_last_item))

    except PermissionError:
        pass

    return lines


def read_file_content(file_path: Path) -> str:
    """–ß–∏—Ç–∞—î –≤–º—ñ—Å—Ç —Ñ–∞–π–ª—É"""
    try:
        # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ä–æ–∑–º—ñ—Ä—É
        if file_path.stat().st_size > MAX_FILE_SIZE:
            return f"[–§–∞–π–ª –∑–∞–Ω–∞–¥—Ç–æ –≤–µ–ª–∏–∫–∏–π: {file_path.stat().st_size / 1024:.1f} KB]"

        # –°–ø—Ä–æ–±–∞ –ø—Ä–æ—á–∏—Ç–∞—Ç–∏ —è–∫ —Ç–µ–∫—Å—Ç
        with open(file_path, 'r', encoding='utf-8') as f:
            return f.read()
    except UnicodeDecodeError:
        # –Ø–∫—â–æ –Ω–µ –≤–¥–∞–ª–æ—Å—è –ø—Ä–æ—á–∏—Ç–∞—Ç–∏ —è–∫ UTF-8
        try:
            with open(file_path, 'r', encoding='cp1251') as f:
                return f.read()
        except:
            return "[–ù–µ –≤–¥–∞–ª–æ—Å—è –ø—Ä–æ—á–∏—Ç–∞—Ç–∏ —Ñ–∞–π–ª - –±—ñ–Ω–∞—Ä–Ω–∏–π –∞–±–æ –Ω–µ–≤—ñ–¥–æ–º–µ –∫–æ–¥—É–≤–∞–Ω–Ω—è]"
    except Exception as e:
        return f"[–ü–æ–º–∏–ª–∫–∞ —á–∏—Ç–∞–Ω–Ω—è: {str(e)}]"


def collect_files(root_path: Path) -> list:
    """–ó–±–∏—Ä–∞—î –≤—Å—ñ —Ç–µ–∫—Å—Ç–æ–≤—ñ —Ñ–∞–π–ª–∏ –ø—Ä–æ—î–∫—Ç—É"""
    files = []

    for item in root_path.rglob('*'):
        if item.is_file() and not should_ignore(item) and is_text_file(item):
            # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞, —â–æ –≤—Å—ñ –±–∞—Ç—å–∫—ñ–≤—Å—å–∫—ñ –ø–∞–ø–∫–∏ –Ω–µ —ñ–≥–Ω–æ—Ä—É—é—Ç—å—Å—è
            if not any(should_ignore(parent) for parent in item.parents):
                files.append(item)

    return sorted(files)


def generate_project_export(project_path: str, output_file: str = None):
    """–ì–µ–Ω–µ—Ä—É—î –ø–æ–≤–Ω–∏–π –µ–∫—Å–ø–æ—Ä—Ç –ø—Ä–æ—î–∫—Ç—É"""
    root = Path(project_path).resolve()

    if not root.exists():
        print(f"‚ùå –ü–æ–º–∏–ª–∫–∞: –®–ª—è—Ö '{project_path}' –Ω–µ —ñ—Å–Ω—É—î!")
        return

    if output_file is None:
        timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
        output_file = f"project_export_{timestamp}.txt"

    print(f"üìÅ –ê–Ω–∞–ª—ñ–∑ –ø—Ä–æ—î–∫—Ç—É: {root.name}")
    print(f"üìù –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –µ–∫—Å–ø–æ—Ä—Ç—É...")

    with open(output_file, 'w', encoding='utf-8') as f:
        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        f.write("=" * 80 + "\n")
        f.write(f"–ï–ö–°–ü–û–†–¢ –ü–†–û–Ñ–ö–¢–£: {root.name}\n")
        f.write(f"–î–∞—Ç–∞: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}\n")
        f.write(f"–®–ª—è—Ö: {root}\n")
        f.write("=" * 80 + "\n\n")

        # –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ—î–∫—Ç—É
        f.write("üìÇ –°–¢–†–£–ö–¢–£–†–ê –ü–†–û–Ñ–ö–¢–£\n")
        f.write("-" * 80 + "\n")
        f.write(f"{root.name}/\n")
        tree_lines = get_tree_structure(root)
        f.write("\n".join(tree_lines))
        f.write("\n\n")

        # –ó–±—ñ—Ä —Ñ–∞–π–ª—ñ–≤
        files = collect_files(root)

        f.write(f"üìÑ –í–ú–Ü–°–¢ –§–ê–ô–õ–Ü–í ({len(files)} —Ñ–∞–π–ª—ñ–≤)\n")
        f.write("=" * 80 + "\n\n")

        # –í–º—ñ—Å—Ç –∫–æ–∂–Ω–æ–≥–æ —Ñ–∞–π–ª—É
        for i, file_path in enumerate(files, 1):
            relative_path = file_path.relative_to(root)

            print(f"  [{i}/{len(files)}] {relative_path}")

            f.write("\n" + "=" * 80 + "\n")
            f.write(f"–§–∞–π–ª {i}/{len(files)}: {relative_path}\n")
            f.write("-" * 80 + "\n")

            content = read_file_content(file_path)
            f.write(content)
            f.write("\n")

        # –ü—ñ–¥—Å—É–º–æ–∫
        f.write("\n" + "=" * 80 + "\n")
        f.write("–ö–Ü–ù–ï–¶–¨ –ï–ö–°–ü–û–†–¢–£\n")
        f.write("=" * 80 + "\n")

    file_size = Path(output_file).stat().st_size
    print(f"\n‚úÖ –ï–∫—Å–ø–æ—Ä—Ç –∑–∞–≤–µ—Ä—à–µ–Ω–æ!")
    print(f"üìÑ –§–∞–π–ª: {output_file}")
    print(f"üìä –†–æ–∑–º—ñ—Ä: {file_size / 1024:.1f} KB")
    print(f"üìÅ –§–∞–π–ª—ñ–≤ –æ–±—Ä–æ–±–ª–µ–Ω–æ: {len(files)}")


if __name__ == "__main__":
    import sys

    # –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è: python export_project.py [—à–ª—è—Ö_–¥–æ_–ø—Ä–æ—î–∫—Ç—É] [–≤–∏—Ö—ñ–¥–Ω–∏–π_—Ñ–∞–π–ª]
    project_path = sys.argv[1] if len(sys.argv) > 1 else "."
    output_file = sys.argv[2] if len(sys.argv) > 2 else None

    generate_project_export(project_path, output_file)


================================================================================
–§–∞–π–ª 3/21: GitCommitTool.py
--------------------------------------------------------------------------------
import customtkinter as ctk
from tkinter import messagebox, scrolledtext
import subprocess
import os
from pathlib import Path
from datetime import datetime


class GitCommitTool(ctk.CTk):
    def __init__(self):
        super().__init__()

        self.title("Git Commit Tool")
        self.geometry("600x700")
        self.resizable(False, False)

        # –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç–µ–º–∏
        ctk.set_appearance_mode("light")
        ctk.set_default_color_theme("blue")

        # –û—Ç—Ä–∏–º–∞–Ω–Ω—è –ø–æ—Ç–æ—á–Ω–æ—ó –≤–µ—Ä—Å—ñ—ó
        self.current_version = self.get_current_version()

        self.setup_ui()

    def setup_ui(self):
        """–°—Ç–≤–æ—Ä–µ–Ω–Ω—è UI"""

        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        title_label = ctk.CTkLabel(
            self,
            text="Git Commit Tool",
            font=ctk.CTkFont(size=24, weight="bold")
        )
        title_label.pack(pady=15)

        # –ü–æ—Ç–æ—á–Ω–∞ –≤–µ—Ä—Å—ñ—è
        version_frame = ctk.CTkFrame(self)
        version_frame.pack(pady=10, padx=20, fill="x")

        ctk.CTkLabel(
            version_frame,
            text="–ü–æ—Ç–æ—á–Ω–∞ –≤–µ—Ä—Å—ñ—è:",
            font=ctk.CTkFont(size=12, weight="bold")
        ).pack(side="left")

        ctk.CTkLabel(
            version_frame,
            text=f"v{self.current_version}",
            font=ctk.CTkFont(size=12),
            text_color="gray"
        ).pack(side="left", padx=10)

        # –ö–æ–º–µ–Ω—Ç–∞—Ä
        ctk.CTkLabel(
            self,
            text="–ö–æ–º–µ–Ω—Ç–∞—Ä (commit message):",
            font=ctk.CTkFont(size=12, weight="bold")
        ).pack(anchor="w", padx=20, pady=(10, 5))

        self.comment_entry = ctk.CTkEntry(
            self,
            placeholder_text="–û–ø–∏—à—ñ—Ç—å –≤–∞—à—ñ –∑–º—ñ–Ω–∏...",
            height=40,
            font=ctk.CTkFont(size=11)
        )
        self.comment_entry.pack(padx=20, fill="x", pady=(0, 15))

        # –ù–æ–≤–∞ –≤–µ—Ä—Å—ñ—è
        ctk.CTkLabel(
            self,
            text="–ù–æ–≤–∞ –≤–µ—Ä—Å—ñ—è (–¥–ª—è —Ç–∞–≥—É):",
            font=ctk.CTkFont(size=12, weight="bold")
        ).pack(anchor="w", padx=20, pady=(10, 5))

        version_frame2 = ctk.CTkFrame(self)
        version_frame2.pack(padx=20, fill="x", pady=(0, 15))

        ctk.CTkLabel(
            version_frame2,
            text="v",
            font=ctk.CTkFont(size=11)
        ).pack(side="left", padx=(0, 5))

        self.version_entry = ctk.CTkEntry(
            version_frame2,
            placeholder_text="1.1.0",
            height=35,
            font=ctk.CTkFont(size=11)
        )
        self.version_entry.pack(side="left", fill="x", expand=True)

        # –ß–µ–∫–±–æ–∫—Å –¥–ª—è —Ç–∞–≥—É
        self.tag_checkbox = ctk.CTkCheckBox(
            self,
            text="–°—Ç–≤–æ—Ä–∏—Ç–∏ —Ç–µ–≥ –≤–µ—Ä—Å—ñ—ó",
            font=ctk.CTkFont(size=11)
        )
        self.tag_checkbox.pack(anchor="w", padx=20, pady=(0, 20))
        self.tag_checkbox.select()

        # –ö–Ω–æ–ø–∫–∏
        button_frame = ctk.CTkFrame(self)
        button_frame.pack(padx=20, fill="x", pady=(0, 15))

        commit_btn = ctk.CTkButton(
            button_frame,
            text="‚úÖ Commit & Push",
            command=self.commit_and_push,
            font=ctk.CTkFont(size=12, weight="bold"),
            height=45,
            corner_radius=10
        )
        commit_btn.pack(side="left", fill="both", expand=True, padx=(0, 5))

        clear_btn = ctk.CTkButton(
            button_frame,
            text="üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç–∏",
            command=self.clear_fields,
            font=ctk.CTkFont(size=12),
            height=45,
            corner_radius=10,
            fg_color="gray30",
            hover_color="gray50"
        )
        clear_btn.pack(side="left", fill="both", expand=True, padx=(5, 0))

        # –õ–æ–≥–∏
        ctk.CTkLabel(
            self,
            text="–õ–æ–≥–∏ –æ–ø–µ—Ä–∞—Ü—ñ–π:",
            font=ctk.CTkFont(size=11, weight="bold")
        ).pack(anchor="w", padx=20, pady=(10, 5))

        self.log_text = scrolledtext.ScrolledText(
            self,
            height=10,
            width=70,
            font=("Courier", 9),
            bg="#f0f0f0",
            fg="#333333",
            relief="solid",
            borderwidth=1
        )
        self.log_text.pack(padx=20, pady=(0, 15), fill="both", expand=True)

        # –°—Ç–∞—Ç—É—Å
        self.status_label = ctk.CTkLabel(
            self,
            text="–ì–æ—Ç–æ–≤–æ –¥–æ —Ä–æ–±–æ—Ç–∏",
            font=ctk.CTkFont(size=10),
            text_color="gray"
        )
        self.status_label.pack(pady=(0, 10))

    def get_current_version(self):
        """–û—Ç—Ä–∏–º–∞–Ω–Ω—è –ø–æ—Ç–æ—á–Ω–æ—ó –≤–µ—Ä—Å—ñ—ó –∑ version.txt"""
        try:
            with open("version.txt", "r") as f:
                return f.read().strip()
        except:
            return "1.0.0"

    def log_message(self, message):
        """–î–æ–¥–∞–Ω–Ω—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –¥–æ –ª–æ–≥—ñ–≤"""
        timestamp = datetime.now().strftime("%H:%M:%S")
        self.log_text.insert("end", f"[{timestamp}] {message}\n")
        self.log_text.see("end")
        self.update()

    def run_git_command(self, command):
        """–í–∏–∫–æ–Ω–∞–Ω–Ω—è git –∫–æ–º–∞–Ω–¥–∏"""
        try:
            result = subprocess.run(
                command,
                shell=True,
                capture_output=True,
                text=True,
                cwd=os.getcwd()
            )

            if result.returncode == 0:
                if result.stdout:
                    self.log_message(f"‚úÖ {result.stdout.strip()}")
                return True
            else:
                error_msg = result.stderr.strip() if result.stderr else "–ù–µ–≤—ñ–¥–æ–º–∞ –ø–æ–º–∏–ª–∫–∞"
                self.log_message(f"‚ùå –ü–æ–º–∏–ª–∫–∞: {error_msg}")
                return False
        except Exception as e:
            self.log_message(f"‚ùå –ò—Å–∫–ª—é—á–µ–Ω–∏–µ: {str(e)}")
            return False

    def commit_and_push(self):
        """–û—Å–Ω–æ–≤–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è - commit, tag —ñ push"""

        comment = self.comment_entry.get().strip()
        new_version = self.version_entry.get().strip()
        create_tag = self.tag_checkbox.get()

        # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∏
        if not comment:
            messagebox.showwarning("–ü–æ–º–∏–ª–∫–∞", "–ù–∞–ø–∏—à—ñ—Ç—å –∫–æ–º–µ–Ω—Ç–∞—Ä –¥–æ –∫–æ–º—ñ—Ç—é!")
            return

        if create_tag and not new_version:
            messagebox.showwarning("–ü–æ–º–∏–ª–∫–∞", "–ù–∞–ø–∏—à—ñ—Ç—å –Ω–æ–≤—É –≤–µ—Ä—Å—ñ—é –¥–ª—è —Ç–∞–≥—É!")
            return

        self.status_label.configure(text="‚è≥ –û–±—Ä–æ–±–∫–∞...")
        self.update()

        self.log_message("=" * 50)
        self.log_message("üöÄ –†–æ–∑–ø–æ—á–∏–Ω–∞—î–º–æ commit & push –ø—Ä–æ—Ü–µ—Å...")
        self.log_message("=" * 50)

        # –ö—Ä–æ–∫ 1: –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å—É
        self.log_message("\nüìã –ö—Ä–æ–∫ 1: –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å—É —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—é...")
        self.run_git_command("git status --short")

        # –ö—Ä–æ–∫ 2: –î–æ–±–∞–≤–ª–µ–Ω–Ω—è –≤—Å—ñ—Ö —Ñ–∞–π–ª—ñ–≤
        self.log_message("\nüì¶ –ö—Ä–æ–∫ 2: –î–æ–¥–∞–≤–∞–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤...")
        if not self.run_git_command("git add ."):
            self.status_label.configure(text="‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –¥–æ–¥–∞–≤–∞–Ω–Ω—ñ —Ñ–∞–π–ª—ñ–≤")
            messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–ù–µ –≤–¥–∞–ª–æ—Å—è –¥–æ–¥–∞—Ç–∏ —Ñ–∞–π–ª–∏!")
            return

        # –ö—Ä–æ–∫ 3: –ö–æ–º—ñ—Ç
        self.log_message("\nüíæ –ö—Ä–æ–∫ 3: –ö–æ–º—ñ—Ç—É–≤–∞–Ω–Ω—è –∑–º—ñ–Ω...")
        if not self.run_git_command(f'git commit -m "{comment}"'):
            self.status_label.configure(text="‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –∫–æ–º—ñ—Ç—É–≤–∞–Ω–Ω—ñ")
            messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–ù–µ –≤–¥–∞–ª–æ—Å—è –∑–∞–∫–æ–º—ñ—Ç–∏—Ç–∏!")
            return

        # –ö—Ä–æ–∫ 4: Push
        self.log_message("\n‚¨ÜÔ∏è  –ö—Ä–æ–∫ 4: –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –Ω–∞ GitHub...")
        if not self.run_git_command("git push origin main"):
            self.status_label.configure(text="‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ push")
            messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–ù–µ –≤–¥–∞–ª–æ—Å—è –≤—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ –Ω–∞ GitHub!")
            return

        # –ö—Ä–æ–∫ 5: –¢–µ–≥ (—è–∫—â–æ –ø–æ—Ç—Ä—ñ–±–µ–Ω)
        if create_tag:
            self.log_message("\nüè∑Ô∏è  –ö—Ä–æ–∫ 5: –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–∞–≥—É...")
            if not self.run_git_command(f"git tag v{new_version}"):
                self.status_label.configure(text="‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—ñ —Ç–∞–≥—É")
                messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–ù–µ –≤–¥–∞–ª–æ—Å—è —Å—Ç–≤–æ—Ä–∏—Ç–∏ —Ç–µ–≥!")
                return

            self.log_message("\n‚¨ÜÔ∏è  –ö—Ä–æ–∫ 6: –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ç–∞–≥—É –Ω–∞ GitHub...")
            if not self.run_git_command(f"git push origin v{new_version}"):
                self.status_label.configure(text="‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ push —Ç–∞–≥—É")
                messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–ù–µ –≤–¥–∞–ª–æ—Å—è –≤—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ —Ç–µ–≥!")
                return

            # –û–Ω–æ–≤–ª–µ–Ω–Ω—è version.txt
            self.log_message("\nüìù –ö—Ä–æ–∫ 7: –û–Ω–æ–≤–ª–µ–Ω–Ω—è version.txt...")
            try:
                with open("version.txt", "w") as f:
                    f.write(new_version)
                self.log_message("‚úÖ version.txt –æ–Ω–æ–≤–ª–µ–Ω–æ")
                self.current_version = new_version
            except Exception as e:
                self.log_message(f"‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –æ–Ω–æ–≤–ª–µ–Ω–Ω—ñ version.txt: {str(e)}")

        self.log_message("\n" + "=" * 50)
        self.log_message("‚úÖ –í–°–ï –£–°–ü–Ü–®–ù–û! GitHub Actions –ø–æ—á–Ω–µ –∫–æ–º–ø—ñ–ª—é–≤–∞—Ç–∏...")
        self.log_message("=" * 50)

        self.status_label.configure(text="‚úÖ –£—Å–ø—ñ—à–Ω–æ! GitHub Actions –∑–∞–ø—É—â–µ–Ω–æ")
        messagebox.showinfo(
            "–£—Å–ø—ñ—Ö",
            f"‚úÖ –ö–æ–º—ñ—Ç —É—Å–ø—ñ—à–Ω–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ!\n\n"
            f"–ö–æ–º–µ–Ω—Ç–∞—Ä: {comment}\n"
            + (f"–í–µ—Ä—Å—ñ—è: v{new_version}\n\nGitHub Actions –ø–æ—á–Ω–µ –∫–æ–º–ø—ñ–ª—é–≤–∞—Ç–∏ EXE..." if create_tag else "")
        )

        self.clear_fields()

    def clear_fields(self):
        """–û—á–∏—Å—Ç–∫–∞ –ø–æ–ª—ñ–≤"""
        self.comment_entry.delete(0, "end")
        self.version_entry.delete(0, "end")
        self.tag_checkbox.select()
        self.status_label.configure(text="–ì–æ—Ç–æ–≤–æ –¥–æ —Ä–æ–±–æ—Ç–∏")


def main():
    app = GitCommitTool()
    app.mainloop()


if __name__ == "__main__":
    main()


================================================================================
–§–∞–π–ª 5/21: README.md
--------------------------------------------------------------------------------


================================================================================
–§–∞–π–ª 6/21: requirements.txt
--------------------------------------------------------------------------------
customtkinter==5.2.1
requests==2.31.0
psutil==5.9.6
keyring==24.1.0
python-telegram-bot==20.3
packaging>=24.0
pywin32>=300
python-dotenv

================================================================================
–§–∞–π–ª 7/21: src\anydesk_manager.py
--------------------------------------------------------------------------------
import os
import sys
import subprocess
import time
import logging
import psutil
import platform
import ctypes
import socket
from pathlib import Path
from typing import Optional, Tuple

logger = logging.getLogger(__name__)

UNATTENDED_PASSWORD = "r3moteh4nd"


class AnyDeskManager:
    """–ú–µ–Ω–µ–¥–∂–µ—Ä –¥–ª—è AnyDesk"""

    def __init__(self, config_manager, telegram_api):
        self.config = config_manager
        self.telegram = telegram_api
        self.anydesk_path = self.find_anydesk()
        self._is_running = False
        self.connection_id = None

    def find_anydesk(self) -> Optional[str]:
        """–ó–Ω–∞–π—Ç–∏ AnyDesk"""
        possible_paths = [
            r"C:\Program Files\AnyDesk\AnyDesk.exe",
            r"C:\Program Files (x86)\AnyDesk\AnyDesk.exe",
            os.path.expanduser("~\\AppData\\Local\\AnyDesk\\AnyDesk.exe"),
            os.path.expanduser("~\\AppData\\Roaming\\AnyDesk\\AnyDesk.exe"),
            os.path.expanduser("~\\Downloads\\AnyDesk.exe"),
            r"C:\ProgramData\AnyDesk\AnyDesk.exe",
        ]

        for path in possible_paths:
            if os.path.exists(path):
                logger.info(f"‚úÖ AnyDesk –∑–Ω–∞–π–¥–µ–Ω–æ: {path}")
                return path

        logger.warning("‚ö†Ô∏è AnyDesk –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ")
        return None

    def download_anydesk(self) -> bool:
        """–ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ AnyDesk"""
        if self.anydesk_path:
            return True

        logger.info("üì• –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è AnyDesk...")
        try:
            import urllib.request
            downloads_dir = os.path.expanduser("~\\Downloads")
            save_path = os.path.join(downloads_dir, "AnyDesk.exe")
            download_url = "https://download.anydesk.com/AnyDesk.exe"

            if not os.path.exists(save_path):
                logger.info(f"–ó–∞–≤–∞–Ω—Ç–∞–∂—É...")
                urllib.request.urlretrieve(download_url, save_path)

            logger.info("–ó–∞–ø—É—Å–∫ –≤—Å—Ç–∞–Ω–æ–≤–ª—é–≤–∞—á–∞...")
            subprocess.Popen([save_path])

            logger.info("–ß–µ–∫–∞—é –Ω–∞ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è (90 —Å–µ–∫)...")
            for i in range(90):
                time.sleep(1)
                self.anydesk_path = self.find_anydesk()
                if self.anydesk_path:
                    logger.info(f"‚úÖ AnyDesk –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ")
                    time.sleep(3)
                    return True

            return False
        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞: {e}")
            return False

    def check_if_running(self) -> bool:
        """–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —á–∏ AnyDesk –∑–∞–ø—É—â–µ–Ω–æ"""
        try:
            for proc in psutil.process_iter(['pid', 'name']):
                if 'anydesk' in proc.info['name'].lower():
                    logger.info(f"‚ÑπÔ∏è AnyDesk –∑–∞–ø—É—â–µ–Ω–æ (PID: {proc.info['pid']})")
                    self._is_running = True
                    return True
        except:
            pass
        self._is_running = False
        return False

    def launch_anydesk(self) -> bool:
        """–ó–∞–ø—É—Å—Ç–∏—Ç–∏ AnyDesk"""
        if self.check_if_running():
            return True

        if not self.anydesk_path or not Path(self.anydesk_path).exists():
            logger.error("–®–ª—è—Ö –Ω–µ–≤—ñ–¥–æ–º–∏–π")
            return False

        try:
            logger.info(f"üöÄ –ó–∞–ø—É—Å–∫–∞—é AnyDesk...")
            subprocess.Popen(self.anydesk_path)
            time.sleep(5)

            if self.check_if_running():
                logger.info("‚úÖ AnyDesk –∑–∞–ø—É—â–µ–Ω–æ")
                return True
            else:
                self._is_running = True
                return True
        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞: {e}")
            return False

    def set_password_with_admin(self) -> bool:
        """–í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –ø–∞—Ä–æ–ª—å —á–µ—Ä–µ–∑ –æ–∫—Ä–µ–º–∏–π —Å–∫—Ä–∏–ø—Ç –∑ –∞–¥–º—ñ–Ω –ø—Ä–∞–≤–∞–º–∏"""
        if not self.anydesk_path:
            logger.error("–®–ª—è—Ö –Ω–µ–≤—ñ–¥–æ–º–∏–π")
            return False

        try:
            logger.info(f"üîê –ó–∞–ø—É—Å–∫–∞—é –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –ø–∞—Ä–æ–ª—è –∑ –∞–¥–º—ñ–Ω –ø—Ä–∞–≤–∞–º–∏...")

            # –í–∏–∑–Ω–∞—á–∏—Ç–∏ —à–ª—è—Ö –¥–æ —Å–∫—Ä–∏–ø—Ç—É
            if getattr(sys, 'frozen', False):
                # –Ø–∫—â–æ EXE - —Å–∫—Ä–∏–ø—Ç –ø–æ—Ä—É—á
                script_path = os.path.join(os.path.dirname(sys.executable), "src", "set_anydesk_password.py")
            else:
                # –Ø–∫—â–æ DEV
                script_path = os.path.join(os.path.dirname(__file__), "set_anydesk_password.py")

            if not os.path.exists(script_path):
                logger.error(f"–°–∫—Ä–∏–ø—Ç –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ: {script_path}")
                return False

            # –ü–µ—Ä–µ–¥–∞—Ç–∏ –ø–∞—Ä–æ–ª—å —è–∫ –∑–º—ñ–Ω–Ω—É —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞
            env = os.environ.copy()
            env["ANYDESK_PASSWORD"] = UNATTENDED_PASSWORD

            # –ó–∞–ø—É—Å—Ç–∏—Ç–∏ —Å–∫—Ä–∏–ø—Ç –∑ –∞–¥–º—ñ–Ω –ø—Ä–∞–≤–∞–º–∏
            ctypes.windll.shell32.ShellExecuteW(
                None,
                "runas",
                sys.executable,
                f'"{script_path}" "{self.anydesk_path}"',
                None,
                1  # SW_SHOW - –ø–æ–∫–∞–∑–∞—Ç–∏ –≤—ñ–∫–Ω–æ
            )

            logger.info(f"‚úÖ –ó–∞–ø—Ä–æ—Å –∞–¥–º—ñ–Ω –ø—Ä–∞–≤ –Ω–∞–¥—ñ—Å–ª–∞–Ω–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—É")
            time.sleep(3)
            return True

        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞: {e}")
            import traceback
            traceback.print_exc()
            return False

    def get_connection_id(self) -> Optional[str]:
        """–û—Ç—Ä–∏–º–∞—Ç–∏ ID"""
        if not self.anydesk_path:
            return None

        try:
            logger.info("üìå –û—Ç—Ä–∏–º—É—é ID...")

            result = subprocess.run(
                [self.anydesk_path, '--get-id'],
                capture_output=True,
                text=True,
                timeout=10,
                creationflags=subprocess.CREATE_NO_WINDOW if platform.system() == "Windows" else 0
            )

            if result.returncode == 0:
                connection_id = result.stdout.strip()
                if connection_id and connection_id.isdigit():
                    logger.info(f"‚úÖ ID: {connection_id}")
                    self.connection_id = connection_id
                    return connection_id

        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞: {e}")

        return None

    def start(self, password: str = None) -> Tuple[Optional[str], Optional[str]]:
        """–ó–∞–ø—É—Å—Ç–∏—Ç–∏ AnyDesk"""
        password = UNATTENDED_PASSWORD

        # –ö—Ä–æ–∫ 1: –Ø–∫—â–æ –≤–∂–µ –∑–∞–ø—É—â–µ–Ω–æ
        if self.check_if_running():
            logger.info("AnyDesk –≤–∂–µ –∑–∞–ø—É—â–µ–Ω–æ")
            connection_id = self.get_connection_id()
            if connection_id:
                try:
                    # ‚ö†Ô∏è –î–û–î–ê–¢–ò –ü–Ü–ë
                    user_name = self.config.get("user_name", "")

                    self.telegram.send_anydesk_info(
                        self.config.store_location_text,
                        user_name,  # ‚¨ÖÔ∏è –ü–Ü–ë
                        socket.gethostname(),  # –ü–ö
                        connection_id,
                        password
                    )
                except Exception as e:
                    logger.error(f"‚ùå Telegram: {e}")
            return connection_id, password

        # –ö—Ä–æ–∫ 2: –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —è–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ
        if not self.anydesk_path:
            if not self.download_anydesk():
                return None, None

        # –ö—Ä–æ–∫ 3: –ó–∞–ø—É—Å—Ç–∏—Ç–∏
        if not self.launch_anydesk():
            return None, None

        # –ö—Ä–æ–∫ 4: –í–°–¢–ê–ù–û–í–ò–¢–ò –ü–ê–†–û–õ–¨ –ó –ê–î–ú–Ü–ù –ü–†–ê–í–ê–ú–ò
        logger.info("üîê –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –ø–∞—Ä–æ–ª—è...")
        time.sleep(2)
        self.set_password_with_admin()

        # –ö—Ä–æ–∫ 5: –û—Ç—Ä–∏–º–∞—Ç–∏ ID
        logger.info("üìå –û—Ç—Ä–∏–º–∞–Ω–Ω—è ID...")
        time.sleep(2)
        connection_id = self.get_connection_id()

        if not connection_id:
            time.sleep(3)
            connection_id = self.get_connection_id()

        # –ö—Ä–æ–∫ 6: –ù–∞–¥—ñ—Å–ª–∞—Ç–∏ –≤ Telegram –∑ –ü–Ü–ë
        try:
            # ‚ö†Ô∏è –î–û–î–ê–¢–ò –ü–Ü–ë
            user_name = self.config.get("user_name", "")

            self.telegram.send_anydesk_info(
                self.config.store_location_text,
                user_name,  # ‚¨ÖÔ∏è –ü–Ü–ë
                socket.gethostname(),  # –ü–ö
                connection_id if connection_id else "–Ω–µ –æ—Ç—Ä–∏–º–∞–Ω–æ",
                password
            )
            logger.info("‚úÖ –¢–µ–ª–µ–≥—Ä–∞–º —Å–ø–æ–≤—ñ—â–µ–Ω–æ")
        except Exception as e:
            logger.error(f"‚ùå –¢–µ–ª–µ–≥—Ä–∞–º –ø–æ–º–∏–ª–∫–∞: {e}")

        logger.info(f"‚úÖ –ì–æ—Ç–æ–≤–æ (ID: {connection_id})")
        return connection_id, password


================================================================================
–§–∞–π–ª 8/21: src\config.py
--------------------------------------------------------------------------------
import os
from pathlib import Path
from dotenv import load_dotenv

# –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ .env
load_dotenv()

APP_NAME = "RemoteHand"
RDP_HOST = "23.88.7.196"
RDP_PORT = 4420
PING_HOST = "23.88.7.196"

# üîí –ó–Ü –ó–ú–Ü–ù–ù–ò–• –°–ï–†–ï–î–û–í–ò–©–ê, –ê –ù–ï –ó .env!
TELEGRAM_TOKEN = os.getenv("TELEGRAM_TOKEN", "")
TELEGRAM_CHAT_ID = os.getenv("TELEGRAM_CHAT_ID", "")

# –§–∞–π–ª–∏
LOCK_FILE = Path.home() / ".remotehand" / "lock"


================================================================================
–§–∞–π–ª 9/21: src\config_manager.py
--------------------------------------------------------------------------------
import json
import os
from pathlib import Path
import logging

logger = logging.getLogger(__name__)


class ConfigManager:
    """–ú–µ–Ω–µ–¥–∂–µ—Ä –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó"""

    def __init__(self):
        self.config_dir = Path.home() / ".remotehand"
        self.config_dir.mkdir(exist_ok=True)
        self.config_file = self.config_dir / "config.json"

        self.config = self.load()

    def load(self):
        """–ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –∫–æ–Ω—Ñ—ñ–≥"""
        if self.config_file.exists():
            try:
                with open(self.config_file, 'r', encoding='utf-8') as f:
                    return json.load(f)
            except:
                pass
        return {}

    def save(self):
        """–ó–±–µ—Ä–µ–≥—Ç–∏ –∫–æ–Ω—Ñ—ñ–≥ –≤ JSON —Ñ–∞–π–ª"""
        try:
            with open(self.config_file, 'w', encoding='utf-8') as f:
                json.dump(self.config, f, ensure_ascii=False, indent=2)
        except Exception as e:
            logger.error(f"–ü–æ–º–∏–ª–∫–∞ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –∫–æ–Ω—Ñ—ñ–≥—É: {e}")

    def set(self, key, value):
        """–í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –∑–Ω–∞—á–µ–Ω–Ω—è"""
        self.config[key] = value
        self.save()

    def get(self, key, default=""):
        """–û—Ç—Ä–∏–º–∞—Ç–∏ –∑–Ω–∞—á–µ–Ω–Ω—è"""
        return self.config.get(key, default)

    def is_first_run(self):
        """–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —á–∏ –ø–µ—Ä—à–∏–π –∑–∞–ø—É—Å–∫"""
        store = self.config.get('store', '')
        location = self.config.get('location', '')
        return not store or not location

    @property
    def store_location_text(self):
        """–û—Ç—Ä–∏–º–∞—Ç–∏ —Ç–µ–∫—Å—Ç –º–∞–≥–∞–∑–∏–Ω—É/–ª–æ–∫–∞—Ü—ñ—ó"""
        store = self.config.get('store', '–ù–µ–≤—ñ–¥–æ–º–æ')
        location = self.config.get('location', '–ù–µ–≤—ñ–¥–æ–º–æ')
        return f"{store} / {location}"


================================================================================
–§–∞–π–ª 10/21: src\main.py
--------------------------------------------------------------------------------
import customtkinter as ctk
from tkinter import messagebox
import sys
import os
import threading
import logging
from pathlib import Path

# –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ .env —Ñ–∞–π–ª
from dotenv import load_dotenv

load_dotenv()

# –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –ª–æ–≥—É–≤–∞–Ω–Ω—è
logging.basicConfig(
    level=logging.INFO,
    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s'
)
logger = logging.getLogger(__name__)

# ============ –ü–ï–†–ï–í–Ü–†–ö–ê DEV –†–ï–ñ–ò–ú–£ ============
DEV_MODE = os.getenv('REMOTEHAND_DEV_MODE') == '1'
logger.info(f"{'üîß DEV –†–ï–ñ–ò–ú' if DEV_MODE else '‚úÖ PRODUCTION –†–ï–ñ–ò–ú'}")

if not DEV_MODE:
    # –¢–Ü–õ–¨–ö–ò –í PRODUCTION
    try:
        from updater import check_and_update

        check_and_update()
    except Exception as e:
        logger.warning(f"–ü–æ–º–∏–ª–∫–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –æ–Ω–æ–≤–ª–µ–Ω—å: {e}")

# ============ –Ü–ú–ü–û–†–¢–ò ============
from utils import close_all_rdp_sessions, test_connection
from config import RDP_HOST, RDP_PORT, PING_HOST, APP_NAME

# –ù–æ–≤—ñ —ñ–º–ø–æ—Ä—Ç–∏
from config_manager import ConfigManager
from telegram_api import TelegramAPI
from setup_wizard import SetupWizard
from network_test import NetworkTest

try:
    from rdp_manager import RDPManager

    rdp_manager_available = True
except ImportError as e:
    rdp_manager_available = False
    logger.warning(f"rdp_manager –Ω–µ –¥–æ—Å—Ç—É–ø–Ω–∞: {e}")

try:
    from anydesk_manager import AnyDeskManager

    anydesk_available = True
except ImportError as e:
    anydesk_available = False
    logger.warning(f"anydesk_manager –Ω–µ –¥–æ—Å—Ç—É–ø–Ω–∞: {e}")


class RemoteHandApp(ctk.CTk):
    def __init__(self):
        super().__init__()

        # –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –≤—ñ–∫–Ω–∞
        self.title(APP_NAME)
        self.geometry("520x800")
        self.resizable(True, True)

        # –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç–µ–º–∏
        ctk.set_appearance_mode("light")
        ctk.set_default_color_theme("blue")

        # –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è –º–µ–Ω–µ–¥–∂–µ—Ä—ñ–≤
        self.config = ConfigManager()

        # ‚ö†Ô∏è –ó–ê–í–ê–ù–¢–ê–ñ–ò–¢–ò –¢–û–ö–ï–ù–ò –ó .env –õ–ò CONFIG
        telegram_token = os.getenv("TELEGRAM_TOKEN") or self.config.get("telegram_token")
        telegram_chat_id = os.getenv("TELEGRAM_CHAT_ID") or self.config.get("telegram_chat_id")

        logger.info(f"Telegram token: {'‚úÖ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ' if telegram_token else '‚ùå –ù–ï –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ'}")
        logger.info(f"Telegram chat_id: {'‚úÖ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ' if telegram_chat_id else '‚ùå –ù–ï –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ'}")

        self.telegram = TelegramAPI(telegram_token, telegram_chat_id)

        if rdp_manager_available:
            self.rdp_manager = RDPManager(self.config, self.telegram)
        else:
            self.rdp_manager = None

        if anydesk_available:
            self.anydesk_manager = AnyDeskManager(self.config, self.telegram)
        else:
            self.anydesk_manager = None

        self.network_test = NetworkTest(self.config, self.telegram)

        # ‚ö†Ô∏è –°–¢–í–û–†–ò–¢–ò UI –í–°–Ü –†–ê–ó–ò, –∞ –ø–æ—Ç—ñ–º –ø–æ–∫–∞–∑–∞—Ç–∏ SetupWizard —è–∫—â–æ –ø–µ—Ä—à–∏–π –∑–∞–ø—É—Å–∫
        self.setup_ui()

        if self.config.is_first_run():
            self.show_setup_wizard()

    def get_app_version(self):
        """–û—Ç—Ä–∏–º–∞—Ç–∏ –≤–µ—Ä—Å—ñ—é –ø—Ä–æ–≥—Ä–∞–º–∏"""
        try:
            if getattr(sys, 'frozen', False):
                # –Ø–∫—â–æ EXE - —à—É–∫–∞—î–º–æ –ø–æ—Ä—É—á –∑ EXE
                base_path = Path(sys.executable).parent
            else:
                # –Ø–∫—â–æ DEV - —à—É–∫–∞—î–º–æ –≤ –∫–æ—Ä–µ–Ω—ñ –ø—Ä–æ–µ–∫—Ç—É
                base_path = Path(__file__).parent.parent

            version_file = base_path / "version.txt"

            if version_file.exists():
                return version_file.read_text(encoding='utf-8').strip()
        except Exception as e:
            logger.error(f"–ü–æ–º–∏–ª–∫–∞ —á–∏—Ç–∞–Ω–Ω—è –≤–µ—Ä—Å—ñ—ó: {e}")

        return "1.0.0"

    def show_setup_wizard(self):
        """–ü–æ–∫–∞–∑–∞—Ç–∏ –≤—ñ–∫–Ω–æ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –ø—Ä–∏ –ø–µ—Ä—à–æ–º—É –∑–∞–ø—É—Å–∫—É"""

        def on_setup_complete(result):
            self.config.set("store", result["store"])
            self.config.set("location", result["location"])
            if result.get("user_name"):
                self.config.set("user_name", result["user_name"])
            # ‚úÖ –û–Ω–æ–≤–∏—Ç–∏ UI –ø—ñ—Å–ª—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è
            self.refresh_ui()

        wizard = SetupWizard(self, on_setup_complete)
        self.wait_window(wizard)

    def refresh_ui(self):
        """–û–Ω–æ–≤–∏—Ç–∏ UI –ø—ñ—Å–ª—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è"""
        # –û–Ω–æ–≤–∏—Ç–∏ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –º–∞–≥–∞–∑–∏–Ω
        user_info = self.config.store_location_text
        user_name = self.config.get("user_name", "")
        if user_name:
            user_info += f" | üë§ {user_name}"

        self.info_label.configure(text=f"üìç {user_info}")

    def setup_ui(self):
        """–°—Ç–≤–æ—Ä–µ–Ω–Ω—è UI"""

        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        title_label = ctk.CTkLabel(
            self,
            text="RemoteHand",
            font=ctk.CTkFont(size=28, weight="bold")
        )
        title_label.pack(pady=15)

        # –Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ –º–∞–≥–∞–∑–∏–Ω/–ª–æ–∫–∞—Ü—ñ—é + –ü–Ü–ë
        user_info = self.config.store_location_text
        user_name = self.config.get("user_name", "")
        if user_name:
            user_info += f" | üë§ {user_name}"

        self.info_label = ctk.CTkLabel(
            self,
            text=f"üìç {user_info}",
            font=ctk.CTkFont(size=11),
            text_color="gray"
        )
        self.info_label.pack(pady=(0, 20))

        # ==================== RDP –ë–õ–û–ö ====================
        rdp_frame = ctk.CTkFrame(self)
        rdp_frame.pack(pady=15, padx=20, fill="x")

        ctk.CTkLabel(
            rdp_frame,
            text="üìã –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ 1–°",
            font=ctk.CTkFont(size=13, weight="bold")
        ).pack(anchor="w", pady=(0, 10))

        # –û—Å–Ω–æ–≤–Ω–∞ –∫–Ω–æ–ø–∫–∞ RDP
        rdp_btn = ctk.CTkButton(
            rdp_frame,
            text="üñ•Ô∏è –í—ñ–¥–∫—Ä–∏—Ç–∏ 1–° (RDP)",
            command=self.open_rdp,
            height=50,
            font=ctk.CTkFont(size=12, weight="bold"),
            corner_radius=12,
            fg_color="#007AFF",
            hover_color="#0051D5"
        )
        rdp_btn.pack(fill="x", pady=(0, 10))

        # ==================== –ó–ê–ö–†–ò–¢–¢–Ø –°–ï–°–Ü–ô ====================
        close_sessions_btn = ctk.CTkButton(
            self,
            text="‚ùå –ó–∞–∫—Ä–∏—Ç–∏ –≤—Å—ñ RDP —Å–µ—Å—ñ—ó",
            command=self.close_sessions_confirm,
            height=45,
            font=ctk.CTkFont(size=12, weight="bold"),
            corner_radius=12,
            fg_color="#FF3B30",
            hover_color="#D70015"
        )
        close_sessions_btn.pack(pady=15, padx=20, fill="x")

        # ==================== ANYDESK –ë–õ–û–ö ====================
        if anydesk_available:
            anydesk_frame = ctk.CTkFrame(self)
            anydesk_frame.pack(pady=15, padx=20, fill="x")

            ctk.CTkLabel(
                anydesk_frame,
                text="üåê –í—ñ–¥–¥–∞–ª–µ–Ω–∏–π –¥–æ—Å—Ç—É–ø",
                font=ctk.CTkFont(size=13, weight="bold")
            ).pack(anchor="w", pady=(0, 10))

            anydesk_btn = ctk.CTkButton(
                anydesk_frame,
                text="üöÄ –ó–∞–ø—É—Å—Ç–∏—Ç–∏ AnyDesk",
                command=self.start_anydesk,
                height=50,
                font=ctk.CTkFont(size=12, weight="bold"),
                corner_radius=12,
                fg_color="#FF6B35",
                hover_color="#CC5529"
            )
            anydesk_btn.pack(fill="x", pady=(0, 10))

        # ==================== –¢–ï–°–¢ –ú–ï–†–ï–ñ–Ü ====================
        test_frame = ctk.CTkFrame(self)
        test_frame.pack(pady=15, padx=20, fill="x")

        ctk.CTkLabel(
            test_frame,
            text="üîß –î—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∞",
            font=ctk.CTkFont(size=13, weight="bold")
        ).pack(anchor="w", pady=(0, 10))

        test_btn = ctk.CTkButton(
            test_frame,
            text="üì° –¢–µ—Å—Ç –∑'—î–¥–Ω–∞–Ω–Ω—è",
            command=self.run_network_test,
            height=50,
            font=ctk.CTkFont(size=12, weight="bold"),
            corner_radius=12,
            fg_color="#34C759",
            hover_color="#248A3D"
        )
        test_btn.pack(fill="x", pady=(0, 10))

        # ==================== –°–¢–ê–¢–£–° ====================
        self.status_label = ctk.CTkLabel(
            self,
            text="‚úÖ –ì–æ—Ç–æ–≤–æ –¥–æ —Ä–æ–±–æ—Ç–∏",
            font=ctk.CTkFont(size=10),
            text_color="gray"
        )
        self.status_label.pack(pady=10)

        # ==================== –ö–ù–û–ü–ö–ê –†–ï–î–ê–ì–£–í–ê–ù–ù–Ø –ú–ê–ì–ê–ó–ò–ù–£ ====================
        settings_frame = ctk.CTkFrame(self)
        settings_frame.pack(pady=10, padx=20, fill="x")

        settings_btn = ctk.CTkButton(
            settings_frame,
            text="‚öôÔ∏è –ó–º—ñ–Ω–∏—Ç–∏ –º–∞–≥–∞–∑–∏–Ω/–ª–æ–∫–∞—Ü—ñ—é/–ü–Ü–ë",
            command=self.show_setup_wizard,
            height=35,
            font=ctk.CTkFont(size=10),
            corner_radius=8,
            fg_color="#999999",
            hover_color="#666666"
        )
        settings_btn.pack(fill="x")

        # ==================== –í–ï–†–°–Ü–Ø + –°–¢–ê–¢–£–° –û–ù–û–í–õ–ï–ù–ù–Ø ====================
        version_frame = ctk.CTkFrame(self)
        version_frame.pack(anchor="se", padx=10, pady=10)

        version_label = ctk.CTkLabel(
            version_frame,
            text=f"v{self.get_app_version()}",
            font=ctk.CTkFont(size=9, weight="bold"),
            text_color="#333333"
        )
        version_label.pack(side="left", padx=5)

        self.update_status_label = ctk.CTkLabel(
            version_frame,
            text="‚úÖ",
            font=ctk.CTkFont(size=10),
            text_color="green"
        )
        self.update_status_label.pack(side="left", padx=5)

    def open_rdp(self):
        """–í—ñ–¥–∫—Ä–∏—Ç–∏ RDP"""
        if not self.rdp_manager:
            messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "RDP –º–µ–Ω–µ–¥–∂–µ—Ä –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω")
            return

        # –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —á–∏ –ø–∞—Ä–æ–ª—å –≤–∂–µ –∑–±–µ—Ä–µ–∂–µ–Ω–æ
        saved_password = self.rdp_manager.get_credentials(RDP_HOST, "admin")

        if saved_password:
            # –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –∑–±–µ—Ä–µ–∂–µ–Ω–∏–π –ø–∞—Ä–æ–ª—å
            self.set_status("‚è≥ –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è...", "processing")

            def connect():
                try:
                    if self.rdp_manager.connect_rdp(RDP_HOST, RDP_PORT, "admin", saved_password):
                        self.set_status("‚úÖ –ü—ñ–¥–∫–ª—é—á–µ–Ω–æ", "success")
                    else:
                        self.set_status("‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è", "error")
                except Exception as e:
                    logger.error(f"–ü–æ–º–∏–ª–∫–∞: {e}")
                    self.set_status("‚ùå –ö—Ä–∏—Ç–∏—á–Ω–∞ –ø–æ–º–∏–ª–∫–∞", "error")

            thread = threading.Thread(target=connect, daemon=True)
            thread.start()
        else:
            # –ó–∞–ø—Ä–æ—Å–∏—Ç–∏ –Ω–æ–≤–∏–π –ø–∞—Ä–æ–ª—å
            dialog = ctk.CTkInputDialog(
                text="–í–≤–µ–¥—ñ—Ç—å –ø–∞—Ä–æ–ª—å –¥–ª—è RDP:",
                title="–ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ 1–°"
            )
            password = dialog.get_input()

            if password:
                self.set_status("üíæ –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è –ø–∞—Ä–æ–ª—è...", "processing")

                # –°–ø—Ä–æ–±—É–≤–∞—Ç–∏ –ø—ñ–¥–∫–ª—é—á–∏—Ç–∏—Å—è
                if self.rdp_manager.connect_rdp(RDP_HOST, RDP_PORT, "admin", password):
                    # –Ø–∫—â–æ —É—Å–ø—ñ—à–Ω–æ, —Ç–æ –∑–±–µ—Ä–µ–≥—Ç–∏ –ø–∞—Ä–æ–ª—å
                    self.rdp_manager.save_credentials(RDP_HOST, "admin", password)
                    self.set_status("‚úÖ –£—Å–ø—ñ—à–Ω–æ –ø—ñ–¥–∫–ª—é—á–µ–Ω–æ", "success")
                else:
                    self.set_status("‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è", "error")

    def close_sessions_confirm(self):
        """–ü—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è –∑–∞–∫—Ä–∏—Ç—Ç—è —Å–µ—Å—ñ–π"""
        result = messagebox.askyesno(
            "–ü—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è",
            "–í–∏ –≤–ø–µ–≤–Ω–µ–Ω—ñ, —â–æ —Ö–æ—á–µ—Ç–µ –∑–∞–∫—Ä–∏—Ç–∏ –≤—Å—ñ RDP —Å–µ—Å—ñ—ó?"
        )
        if result:
            self.set_status("‚è≥ –ó–∞–∫—Ä–∏—Ç—Ç—è —Å–µ—Å—ñ–π...", "processing")
            close_all_rdp_sessions()
            self.set_status("‚úÖ –í—Å—ñ —Å–µ—Å—ñ—ó –∑–∞–∫—Ä–∏—Ç–æ", "success")

    def start_anydesk(self):
        """–ó–∞–ø—É—Å—Ç–∏—Ç–∏ AnyDesk - –ë–ï–ó –ø–æ–∫–∞–∑—É –ø–∞—Ä–æ–ª—è!"""
        if not self.anydesk_manager:
            messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "AnyDesk –º–µ–Ω–µ–¥–∂–µ—Ä –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω")
            return

        self.set_status("‚è≥ –ó–∞–ø—É—Å–∫ AnyDesk...", "processing")

        def anydesk_task():
            try:
                # –ó–∞–ø—É—Å—Ç–∏—Ç–∏ AnyDesk - –ø–∞—Ä–æ–ª—å –ù–ï –ø–µ—Ä–µ–¥–∞—î–º–æ —Ç–∞ –ù–ï –ø–æ–∫–∞–∑—É—î–º–æ!
                anydesk_id, pwd = self.anydesk_manager.start(None)

                if anydesk_id:
                    self.set_status(f"‚úÖ AnyDesk –∑–∞–ø—É—â–µ–Ω–æ\nüÜî ID: {anydesk_id}", "success")
                    messagebox.showinfo(
                        "‚úÖ AnyDesk –∑–∞–ø—É—â–µ–Ω–æ",
                        f"ID –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è: {anydesk_id}\n\n"
                        f"–î–∞–Ω—ñ –Ω–∞–¥—ñ—Å–ª–∞–Ω—ñ –≤ Telegram\n"
                        f"–ü–∞—Ä–æ–ª—å –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ"
                    )
                else:
                    self.set_status("‚ùå AnyDesk –≤–∂–µ –∑–∞–ø—É—â–µ–Ω–æ", "error")
                    messagebox.showwarning(
                        "‚ö†Ô∏è –£–≤–∞–≥–∞",
                        "AnyDesk –≤–∂–µ –∑–∞–ø—É—â–µ–Ω–æ –∞–±–æ –Ω–µ –≤–¥–∞–ª–æ—Å—è –∑–∞–ø—É—Å—Ç–∏—Ç–∏"
                    )
            except Exception as e:
                logger.error(f"–ü–æ–º–∏–ª–∫–∞: {e}")
                self.set_status("‚ùå –ü–æ–º–∏–ª–∫–∞ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è", "error")

        thread = threading.Thread(target=anydesk_task, daemon=True)
        thread.start()

    def run_network_test(self):
        """–ó–∞–ø—É—Å—Ç–∏—Ç–∏ —Ç–µ—Å—Ç –º–µ—Ä–µ–∂—ñ"""
        self.set_status("‚è≥ –¢–µ—Å—Ç –º–µ—Ä–µ–∂—ñ...", "processing")

        def test_task():
            try:
                result = self.network_test.run_full_test()
                self.set_status(f"{result['status']}", result['color'])
            except Exception as e:
                logger.error(f"–ü–æ–º–∏–ª–∫–∞ —Ç–µ—Å—Ç—É: {e}")
                self.set_status("‚ùå –ü–æ–º–∏–ª–∫–∞ —Ç–µ—Å—Ç—É", "error")

        thread = threading.Thread(target=test_task, daemon=True)
        thread.start()

    def set_status(self, text, status_type="info"):
        """–í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ —Å—Ç–∞—Ç—É—Å –∑ –∫–æ–ª—å–æ—Ä–æ–º"""
        color_map = {
            "success": "green",
            "error": "red",
            "processing": "blue",
            "info": "gray"
        }
        self.status_label.configure(text=text, text_color=color_map.get(status_type, "gray"))


def main():
    """–ì–æ–ª–æ–≤–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è"""
    logger.info("–ó–∞–ø—É—Å–∫ RemoteHand...")
    app = RemoteHandApp()
    app.mainloop()


if __name__ == "__main__":
    main()


================================================================================
–§–∞–π–ª 11/21: src\network_test.py
--------------------------------------------------------------------------------
import subprocess
import re
import socket
import logging
from pathlib import Path
import tempfile

logger = logging.getLogger(__name__)


class NetworkTest:
    """–¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è –º–µ—Ä–µ–∂—ñ –∑ –∑–≤—ñ—Ç–æ–º"""

    def __init__(self, config_manager, telegram_api):
        self.config = config_manager
        self.telegram = telegram_api

    def run_ping_test(self, host, count=20):
        """–í–∏–∫–æ–Ω–∞—Ç–∏ ping —Ç–µ—Å—Ç –Ω–∞ —Ö–æ—Å—Ç—É"""
        try:
            result = subprocess.run(
                ['ping', host, '-n', str(count)],
                capture_output=True,
                text=True,
                encoding='cp1252',
                timeout=60,
                creationflags=subprocess.CREATE_NO_WINDOW
            )
            return result.stdout
        except Exception as e:
            logger.error(f"–ü–æ–º–∏–ª–∫–∞ ping: {e}")
            return f"–ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—ñ {host}: {str(e)}"

    def parse_ping_loss(self, ping_output):
        """–í–∏—Ç—è–≥—Ç–∏ –≤—ñ–¥—Å–æ—Ç–æ–∫ –≤—Ç—Ä–∞—Ç–∏ –ø–∞–∫–µ—Ç—ñ–≤"""
        try:
            match = re.search(r'(\d+)%\s+(–ø–æ—Ç–µ—Ä—å|loss)', ping_output, re.IGNORECASE)
            if match:
                return int(match.group(1))
            return 0
        except:
            return -1

    def run_full_test(self):
        """–ó–∞–ø—É—Å—Ç–∏—Ç–∏ –ø–æ–≤–Ω–∏–π —Ç–µ—Å—Ç –º–µ—Ä–µ–∂—ñ"""
        pc_name = socket.gethostname()
        store_location = self.config.store_location_text

        hosts = {
            "1–° –°–µ—Ä–≤–µ—Ä": "23.88.7.196",
            "Google DNS": "8.8.8.8"
        }

        report_parts = []
        total_loss = 0

        for name, ip in hosts.items():
            ping_output = self.run_ping_test(ip)
            loss = self.parse_ping_loss(ping_output)

            if loss >= 0:
                status = "‚úÖ" if loss == 0 else ("‚ö†Ô∏è" if loss <= 15 else "‚ùå")
                report_parts.append(f"{status} {name} ({ip}): {loss}% –≤—Ç—Ä–∞—Ç–∏")
                total_loss += loss
            else:
                report_parts.append(f"‚ùå {name} ({ip}): –ü–æ–º–∏–ª–∫–∞ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è")

        avg_loss = total_loss / len(hosts) if hosts else 0

        if avg_loss == 0:
            status_text = "‚úÖ –ú–µ—Ä–µ–∂–∞ –≤ –Ω–æ—Ä–º—ñ"
            color = "green"
        elif avg_loss <= 15:
            status_text = "‚ö†Ô∏è –Ñ –Ω–µ–≤–µ–ª–∏–∫—ñ –ø—Ä–æ–±–ª–µ–º–∏"
            color = "orange"
        else:
            status_text = "‚ùå –°–µ—Ä–π–æ–∑–Ω—ñ –ø—Ä–æ–±–ª–µ–º–∏"
            color = "red"

        # –í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ –≤ Telegram
        test_report = "\n".join(report_parts)
        self.telegram.send_network_report(store_location, pc_name, test_report)

        return {
            "status": status_text,
            "color": color,
            "details": test_report
        }


================================================================================
–§–∞–π–ª 12/21: src\rdp_manager.py
--------------------------------------------------------------------------------
import os
import subprocess
import time
import winreg
import logging
import keyring
from pathlib import Path

logger = logging.getLogger(__name__)


class RDPManager:
    """–ú–µ–Ω–µ–¥–∂–µ—Ä –¥–ª—è RDP –ø—ñ–¥–∫–ª—é—á–µ–Ω—å –∑ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–º –ª–æ–≥—ñ–Ω–æ–º"""

    def __init__(self, config_manager, telegram_api):
        self.config = config_manager
        self.telegram = telegram_api

    def save_credentials(self, host, username, password):
        """–ó–±–µ—Ä–µ–≥—Ç–∏ RDP –¥–∞–Ω—ñ –≤ Windows Credential Manager"""
        try:
            keyring.set_password(f"RDP_{host}", username, password)
            self.config.set("rdp_password", password)
            logger.info(f"‚úÖ –î–∞–Ω—ñ –∑–±–µ—Ä–µ–∂–µ–Ω—ñ –¥–ª—è {host}")
            return True
        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è: {e}")
            return False

    def get_credentials(self, host, username):
        """–û—Ç—Ä–∏–º–∞—Ç–∏ –ø–∞—Ä–æ–ª—å –∑ Credential Manager"""
        try:
            password = keyring.get_password(f"RDP_{host}", username)
            return password
        except:
            return None

    def connect_rdp(self, host, port, username, password=None):
        """–ü—ñ–¥–∫–ª—é—á–∏—Ç–∏—Å—è –¥–æ RDP"""
        try:
            # –ö–æ–¥—É–≤–∞–Ω–Ω—è –ø–∞—Ä–æ–ª—è –¥–ª—è .RDP —Ñ–∞–π–ª—É
            encrypted_password = self._encrypt_rdp_password(password) if password else ""

            rdp_content = f"""screen mode id:i:2
use multimon:i:0
desktopwidth:i:1920
desktopheight:i:1080
session bpp:i:32
connection type:i:7
disable wallpaper:i:0
allow font smoothing:i:1
allow desktop composition:i:1
disable full window drag:i:0
disable menu anims:i:0
disable themes:i:0
disable cursor setting:i:0
bitmapcachepersistenable:i:1
full address:s:{host}:{port}
audiomode:i:0
redirectprinters:i:0
redirectcomports:i:0
redirectsmartcards:i:0
redirectclipboard:i:1
redirectposdevices:i:0
autoreconnection enabled:i:1
authentication level:i:0
prompt for credentials on client:i:0
negotiate security layer:i:1
enablecredsspsupport:i:1
username:s:{username}
password 51:b:{encrypted_password}
"""

            rdp_file = f"{host}_{username}_session.rdp"
            with open(rdp_file, "w") as f:
                f.write(rdp_content)

            subprocess.Popen(f"mstsc {rdp_file}")
            logger.info(f"‚úÖ RDP –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –∑–∞–ø—É—â–µ–Ω–æ")

            # –í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ –≤ Telegram
#            self.telegram.send_rdp_info(
#                self.config.store_location_text,
#                os.environ.get('COMPUTERNAME', 'Unknown')
#            )

            return True
        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è: {e}")
            return False

    def _encrypt_rdp_password(self, password):
        """–ü—Ä–æ—Å—Ç–æ–µ —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è –ø–∞—Ä–æ–ª—è –¥–ª—è .RDP"""
        encrypted = ""
        for char in password:
            encrypted += format(ord(char) ^ 0xAA, '02x')
        return encrypted


================================================================================
–§–∞–π–ª 13/21: src\set_anydesk_password.py
--------------------------------------------------------------------------------
#!/usr/bin/env python3
"""–í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –ø–∞—Ä–æ–ª—è AnyDesk –∑ –∞–¥–º—ñ–Ω –ø—Ä–∞–≤–∞–º–∏"""

import subprocess
import sys
import os
import time
import ctypes

ANYDESK_PATH = sys.argv[1] if len(sys.argv) > 1 else None
PASSWORD = os.getenv("ANYDESK_PASSWORD", "r3moteh4nd")

if not ANYDESK_PATH or not os.path.exists(ANYDESK_PATH):
    print("[!] AnyDesk –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ")
    sys.exit(1)

# –ü–µ—Ä–µ–≤—ñ—Ä–∏–º–æ —á–∏ –∑–∞–ø—É—â–µ–Ω–æ –∑ –∞–¥–º—ñ–Ω –ø—Ä–∞–≤–∞–º–∏
try:
    is_admin = ctypes.windll.shell32.IsUserAnAdmin()
    if not is_admin:
        print("[!] –ü–æ—Ç—Ä—ñ–±–Ω—ñ –∞–¥–º—ñ–Ω –ø—Ä–∞–≤–∞")
        # –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–∏ –∑ –∞–¥–º—ñ–Ω –ø—Ä–∞–≤–∞–º–∏
        ctypes.windll.shell32.ShellExecuteW(
            None,
            "runas",
            sys.executable,
            f'"{__file__}" "{ANYDESK_PATH}"',
            None,
            1  # SW_SHOW
        )
        sys.exit(0)
except:
    pass

try:
    print(f"[*] –í—Å—Ç–∞–Ω–æ–≤–ª—é—é –ø–∞—Ä–æ–ª—å AnyDesk (—É –∞–¥–º—ñ–Ω—ñ)...")
    time.sleep(1)

    # –í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ —á–µ—Ä–µ–∑ stdin
    cmd = [ANYDESK_PATH, "--set-password", "_full_access"]

    result = subprocess.run(
        cmd,
        input=PASSWORD + "\n",
        capture_output=True,
        text=True,
        timeout=10
    )

    print(f"[CODE] {result.returncode}")
    if result.returncode in [0, 8000]:
        print("[‚úì] –ü–∞—Ä–æ–ª—å –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ!")
    else:
        print(f"[!] –ö–æ–¥: {result.returncode}")

    sys.exit(0)

except Exception as e:
    print(f"[!] –ü–æ–º–∏–ª–∫–∞: {e}")
    sys.exit(1)


================================================================================
–§–∞–π–ª 14/21: src\setup_wizard.py
--------------------------------------------------------------------------------
import customtkinter as ctk
import tkinter.messagebox as messagebox


class SetupWizard(ctk.CTkToplevel):
    def __init__(self, parent, on_complete):
        super().__init__(parent)

        self.title("RemoteHand - –ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞")
        self.geometry("450x500")
        self.resizable(False, False)

        # –¶–µ–Ω—Ç—Ä—É–≤–∞—Ç–∏ –Ω–∞ –µ–∫—Ä–∞–Ω—ñ
        self.transient(parent)
        self.grab_set()

        # ‚ö†Ô∏è –ó–ê–ë–û–†–û–ù–ò–¢–ò –ó–ê–ö–†–ò–¢–¢–Ø –ë–ï–ó –ó–ë–ï–†–ï–ñ–ï–ù–ù–Ø
        self.protocol("WM_DELETE_WINDOW", self.on_closing)

        self.on_complete = on_complete
        self.setup_complete = False

        # –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç–µ–º–∏
        ctk.set_appearance_mode("light")
        ctk.set_default_color_theme("blue")

        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        title = ctk.CTkLabel(
            self,
            text="–ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞",
            font=ctk.CTkFont(size=18, weight="bold")
        )
        title.pack(pady=20)

        # ===== –ú–ê–ì–ê–ó–ò–ù (–í–´–ë–Ü–†) =====
        ctk.CTkLabel(
            self,
            text="–í–∏–±–µ—Ä—ñ—Ç—å –º–∞–≥–∞–∑–∏–Ω:",
            font=ctk.CTkFont(size=12, weight="bold")
        ).pack(anchor="w", padx=20, pady=(10, 5))

        self.store_var = ctk.StringVar(value="")
        store_options = [
            "0 / –û—Ñ—ñ—Å",
            "1 / –î—ñ–∞–ª–æ–≥",
            "5 / –ü–æ–ª—Ç–∞–≤–∞",
            "7 / –û–∞–∑–∏—Å",
            "8 / –•–º–µ–ª—å–Ω–∏—Ü—å–∫–∏–π",
            "9 / –ß–µ—Ä–Ω—ñ–≤—Ü—ñ",
            "17 / –ö—Ä–µ–º–µ–Ω—á—É–∫",
            "18 / –ü_–ö–æ—Ç–ª—è—Ä–µ–≤—Å—å–∫–æ–≥–æ",
            "20 / –©–∞—Å–ª–∏–≤–∏–π",
            "21 / –°–æ—Ñ—ñ—è –º–æ–ª–ª"
        ]

        self.store_menu = ctk.CTkComboBox(
            self,
            values=store_options,
            variable=self.store_var,
            font=ctk.CTkFont(size=11),
            height=35
        )
        self.store_menu.pack(padx=20, fill="x", pady=(0, 20))

        # ===== –õ–û–ö–ê–¶–Ü–Ø (–í–´–ë–Ü–†) =====
        ctk.CTkLabel(
            self,
            text="–í–∏–±–µ—Ä—ñ—Ç—å –ª–æ–∫–∞—Ü—ñ—é:",
            font=ctk.CTkFont(size=12, weight="bold")
        ).pack(anchor="w", padx=20, pady=(10, 5))

        self.location_var = ctk.StringVar(value="")
        location_options = [
            "–∫–∞—Å–∞",
            "–∫–∞—Å–∞ 2",
            "–ø—ñ–¥—Å–æ–±–∫–∞",
            "–æ—Å–æ–±–∏—Å—Ç–∏–π"
        ]

        self.location_menu = ctk.CTkComboBox(
            self,
            values=location_options,
            variable=self.location_var,
            font=ctk.CTkFont(size=11),
            height=35
        )
        self.location_menu.pack(padx=20, fill="x", pady=(0, 20))

        # ===== –ü–Ü–ë (–û–ü–¶–Ü–ô–ù–û) =====
        ctk.CTkLabel(
            self,
            text="–ü–Ü–ë –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ (–æ–ø—Ü—ñ–π–Ω–æ):",
            font=ctk.CTkFont(size=12, weight="bold")
        ).pack(anchor="w", padx=20, pady=(10, 5))

        self.user_name_entry = ctk.CTkEntry(
            self,
            placeholder_text="–ù–∞–ø—Ä–∏–∫–ª–∞–¥: –Ü–≤–∞–Ω –ü–µ—Ç—Ä–µ–Ω–∫–æ",
            height=35,
            font=ctk.CTkFont(size=11)
        )
        self.user_name_entry.pack(padx=20, fill="x", pady=(0, 30))

        # –ö–Ω–æ–ø–∫–∞
        btn = ctk.CTkButton(
            self,
            text="‚úÖ –ó–±–µ—Ä–µ–≥—Ç–∏",
            command=self.save_settings,
            height=45,
            font=ctk.CTkFont(size=12, weight="bold"),
            corner_radius=10
        )
        btn.pack(padx=20, fill="x", pady=10)

    def on_closing(self):
        """–ó–∞–±–æ—Ä–æ–Ω–∏—Ç–∏ –∑–∞–∫—Ä–∏—Ç—Ç—è –±–µ–∑ –≤–≤–µ–¥–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö"""
        if not self.setup_complete:
            messagebox.showwarning(
                "–ü–æ–º–∏–ª–∫–∞",
                "–í–∏–±–µ—Ä—ñ—Ç—å –º–∞–≥–∞–∑–∏–Ω —ñ –ª–æ–∫–∞—Ü—ñ—é –ø–µ—Ä–µ–¥ –∑–∞–∫—Ä–∏—Ç—Ç—è–º!"
            )
            return
        self.destroy()

    def save_settings(self):
        """–ó–±–µ—Ä–µ–≥—Ç–∏ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è - –æ–±–æ–≤'—è–∑–∫–æ–≤–æ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏"""
        store = self.store_var.get().strip()
        location = self.location_var.get().strip()
        user_name = self.user_name_entry.get().strip()

        # ‚ö†Ô∏è –û–ë–û–í'–Ø–ó–ö–û–í–ê –ü–ï–†–ï–í–Ü–†–ö–ê
        if not store:
            messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–í–∏–±–µ—Ä—ñ—Ç—å –º–∞–≥–∞–∑–∏–Ω!")
            return

        if not location:
            messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–í–∏–±–µ—Ä—ñ—Ç—å –ª–æ–∫–∞—Ü—ñ—é!")
            return

        # –í—Å–µ –æ–∫ - –∑–±–µ—Ä–µ–∂–µ–º–æ
        self.setup_complete = True
        self.on_complete({
            "store": store,
            "location": location,
            "user_name": user_name
        })
        self.destroy()


================================================================================
–§–∞–π–ª 15/21: src\telegram_api.py
--------------------------------------------------------------------------------
import requests
import logging
import time
import os
from pathlib import Path

logger = logging.getLogger(__name__)


class TelegramAPI:
    """–†–æ–∑—à–∏—Ä–µ–Ω–∞ Telegram API –¥–ª—è –∑–≤—ñ—Ç—É–≤–∞–Ω–Ω—è"""

    def __init__(self, token, chat_id):
        self.token = token
        self.chat_id = chat_id

        # ‚ö†Ô∏è –ü–ï–†–ï–í–Ü–†–ê –¢–û–ö–ï–ù–Ü–í
        if not token:
            logger.error("‚ùå Telegram —Ç–æ–∫–µ–Ω –Ω–µ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ!")
            self.api_url = None
        elif not chat_id:
            logger.error("‚ùå Telegram chat_id –Ω–µ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ!")
            self.api_url = None
        else:
            self.api_url = f"https://api.telegram.org/bot{token}"
            logger.info(f"‚úÖ Telegram –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–æ (—Ç–æ–∫–µ–Ω: {token[:20]}...)")

    def send_message(self, text, parse_mode="HTML"):
        """–í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ —Ç–µ–∫—Å—Ç–æ–≤–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è"""
        if not self.api_url:
            logger.error("‚ùå Telegram –Ω–µ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–æ")
            return False

        try:
            payload = {
                "chat_id": self.chat_id,
                "text": text,
                "parse_mode": parse_mode
            }
            response = requests.post(
                f"{self.api_url}/sendMessage",
                json=payload,
                timeout=10
            )
            response.raise_for_status()
            logger.info("‚úÖ –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –Ω–∞–¥—ñ—Å–ª–∞–Ω–æ –≤ Telegram")
            return True
        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞ –≤—ñ–¥–ø—Ä–∞–≤–∫–∏ Telegram: {e}")
            return False

    def send_file(self, file_path, caption="", file_type="document"):
        """–í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ —Ñ–∞–π–ª (document –∞–±–æ photo)"""
        if not self.api_url:
            logger.error("‚ùå Telegram –Ω–µ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–æ")
            return False

        try:
            with open(file_path, 'rb') as f:
                files = {file_type: f}
                payload = {
                    "chat_id": self.chat_id,
                    "caption": caption,
                    "parse_mode": "HTML"
                }
                endpoint = "sendDocument" if file_type == "document" else "sendPhoto"
                response = requests.post(
                    f"{self.api_url}/{endpoint}",
                    files=files,
                    data=payload,
                    timeout=30
                )
                response.raise_for_status()
            logger.info(f"‚úÖ –§–∞–π–ª –Ω–∞–¥—ñ—Å–ª–∞–Ω–æ –≤ Telegram")
            return True
        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞ –≤—ñ–¥–ø—Ä–∞–≤–∫–∏ —Ñ–∞–π–ª—É: {e}")
            return False

    def send_network_report(self, store_location, pc_name, test_results):
        """–í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ –∑–≤—ñ—Ç –ø—Ä–æ —Å—Ç–∞–Ω –º–µ—Ä–µ–∂—ñ"""
        report = (
            f"<b>üìä –ó–≤—ñ—Ç –ø—Ä–æ —Å—Ç–∞–Ω –º–µ—Ä–µ–∂—ñ</b>\n\n"
            f"<b>–ú–∞–≥–∞–∑–∏–Ω/–õ–æ–∫–∞—Ü—ñ—è:</b> {store_location}\n"
            f"<b>–ü–ö:</b> <code>{pc_name}</code>\n"
            f"<b>–ß–∞—Å:</b> {time.strftime('%Y-%m-%d %H:%M:%S')}\n\n"
            f"<b>–†–µ–∑—É–ª—å—Ç–∞—Ç–∏:</b>\n"
            f"{test_results}"
        )
        return self.send_message(report)

    def send_anydesk_info(self, store_location, user_name, pc_name, anydesk_id, password):
        """–í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ AnyDesk —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é"""

        # –î–æ–¥–∞—Ç–∏ –ü–Ü–ë —è–∫—â–æ —î
        user_info = f"\n<b>üë§ –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á:</b> {user_name}" if user_name else ""

        message = (
            f"<b>üåê AnyDesk - –ó–∞–ø—Ä–æ—Å –Ω–∞ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è</b>\n\n"
            f"<b>üìç –ú–∞–≥–∞–∑–∏–Ω/–õ–æ–∫–∞—Ü—ñ—è:</b> {store_location}{user_info}\n"
            f"<b>üíª –ü–ö:</b> <code>{pc_name}</code>\n\n"
            f"<b>üÜî ID:</b> <code>{anydesk_id}</code>\n"
            f"<b>üîê –ü–∞—Ä–æ–ª—å:</b> <code>{password}</code>"
        )
        return self.send_message(message)

    def send_rdp_info(self, store_location, pc_name):
        """–í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è –ø—Ä–æ RDP –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è"""
        message = (
            f"<b>üñ•Ô∏è RDP –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è</b>\n\n"
            f"<b>–ú–∞–≥–∞–∑–∏–Ω/–õ–æ–∫–∞—Ü—ñ—è:</b> {store_location}\n"
            f"<b>–ü–ö:</b> <code>{pc_name}</code>\n"
            f"<b>–ß–∞—Å:</b> {time.strftime('%Y-%m-%d %H:%M:%S')}\n\n"
            f"‚úÖ –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –ø—ñ–¥–∫–ª—é—á–∏–≤—Å—è –¥–æ 1–°"
        )
        return self.send_message(message)

    def send_error_report(self, store_location, pc_name, error_text):
        """–í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ –∑–≤—ñ—Ç –ø—Ä–æ –ø–æ–º–∏–ª–∫—É"""
        message = (
            f"<b>‚ùå –ü–æ–º–∏–ª–∫–∞</b>\n\n"
            f"<b>–ú–∞–≥–∞–∑–∏–Ω/–õ–æ–∫–∞—Ü—ñ—è:</b> {store_location}\n"
            f"<b>–ü–ö:</b> <code>{pc_name}</code>\n"
            f"<b>–ß–∞—Å:</b> {time.strftime('%Y-%m-%d %H:%M:%S')}\n\n"
            f"<b>–î–µ—Ç–∞–ª—ñ:</b>\n<code>{error_text}</code>"
        )
        return self.send_message(message)


================================================================================
–§–∞–π–ª 16/21: src\telegram_helper.py
--------------------------------------------------------------------------------
import asyncio
import json
import logging
from telegram import Bot

logger = logging.getLogger(__name__)


class TelegramHelper:
    """–î–æ–ø–æ–º—ñ–∂–Ω–∏–∫ –¥–ª—è –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å –≤ Telegram"""

    def __init__(self, config_path="bot_config.json"):
        self.config_path = config_path
        self.config = self.load_config()

    def load_config(self):
        """–ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –∫–æ–Ω—Ñ—ñ–≥"""
        try:
            with open(self.config_path, "r", encoding="utf-8") as f:
                return json.load(f)
        except:
            return {}

    async def send_anydesk_code(self, anydesk_id, password):
        """–í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ AnyDesk –¥–∞–Ω—ñ –≤ Telegram"""
        try:
            token = self.config.get("TELEGRAM_TOKEN")
            chat_id = self.config.get("CHAT_ID")

            if not token or not chat_id:
                logger.error("‚ùå –ù–µ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ñ TELEGRAM_TOKEN –∞–±–æ CHAT_ID")
                return False

            bot = Bot(token=token)

            message = (
                f"üñ•Ô∏è **AnyDesk —Å–µ—Å—ñ—è –∞–∫—Ç–∏–≤–æ–≤–∞–Ω–∞**\n\n"
                f"üÜî ID: `{anydesk_id}`\n"
                f"üîê –ü–∞—Ä–æ–ª—å: `{password}`\n\n"
                f"–î–ª—è –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ —Ü—ñ –¥–∞–Ω—ñ."
            )

            await bot.send_message(
                chat_id=chat_id,
                text=message,
                parse_mode="Markdown"
            )

            logger.info("‚úÖ –î–∞–Ω—ñ –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω—ñ –≤ Telegram")
            return True

        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞ –≤—ñ–¥–ø—Ä–∞–≤–∫–∏: {e}")
            return False

    async def send_message(self, text):
        """–í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ –¥–æ–≤—ñ–ª—å–Ω–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è"""
        try:
            token = self.config.get("TELEGRAM_TOKEN")
            chat_id = self.config.get("CHAT_ID")

            if not token or not chat_id:
                return False

            bot = Bot(token=token)
            await bot.send_message(chat_id=chat_id, text=text)

            return True

        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞: {e}")
            return False

    def send_anydesk_code_sync(self, anydesk_id, password):
        """–°–∏–Ω—Ö—Ä–æ–Ω–Ω–∞ –≤–µ—Ä—Å—ñ—è (–¥–ª—è GUI)"""
        try:
            loop = asyncio.new_event_loop()
            asyncio.set_event_loop(loop)
            result = loop.run_until_complete(
                self.send_anydesk_code(anydesk_id, password)
            )
            loop.close()
            return result
        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞: {e}")
            return False


================================================================================
–§–∞–π–ª 17/21: src\updater.py
--------------------------------------------------------------------------------
import os
import sys
import requests
import subprocess
import time
import logging
from pathlib import Path

logger = logging.getLogger(__name__)


class UpdaterManager:
    """–ú–µ–Ω–µ–¥–∂–µ—Ä –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ —Ç–∞ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –æ–Ω–æ–≤–ª–µ–Ω—å"""

    GITHUB_REPO = "ShevchukVI/RemoteHand"
    GITHUB_API_URL = f"https://api.github.com/repos/{GITHUB_REPO}/releases/latest"

    def __init__(self):
        self.app_dir = Path(__file__).parent.parent
        self.version_file = self.app_dir / "version.txt"
        self.current_version = self.get_current_version()

    def get_current_version(self):
        """–û—Ç—Ä–∏–º–∞—Ç–∏ –ø–æ—Ç–æ—á–Ω—É –≤–µ—Ä—Å—ñ—é"""
        if self.version_file.exists():
            try:
                with open(self.version_file, 'r', encoding='utf-8') as f:
                    return f.read().strip()
            except:
                pass
        return "1.0.0"

    def get_latest_version(self):
        """–û—Ç—Ä–∏–º–∞—Ç–∏ –Ω–∞–π–Ω–æ–≤—ñ—à—É –≤–µ—Ä—Å—ñ—é –∑ GitHub"""
        try:
            response = requests.get(self.GITHUB_API_URL, timeout=10)
            response.raise_for_status()
            data = response.json()
            tag = data.get('tag_name', 'v1.0.0')
            return tag.lstrip('v')
        except Exception as e:
            logger.warning(f"–ù–µ –≤–¥–∞–ª–æ—Å—è –æ—Ç—Ä–∏–º–∞—Ç–∏ –≤–µ—Ä—Å—ñ—é –∑ GitHub: {e}")
            return None

    def compare_versions(self, current, latest):
        """–ü–æ—Ä—ñ–≤–Ω—è—Ç–∏ –≤–µ—Ä—Å—ñ—ó"""
        try:
            current_parts = [int(x) for x in current.split('.')]
            latest_parts = [int(x) for x in latest.split('.')]
            return latest_parts > current_parts
        except:
            return False

    def download_and_update(self, latest_version):
        """–ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —Ç–∞ –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –Ω–æ–≤—É –≤–µ—Ä—Å—ñ—é"""
        try:
            logger.info(f"üì• –ó–∞–≤–∞–Ω—Ç–∞–∂—É—é RemoteHand v{latest_version}...")

            download_url = f"https://github.com/{self.GITHUB_REPO}/releases/download/v{latest_version}/RemoteHand.exe"

            # –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –Ω–æ–≤—É –≤–µ—Ä—Å—ñ—é
            response = requests.get(download_url, timeout=30)
            response.raise_for_status()

            # –í–∏–∑–Ω–∞—á–∏—Ç–∏ —à–ª—è—Ö –¥–ª—è –Ω–æ–≤–æ—ó –≤–µ—Ä—Å—ñ—ó
            if getattr(sys, 'frozen', False):
                # –Ø–∫—â–æ –∑–∞–ø—É—â–µ–Ω–æ —è–∫ EXE
                current_exe = Path(sys.executable)
                new_exe = current_exe.parent / "RemoteHand_new.exe"
            else:
                # –Ø–∫—â–æ –∑–∞–ø—É—â–µ–Ω–æ —è–∫ Python —Å–∫—Ä–∏–ø—Ç (DEV)
                new_exe = Path.cwd() / "RemoteHand_new.exe"

            # –ó–±–µ—Ä–µ–≥—Ç–∏ –Ω–æ–≤—É –≤–µ—Ä—Å—ñ—é
            with open(new_exe, 'wb') as f:
                f.write(response.content)

            logger.info(f"‚úÖ RemoteHand v{latest_version} –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ")
            return str(new_exe)

        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è: {e}")
            return None

    def check_and_update(self):
        """–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —Ç–∞ –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è"""
        # –ù–ï –æ–Ω–æ–≤–ª—é–≤–∞—Ç–∏ –≤ DEV —Ä–µ–∂–∏–º—ñ!
        if os.getenv('REMOTEHAND_DEV_MODE') == '1':
            logger.info("üîß DEV —Ä–µ–∂–∏–º - –ø—Ä–æ–ø—É—Å–∫–∞—î–º–æ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è")
            return False

        logger.info("üîç –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –æ–Ω–æ–≤–ª–µ–Ω—å...")

        latest_version = self.get_latest_version()
        if not latest_version:
            logger.info("‚ö†Ô∏è –ù–µ –≤–¥–∞–ª–æ—Å—è –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è")
            return False

        if self.compare_versions(self.current_version, latest_version):
            logger.info(f"üì¶ –î–æ—Å—Ç—É–ø–Ω–µ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è: {latest_version}")
            logger.info(f"üìå –ü–æ—Ç–æ—á–Ω–∞ –≤–µ—Ä—Å—ñ—è: {self.current_version}")

            # –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –Ω–æ–≤—É –≤–µ—Ä—Å—ñ—é
            new_exe = self.download_and_update(latest_version)

            if new_exe and os.path.exists(new_exe):
                logger.info(f"‚úÖ –ù–æ–≤–∞ –≤–µ—Ä—Å—ñ—è –≥–æ—Ç–æ–≤–∞!")
                logger.info(f"üîÑ –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫...")

                # ‚ö†Ô∏è –ê–í–¢–û–ú–ê–¢–ò–ß–ù–ò–ô –ü–ï–†–ï–ó–ê–ü–£–°–ö
                try:
                    # –ó–∞–ø—É—Å—Ç–∏—Ç–∏ –Ω–æ–≤—É –≤–µ—Ä—Å—ñ—é
                    subprocess.Popen([new_exe], shell=False)

                    # –ß–µ–∫–∞—Ç–∏ 1 —Å–µ–∫—É–Ω–¥—É
                    time.sleep(1)

                    # –ó–∞–∫—Ä–∏—Ç–∏ –ø–æ—Ç–æ—á–Ω—É –≤–µ—Ä—Å—ñ—é
                    logger.info("üëã –ó–∞–≤–µ—Ä—à–µ–Ω–Ω—è —Ä–æ–±–æ—Ç–∏ —Å—Ç–∞—Ä–æ—ó –≤–µ—Ä—Å—ñ—ó")
                    sys.exit(0)

                except Exception as e:
                    logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫—É: {e}")
                    logger.info(f"–ó–∞–ø—É—Å—Ç—ñ—Ç—å –≤—Ä—É—á–Ω—É: {new_exe}")
                    return False

                return True

        logger.info(f"‚úÖ –í–µ—Ä—Å—ñ—è –∞–∫—Ç—É–∞–ª—å–Ω–∞: {self.current_version}")
        return False


def check_and_update():
    """–§—É–Ω–∫—Ü—ñ—è –¥–ª—è —ñ–º–ø–æ—Ä—Ç—É –≤ main.py"""
    updater = UpdaterManager()
    return updater.check_and_update()


================================================================================
–§–∞–π–ª 18/21: src\utils.py
--------------------------------------------------------------------------------
import os
import sys
import subprocess
import psutil
from pathlib import Path
from config import LOCK_FILE, APP_NAME


class SingleInstance:
    """–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –Ω–∞ —î–¥–∏–Ω–∏–π –µ–∫–∑–µ–º–ø–ª—è—Ä –ø—Ä–æ–≥—Ä–∞–º–∏"""

    def __init__(self):
        self.lock_file = LOCK_FILE
        self.fp = None

    def is_running(self):
        """–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —á–∏ –ø—Ä–æ–≥—Ä–∞–º–∞ –≤–∂–µ –∑–∞–ø—É—â–µ–Ω–∞"""
        if sys.platform == 'win32':
            import win32event
            import win32api
            import winerror

            self.mutex = win32event.CreateMutex(None, False, APP_NAME)
            if win32api.GetLastError() == winerror.ERROR_ALREADY_EXISTS:
                return True
        else:
            try:
                self.fp = open(self.lock_file, 'w')
                import fcntl
                fcntl.flock(self.fp, fcntl.LOCK_EX | fcntl.LOCK_NB)
            except IOError:
                return True
        return False


def open_rdp_connection(host, port):
    """–í—ñ–¥–∫—Ä–∏—Ç—Ç—è RDP –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è"""
    rdp_command = f'mstsc /v:{host}:{port}'
    subprocess.Popen(rdp_command, shell=True)


def close_all_rdp_sessions():
    """–ó–∞–∫—Ä–∏—Ç—Ç—è –≤—Å—ñ—Ö RDP —Å–µ—Å—ñ–π"""
    for proc in psutil.process_iter(['name']):
        try:
            if proc.info['name'].lower() == 'mstsc.exe':
                proc.kill()
        except (psutil.NoSuchProcess, psutil.AccessDenied):
            pass


def test_connection(host):
    """–¢–µ—Å—Ç –∑'—î–¥–Ω–∞–Ω–Ω—è —á–µ—Ä–µ–∑ ping"""
    param = '-n' if sys.platform == 'win32' else '-c'
    command = ['ping', param, '1', host]
    result = subprocess.run(command, capture_output=True, text=True)
    return result.returncode == 0

================================================================================
–§–∞–π–ª 19/21: version.txt
--------------------------------------------------------------------------------
—è—é1 . 0 . 4 
 
 

================================================================================
–§–∞–π–ª 20/21: version_info.txt
--------------------------------------------------------------------------------
VSVersionInfo(
  ffi=FixedFileInfo(mask=0x3f,
    mask_values=[(0, 63), (0, 63), (0, 63), (0, 63)],
    CV_VSVersionInfo=[(0, '0'), (0, '3'), (0, '0'), (0, '0')]),
  StringFileInfo([(u'040904B0',
    StringTable(u'040904B0',
      [StringEntry(u'CompanyName', u'RemoteHand'),
       StringEntry(u'FileDescription', u'RemoteHand - RDP & AnyDesk Manager'),
       StringEntry(u'FileVersion', u'1.0.3.0'),
       StringEntry(u'ProductName', u'RemoteHand'),
       StringEntry(u'ProductVersion', u'1.0.3')]))]),
  VarFileInfo([VarEntry(u'Translation', [1033, 1200])])
)


================================================================================
–§–∞–π–ª 21/21: –ê–∫—Ç–∏–≤–∞—Ü—ñ—è —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞.txt
--------------------------------------------------------------------------------
.venvScriptsActivate.ps1

================================================================================
–ö–Ü–ù–ï–¶–¨ –ï–ö–°–ü–û–†–¢–£
================================================================================


================================================================================
–§–∞–π–ª 5/21: project_export_20251110_151306.txt
--------------------------------------------------------------------------------
================================================================================
–ï–ö–°–ü–û–†–¢ –ü–†–û–Ñ–ö–¢–£: RemoteHand
–î–∞—Ç–∞: 2025-11-10 15:13:06
–®–ª—è—Ö: D:\Python Projects\Prego\RemoteHand
================================================================================

üìÇ –°–¢–†–£–ö–¢–£–†–ê –ü–†–û–Ñ–ö–¢–£
--------------------------------------------------------------------------------
RemoteHand/
‚îú‚îÄ‚îÄ assets/
‚îÇ   ‚îî‚îÄ‚îÄ icon.ico
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ anydesk_manager.py
‚îÇ   ‚îú‚îÄ‚îÄ config.py
‚îÇ   ‚îú‚îÄ‚îÄ config_manager.py
‚îÇ   ‚îú‚îÄ‚îÄ main.py
‚îÇ   ‚îú‚îÄ‚îÄ network_test.py
‚îÇ   ‚îú‚îÄ‚îÄ rdp_manager.py
‚îÇ   ‚îú‚îÄ‚îÄ setup_wizard.py
‚îÇ   ‚îú‚îÄ‚îÄ telegram_api.py
‚îÇ   ‚îú‚îÄ‚îÄ updater.py
‚îÇ   ‚îî‚îÄ‚îÄ utils.py
‚îú‚îÄ‚îÄ .env.example
‚îú‚îÄ‚îÄ 23.88.7.196_admin_session.rdp
‚îú‚îÄ‚îÄ dev_run.py
‚îú‚îÄ‚îÄ export.py
‚îú‚îÄ‚îÄ GitCommitTool.py
‚îú‚îÄ‚îÄ project_export_20251110_104446.txt
‚îú‚îÄ‚îÄ project_export_20251110_151306.txt
‚îú‚îÄ‚îÄ README.md
‚îú‚îÄ‚îÄ RemoteHand.spec
‚îú‚îÄ‚îÄ requirements.txt
‚îú‚îÄ‚îÄ version.txt
‚îú‚îÄ‚îÄ version_info.txt
‚îî‚îÄ‚îÄ –ê–∫—Ç–∏–≤–∞—Ü—ñ—è —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞.txt

üìÑ –í–ú–Ü–°–¢ –§–ê–ô–õ–Ü–í (20 —Ñ–∞–π–ª—ñ–≤)
================================================================================


================================================================================
–§–∞–π–ª 1/20: dev_run.py
--------------------------------------------------------------------------------
"""
DEV_RUN.PY - –õ–æ–∫–∞–ª—å–Ω–µ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è
"""

import sys
import os

# –í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ DEV —Ä–µ–∂–∏–º
os.environ['REMOTEHAND_DEV_MODE'] = '1'

# –î–æ–¥–∞—Ç–∏ src –≤ path
sys.path.insert(0, os.path.join(os.path.dirname(__file__), 'src'))

print("–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π...")
import subprocess
subprocess.run([sys.executable, "-m", "pip", "install", "-r", "requirements.txt", "-q"],
               capture_output=True)

print("üîß –ó–∞–ø—É—Å–∫ —É DEV —Ä–µ–∂–∏–º—ñ...")

# –ü—Ä—è–º–æ –∑–∞–ø—É—Å—Ç–∏—Ç–∏ main
if __name__ == "__main__":
    import main
    main.main()


================================================================================
–§–∞–π–ª 2/20: export.py
--------------------------------------------------------------------------------
#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Project Structure Exporter
–°—Ç–≤–æ—Ä—é—î –¥–µ—Ç–∞–ª—å–Ω–∏–π –æ–ø–∏—Å —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ –ø—Ä–æ—î–∫—Ç—É —Ç–∞ –≤–º—ñ—Å—Ç —Ñ–∞–π–ª—ñ–≤ —É –æ–¥–∏–Ω —Ñ–∞–π–ª
"""

import os
from pathlib import Path
from datetime import datetime

# –§–∞–π–ª–∏ —Ç–∞ –ø–∞–ø–∫–∏, —è–∫—ñ —Ç—Ä–µ–±–∞ —ñ–≥–Ω–æ—Ä—É–≤–∞—Ç–∏
IGNORE_PATTERNS = {
    # –ü–∞–ø–∫–∏
    '__pycache__', '.git', '.idea', '.vscode', 'node_modules',
    'venv', 'env', '.env', 'dist', 'build', '.pytest_cache',
    '.mypy_cache', 'htmlcov', '.coverage', 'logs', 'tmp',
    # –§–∞–π–ª–∏
    '.pyc', '.pyo', '.pyd', '.so', '.dll', '.dylib', '.exe',
    '.log', '.sqlite', '.db', '.pkl', '.pickle', '.DS_Store',
    'Thumbs.db', '.env', '.env.local', '.gitignore'
}

# –†–æ–∑—à–∏—Ä–µ–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤ –¥–ª—è —á–∏—Ç–∞–Ω–Ω—è (—Ç–µ–∫—Å—Ç–æ–≤—ñ —Ñ–∞–π–ª–∏)
TEXT_EXTENSIONS = {
    '.py', '.js', '.ts', '.jsx', '.tsx', '.html', '.css', '.scss',
    '.json', '.yaml', '.yml', '.toml', '.ini', '.cfg', '.conf',
    '.txt', '.md', '.rst', '.xml', '.sql', '.sh', '.bash',
    '.env.example', '.gitignore', 'Dockerfile', 'Makefile',
    '.java', '.c', '.cpp', '.h', '.go', '.rs', '.php', '.rb'
}

# –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∏–π —Ä–æ–∑–º—ñ—Ä —Ñ–∞–π–ª—É (1 MB)
MAX_FILE_SIZE = 1024 * 1024


def should_ignore(path: Path) -> bool:
    """–ü–µ—Ä–µ–≤—ñ—Ä—è—î, —á–∏ —Ç—Ä–µ–±–∞ —ñ–≥–Ω–æ—Ä—É–≤–∞—Ç–∏ —Ñ–∞–π–ª/–ø–∞–ø–∫—É"""
    name = path.name

    # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ç–æ—á–Ω–æ–≥–æ –∑–±—ñ–≥—É
    if name in IGNORE_PATTERNS:
        return True

    # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è
    if path.suffix in IGNORE_PATTERNS:
        return True

    # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø—Ä–∏—Ö–æ–≤–∞–Ω–∏—Ö —Ñ–∞–π–ª—ñ–≤ (–∫—Ä—ñ–º .env.example)
    if name.startswith('.') and name != '.env.example':
        return True

    return False


def is_text_file(path: Path) -> bool:
    """–ü–µ—Ä–µ–≤—ñ—Ä—è—î, —á–∏ —î —Ñ–∞–π–ª —Ç–µ–∫—Å—Ç–æ–≤–∏–º"""
    # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è
    if path.suffix.lower() in TEXT_EXTENSIONS:
        return True

    # –§–∞–π–ª–∏ –±–µ–∑ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è, —è–∫—ñ –∑–∞–∑–≤–∏—á–∞–π —Ç–µ–∫—Å—Ç–æ–≤—ñ
    if path.suffix == '' and path.name in {'Dockerfile', 'Makefile', 'README', 'LICENSE'}:
        return True

    return False


def get_tree_structure(root_path: Path, prefix: str = "", is_last: bool = True) -> list:
    """–ì–µ–Ω–µ—Ä—É—î –¥–µ—Ä–µ–≤–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ –ø—Ä–æ—î–∫—Ç—É"""
    lines = []

    try:
        items = sorted(root_path.iterdir(), key=lambda x: (not x.is_dir(), x.name.lower()))
        items = [item for item in items if not should_ignore(item)]

        for i, item in enumerate(items):
            is_last_item = i == len(items) - 1
            current_prefix = "‚îî‚îÄ‚îÄ " if is_last_item else "‚îú‚îÄ‚îÄ "
            lines.append(f"{prefix}{current_prefix}{item.name}{'/' if item.is_dir() else ''}")

            if item.is_dir():
                extension = "    " if is_last_item else "‚îÇ   "
                lines.extend(get_tree_structure(item, prefix + extension, is_last_item))

    except PermissionError:
        pass

    return lines


def read_file_content(file_path: Path) -> str:
    """–ß–∏—Ç–∞—î –≤–º—ñ—Å—Ç —Ñ–∞–π–ª—É"""
    try:
        # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ä–æ–∑–º—ñ—Ä—É
        if file_path.stat().st_size > MAX_FILE_SIZE:
            return f"[–§–∞–π–ª –∑–∞–Ω–∞–¥—Ç–æ –≤–µ–ª–∏–∫–∏–π: {file_path.stat().st_size / 1024:.1f} KB]"

        # –°–ø—Ä–æ–±–∞ –ø—Ä–æ—á–∏—Ç–∞—Ç–∏ —è–∫ —Ç–µ–∫—Å—Ç
        with open(file_path, 'r', encoding='utf-8') as f:
            return f.read()
    except UnicodeDecodeError:
        # –Ø–∫—â–æ –Ω–µ –≤–¥–∞–ª–æ—Å—è –ø—Ä–æ—á–∏—Ç–∞—Ç–∏ —è–∫ UTF-8
        try:
            with open(file_path, 'r', encoding='cp1251') as f:
                return f.read()
        except:
            return "[–ù–µ –≤–¥–∞–ª–æ—Å—è –ø—Ä–æ—á–∏—Ç–∞—Ç–∏ —Ñ–∞–π–ª - –±—ñ–Ω–∞—Ä–Ω–∏–π –∞–±–æ –Ω–µ–≤—ñ–¥–æ–º–µ –∫–æ–¥—É–≤–∞–Ω–Ω—è]"
    except Exception as e:
        return f"[–ü–æ–º–∏–ª–∫–∞ —á–∏—Ç–∞–Ω–Ω—è: {str(e)}]"


def collect_files(root_path: Path) -> list:
    """–ó–±–∏—Ä–∞—î –≤—Å—ñ —Ç–µ–∫—Å—Ç–æ–≤—ñ —Ñ–∞–π–ª–∏ –ø—Ä–æ—î–∫—Ç—É"""
    files = []

    for item in root_path.rglob('*'):
        if item.is_file() and not should_ignore(item) and is_text_file(item):
            # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞, —â–æ –≤—Å—ñ –±–∞—Ç—å–∫—ñ–≤—Å—å–∫—ñ –ø–∞–ø–∫–∏ –Ω–µ —ñ–≥–Ω–æ—Ä—É—é—Ç—å—Å—è
            if not any(should_ignore(parent) for parent in item.parents):
                files.append(item)

    return sorted(files)


def generate_project_export(project_path: str, output_file: str = None):
    """–ì–µ–Ω–µ—Ä—É—î –ø–æ–≤–Ω–∏–π –µ–∫—Å–ø–æ—Ä—Ç –ø—Ä–æ—î–∫—Ç—É"""
    root = Path(project_path).resolve()

    if not root.exists():
        print(f"‚ùå –ü–æ–º–∏–ª–∫–∞: –®–ª—è—Ö '{project_path}' –Ω–µ —ñ—Å–Ω—É—î!")
        return

    if output_file is None:
        timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
        output_file = f"project_export_{timestamp}.txt"

    print(f"üìÅ –ê–Ω–∞–ª—ñ–∑ –ø—Ä–æ—î–∫—Ç—É: {root.name}")
    print(f"üìù –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –µ–∫—Å–ø–æ—Ä—Ç—É...")

    with open(output_file, 'w', encoding='utf-8') as f:
        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        f.write("=" * 80 + "\n")
        f.write(f"–ï–ö–°–ü–û–†–¢ –ü–†–û–Ñ–ö–¢–£: {root.name}\n")
        f.write(f"–î–∞—Ç–∞: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}\n")
        f.write(f"–®–ª—è—Ö: {root}\n")
        f.write("=" * 80 + "\n\n")

        # –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ—î–∫—Ç—É
        f.write("üìÇ –°–¢–†–£–ö–¢–£–†–ê –ü–†–û–Ñ–ö–¢–£\n")
        f.write("-" * 80 + "\n")
        f.write(f"{root.name}/\n")
        tree_lines = get_tree_structure(root)
        f.write("\n".join(tree_lines))
        f.write("\n\n")

        # –ó–±—ñ—Ä —Ñ–∞–π–ª—ñ–≤
        files = collect_files(root)

        f.write(f"üìÑ –í–ú–Ü–°–¢ –§–ê–ô–õ–Ü–í ({len(files)} —Ñ–∞–π–ª—ñ–≤)\n")
        f.write("=" * 80 + "\n\n")

        # –í–º—ñ—Å—Ç –∫–æ–∂–Ω–æ–≥–æ —Ñ–∞–π–ª—É
        for i, file_path in enumerate(files, 1):
            relative_path = file_path.relative_to(root)

            print(f"  [{i}/{len(files)}] {relative_path}")

            f.write("\n" + "=" * 80 + "\n")
            f.write(f"–§–∞–π–ª {i}/{len(files)}: {relative_path}\n")
            f.write("-" * 80 + "\n")

            content = read_file_content(file_path)
            f.write(content)
            f.write("\n")

        # –ü—ñ–¥—Å—É–º–æ–∫
        f.write("\n" + "=" * 80 + "\n")
        f.write("–ö–Ü–ù–ï–¶–¨ –ï–ö–°–ü–û–†–¢–£\n")
        f.write("=" * 80 + "\n")

    file_size = Path(output_file).stat().st_size
    print(f"\n‚úÖ –ï–∫—Å–ø–æ—Ä—Ç –∑–∞–≤–µ—Ä—à–µ–Ω–æ!")
    print(f"üìÑ –§–∞–π–ª: {output_file}")
    print(f"üìä –†–æ–∑–º—ñ—Ä: {file_size / 1024:.1f} KB")
    print(f"üìÅ –§–∞–π–ª—ñ–≤ –æ–±—Ä–æ–±–ª–µ–Ω–æ: {len(files)}")


if __name__ == "__main__":
    import sys

    # –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è: python export_project.py [—à–ª—è—Ö_–¥–æ_–ø—Ä–æ—î–∫—Ç—É] [–≤–∏—Ö—ñ–¥–Ω–∏–π_—Ñ–∞–π–ª]
    project_path = sys.argv[1] if len(sys.argv) > 1 else "."
    output_file = sys.argv[2] if len(sys.argv) > 2 else None

    generate_project_export(project_path, output_file)


================================================================================
–§–∞–π–ª 3/20: GitCommitTool.py
--------------------------------------------------------------------------------
import customtkinter as ctk
from tkinter import messagebox, scrolledtext
import subprocess
import os
import re
from pathlib import Path
from datetime import datetime
from packaging.version import parse as parse_version


class GitCommitTool(ctk.CTk):
    def __init__(self):
        super().__init__()

        self.title("Git Commit Tool")
        self.geometry("600x750")
        self.resizable(False, False)
        self.is_running = False  # –ü—Ä–∞–ø–æ—Ä–µ—Ü—å –¥–ª—è –±–ª–æ–∫—É–≤–∞–Ω–Ω—è UI

        # –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç–µ–º–∏
        ctk.set_appearance_mode("dark")  # –ó–º—ñ–Ω–µ–Ω–æ –Ω–∞ —Ç–µ–º–Ω—É
        ctk.set_default_color_theme("blue")

        # –û—Ç—Ä–∏–º–∞–Ω–Ω—è –ø–æ—Ç–æ—á–Ω–æ—ó –≤–µ—Ä—Å—ñ—ó
        self.current_version = self.get_current_version()

        # –°–ø–∏—Å–æ–∫ –µ–ª–µ–º–µ–Ω—Ç—ñ–≤ UI –¥–ª—è –±–ª–æ–∫—É–≤–∞–Ω–Ω—è
        self.interactive_widgets = []

        self.setup_ui()
        self.toggle_version_fields()  # –ü–æ—á–∞—Ç–∫–æ–≤–µ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —Å—Ç–∞–Ω—É UI

    def setup_ui(self):
        """(–û–ù–û–í–õ–ï–ù–û) –°—Ç–≤–æ—Ä–µ–Ω–Ω—è UI"""

        main_frame = ctk.CTkFrame(self, fg_color="transparent")
        main_frame.pack(fill="both", expand=True, padx=20, pady=15)

        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        title_label = ctk.CTkLabel(
            main_frame,
            text="Git Commit Tool",
            font=ctk.CTkFont(size=24, weight="bold")
        )
        title_label.pack(pady=10)

        # –ü–æ—Ç–æ—á–Ω–∞ –≤–µ—Ä—Å—ñ—è
        version_frame = ctk.CTkFrame(main_frame)
        version_frame.pack(pady=10, fill="x")

        ctk.CTkLabel(
            version_frame,
            text="–ü–æ—Ç–æ—á–Ω–∞ –≤–µ—Ä—Å—ñ—è:",
            font=ctk.CTkFont(size=12, weight="bold")
        ).pack(side="left", padx=(10, 0))

        self.current_version_label = ctk.CTkLabel(
            version_frame,
            text=f"v{self.current_version}",
            font=ctk.CTkFont(size=12),
            text_color="gray"
        )
        self.current_version_label.pack(side="left", padx=10)

        # –ö–æ–º–µ–Ω—Ç–∞—Ä
        ctk.CTkLabel(
            main_frame,
            text="–ö–æ–º–µ–Ω—Ç–∞—Ä (commit message):",
            font=ctk.CTkFont(size=12, weight="bold")
        ).pack(anchor="w", pady=(10, 5))

        self.comment_entry = ctk.CTkEntry(
            main_frame,
            placeholder_text="–û–ø–∏—à—ñ—Ç—å –≤–∞—à—ñ –∑–º—ñ–Ω–∏...",
            height=40,
            font=ctk.CTkFont(size=11)
        )
        self.comment_entry.pack(fill="x", pady=(0, 15))
        self.interactive_widgets.append(self.comment_entry)

        # --- –ë–ª–æ–∫ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –≤–µ—Ä—Å—ñ—ó ---

        # –ß–µ–∫–±–æ–∫—Å –¥–ª—è —Ç–∞–≥—É
        self.tag_checkbox = ctk.CTkCheckBox(
            main_frame,
            text="–°—Ç–≤–æ—Ä–∏—Ç–∏ –Ω–æ–≤–∏–π —Ç–µ–≥ –≤–µ—Ä—Å—ñ—ó",
            font=ctk.CTkFont(size=11),
            command=self.toggle_version_fields
        )
        self.tag_checkbox.pack(anchor="w", pady=(0, 10))
        self.tag_checkbox.select()
        self.interactive_widgets.append(self.tag_checkbox)

        # –ù–æ–≤–∞ –≤–µ—Ä—Å—ñ—è
        self.version_frame_new = ctk.CTkFrame(main_frame)
        self.version_frame_new.pack(fill="x", pady=(0, 15))

        ctk.CTkLabel(
            self.version_frame_new,
            text="–ù–æ–≤–∞ –≤–µ—Ä—Å—ñ—è (–¥–ª—è —Ç–∞–≥—É):",
            font=ctk.CTkFont(size=12, weight="bold")
        ).pack(anchor="w", pady=(0, 5), padx=10)

        version_entry_frame = ctk.CTkFrame(self.version_frame_new, fg_color="transparent")
        version_entry_frame.pack(fill="x", padx=10)

        ctk.CTkLabel(
            version_entry_frame,
            text="v",
            font=ctk.CTkFont(size=11)
        ).pack(side="left", padx=(0, 5))

        self.version_entry = ctk.CTkEntry(
            version_entry_frame,
            placeholder_text="1.1.0",
            height=35,
            font=ctk.CTkFont(size=11)
        )
        self.version_entry.pack(side="left", fill="x", expand=True)
        self.version_entry.insert(0, self.current_version)  # –ü–æ–ø–µ—Ä–µ–¥–Ω—å–æ –∑–∞–ø–æ–≤–Ω—é—î–º–æ
        self.interactive_widgets.append(self.version_entry)

        # (–ù–û–í–ï) –ö–Ω–æ–ø–∫–∏ –¥–ª—è "–±–∞–º–ø—É" –≤–µ—Ä—Å—ñ—ó
        self.bump_button_frame = ctk.CTkFrame(self.version_frame_new, fg_color="transparent")
        self.bump_button_frame.pack(fill="x", padx=10, pady=10)

        bump_patch_btn = ctk.CTkButton(
            self.bump_button_frame, text="Patch (+0.0.1)",
            command=lambda: self.bump_version('patch'),
            font=ctk.CTkFont(size=10, weight="bold"), height=25
        )
        bump_patch_btn.pack(side="left", fill="x", expand=True, padx=2)

        bump_minor_btn = ctk.CTkButton(
            self.bump_button_frame, text="Minor (+0.1.0)",
            command=lambda: self.bump_version('minor'),
            font=ctk.CTkFont(size=10, weight="bold"), height=25
        )
        bump_minor_btn.pack(side="left", fill="x", expand=True, padx=2)

        bump_major_btn = ctk.CTkButton(
            self.bump_button_frame, text="Major (+1.0.0)",
            command=lambda: self.bump_version('major'),
            font=ctk.CTkFont(size=10, weight="bold"), height=25
        )
        bump_major_btn.pack(side="left", fill="x", expand=True, padx=2)

        self.interactive_widgets.extend([bump_patch_btn, bump_minor_btn, bump_major_btn])

        # –ö–Ω–æ–ø–∫–∏
        button_frame = ctk.CTkFrame(main_frame, fg_color="transparent")
        button_frame.pack(fill="x", pady=(0, 15))

        self.commit_btn = ctk.CTkButton(
            button_frame,
            text="‚úÖ Commit & Push",
            command=self.commit_and_push_thread,
            font=ctk.CTkFont(size=12, weight="bold"),
            height=45,
            corner_radius=10
        )
        self.commit_btn.pack(side="left", fill="both", expand=True, padx=(0, 5))
        self.interactive_widgets.append(self.commit_btn)

        clear_btn = ctk.CTkButton(
            button_frame,
            text="üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç–∏",
            command=self.clear_fields,
            font=ctk.CTkFont(size=12),
            height=45,
            corner_radius=10,
            fg_color="gray30",
            hover_color="gray50"
        )
        clear_btn.pack(side="left", fill="both", expand=True, padx=(5, 0))
        self.interactive_widgets.append(clear_btn)

        # –õ–æ–≥–∏
        ctk.CTkLabel(
            main_frame,
            text="–õ–æ–≥–∏ –æ–ø–µ—Ä–∞—Ü—ñ–π:",
            font=ctk.CTkFont(size=11, weight="bold")
        ).pack(anchor="w", pady=(10, 5))

        log_frame = ctk.CTkFrame(main_frame, fg_color="transparent")
        log_frame.pack(fill="both", expand=True)

        self.log_text = scrolledtext.ScrolledText(
            log_frame,
            height=10,
            width=70,
            font=("Courier", 10),
            bg="#2B2B2B",  # –¢–µ–º–Ω–∏–π —Ñ–æ–Ω
            fg="#E0E0E0",  # –°–≤—ñ—Ç–ª–∏–π —Ç–µ–∫—Å—Ç
            relief="solid",
            borderwidth=1,
            bd=0
        )
        self.log_text.pack(fill="both", expand=True)
        # (–ù–û–í–ï) –¢–µ–≥–∏ –¥–ª—è –∫–æ–ª—å–æ—Ä—ñ–≤
        self.log_text.tag_config("info", foreground="#89CFF0")
        self.log_text.tag_config("success", foreground="#7FFF7F")
        self.log_text.tag_config("error", foreground="#FF6B6B")
        self.log_text.tag_config("warning", foreground="#FFA500")

        # –°—Ç–∞—Ç—É—Å
        self.status_label = ctk.CTkLabel(
            main_frame,
            text="–ì–æ—Ç–æ–≤–æ –¥–æ —Ä–æ–±–æ—Ç–∏",
            font=ctk.CTkFont(size=10),
            text_color="gray"
        )
        self.status_label.pack(pady=(10, 0))

    def get_current_version(self):
        """–û—Ç—Ä–∏–º–∞–Ω–Ω—è –ø–æ—Ç–æ—á–Ω–æ—ó –≤–µ—Ä—Å—ñ—ó –∑ version.txt"""
        try:
            with open("version.txt", "r") as f:
                version = f.read().strip()
                # (–ù–û–í–ï) –í–∞–ª—ñ–¥–∞—Ü—ñ—è –≤–µ—Ä—Å—ñ—ó
                if re.match(r"^\d+\.\d+\.\d+$", version):
                    return version
                else:
                    return "1.0.0"  # Fallback
        except:
            return "1.0.0"

    def toggle_version_fields(self):
        """(–ù–û–í–ï) –í–º–∏–∫–∞—î/–≤–∏–º–∏–∫–∞—î –±–ª–æ–∫ –≤–µ—Ä—Å—ñ—ó"""
        is_enabled = self.tag_checkbox.get()
        state = "normal" if is_enabled else "disabled"

        self.version_entry.configure(state=state)
        for btn in self.bump_button_frame.winfo_children():
            btn.configure(state=state)

        # (–ù–û–í–ï) –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –ø—Ä–æ–ø–æ–Ω—É—î–º–æ patch-bump
        if is_enabled:
            self.bump_version('patch', auto_fill=True)

    def bump_version(self, part="patch", auto_fill=False):
        """(–ù–û–í–ï) –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∑–±—ñ–ª—å—à—É—î –≤–µ—Ä—Å—ñ—é"""
        try:
            current_v = parse_version(self.get_current_version())
            parts = list(current_v.release)

            if part == 'major':
                parts[0] += 1
                parts[1] = 0
                parts[2] = 0
            elif part == 'minor':
                parts[1] += 1
                parts[2] = 0
            else:  # patch
                parts[2] += 1

            new_version = f"{parts[0]}.{parts[1]}.{parts[2]}"

            if not auto_fill or self.version_entry.get() != new_version:
                self.version_entry.delete(0, "end")
                self.version_entry.insert(0, new_version)

        except Exception as e:
            self.log_message(f"‚ùå –ü–æ–º–∏–ª–∫–∞ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –≤–µ—Ä—Å—ñ—ó: {str(e)}", "error")

    def log_message(self, message, tag="info"):
        """(–û–ù–û–í–õ–ï–ù–û) –î–æ–¥–∞–Ω–Ω—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –¥–æ –ª–æ–≥—ñ–≤ –∑ —Ç–µ–≥–æ–º"""
        timestamp = datetime.now().strftime("%H:%M:%S")
        self.log_text.configure(state="normal")
        self.log_text.insert("end", f"[{timestamp}] {message}\n", tag)
        self.log_text.configure(state="disabled")
        self.log_text.see("end")
        self.update_idletasks()

    def set_ui_state(self, is_enabled):
        """(–ù–û–í–ï) –í–º–∏–∫–∞—î/–≤–∏–º–∏–∫–∞—î –≤–µ—Å—å UI"""
        state = "normal" if is_enabled else "disabled"
        for widget in self.interactive_widgets:
            widget.configure(state=state)
        self.is_running = not is_enabled
        if is_enabled:
            self.toggle_version_fields()  # –ü–æ–≤–µ—Ä—Ç–∞—î–º–æ –∫–æ—Ä–µ–∫—Ç–Ω–∏–π —Å—Ç–∞–Ω –ø–æ–ª—ñ–≤ –≤–µ—Ä—Å—ñ—ó

    def run_git_command(self, command, log_output=True):
        """(–û–ù–û–í–õ–ï–ù–û) –í–∏–∫–æ–Ω–∞–Ω–Ω—è git –∫–æ–º–∞–Ω–¥–∏, –ø–æ–≤–µ—Ä—Ç–∞—î (success, output)"""
        self.log_message(f"$ {command}", "info")
        try:
            result = subprocess.run(
                command,
                shell=True,
                capture_output=True,
                text=True,
                encoding='utf-8',  # –í—Å—Ç–∞–Ω–æ–≤–ª—é—î–º–æ –∫–æ–¥—É–≤–∞–Ω–Ω—è
                cwd=os.getcwd()
            )

            if result.returncode == 0:
                if result.stdout and log_output:
                    self.log_message(f"{result.stdout.strip()}", "success")
                return True, result.stdout.strip()
            else:
                error_msg = result.stderr.strip() if result.stderr else "–ù–µ–≤—ñ–¥–æ–º–∞ –ø–æ–º–∏–ª–∫–∞"
                if log_output:
                    self.log_message(f"‚ùå –ü–æ–º–∏–ª–∫–∞: {error_msg}", "error")
                return False, error_msg
        except Exception as e:
            self.log_message(f"‚ùå –í–∏–Ω—è—Ç–æ–∫: {str(e)}", "error")
            return False, str(e)

    def get_current_branch(self):
        """(–ù–û–í–ï) –û—Ç—Ä–∏–º—É—î –ø–æ—Ç–æ—á–Ω—É –≥—ñ–ª–∫—É git"""
        success, output = self.run_git_command("git rev-parse --abbrev-ref HEAD", log_output=False)
        if success:
            return output
        return "main"  # Fallback

    def commit_and_push_thread(self):
        """(–ù–û–í–ï) –ó–∞–ø—É—Å–∫–∞—î –ø—Ä–æ—Ü–µ—Å –≤ –æ–∫—Ä–µ–º–æ–º—É –ø–æ—Ç–æ—Ü—ñ, —â–æ–± UI –Ω–µ "–∑–∞–≤–∏—Å–∞–≤" """
        if self.is_running:
            self.log_message("‚è≥ –û–ø–µ—Ä–∞—Ü—ñ—è –≤–∂–µ –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è...", "warning")
            return

        # –ó–∞–ø—É—Å–∫–∞—î–º–æ –≤ –æ–∫—Ä–µ–º–æ–º—É –ø–æ—Ç–æ—Ü—ñ
        import threading
        threading.Thread(target=self.commit_and_push, daemon=True).start()

    def commit_and_push(self):
        """(–û–ù–û–í–õ–ï–ù–û) –û—Å–Ω–æ–≤–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è - commit, tag —ñ push"""

        self.set_ui_state(False)
        self.status_label.configure(text="‚è≥ –û–±—Ä–æ–±–∫–∞...")

        try:
            comment = self.comment_entry.get().strip()
            new_version = self.version_entry.get().strip()
            create_tag = self.tag_checkbox.get()

            # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∏
            if not comment:
                messagebox.showwarning("–ü–æ–º–∏–ª–∫–∞", "–ù–∞–ø–∏—à—ñ—Ç—å –∫–æ–º–µ–Ω—Ç–∞—Ä –¥–æ –∫–æ–º—ñ—Ç—é!")
                self.log_message("‚ùå –ö–æ–º–µ–Ω—Ç–∞—Ä –Ω–µ –º–æ–∂–µ –±—É—Ç–∏ –ø–æ—Ä–æ–∂–Ω—ñ–º", "error")
                return

            if create_tag and not new_version:
                messagebox.showwarning("–ü–æ–º–∏–ª–∫–∞", "–ù–∞–ø–∏—à—ñ—Ç—å –Ω–æ–≤—É –≤–µ—Ä—Å—ñ—é –¥–ª—è —Ç–∞–≥—É!")
                self.log_message("‚ùå –ù–æ–º–µ—Ä –≤–µ—Ä—Å—ñ—ó –Ω–µ –º–æ–∂–µ –±—É—Ç–∏ –ø–æ—Ä–æ–∂–Ω—ñ–º", "error")
                return

            self.log_message("=" * 50, "info")
            self.log_message("üöÄ –†–æ–∑–ø–æ—á–∏–Ω–∞—î–º–æ commit & push –ø—Ä–æ—Ü–µ—Å...", "info")
            self.log_message("=" * 50, "info")

            # –ö—Ä–æ–∫ 1: –û—Ç—Ä–∏–º–∞–Ω–Ω—è –ø–æ—Ç–æ—á–Ω–æ—ó –≥—ñ–ª–∫–∏
            self.log_message("\nüìã –ö—Ä–æ–∫ 1: –í–∏–∑–Ω–∞—á–µ–Ω–Ω—è –ø–æ—Ç–æ—á–Ω–æ—ó –≥—ñ–ª–∫–∏...", "info")
            current_branch = self.get_current_branch()
            self.log_message(f"–ü–æ—Ç–æ—á–Ω–∞ –≥—ñ–ª–∫–∞: {current_branch}", "success")

            # –ö—Ä–æ–∫ 2: –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å—É
            self.log_message("\nüìã –ö—Ä–æ–∫ 2: –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å—É —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—é...", "info")
            success, status_output = self.run_git_command("git status --short")
            if not status_output:
                self.log_message("‚úÖ –ù–µ–º–∞—î –∑–º—ñ–Ω –¥–ª—è –∫–æ–º—ñ—Ç—É. –í—Å–µ —á–∏—Å—Ç–æ!", "success")
                self.status_label.configure(text="‚úÖ –ù–µ–º–∞—î –∑–º—ñ–Ω")
                return

            # –ö—Ä–æ–∫ 3: –î–æ–¥–∞–≤–∞–Ω–Ω—è –≤—Å—ñ—Ö —Ñ–∞–π–ª—ñ–≤
            self.log_message("\nüì¶ –ö—Ä–æ–∫ 3: –î–æ–¥–∞–≤–∞–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤ (git add .)...", "info")
            if not self.run_git_command("git add .")[0]:
                self.status_label.configure(text="‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ 'git add'")
                messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–ù–µ –≤–¥–∞–ª–æ—Å—è –¥–æ–¥–∞—Ç–∏ —Ñ–∞–π–ª–∏!")
                return

            # –ö—Ä–æ–∫ 4: –ö–æ–º—ñ—Ç
            self.log_message("\nüíæ –ö—Ä–æ–∫ 4: –ö–æ–º—ñ—Ç—É–≤–∞–Ω–Ω—è –∑–º—ñ–Ω...", "info")
            if not self.run_git_command(f'git commit -m "{comment}"')[0]:
                self.status_label.configure(text="‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –∫–æ–º—ñ—Ç—É–≤–∞–Ω–Ω—ñ")
                # (–º–æ–∂–ª–∏–≤–æ, –Ω–µ –±—É–ª–æ –∑–º—ñ–Ω)
                return

            # –ö—Ä–æ–∫ 5: Push
            self.log_message(f"\n‚¨ÜÔ∏è  –ö—Ä–æ–∫ 5: –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –Ω–∞ GitHub (git push origin {current_branch})...", "info")
            if not self.run_git_command(f"git push origin {current_branch}")[0]:
                self.status_label.configure(text="‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ 'git push'")
                messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–ù–µ –≤–¥–∞–ª–æ—Å—è –≤—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ –Ω–∞ GitHub!")
                return

            # –ö—Ä–æ–∫ 6: –¢–µ–≥ (—è–∫—â–æ –ø–æ—Ç—Ä—ñ–±–µ–Ω)
            if create_tag:
                self.log_message(f"\nüè∑Ô∏è  –ö—Ä–æ–∫ 6: –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–∞–≥—É v{new_version}...", "info")
                if not self.run_git_command(f"git tag v{new_version}")[0]:
                    self.status_label.configure(text="‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—ñ —Ç–∞–≥—É")
                    messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–ù–µ –≤–¥–∞–ª–æ—Å—è —Å—Ç–≤–æ—Ä–∏—Ç–∏ —Ç–µ–≥! –ú–æ–∂–ª–∏–≤–æ, –≤—ñ–Ω –≤–∂–µ —ñ—Å–Ω—É—î.")
                    return

                self.log_message(f"\n‚¨ÜÔ∏è  –ö—Ä–æ–∫ 7: –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ç–∞–≥—É –Ω–∞ GitHub...", "info")
                if not self.run_git_command(f"git push origin v{new_version}")[0]:
                    self.status_label.configure(text="‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ 'git push' —Ç–∞–≥—É")
                    messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–ù–µ –≤–¥–∞–ª–æ—Å—è –≤—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ —Ç–µ–≥!")
                    return

                # –û–Ω–æ–≤–ª–µ–Ω–Ω—è version.txt
                self.log_message("\nüìù –ö—Ä–æ–∫ 8: –û–Ω–æ–≤–ª–µ–Ω–Ω—è version.txt...", "info")
                try:
                    with open("version.txt", "w") as f:
                        f.write(new_version)
                    self.log_message("‚úÖ version.txt –æ–Ω–æ–≤–ª–µ–Ω–æ", "success")
                    self.current_version = new_version
                    self.current_version_label.configure(text=f"v{self.current_version}")
                except Exception as e:
                    self.log_message(f"‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –æ–Ω–æ–≤–ª–µ–Ω–Ω—ñ version.txt: {str(e)}", "error")

            self.log_message("\n" + "=" * 50, "success")
            self.log_message("‚úÖ –í–°–ï –£–°–ü–Ü–®–ù–û! GitHub Actions –ø–æ—á–Ω–µ –∫–æ–º–ø—ñ–ª—é–≤–∞—Ç–∏...", "success")
            self.log_message("=" * 50, "success")

            self.status_label.configure(text="‚úÖ –£—Å–ø—ñ—à–Ω–æ! GitHub Actions –∑–∞–ø—É—â–µ–Ω–æ")
            messagebox.showinfo(
                "–£—Å–ø—ñ—Ö",
                f"‚úÖ –ö–æ–º—ñ—Ç —É—Å–ø—ñ—à–Ω–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ!\n\n"
                f"–ö–æ–º–µ–Ω—Ç–∞—Ä: {comment}\n"
                + (f"–í–µ—Ä—Å—ñ—è: v{new_version}\n\nGitHub Actions –ø–æ—á–Ω–µ –∫–æ–º–ø—ñ–ª—é–≤–∞—Ç–∏ EXE..." if create_tag else "")
            )

            self.clear_fields()

        finally:
            # (–ù–û–í–ï) –ó–∞–≤–∂–¥–∏ –≤–º–∏–∫–∞—î–º–æ UI –Ω–∞–∑–∞–¥, –Ω–∞–≤—ñ—Ç—å —è–∫—â–æ –±—É–ª–∞ –ø–æ–º–∏–ª–∫–∞
            self.set_ui_state(True)
            if '–ü–æ–º–∏–ª–∫–∞' not in self.status_label.cget("text"):
                self.status_label.configure(text="–ì–æ—Ç–æ–≤–æ –¥–æ —Ä–æ–±–æ—Ç–∏")

    def clear_fields(self):
        """–û—á–∏—Å—Ç–∫–∞ –ø–æ–ª—ñ–≤"""
        self.comment_entry.delete(0, "end")
        self.version_entry.delete(0, "end")
        self.tag_checkbox.select()
        self.toggle_version_fields()  # –û–Ω–æ–≤–ª—é—î–º–æ —Å—Ç–∞–Ω –ø–æ–ª—ñ–≤ –≤–µ—Ä—Å—ñ—ó
        self.status_label.configure(text="–ì–æ—Ç–æ–≤–æ –¥–æ —Ä–æ–±–æ—Ç–∏")


def main():
    app = GitCommitTool()
    app.mainloop()


if __name__ == "__main__":
    main()

================================================================================
–§–∞–π–ª 4/20: project_export_20251110_104446.txt
--------------------------------------------------------------------------------
================================================================================
–ï–ö–°–ü–û–†–¢ –ü–†–û–Ñ–ö–¢–£: RemoteHand
–î–∞—Ç–∞: 2025-11-10 10:44:46
–®–ª—è—Ö: D:\Python Projects\Prego\RemoteHand
================================================================================

üìÇ –°–¢–†–£–ö–¢–£–†–ê –ü–†–û–Ñ–ö–¢–£
--------------------------------------------------------------------------------
RemoteHand/
‚îú‚îÄ‚îÄ assets/
‚îÇ   ‚îî‚îÄ‚îÄ icon.ico
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ anydesk_manager.py
‚îÇ   ‚îú‚îÄ‚îÄ config.py
‚îÇ   ‚îú‚îÄ‚îÄ config_manager.py
‚îÇ   ‚îú‚îÄ‚îÄ main.py
‚îÇ   ‚îú‚îÄ‚îÄ network_test.py
‚îÇ   ‚îú‚îÄ‚îÄ rdp_manager.py
‚îÇ   ‚îú‚îÄ‚îÄ set_anydesk_password.py
‚îÇ   ‚îú‚îÄ‚îÄ setup_wizard.py
‚îÇ   ‚îú‚îÄ‚îÄ telegram_api.py
‚îÇ   ‚îú‚îÄ‚îÄ telegram_helper.py
‚îÇ   ‚îú‚îÄ‚îÄ update.bat
‚îÇ   ‚îú‚îÄ‚îÄ updater.py
‚îÇ   ‚îî‚îÄ‚îÄ utils.py
‚îú‚îÄ‚îÄ .env.example
‚îú‚îÄ‚îÄ 23.88.7.196_admin_session.rdp
‚îú‚îÄ‚îÄ dev_run.py
‚îú‚îÄ‚îÄ export.py
‚îú‚îÄ‚îÄ GitCommitTool.py
‚îú‚îÄ‚îÄ project_export_20251110_104446.txt
‚îú‚îÄ‚îÄ README.md
‚îú‚îÄ‚îÄ RemoteHand.spec
‚îú‚îÄ‚îÄ requirements.txt
‚îú‚îÄ‚îÄ version.txt
‚îú‚îÄ‚îÄ version_info.txt
‚îî‚îÄ‚îÄ –ê–∫—Ç–∏–≤–∞—Ü—ñ—è —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞.txt

üìÑ –í–ú–Ü–°–¢ –§–ê–ô–õ–Ü–í (21 —Ñ–∞–π–ª—ñ–≤)
================================================================================


================================================================================
–§–∞–π–ª 1/21: dev_run.py
--------------------------------------------------------------------------------
"""
DEV_RUN.PY - –õ–æ–∫–∞–ª—å–Ω–µ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è
"""

import sys
import os

# –í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ DEV —Ä–µ–∂–∏–º
os.environ['REMOTEHAND_DEV_MODE'] = '1'

# –î–æ–¥–∞—Ç–∏ src –≤ path
sys.path.insert(0, os.path.join(os.path.dirname(__file__), 'src'))

print("–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π...")
import subprocess
subprocess.run([sys.executable, "-m", "pip", "install", "-r", "requirements.txt", "-q"],
               capture_output=True)

print("üîß –ó–∞–ø—É—Å–∫ —É DEV —Ä–µ–∂–∏–º—ñ...")

# –ü—Ä—è–º–æ –∑–∞–ø—É—Å—Ç–∏—Ç–∏ main
if __name__ == "__main__":
    import main
    main.main()


================================================================================
–§–∞–π–ª 2/21: export.py
--------------------------------------------------------------------------------
#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Project Structure Exporter
–°—Ç–≤–æ—Ä—é—î –¥–µ—Ç–∞–ª—å–Ω–∏–π –æ–ø–∏—Å —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ –ø—Ä–æ—î–∫—Ç—É —Ç–∞ –≤–º—ñ—Å—Ç —Ñ–∞–π–ª—ñ–≤ —É –æ–¥–∏–Ω —Ñ–∞–π–ª
"""

import os
from pathlib import Path
from datetime import datetime

# –§–∞–π–ª–∏ —Ç–∞ –ø–∞–ø–∫–∏, —è–∫—ñ —Ç—Ä–µ–±–∞ —ñ–≥–Ω–æ—Ä—É–≤–∞—Ç–∏
IGNORE_PATTERNS = {
    # –ü–∞–ø–∫–∏
    '__pycache__', '.git', '.idea', '.vscode', 'node_modules',
    'venv', 'env', '.env', 'dist', 'build', '.pytest_cache',
    '.mypy_cache', 'htmlcov', '.coverage', 'logs', 'tmp',
    # –§–∞–π–ª–∏
    '.pyc', '.pyo', '.pyd', '.so', '.dll', '.dylib', '.exe',
    '.log', '.sqlite', '.db', '.pkl', '.pickle', '.DS_Store',
    'Thumbs.db', '.env', '.env.local', '.gitignore'
}

# –†–æ–∑—à–∏—Ä–µ–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤ –¥–ª—è —á–∏—Ç–∞–Ω–Ω—è (—Ç–µ–∫—Å—Ç–æ–≤—ñ —Ñ–∞–π–ª–∏)
TEXT_EXTENSIONS = {
    '.py', '.js', '.ts', '.jsx', '.tsx', '.html', '.css', '.scss',
    '.json', '.yaml', '.yml', '.toml', '.ini', '.cfg', '.conf',
    '.txt', '.md', '.rst', '.xml', '.sql', '.sh', '.bash',
    '.env.example', '.gitignore', 'Dockerfile', 'Makefile',
    '.java', '.c', '.cpp', '.h', '.go', '.rs', '.php', '.rb'
}

# –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∏–π —Ä–æ–∑–º—ñ—Ä —Ñ–∞–π–ª—É (1 MB)
MAX_FILE_SIZE = 1024 * 1024


def should_ignore(path: Path) -> bool:
    """–ü–µ—Ä–µ–≤—ñ—Ä—è—î, —á–∏ —Ç—Ä–µ–±–∞ —ñ–≥–Ω–æ—Ä—É–≤–∞—Ç–∏ —Ñ–∞–π–ª/–ø–∞–ø–∫—É"""
    name = path.name

    # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ç–æ—á–Ω–æ–≥–æ –∑–±—ñ–≥—É
    if name in IGNORE_PATTERNS:
        return True

    # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è
    if path.suffix in IGNORE_PATTERNS:
        return True

    # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø—Ä–∏—Ö–æ–≤–∞–Ω–∏—Ö —Ñ–∞–π–ª—ñ–≤ (–∫—Ä—ñ–º .env.example)
    if name.startswith('.') and name != '.env.example':
        return True

    return False


def is_text_file(path: Path) -> bool:
    """–ü–µ—Ä–µ–≤—ñ—Ä—è—î, —á–∏ —î —Ñ–∞–π–ª —Ç–µ–∫—Å—Ç–æ–≤–∏–º"""
    # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è
    if path.suffix.lower() in TEXT_EXTENSIONS:
        return True

    # –§–∞–π–ª–∏ –±–µ–∑ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è, —è–∫—ñ –∑–∞–∑–≤–∏—á–∞–π —Ç–µ–∫—Å—Ç–æ–≤—ñ
    if path.suffix == '' and path.name in {'Dockerfile', 'Makefile', 'README', 'LICENSE'}:
        return True

    return False


def get_tree_structure(root_path: Path, prefix: str = "", is_last: bool = True) -> list:
    """–ì–µ–Ω–µ—Ä—É—î –¥–µ—Ä–µ–≤–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ –ø—Ä–æ—î–∫—Ç—É"""
    lines = []

    try:
        items = sorted(root_path.iterdir(), key=lambda x: (not x.is_dir(), x.name.lower()))
        items = [item for item in items if not should_ignore(item)]

        for i, item in enumerate(items):
            is_last_item = i == len(items) - 1
            current_prefix = "‚îî‚îÄ‚îÄ " if is_last_item else "‚îú‚îÄ‚îÄ "
            lines.append(f"{prefix}{current_prefix}{item.name}{'/' if item.is_dir() else ''}")

            if item.is_dir():
                extension = "    " if is_last_item else "‚îÇ   "
                lines.extend(get_tree_structure(item, prefix + extension, is_last_item))

    except PermissionError:
        pass

    return lines


def read_file_content(file_path: Path) -> str:
    """–ß–∏—Ç–∞—î –≤–º—ñ—Å—Ç —Ñ–∞–π–ª—É"""
    try:
        # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ä–æ–∑–º—ñ—Ä—É
        if file_path.stat().st_size > MAX_FILE_SIZE:
            return f"[–§–∞–π–ª –∑–∞–Ω–∞–¥—Ç–æ –≤–µ–ª–∏–∫–∏–π: {file_path.stat().st_size / 1024:.1f} KB]"

        # –°–ø—Ä–æ–±–∞ –ø—Ä–æ—á–∏—Ç–∞—Ç–∏ —è–∫ —Ç–µ–∫—Å—Ç
        with open(file_path, 'r', encoding='utf-8') as f:
            return f.read()
    except UnicodeDecodeError:
        # –Ø–∫—â–æ –Ω–µ –≤–¥–∞–ª–æ—Å—è –ø—Ä–æ—á–∏—Ç–∞—Ç–∏ —è–∫ UTF-8
        try:
            with open(file_path, 'r', encoding='cp1251') as f:
                return f.read()
        except:
            return "[–ù–µ –≤–¥–∞–ª–æ—Å—è –ø—Ä–æ—á–∏—Ç–∞—Ç–∏ —Ñ–∞–π–ª - –±—ñ–Ω–∞—Ä–Ω–∏–π –∞–±–æ –Ω–µ–≤—ñ–¥–æ–º–µ –∫–æ–¥—É–≤–∞–Ω–Ω—è]"
    except Exception as e:
        return f"[–ü–æ–º–∏–ª–∫–∞ —á–∏—Ç–∞–Ω–Ω—è: {str(e)}]"


def collect_files(root_path: Path) -> list:
    """–ó–±–∏—Ä–∞—î –≤—Å—ñ —Ç–µ–∫—Å—Ç–æ–≤—ñ —Ñ–∞–π–ª–∏ –ø—Ä–æ—î–∫—Ç—É"""
    files = []

    for item in root_path.rglob('*'):
        if item.is_file() and not should_ignore(item) and is_text_file(item):
            # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞, —â–æ –≤—Å—ñ –±–∞—Ç—å–∫—ñ–≤—Å—å–∫—ñ –ø–∞–ø–∫–∏ –Ω–µ —ñ–≥–Ω–æ—Ä—É—é—Ç—å—Å—è
            if not any(should_ignore(parent) for parent in item.parents):
                files.append(item)

    return sorted(files)


def generate_project_export(project_path: str, output_file: str = None):
    """–ì–µ–Ω–µ—Ä—É—î –ø–æ–≤–Ω–∏–π –µ–∫—Å–ø–æ—Ä—Ç –ø—Ä–æ—î–∫—Ç—É"""
    root = Path(project_path).resolve()

    if not root.exists():
        print(f"‚ùå –ü–æ–º–∏–ª–∫–∞: –®–ª—è—Ö '{project_path}' –Ω–µ —ñ—Å–Ω—É—î!")
        return

    if output_file is None:
        timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
        output_file = f"project_export_{timestamp}.txt"

    print(f"üìÅ –ê–Ω–∞–ª—ñ–∑ –ø—Ä–æ—î–∫—Ç—É: {root.name}")
    print(f"üìù –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –µ–∫—Å–ø–æ—Ä—Ç—É...")

    with open(output_file, 'w', encoding='utf-8') as f:
        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        f.write("=" * 80 + "\n")
        f.write(f"–ï–ö–°–ü–û–†–¢ –ü–†–û–Ñ–ö–¢–£: {root.name}\n")
        f.write(f"–î–∞—Ç–∞: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}\n")
        f.write(f"–®–ª—è—Ö: {root}\n")
        f.write("=" * 80 + "\n\n")

        # –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ—î–∫—Ç—É
        f.write("üìÇ –°–¢–†–£–ö–¢–£–†–ê –ü–†–û–Ñ–ö–¢–£\n")
        f.write("-" * 80 + "\n")
        f.write(f"{root.name}/\n")
        tree_lines = get_tree_structure(root)
        f.write("\n".join(tree_lines))
        f.write("\n\n")

        # –ó–±—ñ—Ä —Ñ–∞–π–ª—ñ–≤
        files = collect_files(root)

        f.write(f"üìÑ –í–ú–Ü–°–¢ –§–ê–ô–õ–Ü–í ({len(files)} —Ñ–∞–π–ª—ñ–≤)\n")
        f.write("=" * 80 + "\n\n")

        # –í–º—ñ—Å—Ç –∫–æ–∂–Ω–æ–≥–æ —Ñ–∞–π–ª—É
        for i, file_path in enumerate(files, 1):
            relative_path = file_path.relative_to(root)

            print(f"  [{i}/{len(files)}] {relative_path}")

            f.write("\n" + "=" * 80 + "\n")
            f.write(f"–§–∞–π–ª {i}/{len(files)}: {relative_path}\n")
            f.write("-" * 80 + "\n")

            content = read_file_content(file_path)
            f.write(content)
            f.write("\n")

        # –ü—ñ–¥—Å—É–º–æ–∫
        f.write("\n" + "=" * 80 + "\n")
        f.write("–ö–Ü–ù–ï–¶–¨ –ï–ö–°–ü–û–†–¢–£\n")
        f.write("=" * 80 + "\n")

    file_size = Path(output_file).stat().st_size
    print(f"\n‚úÖ –ï–∫—Å–ø–æ—Ä—Ç –∑–∞–≤–µ—Ä—à–µ–Ω–æ!")
    print(f"üìÑ –§–∞–π–ª: {output_file}")
    print(f"üìä –†–æ–∑–º—ñ—Ä: {file_size / 1024:.1f} KB")
    print(f"üìÅ –§–∞–π–ª—ñ–≤ –æ–±—Ä–æ–±–ª–µ–Ω–æ: {len(files)}")


if __name__ == "__main__":
    import sys

    # –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è: python export_project.py [—à–ª—è—Ö_–¥–æ_–ø—Ä–æ—î–∫—Ç—É] [–≤–∏—Ö—ñ–¥–Ω–∏–π_—Ñ–∞–π–ª]
    project_path = sys.argv[1] if len(sys.argv) > 1 else "."
    output_file = sys.argv[2] if len(sys.argv) > 2 else None

    generate_project_export(project_path, output_file)


================================================================================
–§–∞–π–ª 3/21: GitCommitTool.py
--------------------------------------------------------------------------------
import customtkinter as ctk
from tkinter import messagebox, scrolledtext
import subprocess
import os
from pathlib import Path
from datetime import datetime


class GitCommitTool(ctk.CTk):
    def __init__(self):
        super().__init__()

        self.title("Git Commit Tool")
        self.geometry("600x700")
        self.resizable(False, False)

        # –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç–µ–º–∏
        ctk.set_appearance_mode("light")
        ctk.set_default_color_theme("blue")

        # –û—Ç—Ä–∏–º–∞–Ω–Ω—è –ø–æ—Ç–æ—á–Ω–æ—ó –≤–µ—Ä—Å—ñ—ó
        self.current_version = self.get_current_version()

        self.setup_ui()

    def setup_ui(self):
        """–°—Ç–≤–æ—Ä–µ–Ω–Ω—è UI"""

        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        title_label = ctk.CTkLabel(
            self,
            text="Git Commit Tool",
            font=ctk.CTkFont(size=24, weight="bold")
        )
        title_label.pack(pady=15)

        # –ü–æ—Ç–æ—á–Ω–∞ –≤–µ—Ä—Å—ñ—è
        version_frame = ctk.CTkFrame(self)
        version_frame.pack(pady=10, padx=20, fill="x")

        ctk.CTkLabel(
            version_frame,
            text="–ü–æ—Ç–æ—á–Ω–∞ –≤–µ—Ä—Å—ñ—è:",
            font=ctk.CTkFont(size=12, weight="bold")
        ).pack(side="left")

        ctk.CTkLabel(
            version_frame,
            text=f"v{self.current_version}",
            font=ctk.CTkFont(size=12),
            text_color="gray"
        ).pack(side="left", padx=10)

        # –ö–æ–º–µ–Ω—Ç–∞—Ä
        ctk.CTkLabel(
            self,
            text="–ö–æ–º–µ–Ω—Ç–∞—Ä (commit message):",
            font=ctk.CTkFont(size=12, weight="bold")
        ).pack(anchor="w", padx=20, pady=(10, 5))

        self.comment_entry = ctk.CTkEntry(
            self,
            placeholder_text="–û–ø–∏—à—ñ—Ç—å –≤–∞—à—ñ –∑–º—ñ–Ω–∏...",
            height=40,
            font=ctk.CTkFont(size=11)
        )
        self.comment_entry.pack(padx=20, fill="x", pady=(0, 15))

        # –ù–æ–≤–∞ –≤–µ—Ä—Å—ñ—è
        ctk.CTkLabel(
            self,
            text="–ù–æ–≤–∞ –≤–µ—Ä—Å—ñ—è (–¥–ª—è —Ç–∞–≥—É):",
            font=ctk.CTkFont(size=12, weight="bold")
        ).pack(anchor="w", padx=20, pady=(10, 5))

        version_frame2 = ctk.CTkFrame(self)
        version_frame2.pack(padx=20, fill="x", pady=(0, 15))

        ctk.CTkLabel(
            version_frame2,
            text="v",
            font=ctk.CTkFont(size=11)
        ).pack(side="left", padx=(0, 5))

        self.version_entry = ctk.CTkEntry(
            version_frame2,
            placeholder_text="1.1.0",
            height=35,
            font=ctk.CTkFont(size=11)
        )
        self.version_entry.pack(side="left", fill="x", expand=True)

        # –ß–µ–∫–±–æ–∫—Å –¥–ª—è —Ç–∞–≥—É
        self.tag_checkbox = ctk.CTkCheckBox(
            self,
            text="–°—Ç–≤–æ—Ä–∏—Ç–∏ —Ç–µ–≥ –≤–µ—Ä—Å—ñ—ó",
            font=ctk.CTkFont(size=11)
        )
        self.tag_checkbox.pack(anchor="w", padx=20, pady=(0, 20))
        self.tag_checkbox.select()

        # –ö–Ω–æ–ø–∫–∏
        button_frame = ctk.CTkFrame(self)
        button_frame.pack(padx=20, fill="x", pady=(0, 15))

        commit_btn = ctk.CTkButton(
            button_frame,
            text="‚úÖ Commit & Push",
            command=self.commit_and_push,
            font=ctk.CTkFont(size=12, weight="bold"),
            height=45,
            corner_radius=10
        )
        commit_btn.pack(side="left", fill="both", expand=True, padx=(0, 5))

        clear_btn = ctk.CTkButton(
            button_frame,
            text="üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç–∏",
            command=self.clear_fields,
            font=ctk.CTkFont(size=12),
            height=45,
            corner_radius=10,
            fg_color="gray30",
            hover_color="gray50"
        )
        clear_btn.pack(side="left", fill="both", expand=True, padx=(5, 0))

        # –õ–æ–≥–∏
        ctk.CTkLabel(
            self,
            text="–õ–æ–≥–∏ –æ–ø–µ—Ä–∞—Ü—ñ–π:",
            font=ctk.CTkFont(size=11, weight="bold")
        ).pack(anchor="w", padx=20, pady=(10, 5))

        self.log_text = scrolledtext.ScrolledText(
            self,
            height=10,
            width=70,
            font=("Courier", 9),
            bg="#f0f0f0",
            fg="#333333",
            relief="solid",
            borderwidth=1
        )
        self.log_text.pack(padx=20, pady=(0, 15), fill="both", expand=True)

        # –°—Ç–∞—Ç—É—Å
        self.status_label = ctk.CTkLabel(
            self,
            text="–ì–æ—Ç–æ–≤–æ –¥–æ —Ä–æ–±–æ—Ç–∏",
            font=ctk.CTkFont(size=10),
            text_color="gray"
        )
        self.status_label.pack(pady=(0, 10))

    def get_current_version(self):
        """–û—Ç—Ä–∏–º–∞–Ω–Ω—è –ø–æ—Ç–æ—á–Ω–æ—ó –≤–µ—Ä—Å—ñ—ó –∑ version.txt"""
        try:
            with open("version.txt", "r") as f:
                return f.read().strip()
        except:
            return "1.0.0"

    def log_message(self, message):
        """–î–æ–¥–∞–Ω–Ω—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –¥–æ –ª–æ–≥—ñ–≤"""
        timestamp = datetime.now().strftime("%H:%M:%S")
        self.log_text.insert("end", f"[{timestamp}] {message}\n")
        self.log_text.see("end")
        self.update()

    def run_git_command(self, command):
        """–í–∏–∫–æ–Ω–∞–Ω–Ω—è git –∫–æ–º–∞–Ω–¥–∏"""
        try:
            result = subprocess.run(
                command,
                shell=True,
                capture_output=True,
                text=True,
                cwd=os.getcwd()
            )

            if result.returncode == 0:
                if result.stdout:
                    self.log_message(f"‚úÖ {result.stdout.strip()}")
                return True
            else:
                error_msg = result.stderr.strip() if result.stderr else "–ù–µ–≤—ñ–¥–æ–º–∞ –ø–æ–º–∏–ª–∫–∞"
                self.log_message(f"‚ùå –ü–æ–º–∏–ª–∫–∞: {error_msg}")
                return False
        except Exception as e:
            self.log_message(f"‚ùå –ò—Å–∫–ª—é—á–µ–Ω–∏–µ: {str(e)}")
            return False

    def commit_and_push(self):
        """–û—Å–Ω–æ–≤–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è - commit, tag —ñ push"""

        comment = self.comment_entry.get().strip()
        new_version = self.version_entry.get().strip()
        create_tag = self.tag_checkbox.get()

        # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∏
        if not comment:
            messagebox.showwarning("–ü–æ–º–∏–ª–∫–∞", "–ù–∞–ø–∏—à—ñ—Ç—å –∫–æ–º–µ–Ω—Ç–∞—Ä –¥–æ –∫–æ–º—ñ—Ç—é!")
            return

        if create_tag and not new_version:
            messagebox.showwarning("–ü–æ–º–∏–ª–∫–∞", "–ù–∞–ø–∏—à—ñ—Ç—å –Ω–æ–≤—É –≤–µ—Ä—Å—ñ—é –¥–ª—è —Ç–∞–≥—É!")
            return

        self.status_label.configure(text="‚è≥ –û–±—Ä–æ–±–∫–∞...")
        self.update()

        self.log_message("=" * 50)
        self.log_message("üöÄ –†–æ–∑–ø–æ—á–∏–Ω–∞—î–º–æ commit & push –ø—Ä–æ—Ü–µ—Å...")
        self.log_message("=" * 50)

        # –ö—Ä–æ–∫ 1: –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å—É
        self.log_message("\nüìã –ö—Ä–æ–∫ 1: –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å—É —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—é...")
        self.run_git_command("git status --short")

        # –ö—Ä–æ–∫ 2: –î–æ–±–∞–≤–ª–µ–Ω–Ω—è –≤—Å—ñ—Ö —Ñ–∞–π–ª—ñ–≤
        self.log_message("\nüì¶ –ö—Ä–æ–∫ 2: –î–æ–¥–∞–≤–∞–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤...")
        if not self.run_git_command("git add ."):
            self.status_label.configure(text="‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –¥–æ–¥–∞–≤–∞–Ω–Ω—ñ —Ñ–∞–π–ª—ñ–≤")
            messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–ù–µ –≤–¥–∞–ª–æ—Å—è –¥–æ–¥–∞—Ç–∏ —Ñ–∞–π–ª–∏!")
            return

        # –ö—Ä–æ–∫ 3: –ö–æ–º—ñ—Ç
        self.log_message("\nüíæ –ö—Ä–æ–∫ 3: –ö–æ–º—ñ—Ç—É–≤–∞–Ω–Ω—è –∑–º—ñ–Ω...")
        if not self.run_git_command(f'git commit -m "{comment}"'):
            self.status_label.configure(text="‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –∫–æ–º—ñ—Ç—É–≤–∞–Ω–Ω—ñ")
            messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–ù–µ –≤–¥–∞–ª–æ—Å—è –∑–∞–∫–æ–º—ñ—Ç–∏—Ç–∏!")
            return

        # –ö—Ä–æ–∫ 4: Push
        self.log_message("\n‚¨ÜÔ∏è  –ö—Ä–æ–∫ 4: –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –Ω–∞ GitHub...")
        if not self.run_git_command("git push origin main"):
            self.status_label.configure(text="‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ push")
            messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–ù–µ –≤–¥–∞–ª–æ—Å—è –≤—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ –Ω–∞ GitHub!")
            return

        # –ö—Ä–æ–∫ 5: –¢–µ–≥ (—è–∫—â–æ –ø–æ—Ç—Ä—ñ–±–µ–Ω)
        if create_tag:
            self.log_message("\nüè∑Ô∏è  –ö—Ä–æ–∫ 5: –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–∞–≥—É...")
            if not self.run_git_command(f"git tag v{new_version}"):
                self.status_label.configure(text="‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—ñ —Ç–∞–≥—É")
                messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–ù–µ –≤–¥–∞–ª–æ—Å—è —Å—Ç–≤–æ—Ä–∏—Ç–∏ —Ç–µ–≥!")
                return

            self.log_message("\n‚¨ÜÔ∏è  –ö—Ä–æ–∫ 6: –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ç–∞–≥—É –Ω–∞ GitHub...")
            if not self.run_git_command(f"git push origin v{new_version}"):
                self.status_label.configure(text="‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ push —Ç–∞–≥—É")
                messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–ù–µ –≤–¥–∞–ª–æ—Å—è –≤—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ —Ç–µ–≥!")
                return

            # –û–Ω–æ–≤–ª–µ–Ω–Ω—è version.txt
            self.log_message("\nüìù –ö—Ä–æ–∫ 7: –û–Ω–æ–≤–ª–µ–Ω–Ω—è version.txt...")
            try:
                with open("version.txt", "w") as f:
                    f.write(new_version)
                self.log_message("‚úÖ version.txt –æ–Ω–æ–≤–ª–µ–Ω–æ")
                self.current_version = new_version
            except Exception as e:
                self.log_message(f"‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –æ–Ω–æ–≤–ª–µ–Ω–Ω—ñ version.txt: {str(e)}")

        self.log_message("\n" + "=" * 50)
        self.log_message("‚úÖ –í–°–ï –£–°–ü–Ü–®–ù–û! GitHub Actions –ø–æ—á–Ω–µ –∫–æ–º–ø—ñ–ª—é–≤–∞—Ç–∏...")
        self.log_message("=" * 50)

        self.status_label.configure(text="‚úÖ –£—Å–ø—ñ—à–Ω–æ! GitHub Actions –∑–∞–ø—É—â–µ–Ω–æ")
        messagebox.showinfo(
            "–£—Å–ø—ñ—Ö",
            f"‚úÖ –ö–æ–º—ñ—Ç —É—Å–ø—ñ—à–Ω–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ!\n\n"
            f"–ö–æ–º–µ–Ω—Ç–∞—Ä: {comment}\n"
            + (f"–í–µ—Ä—Å—ñ—è: v{new_version}\n\nGitHub Actions –ø–æ—á–Ω–µ –∫–æ–º–ø—ñ–ª—é–≤–∞—Ç–∏ EXE..." if create_tag else "")
        )

        self.clear_fields()

    def clear_fields(self):
        """–û—á–∏—Å—Ç–∫–∞ –ø–æ–ª—ñ–≤"""
        self.comment_entry.delete(0, "end")
        self.version_entry.delete(0, "end")
        self.tag_checkbox.select()
        self.status_label.configure(text="–ì–æ—Ç–æ–≤–æ –¥–æ —Ä–æ–±–æ—Ç–∏")


def main():
    app = GitCommitTool()
    app.mainloop()


if __name__ == "__main__":
    main()


================================================================================
–§–∞–π–ª 4/21: project_export_20251110_104446.txt
--------------------------------------------------------------------------------
================================================================================
–ï–ö–°–ü–û–†–¢ –ü–†–û–Ñ–ö–¢–£: RemoteHand
–î–∞—Ç–∞: 2025-11-10 10:44:46
–®–ª—è—Ö: D:\Python Projects\Prego\RemoteHand
================================================================================

üìÇ –°–¢–†–£–ö–¢–£–†–ê –ü–†–û–Ñ–ö–¢–£
--------------------------------------------------------------------------------
RemoteHand/
‚îú‚îÄ‚îÄ assets/
‚îÇ   ‚îî‚îÄ‚îÄ icon.ico
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ anydesk_manager.py
‚îÇ   ‚îú‚îÄ‚îÄ config.py
‚îÇ   ‚îú‚îÄ‚îÄ config_manager.py
‚îÇ   ‚îú‚îÄ‚îÄ main.py
‚îÇ   ‚îú‚îÄ‚îÄ network_test.py
‚îÇ   ‚îú‚îÄ‚îÄ rdp_manager.py
‚îÇ   ‚îú‚îÄ‚îÄ set_anydesk_password.py
‚îÇ   ‚îú‚îÄ‚îÄ setup_wizard.py
‚îÇ   ‚îú‚îÄ‚îÄ telegram_api.py
‚îÇ   ‚îú‚îÄ‚îÄ telegram_helper.py
‚îÇ   ‚îú‚îÄ‚îÄ update.bat
‚îÇ   ‚îú‚îÄ‚îÄ updater.py
‚îÇ   ‚îî‚îÄ‚îÄ utils.py
‚îú‚îÄ‚îÄ .env.example
‚îú‚îÄ‚îÄ 23.88.7.196_admin_session.rdp
‚îú‚îÄ‚îÄ dev_run.py
‚îú‚îÄ‚îÄ export.py
‚îú‚îÄ‚îÄ GitCommitTool.py
‚îú‚îÄ‚îÄ project_export_20251110_104446.txt
‚îú‚îÄ‚îÄ README.md
‚îú‚îÄ‚îÄ RemoteHand.spec
‚îú‚îÄ‚îÄ requirements.txt
‚îú‚îÄ‚îÄ version.txt
‚îú‚îÄ‚îÄ version_info.txt
‚îî‚îÄ‚îÄ –ê–∫—Ç–∏–≤–∞—Ü—ñ—è —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞.txt

üìÑ –í–ú–Ü–°–¢ –§–ê–ô–õ–Ü–í (21 —Ñ–∞–π–ª—ñ–≤)
================================================================================


================================================================================
–§–∞–π–ª 1/21: dev_run.py
--------------------------------------------------------------------------------
"""
DEV_RUN.PY - –õ–æ–∫–∞–ª—å–Ω–µ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è
"""

import sys
import os

# –í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ DEV —Ä–µ–∂–∏–º
os.environ['REMOTEHAND_DEV_MODE'] = '1'

# –î–æ–¥–∞—Ç–∏ src –≤ path
sys.path.insert(0, os.path.join(os.path.dirname(__file__), 'src'))

print("–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π...")
import subprocess
subprocess.run([sys.executable, "-m", "pip", "install", "-r", "requirements.txt", "-q"],
               capture_output=True)

print("üîß –ó–∞–ø—É—Å–∫ —É DEV —Ä–µ–∂–∏–º—ñ...")

# –ü—Ä—è–º–æ –∑–∞–ø—É—Å—Ç–∏—Ç–∏ main
if __name__ == "__main__":
    import main
    main.main()


================================================================================
–§–∞–π–ª 2/21: export.py
--------------------------------------------------------------------------------
#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Project Structure Exporter
–°—Ç–≤–æ—Ä—é—î –¥–µ—Ç–∞–ª—å–Ω–∏–π –æ–ø–∏—Å —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ –ø—Ä–æ—î–∫—Ç—É —Ç–∞ –≤–º—ñ—Å—Ç —Ñ–∞–π–ª—ñ–≤ —É –æ–¥–∏–Ω —Ñ–∞–π–ª
"""

import os
from pathlib import Path
from datetime import datetime

# –§–∞–π–ª–∏ —Ç–∞ –ø–∞–ø–∫–∏, —è–∫—ñ —Ç—Ä–µ–±–∞ —ñ–≥–Ω–æ—Ä—É–≤–∞—Ç–∏
IGNORE_PATTERNS = {
    # –ü–∞–ø–∫–∏
    '__pycache__', '.git', '.idea', '.vscode', 'node_modules',
    'venv', 'env', '.env', 'dist', 'build', '.pytest_cache',
    '.mypy_cache', 'htmlcov', '.coverage', 'logs', 'tmp',
    # –§–∞–π–ª–∏
    '.pyc', '.pyo', '.pyd', '.so', '.dll', '.dylib', '.exe',
    '.log', '.sqlite', '.db', '.pkl', '.pickle', '.DS_Store',
    'Thumbs.db', '.env', '.env.local', '.gitignore'
}

# –†–æ–∑—à–∏—Ä–µ–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤ –¥–ª—è —á–∏—Ç–∞–Ω–Ω—è (—Ç–µ–∫—Å—Ç–æ–≤—ñ —Ñ–∞–π–ª–∏)
TEXT_EXTENSIONS = {
    '.py', '.js', '.ts', '.jsx', '.tsx', '.html', '.css', '.scss',
    '.json', '.yaml', '.yml', '.toml', '.ini', '.cfg', '.conf',
    '.txt', '.md', '.rst', '.xml', '.sql', '.sh', '.bash',
    '.env.example', '.gitignore', 'Dockerfile', 'Makefile',
    '.java', '.c', '.cpp', '.h', '.go', '.rs', '.php', '.rb'
}

# –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∏–π —Ä–æ–∑–º—ñ—Ä —Ñ–∞–π–ª—É (1 MB)
MAX_FILE_SIZE = 1024 * 1024


def should_ignore(path: Path) -> bool:
    """–ü–µ—Ä–µ–≤—ñ—Ä—è—î, —á–∏ —Ç—Ä–µ–±–∞ —ñ–≥–Ω–æ—Ä—É–≤–∞—Ç–∏ —Ñ–∞–π–ª/–ø–∞–ø–∫—É"""
    name = path.name

    # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ç–æ—á–Ω–æ–≥–æ –∑–±—ñ–≥—É
    if name in IGNORE_PATTERNS:
        return True

    # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è
    if path.suffix in IGNORE_PATTERNS:
        return True

    # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø—Ä–∏—Ö–æ–≤–∞–Ω–∏—Ö —Ñ–∞–π–ª—ñ–≤ (–∫—Ä—ñ–º .env.example)
    if name.startswith('.') and name != '.env.example':
        return True

    return False


def is_text_file(path: Path) -> bool:
    """–ü–µ—Ä–µ–≤—ñ—Ä—è—î, —á–∏ —î —Ñ–∞–π–ª —Ç–µ–∫—Å—Ç–æ–≤–∏–º"""
    # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è
    if path.suffix.lower() in TEXT_EXTENSIONS:
        return True

    # –§–∞–π–ª–∏ –±–µ–∑ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è, —è–∫—ñ –∑–∞–∑–≤–∏—á–∞–π —Ç–µ–∫—Å—Ç–æ–≤—ñ
    if path.suffix == '' and path.name in {'Dockerfile', 'Makefile', 'README', 'LICENSE'}:
        return True

    return False


def get_tree_structure(root_path: Path, prefix: str = "", is_last: bool = True) -> list:
    """–ì–µ–Ω–µ—Ä—É—î –¥–µ—Ä–µ–≤–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ –ø—Ä–æ—î–∫—Ç—É"""
    lines = []

    try:
        items = sorted(root_path.iterdir(), key=lambda x: (not x.is_dir(), x.name.lower()))
        items = [item for item in items if not should_ignore(item)]

        for i, item in enumerate(items):
            is_last_item = i == len(items) - 1
            current_prefix = "‚îî‚îÄ‚îÄ " if is_last_item else "‚îú‚îÄ‚îÄ "
            lines.append(f"{prefix}{current_prefix}{item.name}{'/' if item.is_dir() else ''}")

            if item.is_dir():
                extension = "    " if is_last_item else "‚îÇ   "
                lines.extend(get_tree_structure(item, prefix + extension, is_last_item))

    except PermissionError:
        pass

    return lines


def read_file_content(file_path: Path) -> str:
    """–ß–∏—Ç–∞—î –≤–º—ñ—Å—Ç —Ñ–∞–π–ª—É"""
    try:
        # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ä–æ–∑–º—ñ—Ä—É
        if file_path.stat().st_size > MAX_FILE_SIZE:
            return f"[–§–∞–π–ª –∑–∞–Ω–∞–¥—Ç–æ –≤–µ–ª–∏–∫–∏–π: {file_path.stat().st_size / 1024:.1f} KB]"

        # –°–ø—Ä–æ–±–∞ –ø—Ä–æ—á–∏—Ç–∞—Ç–∏ —è–∫ —Ç–µ–∫—Å—Ç
        with open(file_path, 'r', encoding='utf-8') as f:
            return f.read()
    except UnicodeDecodeError:
        # –Ø–∫—â–æ –Ω–µ –≤–¥–∞–ª–æ—Å—è –ø—Ä–æ—á–∏—Ç–∞—Ç–∏ —è–∫ UTF-8
        try:
            with open(file_path, 'r', encoding='cp1251') as f:
                return f.read()
        except:
            return "[–ù–µ –≤–¥–∞–ª–æ—Å—è –ø—Ä–æ—á–∏—Ç–∞—Ç–∏ —Ñ–∞–π–ª - –±—ñ–Ω–∞—Ä–Ω–∏–π –∞–±–æ –Ω–µ–≤—ñ–¥–æ–º–µ –∫–æ–¥—É–≤–∞–Ω–Ω—è]"
    except Exception as e:
        return f"[–ü–æ–º–∏–ª–∫–∞ —á–∏—Ç–∞–Ω–Ω—è: {str(e)}]"


def collect_files(root_path: Path) -> list:
    """–ó–±–∏—Ä–∞—î –≤—Å—ñ —Ç–µ–∫—Å—Ç–æ–≤—ñ —Ñ–∞–π–ª–∏ –ø—Ä–æ—î–∫—Ç—É"""
    files = []

    for item in root_path.rglob('*'):
        if item.is_file() and not should_ignore(item) and is_text_file(item):
            # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞, —â–æ –≤—Å—ñ –±–∞—Ç—å–∫—ñ–≤—Å—å–∫—ñ –ø–∞–ø–∫–∏ –Ω–µ —ñ–≥–Ω–æ—Ä—É—é—Ç—å—Å—è
            if not any(should_ignore(parent) for parent in item.parents):
                files.append(item)

    return sorted(files)


def generate_project_export(project_path: str, output_file: str = None):
    """–ì–µ–Ω–µ—Ä—É—î –ø–æ–≤–Ω–∏–π –µ–∫—Å–ø–æ—Ä—Ç –ø—Ä–æ—î–∫—Ç—É"""
    root = Path(project_path).resolve()

    if not root.exists():
        print(f"‚ùå –ü–æ–º–∏–ª–∫–∞: –®–ª—è—Ö '{project_path}' –Ω–µ —ñ—Å–Ω—É—î!")
        return

    if output_file is None:
        timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
        output_file = f"project_export_{timestamp}.txt"

    print(f"üìÅ –ê–Ω–∞–ª—ñ–∑ –ø—Ä–æ—î–∫—Ç—É: {root.name}")
    print(f"üìù –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –µ–∫—Å–ø–æ—Ä—Ç—É...")

    with open(output_file, 'w', encoding='utf-8') as f:
        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        f.write("=" * 80 + "\n")
        f.write(f"–ï–ö–°–ü–û–†–¢ –ü–†–û–Ñ–ö–¢–£: {root.name}\n")
        f.write(f"–î–∞—Ç–∞: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}\n")
        f.write(f"–®–ª—è—Ö: {root}\n")
        f.write("=" * 80 + "\n\n")

        # –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ—î–∫—Ç—É
        f.write("üìÇ –°–¢–†–£–ö–¢–£–†–ê –ü–†–û–Ñ–ö–¢–£\n")
        f.write("-" * 80 + "\n")
        f.write(f"{root.name}/\n")
        tree_lines = get_tree_structure(root)
        f.write("\n".join(tree_lines))
        f.write("\n\n")

        # –ó–±—ñ—Ä —Ñ–∞–π–ª—ñ–≤
        files = collect_files(root)

        f.write(f"üìÑ –í–ú–Ü–°–¢ –§–ê–ô–õ–Ü–í ({len(files)} —Ñ–∞–π–ª—ñ–≤)\n")
        f.write("=" * 80 + "\n\n")

        # –í–º—ñ—Å—Ç –∫–æ–∂–Ω–æ–≥–æ —Ñ–∞–π–ª—É
        for i, file_path in enumerate(files, 1):
            relative_path = file_path.relative_to(root)

            print(f"  [{i}/{len(files)}] {relative_path}")

            f.write("\n" + "=" * 80 + "\n")
            f.write(f"–§–∞–π–ª {i}/{len(files)}: {relative_path}\n")
            f.write("-" * 80 + "\n")

            content = read_file_content(file_path)
            f.write(content)
            f.write("\n")

        # –ü—ñ–¥—Å—É–º–æ–∫
        f.write("\n" + "=" * 80 + "\n")
        f.write("–ö–Ü–ù–ï–¶–¨ –ï–ö–°–ü–û–†–¢–£\n")
        f.write("=" * 80 + "\n")

    file_size = Path(output_file).stat().st_size
    print(f"\n‚úÖ –ï–∫—Å–ø–æ—Ä—Ç –∑–∞–≤–µ—Ä—à–µ–Ω–æ!")
    print(f"üìÑ –§–∞–π–ª: {output_file}")
    print(f"üìä –†–æ–∑–º—ñ—Ä: {file_size / 1024:.1f} KB")
    print(f"üìÅ –§–∞–π–ª—ñ–≤ –æ–±—Ä–æ–±–ª–µ–Ω–æ: {len(files)}")


if __name__ == "__main__":
    import sys

    # –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è: python export_project.py [—à–ª—è—Ö_–¥–æ_–ø—Ä–æ—î–∫—Ç—É] [–≤–∏—Ö—ñ–¥–Ω–∏–π_—Ñ–∞–π–ª]
    project_path = sys.argv[1] if len(sys.argv) > 1 else "."
    output_file = sys.argv[2] if len(sys.argv) > 2 else None

    generate_project_export(project_path, output_file)


================================================================================
–§–∞–π–ª 3/21: GitCommitTool.py
--------------------------------------------------------------------------------
import customtkinter as ctk
from tkinter import messagebox, scrolledtext
import subprocess
import os
from pathlib import Path
from datetime import datetime


class GitCommitTool(ctk.CTk):
    def __init__(self):
        super().__init__()

        self.title("Git Commit Tool")
        self.geometry("600x700")
        self.resizable(False, False)

        # –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç–µ–º–∏
        ctk.set_appearance_mode("light")
        ctk.set_default_color_theme("blue")

        # –û—Ç—Ä–∏–º–∞–Ω–Ω—è –ø–æ—Ç–æ—á–Ω–æ—ó –≤–µ—Ä—Å—ñ—ó
        self.current_version = self.get_current_version()

        self.setup_ui()

    def setup_ui(self):
        """–°—Ç–≤–æ—Ä–µ–Ω–Ω—è UI"""

        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        title_label = ctk.CTkLabel(
            self,
            text="Git Commit Tool",
            font=ctk.CTkFont(size=24, weight="bold")
        )
        title_label.pack(pady=15)

        # –ü–æ—Ç–æ—á–Ω–∞ –≤–µ—Ä—Å—ñ—è
        version_frame = ctk.CTkFrame(self)
        version_frame.pack(pady=10, padx=20, fill="x")

        ctk.CTkLabel(
            version_frame,
            text="–ü–æ—Ç–æ—á–Ω–∞ –≤–µ—Ä—Å—ñ—è:",
            font=ctk.CTkFont(size=12, weight="bold")
        ).pack(side="left")

        ctk.CTkLabel(
            version_frame,
            text=f"v{self.current_version}",
            font=ctk.CTkFont(size=12),
            text_color="gray"
        ).pack(side="left", padx=10)

        # –ö–æ–º–µ–Ω—Ç–∞—Ä
        ctk.CTkLabel(
            self,
            text="–ö–æ–º–µ–Ω—Ç–∞—Ä (commit message):",
            font=ctk.CTkFont(size=12, weight="bold")
        ).pack(anchor="w", padx=20, pady=(10, 5))

        self.comment_entry = ctk.CTkEntry(
            self,
            placeholder_text="–û–ø–∏—à—ñ—Ç—å –≤–∞—à—ñ –∑–º—ñ–Ω–∏...",
            height=40,
            font=ctk.CTkFont(size=11)
        )
        self.comment_entry.pack(padx=20, fill="x", pady=(0, 15))

        # –ù–æ–≤–∞ –≤–µ—Ä—Å—ñ—è
        ctk.CTkLabel(
            self,
            text="–ù–æ–≤–∞ –≤–µ—Ä—Å—ñ—è (–¥–ª—è —Ç–∞–≥—É):",
            font=ctk.CTkFont(size=12, weight="bold")
        ).pack(anchor="w", padx=20, pady=(10, 5))

        version_frame2 = ctk.CTkFrame(self)
        version_frame2.pack(padx=20, fill="x", pady=(0, 15))

        ctk.CTkLabel(
            version_frame2,
            text="v",
            font=ctk.CTkFont(size=11)
        ).pack(side="left", padx=(0, 5))

        self.version_entry = ctk.CTkEntry(
            version_frame2,
            placeholder_text="1.1.0",
            height=35,
            font=ctk.CTkFont(size=11)
        )
        self.version_entry.pack(side="left", fill="x", expand=True)

        # –ß–µ–∫–±–æ–∫—Å –¥–ª—è —Ç–∞–≥—É
        self.tag_checkbox = ctk.CTkCheckBox(
            self,
            text="–°—Ç–≤–æ—Ä–∏—Ç–∏ —Ç–µ–≥ –≤–µ—Ä—Å—ñ—ó",
            font=ctk.CTkFont(size=11)
        )
        self.tag_checkbox.pack(anchor="w", padx=20, pady=(0, 20))
        self.tag_checkbox.select()

        # –ö–Ω–æ–ø–∫–∏
        button_frame = ctk.CTkFrame(self)
        button_frame.pack(padx=20, fill="x", pady=(0, 15))

        commit_btn = ctk.CTkButton(
            button_frame,
            text="‚úÖ Commit & Push",
            command=self.commit_and_push,
            font=ctk.CTkFont(size=12, weight="bold"),
            height=45,
            corner_radius=10
        )
        commit_btn.pack(side="left", fill="both", expand=True, padx=(0, 5))

        clear_btn = ctk.CTkButton(
            button_frame,
            text="üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç–∏",
            command=self.clear_fields,
            font=ctk.CTkFont(size=12),
            height=45,
            corner_radius=10,
            fg_color="gray30",
            hover_color="gray50"
        )
        clear_btn.pack(side="left", fill="both", expand=True, padx=(5, 0))

        # –õ–æ–≥–∏
        ctk.CTkLabel(
            self,
            text="–õ–æ–≥–∏ –æ–ø–µ—Ä–∞—Ü—ñ–π:",
            font=ctk.CTkFont(size=11, weight="bold")
        ).pack(anchor="w", padx=20, pady=(10, 5))

        self.log_text = scrolledtext.ScrolledText(
            self,
            height=10,
            width=70,
            font=("Courier", 9),
            bg="#f0f0f0",
            fg="#333333",
            relief="solid",
            borderwidth=1
        )
        self.log_text.pack(padx=20, pady=(0, 15), fill="both", expand=True)

        # –°—Ç–∞—Ç—É—Å
        self.status_label = ctk.CTkLabel(
            self,
            text="–ì–æ—Ç–æ–≤–æ –¥–æ —Ä–æ–±–æ—Ç–∏",
            font=ctk.CTkFont(size=10),
            text_color="gray"
        )
        self.status_label.pack(pady=(0, 10))

    def get_current_version(self):
        """–û—Ç—Ä–∏–º–∞–Ω–Ω—è –ø–æ—Ç–æ—á–Ω–æ—ó –≤–µ—Ä—Å—ñ—ó –∑ version.txt"""
        try:
            with open("version.txt", "r") as f:
                return f.read().strip()
        except:
            return "1.0.0"

    def log_message(self, message):
        """–î–æ–¥–∞–Ω–Ω—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –¥–æ –ª–æ–≥—ñ–≤"""
        timestamp = datetime.now().strftime("%H:%M:%S")
        self.log_text.insert("end", f"[{timestamp}] {message}\n")
        self.log_text.see("end")
        self.update()

    def run_git_command(self, command):
        """–í–∏–∫–æ–Ω–∞–Ω–Ω—è git –∫–æ–º–∞–Ω–¥–∏"""
        try:
            result = subprocess.run(
                command,
                shell=True,
                capture_output=True,
                text=True,
                cwd=os.getcwd()
            )

            if result.returncode == 0:
                if result.stdout:
                    self.log_message(f"‚úÖ {result.stdout.strip()}")
                return True
            else:
                error_msg = result.stderr.strip() if result.stderr else "–ù–µ–≤—ñ–¥–æ–º–∞ –ø–æ–º–∏–ª–∫–∞"
                self.log_message(f"‚ùå –ü–æ–º–∏–ª–∫–∞: {error_msg}")
                return False
        except Exception as e:
            self.log_message(f"‚ùå –ò—Å–∫–ª—é—á–µ–Ω–∏–µ: {str(e)}")
            return False

    def commit_and_push(self):
        """–û—Å–Ω–æ–≤–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è - commit, tag —ñ push"""

        comment = self.comment_entry.get().strip()
        new_version = self.version_entry.get().strip()
        create_tag = self.tag_checkbox.get()

        # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∏
        if not comment:
            messagebox.showwarning("–ü–æ–º–∏–ª–∫–∞", "–ù–∞–ø–∏—à—ñ—Ç—å –∫–æ–º–µ–Ω—Ç–∞—Ä –¥–æ –∫–æ–º—ñ—Ç—é!")
            return

        if create_tag and not new_version:
            messagebox.showwarning("–ü–æ–º–∏–ª–∫–∞", "–ù–∞–ø–∏—à—ñ—Ç—å –Ω–æ–≤—É –≤–µ—Ä—Å—ñ—é –¥–ª—è —Ç–∞–≥—É!")
            return

        self.status_label.configure(text="‚è≥ –û–±—Ä–æ–±–∫–∞...")
        self.update()

        self.log_message("=" * 50)
        self.log_message("üöÄ –†–æ–∑–ø–æ—á–∏–Ω–∞—î–º–æ commit & push –ø—Ä–æ—Ü–µ—Å...")
        self.log_message("=" * 50)

        # –ö—Ä–æ–∫ 1: –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å—É
        self.log_message("\nüìã –ö—Ä–æ–∫ 1: –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å—É —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—é...")
        self.run_git_command("git status --short")

        # –ö—Ä–æ–∫ 2: –î–æ–±–∞–≤–ª–µ–Ω–Ω—è –≤—Å—ñ—Ö —Ñ–∞–π–ª—ñ–≤
        self.log_message("\nüì¶ –ö—Ä–æ–∫ 2: –î–æ–¥–∞–≤–∞–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤...")
        if not self.run_git_command("git add ."):
            self.status_label.configure(text="‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –¥–æ–¥–∞–≤–∞–Ω–Ω—ñ —Ñ–∞–π–ª—ñ–≤")
            messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–ù–µ –≤–¥–∞–ª–æ—Å—è –¥–æ–¥–∞—Ç–∏ —Ñ–∞–π–ª–∏!")
            return

        # –ö—Ä–æ–∫ 3: –ö–æ–º—ñ—Ç
        self.log_message("\nüíæ –ö—Ä–æ–∫ 3: –ö–æ–º—ñ—Ç—É–≤–∞–Ω–Ω—è –∑–º—ñ–Ω...")
        if not self.run_git_command(f'git commit -m "{comment}"'):
            self.status_label.configure(text="‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –∫–æ–º—ñ—Ç—É–≤–∞–Ω–Ω—ñ")
            messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–ù–µ –≤–¥–∞–ª–æ—Å—è –∑–∞–∫–æ–º—ñ—Ç–∏—Ç–∏!")
            return

        # –ö—Ä–æ–∫ 4: Push
        self.log_message("\n‚¨ÜÔ∏è  –ö—Ä–æ–∫ 4: –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –Ω–∞ GitHub...")
        if not self.run_git_command("git push origin main"):
            self.status_label.configure(text="‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ push")
            messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–ù–µ –≤–¥–∞–ª–æ—Å—è –≤—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ –Ω–∞ GitHub!")
            return

        # –ö—Ä–æ–∫ 5: –¢–µ–≥ (—è–∫—â–æ –ø–æ—Ç—Ä—ñ–±–µ–Ω)
        if create_tag:
            self.log_message("\nüè∑Ô∏è  –ö—Ä–æ–∫ 5: –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–∞–≥—É...")
            if not self.run_git_command(f"git tag v{new_version}"):
                self.status_label.configure(text="‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—ñ —Ç–∞–≥—É")
                messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–ù–µ –≤–¥–∞–ª–æ—Å—è —Å—Ç–≤–æ—Ä–∏—Ç–∏ —Ç–µ–≥!")
                return

            self.log_message("\n‚¨ÜÔ∏è  –ö—Ä–æ–∫ 6: –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ç–∞–≥—É –Ω–∞ GitHub...")
            if not self.run_git_command(f"git push origin v{new_version}"):
                self.status_label.configure(text="‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ push —Ç–∞–≥—É")
                messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–ù–µ –≤–¥–∞–ª–æ—Å—è –≤—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ —Ç–µ–≥!")
                return

            # –û–Ω–æ–≤–ª–µ–Ω–Ω—è version.txt
            self.log_message("\nüìù –ö—Ä–æ–∫ 7: –û–Ω–æ–≤–ª–µ–Ω–Ω—è version.txt...")
            try:
                with open("version.txt", "w") as f:
                    f.write(new_version)
                self.log_message("‚úÖ version.txt –æ–Ω–æ–≤–ª–µ–Ω–æ")
                self.current_version = new_version
            except Exception as e:
                self.log_message(f"‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –æ–Ω–æ–≤–ª–µ–Ω–Ω—ñ version.txt: {str(e)}")

        self.log_message("\n" + "=" * 50)
        self.log_message("‚úÖ –í–°–ï –£–°–ü–Ü–®–ù–û! GitHub Actions –ø–æ—á–Ω–µ –∫–æ–º–ø—ñ–ª—é–≤–∞—Ç–∏...")
        self.log_message("=" * 50)

        self.status_label.configure(text="‚úÖ –£—Å–ø—ñ—à–Ω–æ! GitHub Actions –∑–∞–ø—É—â–µ–Ω–æ")
        messagebox.showinfo(
            "–£—Å–ø—ñ—Ö",
            f"‚úÖ –ö–æ–º—ñ—Ç —É—Å–ø—ñ—à–Ω–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ!\n\n"
            f"–ö–æ–º–µ–Ω—Ç–∞—Ä: {comment}\n"
            + (f"–í–µ—Ä—Å—ñ—è: v{new_version}\n\nGitHub Actions –ø–æ—á–Ω–µ –∫–æ–º–ø—ñ–ª—é–≤–∞—Ç–∏ EXE..." if create_tag else "")
        )

        self.clear_fields()

    def clear_fields(self):
        """–û—á–∏—Å—Ç–∫–∞ –ø–æ–ª—ñ–≤"""
        self.comment_entry.delete(0, "end")
        self.version_entry.delete(0, "end")
        self.tag_checkbox.select()
        self.status_label.configure(text="–ì–æ—Ç–æ–≤–æ –¥–æ —Ä–æ–±–æ—Ç–∏")


def main():
    app = GitCommitTool()
    app.mainloop()


if __name__ == "__main__":
    main()


================================================================================
–§–∞–π–ª 5/21: README.md
--------------------------------------------------------------------------------


================================================================================
–§–∞–π–ª 6/21: requirements.txt
--------------------------------------------------------------------------------
customtkinter==5.2.1
requests==2.31.0
psutil==5.9.6
keyring==24.1.0
python-telegram-bot==20.3
packaging>=24.0
pywin32>=300
python-dotenv

================================================================================
–§–∞–π–ª 7/21: src\anydesk_manager.py
--------------------------------------------------------------------------------
import os
import sys
import subprocess
import time
import logging
import psutil
import platform
import ctypes
import socket
from pathlib import Path
from typing import Optional, Tuple

logger = logging.getLogger(__name__)

UNATTENDED_PASSWORD = "r3moteh4nd"


class AnyDeskManager:
    """–ú–µ–Ω–µ–¥–∂–µ—Ä –¥–ª—è AnyDesk"""

    def __init__(self, config_manager, telegram_api):
        self.config = config_manager
        self.telegram = telegram_api
        self.anydesk_path = self.find_anydesk()
        self._is_running = False
        self.connection_id = None

    def find_anydesk(self) -> Optional[str]:
        """–ó–Ω–∞–π—Ç–∏ AnyDesk"""
        possible_paths = [
            r"C:\Program Files\AnyDesk\AnyDesk.exe",
            r"C:\Program Files (x86)\AnyDesk\AnyDesk.exe",
            os.path.expanduser("~\\AppData\\Local\\AnyDesk\\AnyDesk.exe"),
            os.path.expanduser("~\\AppData\\Roaming\\AnyDesk\\AnyDesk.exe"),
            os.path.expanduser("~\\Downloads\\AnyDesk.exe"),
            r"C:\ProgramData\AnyDesk\AnyDesk.exe",
        ]

        for path in possible_paths:
            if os.path.exists(path):
                logger.info(f"‚úÖ AnyDesk –∑–Ω–∞–π–¥–µ–Ω–æ: {path}")
                return path

        logger.warning("‚ö†Ô∏è AnyDesk –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ")
        return None

    def download_anydesk(self) -> bool:
        """–ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ AnyDesk"""
        if self.anydesk_path:
            return True

        logger.info("üì• –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è AnyDesk...")
        try:
            import urllib.request
            downloads_dir = os.path.expanduser("~\\Downloads")
            save_path = os.path.join(downloads_dir, "AnyDesk.exe")
            download_url = "https://download.anydesk.com/AnyDesk.exe"

            if not os.path.exists(save_path):
                logger.info(f"–ó–∞–≤–∞–Ω—Ç–∞–∂—É...")
                urllib.request.urlretrieve(download_url, save_path)

            logger.info("–ó–∞–ø—É—Å–∫ –≤—Å—Ç–∞–Ω–æ–≤–ª—é–≤–∞—á–∞...")
            subprocess.Popen([save_path])

            logger.info("–ß–µ–∫–∞—é –Ω–∞ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è (90 —Å–µ–∫)...")
            for i in range(90):
                time.sleep(1)
                self.anydesk_path = self.find_anydesk()
                if self.anydesk_path:
                    logger.info(f"‚úÖ AnyDesk –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ")
                    time.sleep(3)
                    return True

            return False
        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞: {e}")
            return False

    def check_if_running(self) -> bool:
        """–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —á–∏ AnyDesk –∑–∞–ø—É—â–µ–Ω–æ"""
        try:
            for proc in psutil.process_iter(['pid', 'name']):
                if 'anydesk' in proc.info['name'].lower():
                    logger.info(f"‚ÑπÔ∏è AnyDesk –∑–∞–ø—É—â–µ–Ω–æ (PID: {proc.info['pid']})")
                    self._is_running = True
                    return True
        except:
            pass
        self._is_running = False
        return False

    def launch_anydesk(self) -> bool:
        """–ó–∞–ø—É—Å—Ç–∏—Ç–∏ AnyDesk"""
        if self.check_if_running():
            return True

        if not self.anydesk_path or not Path(self.anydesk_path).exists():
            logger.error("–®–ª—è—Ö –Ω–µ–≤—ñ–¥–æ–º–∏–π")
            return False

        try:
            logger.info(f"üöÄ –ó–∞–ø—É—Å–∫–∞—é AnyDesk...")
            subprocess.Popen(self.anydesk_path)
            time.sleep(5)

            if self.check_if_running():
                logger.info("‚úÖ AnyDesk –∑–∞–ø—É—â–µ–Ω–æ")
                return True
            else:
                self._is_running = True
                return True
        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞: {e}")
            return False

    def set_password_with_admin(self) -> bool:
        """–í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –ø–∞—Ä–æ–ª—å —á–µ—Ä–µ–∑ –æ–∫—Ä–µ–º–∏–π —Å–∫—Ä–∏–ø—Ç –∑ –∞–¥–º—ñ–Ω –ø—Ä–∞–≤–∞–º–∏"""
        if not self.anydesk_path:
            logger.error("–®–ª—è—Ö –Ω–µ–≤—ñ–¥–æ–º–∏–π")
            return False

        try:
            logger.info(f"üîê –ó–∞–ø—É—Å–∫–∞—é –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –ø–∞—Ä–æ–ª—è –∑ –∞–¥–º—ñ–Ω –ø—Ä–∞–≤–∞–º–∏...")

            # –í–∏–∑–Ω–∞—á–∏—Ç–∏ —à–ª—è—Ö –¥–æ —Å–∫—Ä–∏–ø—Ç—É
            if getattr(sys, 'frozen', False):
                # –Ø–∫—â–æ EXE - —Å–∫—Ä–∏–ø—Ç –ø–æ—Ä—É—á
                script_path = os.path.join(os.path.dirname(sys.executable), "src", "set_anydesk_password.py")
            else:
                # –Ø–∫—â–æ DEV
                script_path = os.path.join(os.path.dirname(__file__), "set_anydesk_password.py")

            if not os.path.exists(script_path):
                logger.error(f"–°–∫—Ä–∏–ø—Ç –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ: {script_path}")
                return False

            # –ü–µ—Ä–µ–¥–∞—Ç–∏ –ø–∞—Ä–æ–ª—å —è–∫ –∑–º—ñ–Ω–Ω—É —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞
            env = os.environ.copy()
            env["ANYDESK_PASSWORD"] = UNATTENDED_PASSWORD

            # –ó–∞–ø—É—Å—Ç–∏—Ç–∏ —Å–∫—Ä–∏–ø—Ç –∑ –∞–¥–º—ñ–Ω –ø—Ä–∞–≤–∞–º–∏
            ctypes.windll.shell32.ShellExecuteW(
                None,
                "runas",
                sys.executable,
                f'"{script_path}" "{self.anydesk_path}"',
                None,
                1  # SW_SHOW - –ø–æ–∫–∞–∑–∞—Ç–∏ –≤—ñ–∫–Ω–æ
            )

            logger.info(f"‚úÖ –ó–∞–ø—Ä–æ—Å –∞–¥–º—ñ–Ω –ø—Ä–∞–≤ –Ω–∞–¥—ñ—Å–ª–∞–Ω–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—É")
            time.sleep(3)
            return True

        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞: {e}")
            import traceback
            traceback.print_exc()
            return False

    def get_connection_id(self) -> Optional[str]:
        """–û—Ç—Ä–∏–º–∞—Ç–∏ ID"""
        if not self.anydesk_path:
            return None

        try:
            logger.info("üìå –û—Ç—Ä–∏–º—É—é ID...")

            result = subprocess.run(
                [self.anydesk_path, '--get-id'],
                capture_output=True,
                text=True,
                timeout=10,
                creationflags=subprocess.CREATE_NO_WINDOW if platform.system() == "Windows" else 0
            )

            if result.returncode == 0:
                connection_id = result.stdout.strip()
                if connection_id and connection_id.isdigit():
                    logger.info(f"‚úÖ ID: {connection_id}")
                    self.connection_id = connection_id
                    return connection_id

        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞: {e}")

        return None

    def start(self, password: str = None) -> Tuple[Optional[str], Optional[str]]:
        """–ó–∞–ø—É—Å—Ç–∏—Ç–∏ AnyDesk"""
        password = UNATTENDED_PASSWORD

        # –ö—Ä–æ–∫ 1: –Ø–∫—â–æ –≤–∂–µ –∑–∞–ø—É—â–µ–Ω–æ
        if self.check_if_running():
            logger.info("AnyDesk –≤–∂–µ –∑–∞–ø—É—â–µ–Ω–æ")
            connection_id = self.get_connection_id()
            if connection_id:
                try:
                    # ‚ö†Ô∏è –î–û–î–ê–¢–ò –ü–Ü–ë
                    user_name = self.config.get("user_name", "")

                    self.telegram.send_anydesk_info(
                        self.config.store_location_text,
                        user_name,  # ‚¨ÖÔ∏è –ü–Ü–ë
                        socket.gethostname(),  # –ü–ö
                        connection_id,
                        password
                    )
                except Exception as e:
                    logger.error(f"‚ùå Telegram: {e}")
            return connection_id, password

        # –ö—Ä–æ–∫ 2: –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —è–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ
        if not self.anydesk_path:
            if not self.download_anydesk():
                return None, None

        # –ö—Ä–æ–∫ 3: –ó–∞–ø—É—Å—Ç–∏—Ç–∏
        if not self.launch_anydesk():
            return None, None

        # –ö—Ä–æ–∫ 4: –í–°–¢–ê–ù–û–í–ò–¢–ò –ü–ê–†–û–õ–¨ –ó –ê–î–ú–Ü–ù –ü–†–ê–í–ê–ú–ò
        logger.info("üîê –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –ø–∞—Ä–æ–ª—è...")
        time.sleep(2)
        self.set_password_with_admin()

        # –ö—Ä–æ–∫ 5: –û—Ç—Ä–∏–º–∞—Ç–∏ ID
        logger.info("üìå –û—Ç—Ä–∏–º–∞–Ω–Ω—è ID...")
        time.sleep(2)
        connection_id = self.get_connection_id()

        if not connection_id:
            time.sleep(3)
            connection_id = self.get_connection_id()

        # –ö—Ä–æ–∫ 6: –ù–∞–¥—ñ—Å–ª–∞—Ç–∏ –≤ Telegram –∑ –ü–Ü–ë
        try:
            # ‚ö†Ô∏è –î–û–î–ê–¢–ò –ü–Ü–ë
            user_name = self.config.get("user_name", "")

            self.telegram.send_anydesk_info(
                self.config.store_location_text,
                user_name,  # ‚¨ÖÔ∏è –ü–Ü–ë
                socket.gethostname(),  # –ü–ö
                connection_id if connection_id else "–Ω–µ –æ—Ç—Ä–∏–º–∞–Ω–æ",
                password
            )
            logger.info("‚úÖ –¢–µ–ª–µ–≥—Ä–∞–º —Å–ø–æ–≤—ñ—â–µ–Ω–æ")
        except Exception as e:
            logger.error(f"‚ùå –¢–µ–ª–µ–≥—Ä–∞–º –ø–æ–º–∏–ª–∫–∞: {e}")

        logger.info(f"‚úÖ –ì–æ—Ç–æ–≤–æ (ID: {connection_id})")
        return connection_id, password


================================================================================
–§–∞–π–ª 8/21: src\config.py
--------------------------------------------------------------------------------
import os
from pathlib import Path
from dotenv import load_dotenv

# –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ .env
load_dotenv()

APP_NAME = "RemoteHand"
RDP_HOST = "23.88.7.196"
RDP_PORT = 4420
PING_HOST = "23.88.7.196"

# üîí –ó–Ü –ó–ú–Ü–ù–ù–ò–• –°–ï–†–ï–î–û–í–ò–©–ê, –ê –ù–ï –ó .env!
TELEGRAM_TOKEN = os.getenv("TELEGRAM_TOKEN", "")
TELEGRAM_CHAT_ID = os.getenv("TELEGRAM_CHAT_ID", "")

# –§–∞–π–ª–∏
LOCK_FILE = Path.home() / ".remotehand" / "lock"


================================================================================
–§–∞–π–ª 9/21: src\config_manager.py
--------------------------------------------------------------------------------
import json
import os
from pathlib import Path
import logging

logger = logging.getLogger(__name__)


class ConfigManager:
    """–ú–µ–Ω–µ–¥–∂–µ—Ä –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó"""

    def __init__(self):
        self.config_dir = Path.home() / ".remotehand"
        self.config_dir.mkdir(exist_ok=True)
        self.config_file = self.config_dir / "config.json"

        self.config = self.load()

    def load(self):
        """–ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –∫–æ–Ω—Ñ—ñ–≥"""
        if self.config_file.exists():
            try:
                with open(self.config_file, 'r', encoding='utf-8') as f:
                    return json.load(f)
            except:
                pass
        return {}

    def save(self):
        """–ó–±–µ—Ä–µ–≥—Ç–∏ –∫–æ–Ω—Ñ—ñ–≥ –≤ JSON —Ñ–∞–π–ª"""
        try:
            with open(self.config_file, 'w', encoding='utf-8') as f:
                json.dump(self.config, f, ensure_ascii=False, indent=2)
        except Exception as e:
            logger.error(f"–ü–æ–º–∏–ª–∫–∞ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –∫–æ–Ω—Ñ—ñ–≥—É: {e}")

    def set(self, key, value):
        """–í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –∑–Ω–∞—á–µ–Ω–Ω—è"""
        self.config[key] = value
        self.save()

    def get(self, key, default=""):
        """–û—Ç—Ä–∏–º–∞—Ç–∏ –∑–Ω–∞—á–µ–Ω–Ω—è"""
        return self.config.get(key, default)

    def is_first_run(self):
        """–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —á–∏ –ø–µ—Ä—à–∏–π –∑–∞–ø—É—Å–∫"""
        store = self.config.get('store', '')
        location = self.config.get('location', '')
        return not store or not location

    @property
    def store_location_text(self):
        """–û—Ç—Ä–∏–º–∞—Ç–∏ —Ç–µ–∫—Å—Ç –º–∞–≥–∞–∑–∏–Ω—É/–ª–æ–∫–∞—Ü—ñ—ó"""
        store = self.config.get('store', '–ù–µ–≤—ñ–¥–æ–º–æ')
        location = self.config.get('location', '–ù–µ–≤—ñ–¥–æ–º–æ')
        return f"{store} / {location}"


================================================================================
–§–∞–π–ª 10/21: src\main.py
--------------------------------------------------------------------------------
import customtkinter as ctk
from tkinter import messagebox
import sys
import os
import threading
import logging
from pathlib import Path

# –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ .env —Ñ–∞–π–ª
from dotenv import load_dotenv

load_dotenv()

# –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –ª–æ–≥—É–≤–∞–Ω–Ω—è
logging.basicConfig(
    level=logging.INFO,
    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s'
)
logger = logging.getLogger(__name__)

# ============ –ü–ï–†–ï–í–Ü–†–ö–ê DEV –†–ï–ñ–ò–ú–£ ============
DEV_MODE = os.getenv('REMOTEHAND_DEV_MODE') == '1'
logger.info(f"{'üîß DEV –†–ï–ñ–ò–ú' if DEV_MODE else '‚úÖ PRODUCTION –†–ï–ñ–ò–ú'}")

if not DEV_MODE:
    # –¢–Ü–õ–¨–ö–ò –í PRODUCTION
    try:
        from updater import check_and_update

        check_and_update()
    except Exception as e:
        logger.warning(f"–ü–æ–º–∏–ª–∫–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –æ–Ω–æ–≤–ª–µ–Ω—å: {e}")

# ============ –Ü–ú–ü–û–†–¢–ò ============
from utils import close_all_rdp_sessions, test_connection
from config import RDP_HOST, RDP_PORT, PING_HOST, APP_NAME

# –ù–æ–≤—ñ —ñ–º–ø–æ—Ä—Ç–∏
from config_manager import ConfigManager
from telegram_api import TelegramAPI
from setup_wizard import SetupWizard
from network_test import NetworkTest

try:
    from rdp_manager import RDPManager

    rdp_manager_available = True
except ImportError as e:
    rdp_manager_available = False
    logger.warning(f"rdp_manager –Ω–µ –¥–æ—Å—Ç—É–ø–Ω–∞: {e}")

try:
    from anydesk_manager import AnyDeskManager

    anydesk_available = True
except ImportError as e:
    anydesk_available = False
    logger.warning(f"anydesk_manager –Ω–µ –¥–æ—Å—Ç—É–ø–Ω–∞: {e}")


class RemoteHandApp(ctk.CTk):
    def __init__(self):
        super().__init__()

        # –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –≤—ñ–∫–Ω–∞
        self.title(APP_NAME)
        self.geometry("520x800")
        self.resizable(True, True)

        # –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç–µ–º–∏
        ctk.set_appearance_mode("light")
        ctk.set_default_color_theme("blue")

        # –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è –º–µ–Ω–µ–¥–∂–µ—Ä—ñ–≤
        self.config = ConfigManager()

        # ‚ö†Ô∏è –ó–ê–í–ê–ù–¢–ê–ñ–ò–¢–ò –¢–û–ö–ï–ù–ò –ó .env –õ–ò CONFIG
        telegram_token = os.getenv("TELEGRAM_TOKEN") or self.config.get("telegram_token")
        telegram_chat_id = os.getenv("TELEGRAM_CHAT_ID") or self.config.get("telegram_chat_id")

        logger.info(f"Telegram token: {'‚úÖ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ' if telegram_token else '‚ùå –ù–ï –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ'}")
        logger.info(f"Telegram chat_id: {'‚úÖ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ' if telegram_chat_id else '‚ùå –ù–ï –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ'}")

        self.telegram = TelegramAPI(telegram_token, telegram_chat_id)

        if rdp_manager_available:
            self.rdp_manager = RDPManager(self.config, self.telegram)
        else:
            self.rdp_manager = None

        if anydesk_available:
            self.anydesk_manager = AnyDeskManager(self.config, self.telegram)
        else:
            self.anydesk_manager = None

        self.network_test = NetworkTest(self.config, self.telegram)

        # ‚ö†Ô∏è –°–¢–í–û–†–ò–¢–ò UI –í–°–Ü –†–ê–ó–ò, –∞ –ø–æ—Ç—ñ–º –ø–æ–∫–∞–∑–∞—Ç–∏ SetupWizard —è–∫—â–æ –ø–µ—Ä—à–∏–π –∑–∞–ø—É—Å–∫
        self.setup_ui()

        if self.config.is_first_run():
            self.show_setup_wizard()

    def get_app_version(self):
        """–û—Ç—Ä–∏–º–∞—Ç–∏ –≤–µ—Ä—Å—ñ—é –ø—Ä–æ–≥—Ä–∞–º–∏"""
        try:
            if getattr(sys, 'frozen', False):
                # –Ø–∫—â–æ EXE - —à—É–∫–∞—î–º–æ –ø–æ—Ä—É—á –∑ EXE
                base_path = Path(sys.executable).parent
            else:
                # –Ø–∫—â–æ DEV - —à—É–∫–∞—î–º–æ –≤ –∫–æ—Ä–µ–Ω—ñ –ø—Ä–æ–µ–∫—Ç—É
                base_path = Path(__file__).parent.parent

            version_file = base_path / "version.txt"

            if version_file.exists():
                return version_file.read_text(encoding='utf-8').strip()
        except Exception as e:
            logger.error(f"–ü–æ–º–∏–ª–∫–∞ —á–∏—Ç–∞–Ω–Ω—è –≤–µ—Ä—Å—ñ—ó: {e}")

        return "1.0.0"

    def show_setup_wizard(self):
        """–ü–æ–∫–∞–∑–∞—Ç–∏ –≤—ñ–∫–Ω–æ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –ø—Ä–∏ –ø–µ—Ä—à–æ–º—É –∑–∞–ø—É—Å–∫—É"""

        def on_setup_complete(result):
            self.config.set("store", result["store"])
            self.config.set("location", result["location"])
            if result.get("user_name"):
                self.config.set("user_name", result["user_name"])
            # ‚úÖ –û–Ω–æ–≤–∏—Ç–∏ UI –ø—ñ—Å–ª—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è
            self.refresh_ui()

        wizard = SetupWizard(self, on_setup_complete)
        self.wait_window(wizard)

    def refresh_ui(self):
        """–û–Ω–æ–≤–∏—Ç–∏ UI –ø—ñ—Å–ª—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è"""
        # –û–Ω–æ–≤–∏—Ç–∏ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –º–∞–≥–∞–∑–∏–Ω
        user_info = self.config.store_location_text
        user_name = self.config.get("user_name", "")
        if user_name:
            user_info += f" | üë§ {user_name}"

        self.info_label.configure(text=f"üìç {user_info}")

    def setup_ui(self):
        """–°—Ç–≤–æ—Ä–µ–Ω–Ω—è UI"""

        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        title_label = ctk.CTkLabel(
            self,
            text="RemoteHand",
            font=ctk.CTkFont(size=28, weight="bold")
        )
        title_label.pack(pady=15)

        # –Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ –º–∞–≥–∞–∑–∏–Ω/–ª–æ–∫–∞—Ü—ñ—é + –ü–Ü–ë
        user_info = self.config.store_location_text
        user_name = self.config.get("user_name", "")
        if user_name:
            user_info += f" | üë§ {user_name}"

        self.info_label = ctk.CTkLabel(
            self,
            text=f"üìç {user_info}",
            font=ctk.CTkFont(size=11),
            text_color="gray"
        )
        self.info_label.pack(pady=(0, 20))

        # ==================== RDP –ë–õ–û–ö ====================
        rdp_frame = ctk.CTkFrame(self)
        rdp_frame.pack(pady=15, padx=20, fill="x")

        ctk.CTkLabel(
            rdp_frame,
            text="üìã –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ 1–°",
            font=ctk.CTkFont(size=13, weight="bold")
        ).pack(anchor="w", pady=(0, 10))

        # –û—Å–Ω–æ–≤–Ω–∞ –∫–Ω–æ–ø–∫–∞ RDP
        rdp_btn = ctk.CTkButton(
            rdp_frame,
            text="üñ•Ô∏è –í—ñ–¥–∫—Ä–∏—Ç–∏ 1–° (RDP)",
            command=self.open_rdp,
            height=50,
            font=ctk.CTkFont(size=12, weight="bold"),
            corner_radius=12,
            fg_color="#007AFF",
            hover_color="#0051D5"
        )
        rdp_btn.pack(fill="x", pady=(0, 10))

        # ==================== –ó–ê–ö–†–ò–¢–¢–Ø –°–ï–°–Ü–ô ====================
        close_sessions_btn = ctk.CTkButton(
            self,
            text="‚ùå –ó–∞–∫—Ä–∏—Ç–∏ –≤—Å—ñ RDP —Å–µ—Å—ñ—ó",
            command=self.close_sessions_confirm,
            height=45,
            font=ctk.CTkFont(size=12, weight="bold"),
            corner_radius=12,
            fg_color="#FF3B30",
            hover_color="#D70015"
        )
        close_sessions_btn.pack(pady=15, padx=20, fill="x")

        # ==================== ANYDESK –ë–õ–û–ö ====================
        if anydesk_available:
            anydesk_frame = ctk.CTkFrame(self)
            anydesk_frame.pack(pady=15, padx=20, fill="x")

            ctk.CTkLabel(
                anydesk_frame,
                text="üåê –í—ñ–¥–¥–∞–ª–µ–Ω–∏–π –¥–æ—Å—Ç—É–ø",
                font=ctk.CTkFont(size=13, weight="bold")
            ).pack(anchor="w", pady=(0, 10))

            anydesk_btn = ctk.CTkButton(
                anydesk_frame,
                text="üöÄ –ó–∞–ø—É—Å—Ç–∏—Ç–∏ AnyDesk",
                command=self.start_anydesk,
                height=50,
                font=ctk.CTkFont(size=12, weight="bold"),
                corner_radius=12,
                fg_color="#FF6B35",
                hover_color="#CC5529"
            )
            anydesk_btn.pack(fill="x", pady=(0, 10))

        # ==================== –¢–ï–°–¢ –ú–ï–†–ï–ñ–Ü ====================
        test_frame = ctk.CTkFrame(self)
        test_frame.pack(pady=15, padx=20, fill="x")

        ctk.CTkLabel(
            test_frame,
            text="üîß –î—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∞",
            font=ctk.CTkFont(size=13, weight="bold")
        ).pack(anchor="w", pady=(0, 10))

        test_btn = ctk.CTkButton(
            test_frame,
            text="üì° –¢–µ—Å—Ç –∑'—î–¥–Ω–∞–Ω–Ω—è",
            command=self.run_network_test,
            height=50,
            font=ctk.CTkFont(size=12, weight="bold"),
            corner_radius=12,
            fg_color="#34C759",
            hover_color="#248A3D"
        )
        test_btn.pack(fill="x", pady=(0, 10))

        # ==================== –°–¢–ê–¢–£–° ====================
        self.status_label = ctk.CTkLabel(
            self,
            text="‚úÖ –ì–æ—Ç–æ–≤–æ –¥–æ —Ä–æ–±–æ—Ç–∏",
            font=ctk.CTkFont(size=10),
            text_color="gray"
        )
        self.status_label.pack(pady=10)

        # ==================== –ö–ù–û–ü–ö–ê –†–ï–î–ê–ì–£–í–ê–ù–ù–Ø –ú–ê–ì–ê–ó–ò–ù–£ ====================
        settings_frame = ctk.CTkFrame(self)
        settings_frame.pack(pady=10, padx=20, fill="x")

        settings_btn = ctk.CTkButton(
            settings_frame,
            text="‚öôÔ∏è –ó–º—ñ–Ω–∏—Ç–∏ –º–∞–≥–∞–∑–∏–Ω/–ª–æ–∫–∞—Ü—ñ—é/–ü–Ü–ë",
            command=self.show_setup_wizard,
            height=35,
            font=ctk.CTkFont(size=10),
            corner_radius=8,
            fg_color="#999999",
            hover_color="#666666"
        )
        settings_btn.pack(fill="x")

        # ==================== –í–ï–†–°–Ü–Ø + –°–¢–ê–¢–£–° –û–ù–û–í–õ–ï–ù–ù–Ø ====================
        version_frame = ctk.CTkFrame(self)
        version_frame.pack(anchor="se", padx=10, pady=10)

        version_label = ctk.CTkLabel(
            version_frame,
            text=f"v{self.get_app_version()}",
            font=ctk.CTkFont(size=9, weight="bold"),
            text_color="#333333"
        )
        version_label.pack(side="left", padx=5)

        self.update_status_label = ctk.CTkLabel(
            version_frame,
            text="‚úÖ",
            font=ctk.CTkFont(size=10),
            text_color="green"
        )
        self.update_status_label.pack(side="left", padx=5)

    def open_rdp(self):
        """–í—ñ–¥–∫—Ä–∏—Ç–∏ RDP"""
        if not self.rdp_manager:
            messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "RDP –º–µ–Ω–µ–¥–∂–µ—Ä –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω")
            return

        # –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —á–∏ –ø–∞—Ä–æ–ª—å –≤–∂–µ –∑–±–µ—Ä–µ–∂–µ–Ω–æ
        saved_password = self.rdp_manager.get_credentials(RDP_HOST, "admin")

        if saved_password:
            # –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –∑–±–µ—Ä–µ–∂–µ–Ω–∏–π –ø–∞—Ä–æ–ª—å
            self.set_status("‚è≥ –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è...", "processing")

            def connect():
                try:
                    if self.rdp_manager.connect_rdp(RDP_HOST, RDP_PORT, "admin", saved_password):
                        self.set_status("‚úÖ –ü—ñ–¥–∫–ª—é—á–µ–Ω–æ", "success")
                    else:
                        self.set_status("‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è", "error")
                except Exception as e:
                    logger.error(f"–ü–æ–º–∏–ª–∫–∞: {e}")
                    self.set_status("‚ùå –ö—Ä–∏—Ç–∏—á–Ω–∞ –ø–æ–º–∏–ª–∫–∞", "error")

            thread = threading.Thread(target=connect, daemon=True)
            thread.start()
        else:
            # –ó–∞–ø—Ä–æ—Å–∏—Ç–∏ –Ω–æ–≤–∏–π –ø–∞—Ä–æ–ª—å
            dialog = ctk.CTkInputDialog(
                text="–í–≤–µ–¥—ñ—Ç—å –ø–∞—Ä–æ–ª—å –¥–ª—è RDP:",
                title="–ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ 1–°"
            )
            password = dialog.get_input()

            if password:
                self.set_status("üíæ –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è –ø–∞—Ä–æ–ª—è...", "processing")

                # –°–ø—Ä–æ–±—É–≤–∞—Ç–∏ –ø—ñ–¥–∫–ª—é—á–∏—Ç–∏—Å—è
                if self.rdp_manager.connect_rdp(RDP_HOST, RDP_PORT, "admin", password):
                    # –Ø–∫—â–æ —É—Å–ø—ñ—à–Ω–æ, —Ç–æ –∑–±–µ—Ä–µ–≥—Ç–∏ –ø–∞—Ä–æ–ª—å
                    self.rdp_manager.save_credentials(RDP_HOST, "admin", password)
                    self.set_status("‚úÖ –£—Å–ø—ñ—à–Ω–æ –ø—ñ–¥–∫–ª—é—á–µ–Ω–æ", "success")
                else:
                    self.set_status("‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è", "error")

    def close_sessions_confirm(self):
        """–ü—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è –∑–∞–∫—Ä–∏—Ç—Ç—è —Å–µ—Å—ñ–π"""
        result = messagebox.askyesno(
            "–ü—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è",
            "–í–∏ –≤–ø–µ–≤–Ω–µ–Ω—ñ, —â–æ —Ö–æ—á–µ—Ç–µ –∑–∞–∫—Ä–∏—Ç–∏ –≤—Å—ñ RDP —Å–µ—Å—ñ—ó?"
        )
        if result:
            self.set_status("‚è≥ –ó–∞–∫—Ä–∏—Ç—Ç—è —Å–µ—Å—ñ–π...", "processing")
            close_all_rdp_sessions()
            self.set_status("‚úÖ –í—Å—ñ —Å–µ—Å—ñ—ó –∑–∞–∫—Ä–∏—Ç–æ", "success")

    def start_anydesk(self):
        """–ó–∞–ø—É—Å—Ç–∏—Ç–∏ AnyDesk - –ë–ï–ó –ø–æ–∫–∞–∑—É –ø–∞—Ä–æ–ª—è!"""
        if not self.anydesk_manager:
            messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "AnyDesk –º–µ–Ω–µ–¥–∂–µ—Ä –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω")
            return

        self.set_status("‚è≥ –ó–∞–ø—É—Å–∫ AnyDesk...", "processing")

        def anydesk_task():
            try:
                # –ó–∞–ø—É—Å—Ç–∏—Ç–∏ AnyDesk - –ø–∞—Ä–æ–ª—å –ù–ï –ø–µ—Ä–µ–¥–∞—î–º–æ —Ç–∞ –ù–ï –ø–æ–∫–∞–∑—É—î–º–æ!
                anydesk_id, pwd = self.anydesk_manager.start(None)

                if anydesk_id:
                    self.set_status(f"‚úÖ AnyDesk –∑–∞–ø—É—â–µ–Ω–æ\nüÜî ID: {anydesk_id}", "success")
                    messagebox.showinfo(
                        "‚úÖ AnyDesk –∑–∞–ø—É—â–µ–Ω–æ",
                        f"ID –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è: {anydesk_id}\n\n"
                        f"–î–∞–Ω—ñ –Ω–∞–¥—ñ—Å–ª–∞–Ω—ñ –≤ Telegram\n"
                        f"–ü–∞—Ä–æ–ª—å –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ"
                    )
                else:
                    self.set_status("‚ùå AnyDesk –≤–∂–µ –∑–∞–ø—É—â–µ–Ω–æ", "error")
                    messagebox.showwarning(
                        "‚ö†Ô∏è –£–≤–∞–≥–∞",
                        "AnyDesk –≤–∂–µ –∑–∞–ø—É—â–µ–Ω–æ –∞–±–æ –Ω–µ –≤–¥–∞–ª–æ—Å—è –∑–∞–ø—É—Å—Ç–∏—Ç–∏"
                    )
            except Exception as e:
                logger.error(f"–ü–æ–º–∏–ª–∫–∞: {e}")
                self.set_status("‚ùå –ü–æ–º–∏–ª–∫–∞ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è", "error")

        thread = threading.Thread(target=anydesk_task, daemon=True)
        thread.start()

    def run_network_test(self):
        """–ó–∞–ø—É—Å—Ç–∏—Ç–∏ —Ç–µ—Å—Ç –º–µ—Ä–µ–∂—ñ"""
        self.set_status("‚è≥ –¢–µ—Å—Ç –º–µ—Ä–µ–∂—ñ...", "processing")

        def test_task():
            try:
                result = self.network_test.run_full_test()
                self.set_status(f"{result['status']}", result['color'])
            except Exception as e:
                logger.error(f"–ü–æ–º–∏–ª–∫–∞ —Ç–µ—Å—Ç—É: {e}")
                self.set_status("‚ùå –ü–æ–º–∏–ª–∫–∞ —Ç–µ—Å—Ç—É", "error")

        thread = threading.Thread(target=test_task, daemon=True)
        thread.start()

    def set_status(self, text, status_type="info"):
        """–í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ —Å—Ç–∞—Ç—É—Å –∑ –∫–æ–ª—å–æ—Ä–æ–º"""
        color_map = {
            "success": "green",
            "error": "red",
            "processing": "blue",
            "info": "gray"
        }
        self.status_label.configure(text=text, text_color=color_map.get(status_type, "gray"))


def main():
    """–ì–æ–ª–æ–≤–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è"""
    logger.info("–ó–∞–ø—É—Å–∫ RemoteHand...")
    app = RemoteHandApp()
    app.mainloop()


if __name__ == "__main__":
    main()


================================================================================
–§–∞–π–ª 11/21: src\network_test.py
--------------------------------------------------------------------------------
import subprocess
import re
import socket
import logging
from pathlib import Path
import tempfile

logger = logging.getLogger(__name__)


class NetworkTest:
    """–¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è –º–µ—Ä–µ–∂—ñ –∑ –∑–≤—ñ—Ç–æ–º"""

    def __init__(self, config_manager, telegram_api):
        self.config = config_manager
        self.telegram = telegram_api

    def run_ping_test(self, host, count=20):
        """–í–∏–∫–æ–Ω–∞—Ç–∏ ping —Ç–µ—Å—Ç –Ω–∞ —Ö–æ—Å—Ç—É"""
        try:
            result = subprocess.run(
                ['ping', host, '-n', str(count)],
                capture_output=True,
                text=True,
                encoding='cp1252',
                timeout=60,
                creationflags=subprocess.CREATE_NO_WINDOW
            )
            return result.stdout
        except Exception as e:
            logger.error(f"–ü–æ–º–∏–ª–∫–∞ ping: {e}")
            return f"–ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—ñ {host}: {str(e)}"

    def parse_ping_loss(self, ping_output):
        """–í–∏—Ç—è–≥—Ç–∏ –≤—ñ–¥—Å–æ—Ç–æ–∫ –≤—Ç—Ä–∞—Ç–∏ –ø–∞–∫–µ—Ç—ñ–≤"""
        try:
            match = re.search(r'(\d+)%\s+(–ø–æ—Ç–µ—Ä—å|loss)', ping_output, re.IGNORECASE)
            if match:
                return int(match.group(1))
            return 0
        except:
            return -1

    def run_full_test(self):
        """–ó–∞–ø—É—Å—Ç–∏—Ç–∏ –ø–æ–≤–Ω–∏–π —Ç–µ—Å—Ç –º–µ—Ä–µ–∂—ñ"""
        pc_name = socket.gethostname()
        store_location = self.config.store_location_text

        hosts = {
            "1–° –°–µ—Ä–≤–µ—Ä": "23.88.7.196",
            "Google DNS": "8.8.8.8"
        }

        report_parts = []
        total_loss = 0

        for name, ip in hosts.items():
            ping_output = self.run_ping_test(ip)
            loss = self.parse_ping_loss(ping_output)

            if loss >= 0:
                status = "‚úÖ" if loss == 0 else ("‚ö†Ô∏è" if loss <= 15 else "‚ùå")
                report_parts.append(f"{status} {name} ({ip}): {loss}% –≤—Ç—Ä–∞—Ç–∏")
                total_loss += loss
            else:
                report_parts.append(f"‚ùå {name} ({ip}): –ü–æ–º–∏–ª–∫–∞ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è")

        avg_loss = total_loss / len(hosts) if hosts else 0

        if avg_loss == 0:
            status_text = "‚úÖ –ú–µ—Ä–µ–∂–∞ –≤ –Ω–æ—Ä–º—ñ"
            color = "green"
        elif avg_loss <= 15:
            status_text = "‚ö†Ô∏è –Ñ –Ω–µ–≤–µ–ª–∏–∫—ñ –ø—Ä–æ–±–ª–µ–º–∏"
            color = "orange"
        else:
            status_text = "‚ùå –°–µ—Ä–π–æ–∑–Ω—ñ –ø—Ä–æ–±–ª–µ–º–∏"
            color = "red"

        # –í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ –≤ Telegram
        test_report = "\n".join(report_parts)
        self.telegram.send_network_report(store_location, pc_name, test_report)

        return {
            "status": status_text,
            "color": color,
            "details": test_report
        }


================================================================================
–§–∞–π–ª 12/21: src\rdp_manager.py
--------------------------------------------------------------------------------
import os
import subprocess
import time
import winreg
import logging
import keyring
from pathlib import Path

logger = logging.getLogger(__name__)


class RDPManager:
    """–ú–µ–Ω–µ–¥–∂–µ—Ä –¥–ª—è RDP –ø—ñ–¥–∫–ª—é—á–µ–Ω—å –∑ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–º –ª–æ–≥—ñ–Ω–æ–º"""

    def __init__(self, config_manager, telegram_api):
        self.config = config_manager
        self.telegram = telegram_api

    def save_credentials(self, host, username, password):
        """–ó–±–µ—Ä–µ–≥—Ç–∏ RDP –¥–∞–Ω—ñ –≤ Windows Credential Manager"""
        try:
            keyring.set_password(f"RDP_{host}", username, password)
            self.config.set("rdp_password", password)
            logger.info(f"‚úÖ –î–∞–Ω—ñ –∑–±–µ—Ä–µ–∂–µ–Ω—ñ –¥–ª—è {host}")
            return True
        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è: {e}")
            return False

    def get_credentials(self, host, username):
        """–û—Ç—Ä–∏–º–∞—Ç–∏ –ø–∞—Ä–æ–ª—å –∑ Credential Manager"""
        try:
            password = keyring.get_password(f"RDP_{host}", username)
            return password
        except:
            return None

    def connect_rdp(self, host, port, username, password=None):
        """–ü—ñ–¥–∫–ª—é—á–∏—Ç–∏—Å—è –¥–æ RDP"""
        try:
            # –ö–æ–¥—É–≤–∞–Ω–Ω—è –ø–∞—Ä–æ–ª—è –¥–ª—è .RDP —Ñ–∞–π–ª—É
            encrypted_password = self._encrypt_rdp_password(password) if password else ""

            rdp_content = f"""screen mode id:i:2
use multimon:i:0
desktopwidth:i:1920
desktopheight:i:1080
session bpp:i:32
connection type:i:7
disable wallpaper:i:0
allow font smoothing:i:1
allow desktop composition:i:1
disable full window drag:i:0
disable menu anims:i:0
disable themes:i:0
disable cursor setting:i:0
bitmapcachepersistenable:i:1
full address:s:{host}:{port}
audiomode:i:0
redirectprinters:i:0
redirectcomports:i:0
redirectsmartcards:i:0
redirectclipboard:i:1
redirectposdevices:i:0
autoreconnection enabled:i:1
authentication level:i:0
prompt for credentials on client:i:0
negotiate security layer:i:1
enablecredsspsupport:i:1
username:s:{username}
password 51:b:{encrypted_password}
"""

            rdp_file = f"{host}_{username}_session.rdp"
            with open(rdp_file, "w") as f:
                f.write(rdp_content)

            subprocess.Popen(f"mstsc {rdp_file}")
            logger.info(f"‚úÖ RDP –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –∑–∞–ø—É—â–µ–Ω–æ")

            # –í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ –≤ Telegram
#            self.telegram.send_rdp_info(
#                self.config.store_location_text,
#                os.environ.get('COMPUTERNAME', 'Unknown')
#            )

            return True
        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è: {e}")
            return False

    def _encrypt_rdp_password(self, password):
        """–ü—Ä–æ—Å—Ç–æ–µ —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è –ø–∞—Ä–æ–ª—è –¥–ª—è .RDP"""
        encrypted = ""
        for char in password:
            encrypted += format(ord(char) ^ 0xAA, '02x')
        return encrypted


================================================================================
–§–∞–π–ª 13/21: src\set_anydesk_password.py
--------------------------------------------------------------------------------
#!/usr/bin/env python3
"""–í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –ø–∞—Ä–æ–ª—è AnyDesk –∑ –∞–¥–º—ñ–Ω –ø—Ä–∞–≤–∞–º–∏"""

import subprocess
import sys
import os
import time
import ctypes

ANYDESK_PATH = sys.argv[1] if len(sys.argv) > 1 else None
PASSWORD = os.getenv("ANYDESK_PASSWORD", "r3moteh4nd")

if not ANYDESK_PATH or not os.path.exists(ANYDESK_PATH):
    print("[!] AnyDesk –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ")
    sys.exit(1)

# –ü–µ—Ä–µ–≤—ñ—Ä–∏–º–æ —á–∏ –∑–∞–ø—É—â–µ–Ω–æ –∑ –∞–¥–º—ñ–Ω –ø—Ä–∞–≤–∞–º–∏
try:
    is_admin = ctypes.windll.shell32.IsUserAnAdmin()
    if not is_admin:
        print("[!] –ü–æ—Ç—Ä—ñ–±–Ω—ñ –∞–¥–º—ñ–Ω –ø—Ä–∞–≤–∞")
        # –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–∏ –∑ –∞–¥–º—ñ–Ω –ø—Ä–∞–≤–∞–º–∏
        ctypes.windll.shell32.ShellExecuteW(
            None,
            "runas",
            sys.executable,
            f'"{__file__}" "{ANYDESK_PATH}"',
            None,
            1  # SW_SHOW
        )
        sys.exit(0)
except:
    pass

try:
    print(f"[*] –í—Å—Ç–∞–Ω–æ–≤–ª—é—é –ø–∞—Ä–æ–ª—å AnyDesk (—É –∞–¥–º—ñ–Ω—ñ)...")
    time.sleep(1)

    # –í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ —á–µ—Ä–µ–∑ stdin
    cmd = [ANYDESK_PATH, "--set-password", "_full_access"]

    result = subprocess.run(
        cmd,
        input=PASSWORD + "\n",
        capture_output=True,
        text=True,
        timeout=10
    )

    print(f"[CODE] {result.returncode}")
    if result.returncode in [0, 8000]:
        print("[‚úì] –ü–∞—Ä–æ–ª—å –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ!")
    else:
        print(f"[!] –ö–æ–¥: {result.returncode}")

    sys.exit(0)

except Exception as e:
    print(f"[!] –ü–æ–º–∏–ª–∫–∞: {e}")
    sys.exit(1)


================================================================================
–§–∞–π–ª 14/21: src\setup_wizard.py
--------------------------------------------------------------------------------
import customtkinter as ctk
import tkinter.messagebox as messagebox


class SetupWizard(ctk.CTkToplevel):
    def __init__(self, parent, on_complete):
        super().__init__(parent)

        self.title("RemoteHand - –ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞")
        self.geometry("450x500")
        self.resizable(False, False)

        # –¶–µ–Ω—Ç—Ä—É–≤–∞—Ç–∏ –Ω–∞ –µ–∫—Ä–∞–Ω—ñ
        self.transient(parent)
        self.grab_set()

        # ‚ö†Ô∏è –ó–ê–ë–û–†–û–ù–ò–¢–ò –ó–ê–ö–†–ò–¢–¢–Ø –ë–ï–ó –ó–ë–ï–†–ï–ñ–ï–ù–ù–Ø
        self.protocol("WM_DELETE_WINDOW", self.on_closing)

        self.on_complete = on_complete
        self.setup_complete = False

        # –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç–µ–º–∏
        ctk.set_appearance_mode("light")
        ctk.set_default_color_theme("blue")

        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        title = ctk.CTkLabel(
            self,
            text="–ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞",
            font=ctk.CTkFont(size=18, weight="bold")
        )
        title.pack(pady=20)

        # ===== –ú–ê–ì–ê–ó–ò–ù (–í–´–ë–Ü–†) =====
        ctk.CTkLabel(
            self,
            text="–í–∏–±–µ—Ä—ñ—Ç—å –º–∞–≥–∞–∑–∏–Ω:",
            font=ctk.CTkFont(size=12, weight="bold")
        ).pack(anchor="w", padx=20, pady=(10, 5))

        self.store_var = ctk.StringVar(value="")
        store_options = [
            "0 / –û—Ñ—ñ—Å",
            "1 / –î—ñ–∞–ª–æ–≥",
            "5 / –ü–æ–ª—Ç–∞–≤–∞",
            "7 / –û–∞–∑–∏—Å",
            "8 / –•–º–µ–ª—å–Ω–∏—Ü—å–∫–∏–π",
            "9 / –ß–µ—Ä–Ω—ñ–≤—Ü—ñ",
            "17 / –ö—Ä–µ–º–µ–Ω—á—É–∫",
            "18 / –ü_–ö–æ—Ç–ª—è—Ä–µ–≤—Å—å–∫–æ–≥–æ",
            "20 / –©–∞—Å–ª–∏–≤–∏–π",
            "21 / –°–æ—Ñ—ñ—è –º–æ–ª–ª"
        ]

        self.store_menu = ctk.CTkComboBox(
            self,
            values=store_options,
            variable=self.store_var,
            font=ctk.CTkFont(size=11),
            height=35
        )
        self.store_menu.pack(padx=20, fill="x", pady=(0, 20))

        # ===== –õ–û–ö–ê–¶–Ü–Ø (–í–´–ë–Ü–†) =====
        ctk.CTkLabel(
            self,
            text="–í–∏–±–µ—Ä—ñ—Ç—å –ª–æ–∫–∞—Ü—ñ—é:",
            font=ctk.CTkFont(size=12, weight="bold")
        ).pack(anchor="w", padx=20, pady=(10, 5))

        self.location_var = ctk.StringVar(value="")
        location_options = [
            "–∫–∞—Å–∞",
            "–∫–∞—Å–∞ 2",
            "–ø—ñ–¥—Å–æ–±–∫–∞",
            "–æ—Å–æ–±–∏—Å—Ç–∏–π"
        ]

        self.location_menu = ctk.CTkComboBox(
            self,
            values=location_options,
            variable=self.location_var,
            font=ctk.CTkFont(size=11),
            height=35
        )
        self.location_menu.pack(padx=20, fill="x", pady=(0, 20))

        # ===== –ü–Ü–ë (–û–ü–¶–Ü–ô–ù–û) =====
        ctk.CTkLabel(
            self,
            text="–ü–Ü–ë –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ (–æ–ø—Ü—ñ–π–Ω–æ):",
            font=ctk.CTkFont(size=12, weight="bold")
        ).pack(anchor="w", padx=20, pady=(10, 5))

        self.user_name_entry = ctk.CTkEntry(
            self,
            placeholder_text="–ù–∞–ø—Ä–∏–∫–ª–∞–¥: –Ü–≤–∞–Ω –ü–µ—Ç—Ä–µ–Ω–∫–æ",
            height=35,
            font=ctk.CTkFont(size=11)
        )
        self.user_name_entry.pack(padx=20, fill="x", pady=(0, 30))

        # –ö–Ω–æ–ø–∫–∞
        btn = ctk.CTkButton(
            self,
            text="‚úÖ –ó–±–µ—Ä–µ–≥—Ç–∏",
            command=self.save_settings,
            height=45,
            font=ctk.CTkFont(size=12, weight="bold"),
            corner_radius=10
        )
        btn.pack(padx=20, fill="x", pady=10)

    def on_closing(self):
        """–ó–∞–±–æ—Ä–æ–Ω–∏—Ç–∏ –∑–∞–∫—Ä–∏—Ç—Ç—è –±–µ–∑ –≤–≤–µ–¥–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö"""
        if not self.setup_complete:
            messagebox.showwarning(
                "–ü–æ–º–∏–ª–∫–∞",
                "–í–∏–±–µ—Ä—ñ—Ç—å –º–∞–≥–∞–∑–∏–Ω —ñ –ª–æ–∫–∞—Ü—ñ—é –ø–µ—Ä–µ–¥ –∑–∞–∫—Ä–∏—Ç—Ç—è–º!"
            )
            return
        self.destroy()

    def save_settings(self):
        """–ó–±–µ—Ä–µ–≥—Ç–∏ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è - –æ–±–æ–≤'—è–∑–∫–æ–≤–æ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏"""
        store = self.store_var.get().strip()
        location = self.location_var.get().strip()
        user_name = self.user_name_entry.get().strip()

        # ‚ö†Ô∏è –û–ë–û–í'–Ø–ó–ö–û–í–ê –ü–ï–†–ï–í–Ü–†–ö–ê
        if not store:
            messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–í–∏–±–µ—Ä—ñ—Ç—å –º–∞–≥–∞–∑–∏–Ω!")
            return

        if not location:
            messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–í–∏–±–µ—Ä—ñ—Ç—å –ª–æ–∫–∞—Ü—ñ—é!")
            return

        # –í—Å–µ –æ–∫ - –∑–±–µ—Ä–µ–∂–µ–º–æ
        self.setup_complete = True
        self.on_complete({
            "store": store,
            "location": location,
            "user_name": user_name
        })
        self.destroy()


================================================================================
–§–∞–π–ª 15/21: src\telegram_api.py
--------------------------------------------------------------------------------
import requests
import logging
import time
import os
from pathlib import Path

logger = logging.getLogger(__name__)


class TelegramAPI:
    """–†–æ–∑—à–∏—Ä–µ–Ω–∞ Telegram API –¥–ª—è –∑–≤—ñ—Ç—É–≤–∞–Ω–Ω—è"""

    def __init__(self, token, chat_id):
        self.token = token
        self.chat_id = chat_id

        # ‚ö†Ô∏è –ü–ï–†–ï–í–Ü–†–ê –¢–û–ö–ï–ù–Ü–í
        if not token:
            logger.error("‚ùå Telegram —Ç–æ–∫–µ–Ω –Ω–µ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ!")
            self.api_url = None
        elif not chat_id:
            logger.error("‚ùå Telegram chat_id –Ω–µ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ!")
            self.api_url = None
        else:
            self.api_url = f"https://api.telegram.org/bot{token}"
            logger.info(f"‚úÖ Telegram –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–æ (—Ç–æ–∫–µ–Ω: {token[:20]}...)")

    def send_message(self, text, parse_mode="HTML"):
        """–í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ —Ç–µ–∫—Å—Ç–æ–≤–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è"""
        if not self.api_url:
            logger.error("‚ùå Telegram –Ω–µ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–æ")
            return False

        try:
            payload = {
                "chat_id": self.chat_id,
                "text": text,
                "parse_mode": parse_mode
            }
            response = requests.post(
                f"{self.api_url}/sendMessage",
                json=payload,
                timeout=10
            )
            response.raise_for_status()
            logger.info("‚úÖ –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –Ω–∞–¥—ñ—Å–ª–∞–Ω–æ –≤ Telegram")
            return True
        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞ –≤—ñ–¥–ø—Ä–∞–≤–∫–∏ Telegram: {e}")
            return False

    def send_file(self, file_path, caption="", file_type="document"):
        """–í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ —Ñ–∞–π–ª (document –∞–±–æ photo)"""
        if not self.api_url:
            logger.error("‚ùå Telegram –Ω–µ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–æ")
            return False

        try:
            with open(file_path, 'rb') as f:
                files = {file_type: f}
                payload = {
                    "chat_id": self.chat_id,
                    "caption": caption,
                    "parse_mode": "HTML"
                }
                endpoint = "sendDocument" if file_type == "document" else "sendPhoto"
                response = requests.post(
                    f"{self.api_url}/{endpoint}",
                    files=files,
                    data=payload,
                    timeout=30
                )
                response.raise_for_status()
            logger.info(f"‚úÖ –§–∞–π–ª –Ω–∞–¥—ñ—Å–ª–∞–Ω–æ –≤ Telegram")
            return True
        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞ –≤—ñ–¥–ø—Ä–∞–≤–∫–∏ —Ñ–∞–π–ª—É: {e}")
            return False

    def send_network_report(self, store_location, pc_name, test_results):
        """–í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ –∑–≤—ñ—Ç –ø—Ä–æ —Å—Ç–∞–Ω –º–µ—Ä–µ–∂—ñ"""
        report = (
            f"<b>üìä –ó–≤—ñ—Ç –ø—Ä–æ —Å—Ç–∞–Ω –º–µ—Ä–µ–∂—ñ</b>\n\n"
            f"<b>–ú–∞–≥–∞–∑–∏–Ω/–õ–æ–∫–∞—Ü—ñ—è:</b> {store_location}\n"
            f"<b>–ü–ö:</b> <code>{pc_name}</code>\n"
            f"<b>–ß–∞—Å:</b> {time.strftime('%Y-%m-%d %H:%M:%S')}\n\n"
            f"<b>–†–µ–∑—É–ª—å—Ç–∞—Ç–∏:</b>\n"
            f"{test_results}"
        )
        return self.send_message(report)

    def send_anydesk_info(self, store_location, user_name, pc_name, anydesk_id, password):
        """–í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ AnyDesk —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é"""

        # –î–æ–¥–∞—Ç–∏ –ü–Ü–ë —è–∫—â–æ —î
        user_info = f"\n<b>üë§ –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á:</b> {user_name}" if user_name else ""

        message = (
            f"<b>üåê AnyDesk - –ó–∞–ø—Ä–æ—Å –Ω–∞ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è</b>\n\n"
            f"<b>üìç –ú–∞–≥–∞–∑–∏–Ω/–õ–æ–∫–∞—Ü—ñ—è:</b> {store_location}{user_info}\n"
            f"<b>üíª –ü–ö:</b> <code>{pc_name}</code>\n\n"
            f"<b>üÜî ID:</b> <code>{anydesk_id}</code>\n"
            f"<b>üîê –ü–∞—Ä–æ–ª—å:</b> <code>{password}</code>"
        )
        return self.send_message(message)

    def send_rdp_info(self, store_location, pc_name):
        """–í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è –ø—Ä–æ RDP –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è"""
        message = (
            f"<b>üñ•Ô∏è RDP –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è</b>\n\n"
            f"<b>–ú–∞–≥–∞–∑–∏–Ω/–õ–æ–∫–∞—Ü—ñ—è:</b> {store_location}\n"
            f"<b>–ü–ö:</b> <code>{pc_name}</code>\n"
            f"<b>–ß–∞—Å:</b> {time.strftime('%Y-%m-%d %H:%M:%S')}\n\n"
            f"‚úÖ –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –ø—ñ–¥–∫–ª—é—á–∏–≤—Å—è –¥–æ 1–°"
        )
        return self.send_message(message)

    def send_error_report(self, store_location, pc_name, error_text):
        """–í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ –∑–≤—ñ—Ç –ø—Ä–æ –ø–æ–º–∏–ª–∫—É"""
        message = (
            f"<b>‚ùå –ü–æ–º–∏–ª–∫–∞</b>\n\n"
            f"<b>–ú–∞–≥–∞–∑–∏–Ω/–õ–æ–∫–∞—Ü—ñ—è:</b> {store_location}\n"
            f"<b>–ü–ö:</b> <code>{pc_name}</code>\n"
            f"<b>–ß–∞—Å:</b> {time.strftime('%Y-%m-%d %H:%M:%S')}\n\n"
            f"<b>–î–µ—Ç–∞–ª—ñ:</b>\n<code>{error_text}</code>"
        )
        return self.send_message(message)


================================================================================
–§–∞–π–ª 16/21: src\telegram_helper.py
--------------------------------------------------------------------------------
import asyncio
import json
import logging
from telegram import Bot

logger = logging.getLogger(__name__)


class TelegramHelper:
    """–î–æ–ø–æ–º—ñ–∂–Ω–∏–∫ –¥–ª—è –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å –≤ Telegram"""

    def __init__(self, config_path="bot_config.json"):
        self.config_path = config_path
        self.config = self.load_config()

    def load_config(self):
        """–ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –∫–æ–Ω—Ñ—ñ–≥"""
        try:
            with open(self.config_path, "r", encoding="utf-8") as f:
                return json.load(f)
        except:
            return {}

    async def send_anydesk_code(self, anydesk_id, password):
        """–í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ AnyDesk –¥–∞–Ω—ñ –≤ Telegram"""
        try:
            token = self.config.get("TELEGRAM_TOKEN")
            chat_id = self.config.get("CHAT_ID")

            if not token or not chat_id:
                logger.error("‚ùå –ù–µ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ñ TELEGRAM_TOKEN –∞–±–æ CHAT_ID")
                return False

            bot = Bot(token=token)

            message = (
                f"üñ•Ô∏è **AnyDesk —Å–µ—Å—ñ—è –∞–∫—Ç–∏–≤–æ–≤–∞–Ω–∞**\n\n"
                f"üÜî ID: `{anydesk_id}`\n"
                f"üîê –ü–∞—Ä–æ–ª—å: `{password}`\n\n"
                f"–î–ª—è –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ —Ü—ñ –¥–∞–Ω—ñ."
            )

            await bot.send_message(
                chat_id=chat_id,
                text=message,
                parse_mode="Markdown"
            )

            logger.info("‚úÖ –î–∞–Ω—ñ –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω—ñ –≤ Telegram")
            return True

        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞ –≤—ñ–¥–ø—Ä–∞–≤–∫–∏: {e}")
            return False

    async def send_message(self, text):
        """–í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ –¥–æ–≤—ñ–ª—å–Ω–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è"""
        try:
            token = self.config.get("TELEGRAM_TOKEN")
            chat_id = self.config.get("CHAT_ID")

            if not token or not chat_id:
                return False

            bot = Bot(token=token)
            await bot.send_message(chat_id=chat_id, text=text)

            return True

        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞: {e}")
            return False

    def send_anydesk_code_sync(self, anydesk_id, password):
        """–°–∏–Ω—Ö—Ä–æ–Ω–Ω–∞ –≤–µ—Ä—Å—ñ—è (–¥–ª—è GUI)"""
        try:
            loop = asyncio.new_event_loop()
            asyncio.set_event_loop(loop)
            result = loop.run_until_complete(
                self.send_anydesk_code(anydesk_id, password)
            )
            loop.close()
            return result
        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞: {e}")
            return False


================================================================================
–§–∞–π–ª 17/21: src\updater.py
--------------------------------------------------------------------------------
import os
import sys
import requests
import subprocess
import time
import logging
from pathlib import Path

logger = logging.getLogger(__name__)


class UpdaterManager:
    """–ú–µ–Ω–µ–¥–∂–µ—Ä –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ —Ç–∞ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –æ–Ω–æ–≤–ª–µ–Ω—å"""

    GITHUB_REPO = "ShevchukVI/RemoteHand"
    GITHUB_API_URL = f"https://api.github.com/repos/{GITHUB_REPO}/releases/latest"

    def __init__(self):
        self.app_dir = Path(__file__).parent.parent
        self.version_file = self.app_dir / "version.txt"
        self.current_version = self.get_current_version()

    def get_current_version(self):
        """–û—Ç—Ä–∏–º–∞—Ç–∏ –ø–æ—Ç–æ—á–Ω—É –≤–µ—Ä—Å—ñ—é"""
        if self.version_file.exists():
            try:
                with open(self.version_file, 'r', encoding='utf-8') as f:
                    return f.read().strip()
            except:
                pass
        return "1.0.0"

    def get_latest_version(self):
        """–û—Ç—Ä–∏–º–∞—Ç–∏ –Ω–∞–π–Ω–æ–≤—ñ—à—É –≤–µ—Ä—Å—ñ—é –∑ GitHub"""
        try:
            response = requests.get(self.GITHUB_API_URL, timeout=10)
            response.raise_for_status()
            data = response.json()
            tag = data.get('tag_name', 'v1.0.0')
            return tag.lstrip('v')
        except Exception as e:
            logger.warning(f"–ù–µ –≤–¥–∞–ª–æ—Å—è –æ—Ç—Ä–∏–º–∞—Ç–∏ –≤–µ—Ä—Å—ñ—é –∑ GitHub: {e}")
            return None

    def compare_versions(self, current, latest):
        """–ü–æ—Ä—ñ–≤–Ω—è—Ç–∏ –≤–µ—Ä—Å—ñ—ó"""
        try:
            current_parts = [int(x) for x in current.split('.')]
            latest_parts = [int(x) for x in latest.split('.')]
            return latest_parts > current_parts
        except:
            return False

    def download_and_update(self, latest_version):
        """–ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —Ç–∞ –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –Ω–æ–≤—É –≤–µ—Ä—Å—ñ—é"""
        try:
            logger.info(f"üì• –ó–∞–≤–∞–Ω—Ç–∞–∂—É—é RemoteHand v{latest_version}...")

            download_url = f"https://github.com/{self.GITHUB_REPO}/releases/download/v{latest_version}/RemoteHand.exe"

            # –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –Ω–æ–≤—É –≤–µ—Ä—Å—ñ—é
            response = requests.get(download_url, timeout=30)
            response.raise_for_status()

            # –í–∏–∑–Ω–∞—á–∏—Ç–∏ —à–ª—è—Ö –¥–ª—è –Ω–æ–≤–æ—ó –≤–µ—Ä—Å—ñ—ó
            if getattr(sys, 'frozen', False):
                # –Ø–∫—â–æ –∑–∞–ø—É—â–µ–Ω–æ —è–∫ EXE
                current_exe = Path(sys.executable)
                new_exe = current_exe.parent / "RemoteHand_new.exe"
            else:
                # –Ø–∫—â–æ –∑–∞–ø—É—â–µ–Ω–æ —è–∫ Python —Å–∫—Ä–∏–ø—Ç (DEV)
                new_exe = Path.cwd() / "RemoteHand_new.exe"

            # –ó–±–µ—Ä–µ–≥—Ç–∏ –Ω–æ–≤—É –≤–µ—Ä—Å—ñ—é
            with open(new_exe, 'wb') as f:
                f.write(response.content)

            logger.info(f"‚úÖ RemoteHand v{latest_version} –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ")
            return str(new_exe)

        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è: {e}")
            return None

    def check_and_update(self):
        """–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —Ç–∞ –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è"""
        # –ù–ï –æ–Ω–æ–≤–ª—é–≤–∞—Ç–∏ –≤ DEV —Ä–µ–∂–∏–º—ñ!
        if os.getenv('REMOTEHAND_DEV_MODE') == '1':
            logger.info("üîß DEV —Ä–µ–∂–∏–º - –ø—Ä–æ–ø—É—Å–∫–∞—î–º–æ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è")
            return False

        logger.info("üîç –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –æ–Ω–æ–≤–ª–µ–Ω—å...")

        latest_version = self.get_latest_version()
        if not latest_version:
            logger.info("‚ö†Ô∏è –ù–µ –≤–¥–∞–ª–æ—Å—è –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è")
            return False

        if self.compare_versions(self.current_version, latest_version):
            logger.info(f"üì¶ –î–æ—Å—Ç—É–ø–Ω–µ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è: {latest_version}")
            logger.info(f"üìå –ü–æ—Ç–æ—á–Ω–∞ –≤–µ—Ä—Å—ñ—è: {self.current_version}")

            # –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –Ω–æ–≤—É –≤–µ—Ä—Å—ñ—é
            new_exe = self.download_and_update(latest_version)

            if new_exe and os.path.exists(new_exe):
                logger.info(f"‚úÖ –ù–æ–≤–∞ –≤–µ—Ä—Å—ñ—è –≥–æ—Ç–æ–≤–∞!")
                logger.info(f"üîÑ –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫...")

                # ‚ö†Ô∏è –ê–í–¢–û–ú–ê–¢–ò–ß–ù–ò–ô –ü–ï–†–ï–ó–ê–ü–£–°–ö
                try:
                    # –ó–∞–ø—É—Å—Ç–∏—Ç–∏ –Ω–æ–≤—É –≤–µ—Ä—Å—ñ—é
                    subprocess.Popen([new_exe], shell=False)

                    # –ß–µ–∫–∞—Ç–∏ 1 —Å–µ–∫—É–Ω–¥—É
                    time.sleep(1)

                    # –ó–∞–∫—Ä–∏—Ç–∏ –ø–æ—Ç–æ—á–Ω—É –≤–µ—Ä—Å—ñ—é
                    logger.info("üëã –ó–∞–≤–µ—Ä—à–µ–Ω–Ω—è —Ä–æ–±–æ—Ç–∏ —Å—Ç–∞—Ä–æ—ó –≤–µ—Ä—Å—ñ—ó")
                    sys.exit(0)

                except Exception as e:
                    logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫—É: {e}")
                    logger.info(f"–ó–∞–ø—É—Å—Ç—ñ—Ç—å –≤—Ä—É—á–Ω—É: {new_exe}")
                    return False

                return True

        logger.info(f"‚úÖ –í–µ—Ä—Å—ñ—è –∞–∫—Ç—É–∞–ª—å–Ω–∞: {self.current_version}")
        return False


def check_and_update():
    """–§—É–Ω–∫—Ü—ñ—è –¥–ª—è —ñ–º–ø–æ—Ä—Ç—É –≤ main.py"""
    updater = UpdaterManager()
    return updater.check_and_update()


================================================================================
–§–∞–π–ª 18/21: src\utils.py
--------------------------------------------------------------------------------
import os
import sys
import subprocess
import psutil
from pathlib import Path
from config import LOCK_FILE, APP_NAME


class SingleInstance:
    """–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –Ω–∞ —î–¥–∏–Ω–∏–π –µ–∫–∑–µ–º–ø–ª—è—Ä –ø—Ä–æ–≥—Ä–∞–º–∏"""

    def __init__(self):
        self.lock_file = LOCK_FILE
        self.fp = None

    def is_running(self):
        """–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —á–∏ –ø—Ä–æ–≥—Ä–∞–º–∞ –≤–∂–µ –∑–∞–ø—É—â–µ–Ω–∞"""
        if sys.platform == 'win32':
            import win32event
            import win32api
            import winerror

            self.mutex = win32event.CreateMutex(None, False, APP_NAME)
            if win32api.GetLastError() == winerror.ERROR_ALREADY_EXISTS:
                return True
        else:
            try:
                self.fp = open(self.lock_file, 'w')
                import fcntl
                fcntl.flock(self.fp, fcntl.LOCK_EX | fcntl.LOCK_NB)
            except IOError:
                return True
        return False


def open_rdp_connection(host, port):
    """–í—ñ–¥–∫—Ä–∏—Ç—Ç—è RDP –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è"""
    rdp_command = f'mstsc /v:{host}:{port}'
    subprocess.Popen(rdp_command, shell=True)


def close_all_rdp_sessions():
    """–ó–∞–∫—Ä–∏—Ç—Ç—è –≤—Å—ñ—Ö RDP —Å–µ—Å—ñ–π"""
    for proc in psutil.process_iter(['name']):
        try:
            if proc.info['name'].lower() == 'mstsc.exe':
                proc.kill()
        except (psutil.NoSuchProcess, psutil.AccessDenied):
            pass


def test_connection(host):
    """–¢–µ—Å—Ç –∑'—î–¥–Ω–∞–Ω–Ω—è —á–µ—Ä–µ–∑ ping"""
    param = '-n' if sys.platform == 'win32' else '-c'
    command = ['ping', param, '1', host]
    result = subprocess.run(command, capture_output=True, text=True)
    return result.returncode == 0

================================================================================
–§–∞–π–ª 19/21: version.txt
--------------------------------------------------------------------------------
—è—é1 . 0 . 4 
 
 

================================================================================
–§–∞–π–ª 20/21: version_info.txt
--------------------------------------------------------------------------------
VSVersionInfo(
  ffi=FixedFileInfo(mask=0x3f,
    mask_values=[(0, 63), (0, 63), (0, 63), (0, 63)],
    CV_VSVersionInfo=[(0, '0'), (0, '3'), (0, '0'), (0, '0')]),
  StringFileInfo([(u'040904B0',
    StringTable(u'040904B0',
      [StringEntry(u'CompanyName', u'RemoteHand'),
       StringEntry(u'FileDescription', u'RemoteHand - RDP & AnyDesk Manager'),
       StringEntry(u'FileVersion', u'1.0.3.0'),
       StringEntry(u'ProductName', u'RemoteHand'),
       StringEntry(u'ProductVersion', u'1.0.3')]))]),
  VarFileInfo([VarEntry(u'Translation', [1033, 1200])])
)


================================================================================
–§–∞–π–ª 21/21: –ê–∫—Ç–∏–≤–∞—Ü—ñ—è —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞.txt
--------------------------------------------------------------------------------
.venvScriptsActivate.ps1

================================================================================
–ö–Ü–ù–ï–¶–¨ –ï–ö–°–ü–û–†–¢–£
================================================================================


================================================================================
–§–∞–π–ª 5/20: project_export_20251110_151306.txt
--------------------------------------------------------------------------------
================================================================================
–ï–ö–°–ü–û–†–¢ –ü–†–û–Ñ–ö–¢–£: RemoteHand
–î–∞—Ç–∞: 2025-11-10 15:13:06
–®–ª—è—Ö: D:\Python Projects\Prego\RemoteHand
================================================================================

üìÇ –°–¢–†–£–ö–¢–£–†–ê –ü–†–û–Ñ–ö–¢–£
--------------------------------------------------------------------------------
RemoteHand/
‚îú‚îÄ‚îÄ assets/
‚îÇ   ‚îî‚îÄ‚îÄ icon.ico
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ anydesk_manager.py
‚îÇ   ‚îú‚îÄ‚îÄ config.py
‚îÇ   ‚îú‚îÄ‚îÄ config_manager.py
‚îÇ   ‚îú‚îÄ‚îÄ main.py
‚îÇ   ‚îú‚îÄ‚îÄ network_test.py
‚îÇ   ‚îú‚îÄ‚îÄ rdp_manager.py
‚îÇ   ‚îú‚îÄ‚îÄ setup_wizard.py
‚îÇ   ‚îú‚îÄ‚îÄ telegram_api.py
‚îÇ   ‚îú‚îÄ‚îÄ updater.py
‚îÇ   ‚îî‚îÄ‚îÄ utils.py
‚îú‚îÄ‚îÄ .env.example
‚îú‚îÄ‚îÄ 23.88.7.196_admin_session.rdp
‚îú‚îÄ‚îÄ dev_run.py
‚îú‚îÄ‚îÄ export.py
‚îú‚îÄ‚îÄ GitCommitTool.py
‚îú‚îÄ‚îÄ project_export_20251110_104446.txt
‚îú‚îÄ‚îÄ project_export_20251110_151306.txt
‚îú‚îÄ‚îÄ README.md
‚îú‚îÄ‚îÄ RemoteHand.spec
‚îú‚îÄ‚îÄ requirements.txt
‚îú‚îÄ‚îÄ version.txt
‚îú‚îÄ‚îÄ version_info.txt
‚îî‚îÄ‚îÄ –ê–∫—Ç–∏–≤–∞—Ü—ñ—è —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞.txt

üìÑ –í–ú–Ü–°–¢ –§–ê–ô–õ–Ü–í (20 —Ñ–∞–π–ª—ñ–≤)
================================================================================


================================================================================
–§–∞–π–ª 1/20: dev_run.py
--------------------------------------------------------------------------------
"""
DEV_RUN.PY - –õ–æ–∫–∞–ª—å–Ω–µ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è
"""

import sys
import os

# –í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ DEV —Ä–µ–∂–∏–º
os.environ['REMOTEHAND_DEV_MODE'] = '1'

# –î–æ–¥–∞—Ç–∏ src –≤ path
sys.path.insert(0, os.path.join(os.path.dirname(__file__), 'src'))

print("–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π...")
import subprocess
subprocess.run([sys.executable, "-m", "pip", "install", "-r", "requirements.txt", "-q"],
               capture_output=True)

print("üîß –ó–∞–ø—É—Å–∫ —É DEV —Ä–µ–∂–∏–º—ñ...")

# –ü—Ä—è–º–æ –∑–∞–ø—É—Å—Ç–∏—Ç–∏ main
if __name__ == "__main__":
    import main
    main.main()


================================================================================
–§–∞–π–ª 2/20: export.py
--------------------------------------------------------------------------------
#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Project Structure Exporter
–°—Ç–≤–æ—Ä—é—î –¥–µ—Ç–∞–ª—å–Ω–∏–π –æ–ø–∏—Å —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ –ø—Ä–æ—î–∫—Ç—É —Ç–∞ –≤–º—ñ—Å—Ç —Ñ–∞–π–ª—ñ–≤ —É –æ–¥–∏–Ω —Ñ–∞–π–ª
"""

import os
from pathlib import Path
from datetime import datetime

# –§–∞–π–ª–∏ —Ç–∞ –ø–∞–ø–∫–∏, —è–∫—ñ —Ç—Ä–µ–±–∞ —ñ–≥–Ω–æ—Ä—É–≤–∞—Ç–∏
IGNORE_PATTERNS = {
    # –ü–∞–ø–∫–∏
    '__pycache__', '.git', '.idea', '.vscode', 'node_modules',
    'venv', 'env', '.env', 'dist', 'build', '.pytest_cache',
    '.mypy_cache', 'htmlcov', '.coverage', 'logs', 'tmp',
    # –§–∞–π–ª–∏
    '.pyc', '.pyo', '.pyd', '.so', '.dll', '.dylib', '.exe',
    '.log', '.sqlite', '.db', '.pkl', '.pickle', '.DS_Store',
    'Thumbs.db', '.env', '.env.local', '.gitignore'
}

# –†–æ–∑—à–∏—Ä–µ–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤ –¥–ª—è —á–∏—Ç–∞–Ω–Ω—è (—Ç–µ–∫—Å—Ç–æ–≤—ñ —Ñ–∞–π–ª–∏)
TEXT_EXTENSIONS = {
    '.py', '.js', '.ts', '.jsx', '.tsx', '.html', '.css', '.scss',
    '.json', '.yaml', '.yml', '.toml', '.ini', '.cfg', '.conf',
    '.txt', '.md', '.rst', '.xml', '.sql', '.sh', '.bash',
    '.env.example', '.gitignore', 'Dockerfile', 'Makefile',
    '.java', '.c', '.cpp', '.h', '.go', '.rs', '.php', '.rb'
}

# –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∏–π —Ä–æ–∑–º—ñ—Ä —Ñ–∞–π–ª—É (1 MB)
MAX_FILE_SIZE = 1024 * 1024


def should_ignore(path: Path) -> bool:
    """–ü–µ—Ä–µ–≤—ñ—Ä—è—î, —á–∏ —Ç—Ä–µ–±–∞ —ñ–≥–Ω–æ—Ä—É–≤–∞—Ç–∏ —Ñ–∞–π–ª/–ø–∞–ø–∫—É"""
    name = path.name

    # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ç–æ—á–Ω–æ–≥–æ –∑–±—ñ–≥—É
    if name in IGNORE_PATTERNS:
        return True

    # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è
    if path.suffix in IGNORE_PATTERNS:
        return True

    # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø—Ä–∏—Ö–æ–≤–∞–Ω–∏—Ö —Ñ–∞–π–ª—ñ–≤ (–∫—Ä—ñ–º .env.example)
    if name.startswith('.') and name != '.env.example':
        return True

    return False


def is_text_file(path: Path) -> bool:
    """–ü–µ—Ä–µ–≤—ñ—Ä—è—î, —á–∏ —î —Ñ–∞–π–ª —Ç–µ–∫—Å—Ç–æ–≤–∏–º"""
    # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è
    if path.suffix.lower() in TEXT_EXTENSIONS:
        return True

    # –§–∞–π–ª–∏ –±–µ–∑ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è, —è–∫—ñ –∑–∞–∑–≤–∏—á–∞–π —Ç–µ–∫—Å—Ç–æ–≤—ñ
    if path.suffix == '' and path.name in {'Dockerfile', 'Makefile', 'README', 'LICENSE'}:
        return True

    return False


def get_tree_structure(root_path: Path, prefix: str = "", is_last: bool = True) -> list:
    """–ì–µ–Ω–µ—Ä—É—î –¥–µ—Ä–µ–≤–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ –ø—Ä–æ—î–∫—Ç—É"""
    lines = []

    try:
        items = sorted(root_path.iterdir(), key=lambda x: (not x.is_dir(), x.name.lower()))
        items = [item for item in items if not should_ignore(item)]

        for i, item in enumerate(items):
            is_last_item = i == len(items) - 1
            current_prefix = "‚îî‚îÄ‚îÄ " if is_last_item else "‚îú‚îÄ‚îÄ "
            lines.append(f"{prefix}{current_prefix}{item.name}{'/' if item.is_dir() else ''}")

            if item.is_dir():
                extension = "    " if is_last_item else "‚îÇ   "
                lines.extend(get_tree_structure(item, prefix + extension, is_last_item))

    except PermissionError:
        pass

    return lines


def read_file_content(file_path: Path) -> str:
    """–ß–∏—Ç–∞—î –≤–º—ñ—Å—Ç —Ñ–∞–π–ª—É"""
    try:
        # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ä–æ–∑–º—ñ—Ä—É
        if file_path.stat().st_size > MAX_FILE_SIZE:
            return f"[–§–∞–π–ª –∑–∞–Ω–∞–¥—Ç–æ –≤–µ–ª–∏–∫–∏–π: {file_path.stat().st_size / 1024:.1f} KB]"

        # –°–ø—Ä–æ–±–∞ –ø—Ä–æ—á–∏—Ç–∞—Ç–∏ —è–∫ —Ç–µ–∫—Å—Ç
        with open(file_path, 'r', encoding='utf-8') as f:
            return f.read()
    except UnicodeDecodeError:
        # –Ø–∫—â–æ –Ω–µ –≤–¥–∞–ª–æ—Å—è –ø—Ä–æ—á–∏—Ç–∞—Ç–∏ —è–∫ UTF-8
        try:
            with open(file_path, 'r', encoding='cp1251') as f:
                return f.read()
        except:
            return "[–ù–µ –≤–¥–∞–ª–æ—Å—è –ø—Ä–æ—á–∏—Ç–∞—Ç–∏ —Ñ–∞–π–ª - –±—ñ–Ω–∞—Ä–Ω–∏–π –∞–±–æ –Ω–µ–≤—ñ–¥–æ–º–µ –∫–æ–¥—É–≤–∞–Ω–Ω—è]"
    except Exception as e:
        return f"[–ü–æ–º–∏–ª–∫–∞ —á–∏—Ç–∞–Ω–Ω—è: {str(e)}]"


def collect_files(root_path: Path) -> list:
    """–ó–±–∏—Ä–∞—î –≤—Å—ñ —Ç–µ–∫—Å—Ç–æ–≤—ñ —Ñ–∞–π–ª–∏ –ø—Ä–æ—î–∫—Ç—É"""
    files = []

    for item in root_path.rglob('*'):
        if item.is_file() and not should_ignore(item) and is_text_file(item):
            # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞, —â–æ –≤—Å—ñ –±–∞—Ç—å–∫—ñ–≤—Å—å–∫—ñ –ø–∞–ø–∫–∏ –Ω–µ —ñ–≥–Ω–æ—Ä—É—é—Ç—å—Å—è
            if not any(should_ignore(parent) for parent in item.parents):
                files.append(item)

    return sorted(files)


def generate_project_export(project_path: str, output_file: str = None):
    """–ì–µ–Ω–µ—Ä—É—î –ø–æ–≤–Ω–∏–π –µ–∫—Å–ø–æ—Ä—Ç –ø—Ä–æ—î–∫—Ç—É"""
    root = Path(project_path).resolve()

    if not root.exists():
        print(f"‚ùå –ü–æ–º–∏–ª–∫–∞: –®–ª—è—Ö '{project_path}' –Ω–µ —ñ—Å–Ω—É—î!")
        return

    if output_file is None:
        timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
        output_file = f"project_export_{timestamp}.txt"

    print(f"üìÅ –ê–Ω–∞–ª—ñ–∑ –ø—Ä–æ—î–∫—Ç—É: {root.name}")
    print(f"üìù –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –µ–∫—Å–ø–æ—Ä—Ç—É...")

    with open(output_file, 'w', encoding='utf-8') as f:
        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        f.write("=" * 80 + "\n")
        f.write(f"–ï–ö–°–ü–û–†–¢ –ü–†–û–Ñ–ö–¢–£: {root.name}\n")
        f.write(f"–î–∞—Ç–∞: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}\n")
        f.write(f"–®–ª—è—Ö: {root}\n")
        f.write("=" * 80 + "\n\n")

        # –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ—î–∫—Ç—É
        f.write("üìÇ –°–¢–†–£–ö–¢–£–†–ê –ü–†–û–Ñ–ö–¢–£\n")
        f.write("-" * 80 + "\n")
        f.write(f"{root.name}/\n")
        tree_lines = get_tree_structure(root)
        f.write("\n".join(tree_lines))
        f.write("\n\n")

        # –ó–±—ñ—Ä —Ñ–∞–π–ª—ñ–≤
        files = collect_files(root)

        f.write(f"üìÑ –í–ú–Ü–°–¢ –§–ê–ô–õ–Ü–í ({len(files)} —Ñ–∞–π–ª—ñ–≤)\n")
        f.write("=" * 80 + "\n\n")

        # –í–º—ñ—Å—Ç –∫–æ–∂–Ω–æ–≥–æ —Ñ–∞–π–ª—É
        for i, file_path in enumerate(files, 1):
            relative_path = file_path.relative_to(root)

            print(f"  [{i}/{len(files)}] {relative_path}")

            f.write("\n" + "=" * 80 + "\n")
            f.write(f"–§–∞–π–ª {i}/{len(files)}: {relative_path}\n")
            f.write("-" * 80 + "\n")

            content = read_file_content(file_path)
            f.write(content)
            f.write("\n")

        # –ü—ñ–¥—Å—É–º–æ–∫
        f.write("\n" + "=" * 80 + "\n")
        f.write("–ö–Ü–ù–ï–¶–¨ –ï–ö–°–ü–û–†–¢–£\n")
        f.write("=" * 80 + "\n")

    file_size = Path(output_file).stat().st_size
    print(f"\n‚úÖ –ï–∫—Å–ø–æ—Ä—Ç –∑–∞–≤–µ—Ä—à–µ–Ω–æ!")
    print(f"üìÑ –§–∞–π–ª: {output_file}")
    print(f"üìä –†–æ–∑–º—ñ—Ä: {file_size / 1024:.1f} KB")
    print(f"üìÅ –§–∞–π–ª—ñ–≤ –æ–±—Ä–æ–±–ª–µ–Ω–æ: {len(files)}")


if __name__ == "__main__":
    import sys

    # –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è: python export_project.py [—à–ª—è—Ö_–¥–æ_–ø—Ä–æ—î–∫—Ç—É] [–≤–∏—Ö—ñ–¥–Ω–∏–π_—Ñ–∞–π–ª]
    project_path = sys.argv[1] if len(sys.argv) > 1 else "."
    output_file = sys.argv[2] if len(sys.argv) > 2 else None

    generate_project_export(project_path, output_file)


================================================================================
–§–∞–π–ª 3/20: GitCommitTool.py
--------------------------------------------------------------------------------
import customtkinter as ctk
from tkinter import messagebox, scrolledtext
import subprocess
import os
import re
from pathlib import Path
from datetime import datetime
from packaging.version import parse as parse_version


class GitCommitTool(ctk.CTk):
    def __init__(self):
        super().__init__()

        self.title("Git Commit Tool")
        self.geometry("600x750")
        self.resizable(False, False)
        self.is_running = False  # –ü—Ä–∞–ø–æ—Ä–µ—Ü—å –¥–ª—è –±–ª–æ–∫—É–≤–∞–Ω–Ω—è UI

        # –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç–µ–º–∏
        ctk.set_appearance_mode("dark")  # –ó–º—ñ–Ω–µ–Ω–æ –Ω–∞ —Ç–µ–º–Ω—É
        ctk.set_default_color_theme("blue")

        # –û—Ç—Ä–∏–º–∞–Ω–Ω—è –ø–æ—Ç–æ—á–Ω–æ—ó –≤–µ—Ä—Å—ñ—ó
        self.current_version = self.get_current_version()

        # –°–ø–∏—Å–æ–∫ –µ–ª–µ–º–µ–Ω—Ç—ñ–≤ UI –¥–ª—è –±–ª–æ–∫—É–≤–∞–Ω–Ω—è
        self.interactive_widgets = []

        self.setup_ui()
        self.toggle_version_fields()  # –ü–æ—á–∞—Ç–∫–æ–≤–µ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —Å—Ç–∞–Ω—É UI

    def setup_ui(self):
        """(–û–ù–û–í–õ–ï–ù–û) –°—Ç–≤–æ—Ä–µ–Ω–Ω—è UI"""

        main_frame = ctk.CTkFrame(self, fg_color="transparent")
        main_frame.pack(fill="both", expand=True, padx=20, pady=15)

        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        title_label = ctk.CTkLabel(
            main_frame,
            text="Git Commit Tool",
            font=ctk.CTkFont(size=24, weight="bold")
        )
        title_label.pack(pady=10)

        # –ü–æ—Ç–æ—á–Ω–∞ –≤–µ—Ä—Å—ñ—è
        version_frame = ctk.CTkFrame(main_frame)
        version_frame.pack(pady=10, fill="x")

        ctk.CTkLabel(
            version_frame,
            text="–ü–æ—Ç–æ—á–Ω–∞ –≤–µ—Ä—Å—ñ—è:",
            font=ctk.CTkFont(size=12, weight="bold")
        ).pack(side="left", padx=(10, 0))

        self.current_version_label = ctk.CTkLabel(
            version_frame,
            text=f"v{self.current_version}",
            font=ctk.CTkFont(size=12),
            text_color="gray"
        )
        self.current_version_label.pack(side="left", padx=10)

        # –ö–æ–º–µ–Ω—Ç–∞—Ä
        ctk.CTkLabel(
            main_frame,
            text="–ö–æ–º–µ–Ω—Ç–∞—Ä (commit message):",
            font=ctk.CTkFont(size=12, weight="bold")
        ).pack(anchor="w", pady=(10, 5))

        self.comment_entry = ctk.CTkEntry(
            main_frame,
            placeholder_text="–û–ø–∏—à—ñ—Ç—å –≤–∞—à—ñ –∑–º—ñ–Ω–∏...",
            height=40,
            font=ctk.CTkFont(size=11)
        )
        self.comment_entry.pack(fill="x", pady=(0, 15))
        self.interactive_widgets.append(self.comment_entry)

        # --- –ë–ª–æ–∫ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –≤–µ—Ä—Å—ñ—ó ---

        # –ß–µ–∫–±–æ–∫—Å –¥–ª—è —Ç–∞–≥—É
        self.tag_checkbox = ctk.CTkCheckBox(
            main_frame,
            text="–°—Ç–≤–æ—Ä–∏—Ç–∏ –Ω–æ–≤–∏–π —Ç–µ–≥ –≤–µ—Ä—Å—ñ—ó",
            font=ctk.CTkFont(size=11),
            command=self.toggle_version_fields
        )
        self.tag_checkbox.pack(anchor="w", pady=(0, 10))
        self.tag_checkbox.select()
        self.interactive_widgets.append(self.tag_checkbox)

        # –ù–æ–≤–∞ –≤–µ—Ä—Å—ñ—è
        self.version_frame_new = ctk.CTkFrame(main_frame)
        self.version_frame_new.pack(fill="x", pady=(0, 15))

        ctk.CTkLabel(
            self.version_frame_new,
            text="–ù–æ–≤–∞ –≤–µ—Ä—Å—ñ—è (–¥–ª—è —Ç–∞–≥—É):",
            font=ctk.CTkFont(size=12, weight="bold")
        ).pack(anchor="w", pady=(0, 5), padx=10)

        version_entry_frame = ctk.CTkFrame(self.version_frame_new, fg_color="transparent")
        version_entry_frame.pack(fill="x", padx=10)

        ctk.CTkLabel(
            version_entry_frame,
            text="v",
            font=ctk.CTkFont(size=11)
        ).pack(side="left", padx=(0, 5))

        self.version_entry = ctk.CTkEntry(
            version_entry_frame,
            placeholder_text="1.1.0",
            height=35,
            font=ctk.CTkFont(size=11)
        )
        self.version_entry.pack(side="left", fill="x", expand=True)
        self.version_entry.insert(0, self.current_version)  # –ü–æ–ø–µ—Ä–µ–¥–Ω—å–æ –∑–∞–ø–æ–≤–Ω—é—î–º–æ
        self.interactive_widgets.append(self.version_entry)

        # (–ù–û–í–ï) –ö–Ω–æ–ø–∫–∏ –¥–ª—è "–±–∞–º–ø—É" –≤–µ—Ä—Å—ñ—ó
        self.bump_button_frame = ctk.CTkFrame(self.version_frame_new, fg_color="transparent")
        self.bump_button_frame.pack(fill="x", padx=10, pady=10)

        bump_patch_btn = ctk.CTkButton(
            self.bump_button_frame, text="Patch (+0.0.1)",
            command=lambda: self.bump_version('patch'),
            font=ctk.CTkFont(size=10, weight="bold"), height=25
        )
        bump_patch_btn.pack(side="left", fill="x", expand=True, padx=2)

        bump_minor_btn = ctk.CTkButton(
            self.bump_button_frame, text="Minor (+0.1.0)",
            command=lambda: self.bump_version('minor'),
            font=ctk.CTkFont(size=10, weight="bold"), height=25
        )
        bump_minor_btn.pack(side="left", fill="x", expand=True, padx=2)

        bump_major_btn = ctk.CTkButton(
            self.bump_button_frame, text="Major (+1.0.0)",
            command=lambda: self.bump_version('major'),
            font=ctk.CTkFont(size=10, weight="bold"), height=25
        )
        bump_major_btn.pack(side="left", fill="x", expand=True, padx=2)

        self.interactive_widgets.extend([bump_patch_btn, bump_minor_btn, bump_major_btn])

        # –ö–Ω–æ–ø–∫–∏
        button_frame = ctk.CTkFrame(main_frame, fg_color="transparent")
        button_frame.pack(fill="x", pady=(0, 15))

        self.commit_btn = ctk.CTkButton(
            button_frame,
            text="‚úÖ Commit & Push",
            command=self.commit_and_push_thread,
            font=ctk.CTkFont(size=12, weight="bold"),
            height=45,
            corner_radius=10
        )
        self.commit_btn.pack(side="left", fill="both", expand=True, padx=(0, 5))
        self.interactive_widgets.append(self.commit_btn)

        clear_btn = ctk.CTkButton(
            button_frame,
            text="üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç–∏",
            command=self.clear_fields,
            font=ctk.CTkFont(size=12),
            height=45,
            corner_radius=10,
            fg_color="gray30",
            hover_color="gray50"
        )
        clear_btn.pack(side="left", fill="both", expand=True, padx=(5, 0))
        self.interactive_widgets.append(clear_btn)

        # –õ–æ–≥–∏
        ctk.CTkLabel(
            main_frame,
            text="–õ–æ–≥–∏ –æ–ø–µ—Ä–∞—Ü—ñ–π:",
            font=ctk.CTkFont(size=11, weight="bold")
        ).pack(anchor="w", pady=(10, 5))

        log_frame = ctk.CTkFrame(main_frame, fg_color="transparent")
        log_frame.pack(fill="both", expand=True)

        self.log_text = scrolledtext.ScrolledText(
            log_frame,
            height=10,
            width=70,
            font=("Courier", 10),
            bg="#2B2B2B",  # –¢–µ–º–Ω–∏–π —Ñ–æ–Ω
            fg="#E0E0E0",  # –°–≤—ñ—Ç–ª–∏–π —Ç–µ–∫—Å—Ç
            relief="solid",
            borderwidth=1,
            bd=0
        )
        self.log_text.pack(fill="both", expand=True)
        # (–ù–û–í–ï) –¢–µ–≥–∏ –¥–ª—è –∫–æ–ª—å–æ—Ä—ñ–≤
        self.log_text.tag_config("info", foreground="#89CFF0")
        self.log_text.tag_config("success", foreground="#7FFF7F")
        self.log_text.tag_config("error", foreground="#FF6B6B")
        self.log_text.tag_config("warning", foreground="#FFA500")

        # –°—Ç–∞—Ç—É—Å
        self.status_label = ctk.CTkLabel(
            main_frame,
            text="–ì–æ—Ç–æ–≤–æ –¥–æ —Ä–æ–±–æ—Ç–∏",
            font=ctk.CTkFont(size=10),
            text_color="gray"
        )
        self.status_label.pack(pady=(10, 0))

    def get_current_version(self):
        """–û—Ç—Ä–∏–º–∞–Ω–Ω—è –ø–æ—Ç–æ—á–Ω–æ—ó –≤–µ—Ä—Å—ñ—ó –∑ version.txt"""
        try:
            with open("version.txt", "r") as f:
                version = f.read().strip()
                # (–ù–û–í–ï) –í–∞–ª—ñ–¥–∞—Ü—ñ—è –≤–µ—Ä—Å—ñ—ó
                if re.match(r"^\d+\.\d+\.\d+$", version):
                    return version
                else:
                    return "1.0.0"  # Fallback
        except:
            return "1.0.0"

    def toggle_version_fields(self):
        """(–ù–û–í–ï) –í–º–∏–∫–∞—î/–≤–∏–º–∏–∫–∞—î –±–ª–æ–∫ –≤–µ—Ä—Å—ñ—ó"""
        is_enabled = self.tag_checkbox.get()
        state = "normal" if is_enabled else "disabled"

        self.version_entry.configure(state=state)
        for btn in self.bump_button_frame.winfo_children():
            btn.configure(state=state)

        # (–ù–û–í–ï) –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –ø—Ä–æ–ø–æ–Ω—É—î–º–æ patch-bump
        if is_enabled:
            self.bump_version('patch', auto_fill=True)

    def bump_version(self, part="patch", auto_fill=False):
        """(–ù–û–í–ï) –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∑–±—ñ–ª—å—à—É—î –≤–µ—Ä—Å—ñ—é"""
        try:
            current_v = parse_version(self.get_current_version())
            parts = list(current_v.release)

            if part == 'major':
                parts[0] += 1
                parts[1] = 0
                parts[2] = 0
            elif part == 'minor':
                parts[1] += 1
                parts[2] = 0
            else:  # patch
                parts[2] += 1

            new_version = f"{parts[0]}.{parts[1]}.{parts[2]}"

            if not auto_fill or self.version_entry.get() != new_version:
                self.version_entry.delete(0, "end")
                self.version_entry.insert(0, new_version)

        except Exception as e:
            self.log_message(f"‚ùå –ü–æ–º–∏–ª–∫–∞ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –≤–µ—Ä—Å—ñ—ó: {str(e)}", "error")

    def log_message(self, message, tag="info"):
        """(–û–ù–û–í–õ–ï–ù–û) –î–æ–¥–∞–Ω–Ω—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –¥–æ –ª–æ–≥—ñ–≤ –∑ —Ç–µ–≥–æ–º"""
        timestamp = datetime.now().strftime("%H:%M:%S")
        self.log_text.configure(state="normal")
        self.log_text.insert("end", f"[{timestamp}] {message}\n", tag)
        self.log_text.configure(state="disabled")
        self.log_text.see("end")
        self.update_idletasks()

    def set_ui_state(self, is_enabled):
        """(–ù–û–í–ï) –í–º–∏–∫–∞—î/–≤–∏–º–∏–∫–∞—î –≤–µ—Å—å UI"""
        state = "normal" if is_enabled else "disabled"
        for widget in self.interactive_widgets:
            widget.configure(state=state)
        self.is_running = not is_enabled
        if is_enabled:
            self.toggle_version_fields()  # –ü–æ–≤–µ—Ä—Ç–∞—î–º–æ –∫–æ—Ä–µ–∫—Ç–Ω–∏–π —Å—Ç–∞–Ω –ø–æ–ª—ñ–≤ –≤–µ—Ä—Å—ñ—ó

    def run_git_command(self, command, log_output=True):
        """(–û–ù–û–í–õ–ï–ù–û) –í–∏–∫–æ–Ω–∞–Ω–Ω—è git –∫–æ–º–∞–Ω–¥–∏, –ø–æ–≤–µ—Ä—Ç–∞—î (success, output)"""
        self.log_message(f"$ {command}", "info")
        try:
            result = subprocess.run(
                command,
                shell=True,
                capture_output=True,
                text=True,
                encoding='utf-8',  # –í—Å—Ç–∞–Ω–æ–≤–ª—é—î–º–æ –∫–æ–¥—É–≤–∞–Ω–Ω—è
                cwd=os.getcwd()
            )

            if result.returncode == 0:
                if result.stdout and log_output:
                    self.log_message(f"{result.stdout.strip()}", "success")
                return True, result.stdout.strip()
            else:
                error_msg = result.stderr.strip() if result.stderr else "–ù–µ–≤—ñ–¥–æ–º–∞ –ø–æ–º–∏–ª–∫–∞"
                if log_output:
                    self.log_message(f"‚ùå –ü–æ–º–∏–ª–∫–∞: {error_msg}", "error")
                return False, error_msg
        except Exception as e:
            self.log_message(f"‚ùå –í–∏–Ω—è—Ç–æ–∫: {str(e)}", "error")
            return False, str(e)

    def get_current_branch(self):
        """(–ù–û–í–ï) –û—Ç—Ä–∏–º—É—î –ø–æ—Ç–æ—á–Ω—É –≥—ñ–ª–∫—É git"""
        success, output = self.run_git_command("git rev-parse --abbrev-ref HEAD", log_output=False)
        if success:
            return output
        return "main"  # Fallback

    def commit_and_push_thread(self):
        """(–ù–û–í–ï) –ó–∞–ø—É—Å–∫–∞—î –ø—Ä–æ—Ü–µ—Å –≤ –æ–∫—Ä–µ–º–æ–º—É –ø–æ—Ç–æ—Ü—ñ, —â–æ–± UI –Ω–µ "–∑–∞–≤–∏—Å–∞–≤" """
        if self.is_running:
            self.log_message("‚è≥ –û–ø–µ—Ä–∞—Ü—ñ—è –≤–∂–µ –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è...", "warning")
            return

        # –ó–∞–ø—É—Å–∫–∞—î–º–æ –≤ –æ–∫—Ä–µ–º–æ–º—É –ø–æ—Ç–æ—Ü—ñ
        import threading
        threading.Thread(target=self.commit_and_push, daemon=True).start()

    def commit_and_push(self):
        """(–û–ù–û–í–õ–ï–ù–û) –û—Å–Ω–æ–≤–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è - commit, tag —ñ push"""

        self.set_ui_state(False)
        self.status_label.configure(text="‚è≥ –û–±—Ä–æ–±–∫–∞...")

        try:
            comment = self.comment_entry.get().strip()
            new_version = self.version_entry.get().strip()
            create_tag = self.tag_checkbox.get()

            # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∏
            if not comment:
                messagebox.showwarning("–ü–æ–º–∏–ª–∫–∞", "–ù–∞–ø–∏—à—ñ—Ç—å –∫–æ–º–µ–Ω—Ç–∞—Ä –¥–æ –∫–æ–º—ñ—Ç—é!")
                self.log_message("‚ùå –ö–æ–º–µ–Ω—Ç–∞—Ä –Ω–µ –º–æ–∂–µ –±—É—Ç–∏ –ø–æ—Ä–æ–∂–Ω—ñ–º", "error")
                return

            if create_tag and not new_version:
                messagebox.showwarning("–ü–æ–º–∏–ª–∫–∞", "–ù–∞–ø–∏—à—ñ—Ç—å –Ω–æ–≤—É –≤–µ—Ä—Å—ñ—é –¥–ª—è —Ç–∞–≥—É!")
                self.log_message("‚ùå –ù–æ–º–µ—Ä –≤–µ—Ä—Å—ñ—ó –Ω–µ –º–æ–∂–µ –±—É—Ç–∏ –ø–æ—Ä–æ–∂–Ω—ñ–º", "error")
                return

            self.log_message("=" * 50, "info")
            self.log_message("üöÄ –†–æ–∑–ø–æ—á–∏–Ω–∞—î–º–æ commit & push –ø—Ä–æ—Ü–µ—Å...", "info")
            self.log_message("=" * 50, "info")

            # –ö—Ä–æ–∫ 1: –û—Ç—Ä–∏–º–∞–Ω–Ω—è –ø–æ—Ç–æ—á–Ω–æ—ó –≥—ñ–ª–∫–∏
            self.log_message("\nüìã –ö—Ä–æ–∫ 1: –í–∏–∑–Ω–∞—á–µ–Ω–Ω—è –ø–æ—Ç–æ—á–Ω–æ—ó –≥—ñ–ª–∫–∏...", "info")
            current_branch = self.get_current_branch()
            self.log_message(f"–ü–æ—Ç–æ—á–Ω–∞ –≥—ñ–ª–∫–∞: {current_branch}", "success")

            # –ö—Ä–æ–∫ 2: –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å—É
            self.log_message("\nüìã –ö—Ä–æ–∫ 2: –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å—É —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—é...", "info")
            success, status_output = self.run_git_command("git status --short")
            if not status_output:
                self.log_message("‚úÖ –ù–µ–º–∞—î –∑–º—ñ–Ω –¥–ª—è –∫–æ–º—ñ—Ç—É. –í—Å–µ —á–∏—Å—Ç–æ!", "success")
                self.status_label.configure(text="‚úÖ –ù–µ–º–∞—î –∑–º—ñ–Ω")
                return

            # –ö—Ä–æ–∫ 3: –î–æ–¥–∞–≤–∞–Ω–Ω—è –≤—Å—ñ—Ö —Ñ–∞–π–ª—ñ–≤
            self.log_message("\nüì¶ –ö—Ä–æ–∫ 3: –î–æ–¥–∞–≤–∞–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤ (git add .)...", "info")
            if not self.run_git_command("git add .")[0]:
                self.status_label.configure(text="‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ 'git add'")
                messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–ù–µ –≤–¥–∞–ª–æ—Å—è –¥–æ–¥–∞—Ç–∏ —Ñ–∞–π–ª–∏!")
                return

            # –ö—Ä–æ–∫ 4: –ö–æ–º—ñ—Ç
            self.log_message("\nüíæ –ö—Ä–æ–∫ 4: –ö–æ–º—ñ—Ç—É–≤–∞–Ω–Ω—è –∑–º—ñ–Ω...", "info")
            if not self.run_git_command(f'git commit -m "{comment}"')[0]:
                self.status_label.configure(text="‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –∫–æ–º—ñ—Ç—É–≤–∞–Ω–Ω—ñ")
                # (–º–æ–∂–ª–∏–≤–æ, –Ω–µ –±—É–ª–æ –∑–º—ñ–Ω)
                return

            # –ö—Ä–æ–∫ 5: Push
            self.log_message(f"\n‚¨ÜÔ∏è  –ö—Ä–æ–∫ 5: –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –Ω–∞ GitHub (git push origin {current_branch})...", "info")
            if not self.run_git_command(f"git push origin {current_branch}")[0]:
                self.status_label.configure(text="‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ 'git push'")
                messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–ù–µ –≤–¥–∞–ª–æ—Å—è –≤—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ –Ω–∞ GitHub!")
                return

            # –ö—Ä–æ–∫ 6: –¢–µ–≥ (—è–∫—â–æ –ø–æ—Ç—Ä—ñ–±–µ–Ω)
            if create_tag:
                self.log_message(f"\nüè∑Ô∏è  –ö—Ä–æ–∫ 6: –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–∞–≥—É v{new_version}...", "info")
                if not self.run_git_command(f"git tag v{new_version}")[0]:
                    self.status_label.configure(text="‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—ñ —Ç–∞–≥—É")
                    messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–ù–µ –≤–¥–∞–ª–æ—Å—è —Å—Ç–≤–æ—Ä–∏—Ç–∏ —Ç–µ–≥! –ú–æ–∂–ª–∏–≤–æ, –≤—ñ–Ω –≤–∂–µ —ñ—Å–Ω—É—î.")
                    return

                self.log_message(f"\n‚¨ÜÔ∏è  –ö—Ä–æ–∫ 7: –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ç–∞–≥—É –Ω–∞ GitHub...", "info")
                if not self.run_git_command(f"git push origin v{new_version}")[0]:
                    self.status_label.configure(text="‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ 'git push' —Ç–∞–≥—É")
                    messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–ù–µ –≤–¥–∞–ª–æ—Å—è –≤—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ —Ç–µ–≥!")
                    return

                # –û–Ω–æ–≤–ª–µ–Ω–Ω—è version.txt
                self.log_message("\nüìù –ö—Ä–æ–∫ 8: –û–Ω–æ–≤–ª–µ–Ω–Ω—è version.txt...", "info")
                try:
                    with open("version.txt", "w") as f:
                        f.write(new_version)
                    self.log_message("‚úÖ version.txt –æ–Ω–æ–≤–ª–µ–Ω–æ", "success")
                    self.current_version = new_version
                    self.current_version_label.configure(text=f"v{self.current_version}")
                except Exception as e:
                    self.log_message(f"‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –æ–Ω–æ–≤–ª–µ–Ω–Ω—ñ version.txt: {str(e)}", "error")

            self.log_message("\n" + "=" * 50, "success")
            self.log_message("‚úÖ –í–°–ï –£–°–ü–Ü–®–ù–û! GitHub Actions –ø–æ—á–Ω–µ –∫–æ–º–ø—ñ–ª—é–≤–∞—Ç–∏...", "success")
            self.log_message("=" * 50, "success")

            self.status_label.configure(text="‚úÖ –£—Å–ø—ñ—à–Ω–æ! GitHub Actions –∑–∞–ø—É—â–µ–Ω–æ")
            messagebox.showinfo(
                "–£—Å–ø—ñ—Ö",
                f"‚úÖ –ö–æ–º—ñ—Ç —É—Å–ø—ñ—à–Ω–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ!\n\n"
                f"–ö–æ–º–µ–Ω—Ç–∞—Ä: {comment}\n"
                + (f"–í–µ—Ä—Å—ñ—è: v{new_version}\n\nGitHub Actions –ø–æ—á–Ω–µ –∫–æ–º–ø—ñ–ª—é–≤–∞—Ç–∏ EXE..." if create_tag else "")
            )

            self.clear_fields()

        finally:
            # (–ù–û–í–ï) –ó–∞–≤–∂–¥–∏ –≤–º–∏–∫–∞—î–º–æ UI –Ω–∞–∑–∞–¥, –Ω–∞–≤—ñ—Ç—å —è–∫—â–æ –±—É–ª–∞ –ø–æ–º–∏–ª–∫–∞
            self.set_ui_state(True)
            if '–ü–æ–º–∏–ª–∫–∞' not in self.status_label.cget("text"):
                self.status_label.configure(text="–ì–æ—Ç–æ–≤–æ –¥–æ —Ä–æ–±–æ—Ç–∏")

    def clear_fields(self):
        """–û—á–∏—Å—Ç–∫–∞ –ø–æ–ª—ñ–≤"""
        self.comment_entry.delete(0, "end")
        self.version_entry.delete(0, "end")
        self.tag_checkbox.select()
        self.toggle_version_fields()  # –û–Ω–æ–≤–ª—é—î–º–æ —Å—Ç–∞–Ω –ø–æ–ª—ñ–≤ –≤–µ—Ä—Å—ñ—ó
        self.status_label.configure(text="–ì–æ—Ç–æ–≤–æ –¥–æ —Ä–æ–±–æ—Ç–∏")


def main():
    app = GitCommitTool()
    app.mainloop()


if __name__ == "__main__":
    main()

================================================================================
–§–∞–π–ª 4/20: project_export_20251110_104446.txt
--------------------------------------------------------------------------------
================================================================================
–ï–ö–°–ü–û–†–¢ –ü–†–û–Ñ–ö–¢–£: RemoteHand
–î–∞—Ç–∞: 2025-11-10 10:44:46
–®–ª—è—Ö: D:\Python Projects\Prego\RemoteHand
================================================================================

üìÇ –°–¢–†–£–ö–¢–£–†–ê –ü–†–û–Ñ–ö–¢–£
--------------------------------------------------------------------------------
RemoteHand/
‚îú‚îÄ‚îÄ assets/
‚îÇ   ‚îî‚îÄ‚îÄ icon.ico
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ anydesk_manager.py
‚îÇ   ‚îú‚îÄ‚îÄ config.py
‚îÇ   ‚îú‚îÄ‚îÄ config_manager.py
‚îÇ   ‚îú‚îÄ‚îÄ main.py
‚îÇ   ‚îú‚îÄ‚îÄ network_test.py
‚îÇ   ‚îú‚îÄ‚îÄ rdp_manager.py
‚îÇ   ‚îú‚îÄ‚îÄ set_anydesk_password.py
‚îÇ   ‚îú‚îÄ‚îÄ setup_wizard.py
‚îÇ   ‚îú‚îÄ‚îÄ telegram_api.py
‚îÇ   ‚îú‚îÄ‚îÄ telegram_helper.py
‚îÇ   ‚îú‚îÄ‚îÄ update.bat
‚îÇ   ‚îú‚îÄ‚îÄ updater.py
‚îÇ   ‚îî‚îÄ‚îÄ utils.py
‚îú‚îÄ‚îÄ .env.example
‚îú‚îÄ‚îÄ 23.88.7.196_admin_session.rdp
‚îú‚îÄ‚îÄ dev_run.py
‚îú‚îÄ‚îÄ export.py
‚îú‚îÄ‚îÄ GitCommitTool.py
‚îú‚îÄ‚îÄ project_export_20251110_104446.txt
‚îú‚îÄ‚îÄ README.md
‚îú‚îÄ‚îÄ RemoteHand.spec
‚îú‚îÄ‚îÄ requirements.txt
‚îú‚îÄ‚îÄ version.txt
‚îú‚îÄ‚îÄ version_info.txt
‚îî‚îÄ‚îÄ –ê–∫—Ç–∏–≤–∞—Ü—ñ—è —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞.txt

üìÑ –í–ú–Ü–°–¢ –§–ê–ô–õ–Ü–í (21 —Ñ–∞–π–ª—ñ–≤)
================================================================================


================================================================================
–§–∞–π–ª 1/21: dev_run.py
--------------------------------------------------------------------------------
"""
DEV_RUN.PY - –õ–æ–∫–∞–ª—å–Ω–µ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è
"""

import sys
import os

# –í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ DEV —Ä–µ–∂–∏–º
os.environ['REMOTEHAND_DEV_MODE'] = '1'

# –î–æ–¥–∞—Ç–∏ src –≤ path
sys.path.insert(0, os.path.join(os.path.dirname(__file__), 'src'))

print("–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π...")
import subprocess
subprocess.run([sys.executable, "-m", "pip", "install", "-r", "requirements.txt", "-q"],
               capture_output=True)

print("üîß –ó–∞–ø—É—Å–∫ —É DEV —Ä–µ–∂–∏–º—ñ...")

# –ü—Ä—è–º–æ –∑–∞–ø—É—Å—Ç–∏—Ç–∏ main
if __name__ == "__main__":
    import main
    main.main()


================================================================================
–§–∞–π–ª 2/21: export.py
--------------------------------------------------------------------------------
#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Project Structure Exporter
–°—Ç–≤–æ—Ä—é—î –¥–µ—Ç–∞–ª—å–Ω–∏–π –æ–ø–∏—Å —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ –ø—Ä–æ—î–∫—Ç—É —Ç–∞ –≤–º—ñ—Å—Ç —Ñ–∞–π–ª—ñ–≤ —É –æ–¥–∏–Ω —Ñ–∞–π–ª
"""

import os
from pathlib import Path
from datetime import datetime

# –§–∞–π–ª–∏ —Ç–∞ –ø–∞–ø–∫–∏, —è–∫—ñ —Ç—Ä–µ–±–∞ —ñ–≥–Ω–æ—Ä—É–≤–∞—Ç–∏
IGNORE_PATTERNS = {
    # –ü–∞–ø–∫–∏
    '__pycache__', '.git', '.idea', '.vscode', 'node_modules',
    'venv', 'env', '.env', 'dist', 'build', '.pytest_cache',
    '.mypy_cache', 'htmlcov', '.coverage', 'logs', 'tmp',
    # –§–∞–π–ª–∏
    '.pyc', '.pyo', '.pyd', '.so', '.dll', '.dylib', '.exe',
    '.log', '.sqlite', '.db', '.pkl', '.pickle', '.DS_Store',
    'Thumbs.db', '.env', '.env.local', '.gitignore'
}

# –†–æ–∑—à–∏—Ä–µ–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤ –¥–ª—è —á–∏—Ç–∞–Ω–Ω—è (—Ç–µ–∫—Å—Ç–æ–≤—ñ —Ñ–∞–π–ª–∏)
TEXT_EXTENSIONS = {
    '.py', '.js', '.ts', '.jsx', '.tsx', '.html', '.css', '.scss',
    '.json', '.yaml', '.yml', '.toml', '.ini', '.cfg', '.conf',
    '.txt', '.md', '.rst', '.xml', '.sql', '.sh', '.bash',
    '.env.example', '.gitignore', 'Dockerfile', 'Makefile',
    '.java', '.c', '.cpp', '.h', '.go', '.rs', '.php', '.rb'
}

# –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∏–π —Ä–æ–∑–º—ñ—Ä —Ñ–∞–π–ª—É (1 MB)
MAX_FILE_SIZE = 1024 * 1024


def should_ignore(path: Path) -> bool:
    """–ü–µ—Ä–µ–≤—ñ—Ä—è—î, —á–∏ —Ç—Ä–µ–±–∞ —ñ–≥–Ω–æ—Ä—É–≤–∞—Ç–∏ —Ñ–∞–π–ª/–ø–∞–ø–∫—É"""
    name = path.name

    # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ç–æ—á–Ω–æ–≥–æ –∑–±—ñ–≥—É
    if name in IGNORE_PATTERNS:
        return True

    # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è
    if path.suffix in IGNORE_PATTERNS:
        return True

    # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø—Ä–∏—Ö–æ–≤–∞–Ω–∏—Ö —Ñ–∞–π–ª—ñ–≤ (–∫—Ä—ñ–º .env.example)
    if name.startswith('.') and name != '.env.example':
        return True

    return False


def is_text_file(path: Path) -> bool:
    """–ü–µ—Ä–µ–≤—ñ—Ä—è—î, —á–∏ —î —Ñ–∞–π–ª —Ç–µ–∫—Å—Ç–æ–≤–∏–º"""
    # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è
    if path.suffix.lower() in TEXT_EXTENSIONS:
        return True

    # –§–∞–π–ª–∏ –±–µ–∑ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è, —è–∫—ñ –∑–∞–∑–≤–∏—á–∞–π —Ç–µ–∫—Å—Ç–æ–≤—ñ
    if path.suffix == '' and path.name in {'Dockerfile', 'Makefile', 'README', 'LICENSE'}:
        return True

    return False


def get_tree_structure(root_path: Path, prefix: str = "", is_last: bool = True) -> list:
    """–ì–µ–Ω–µ—Ä—É—î –¥–µ—Ä–µ–≤–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ –ø—Ä–æ—î–∫—Ç—É"""
    lines = []

    try:
        items = sorted(root_path.iterdir(), key=lambda x: (not x.is_dir(), x.name.lower()))
        items = [item for item in items if not should_ignore(item)]

        for i, item in enumerate(items):
            is_last_item = i == len(items) - 1
            current_prefix = "‚îî‚îÄ‚îÄ " if is_last_item else "‚îú‚îÄ‚îÄ "
            lines.append(f"{prefix}{current_prefix}{item.name}{'/' if item.is_dir() else ''}")

            if item.is_dir():
                extension = "    " if is_last_item else "‚îÇ   "
                lines.extend(get_tree_structure(item, prefix + extension, is_last_item))

    except PermissionError:
        pass

    return lines


def read_file_content(file_path: Path) -> str:
    """–ß–∏—Ç–∞—î –≤–º—ñ—Å—Ç —Ñ–∞–π–ª—É"""
    try:
        # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ä–æ–∑–º—ñ—Ä—É
        if file_path.stat().st_size > MAX_FILE_SIZE:
            return f"[–§–∞–π–ª –∑–∞–Ω–∞–¥—Ç–æ –≤–µ–ª–∏–∫–∏–π: {file_path.stat().st_size / 1024:.1f} KB]"

        # –°–ø—Ä–æ–±–∞ –ø—Ä–æ—á–∏—Ç–∞—Ç–∏ —è–∫ —Ç–µ–∫—Å—Ç
        with open(file_path, 'r', encoding='utf-8') as f:
            return f.read()
    except UnicodeDecodeError:
        # –Ø–∫—â–æ –Ω–µ –≤–¥–∞–ª–æ—Å—è –ø—Ä–æ—á–∏—Ç–∞—Ç–∏ —è–∫ UTF-8
        try:
            with open(file_path, 'r', encoding='cp1251') as f:
                return f.read()
        except:
            return "[–ù–µ –≤–¥–∞–ª–æ—Å—è –ø—Ä–æ—á–∏—Ç–∞—Ç–∏ —Ñ–∞–π–ª - –±—ñ–Ω–∞—Ä–Ω–∏–π –∞–±–æ –Ω–µ–≤—ñ–¥–æ–º–µ –∫–æ–¥—É–≤–∞–Ω–Ω—è]"
    except Exception as e:
        return f"[–ü–æ–º–∏–ª–∫–∞ —á–∏—Ç–∞–Ω–Ω—è: {str(e)}]"


def collect_files(root_path: Path) -> list:
    """–ó–±–∏—Ä–∞—î –≤—Å—ñ —Ç–µ–∫—Å—Ç–æ–≤—ñ —Ñ–∞–π–ª–∏ –ø—Ä–æ—î–∫—Ç—É"""
    files = []

    for item in root_path.rglob('*'):
        if item.is_file() and not should_ignore(item) and is_text_file(item):
            # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞, —â–æ –≤—Å—ñ –±–∞—Ç—å–∫—ñ–≤—Å—å–∫—ñ –ø–∞–ø–∫–∏ –Ω–µ —ñ–≥–Ω–æ—Ä—É—é—Ç—å—Å—è
            if not any(should_ignore(parent) for parent in item.parents):
                files.append(item)

    return sorted(files)


def generate_project_export(project_path: str, output_file: str = None):
    """–ì–µ–Ω–µ—Ä—É—î –ø–æ–≤–Ω–∏–π –µ–∫—Å–ø–æ—Ä—Ç –ø—Ä–æ—î–∫—Ç—É"""
    root = Path(project_path).resolve()

    if not root.exists():
        print(f"‚ùå –ü–æ–º–∏–ª–∫–∞: –®–ª—è—Ö '{project_path}' –Ω–µ —ñ—Å–Ω—É—î!")
        return

    if output_file is None:
        timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
        output_file = f"project_export_{timestamp}.txt"

    print(f"üìÅ –ê–Ω–∞–ª—ñ–∑ –ø—Ä–æ—î–∫—Ç—É: {root.name}")
    print(f"üìù –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –µ–∫—Å–ø–æ—Ä—Ç—É...")

    with open(output_file, 'w', encoding='utf-8') as f:
        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        f.write("=" * 80 + "\n")
        f.write(f"–ï–ö–°–ü–û–†–¢ –ü–†–û–Ñ–ö–¢–£: {root.name}\n")
        f.write(f"–î–∞—Ç–∞: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}\n")
        f.write(f"–®–ª—è—Ö: {root}\n")
        f.write("=" * 80 + "\n\n")

        # –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ—î–∫—Ç—É
        f.write("üìÇ –°–¢–†–£–ö–¢–£–†–ê –ü–†–û–Ñ–ö–¢–£\n")
        f.write("-" * 80 + "\n")
        f.write(f"{root.name}/\n")
        tree_lines = get_tree_structure(root)
        f.write("\n".join(tree_lines))
        f.write("\n\n")

        # –ó–±—ñ—Ä —Ñ–∞–π–ª—ñ–≤
        files = collect_files(root)

        f.write(f"üìÑ –í–ú–Ü–°–¢ –§–ê–ô–õ–Ü–í ({len(files)} —Ñ–∞–π–ª—ñ–≤)\n")
        f.write("=" * 80 + "\n\n")

        # –í–º—ñ—Å—Ç –∫–æ–∂–Ω–æ–≥–æ —Ñ–∞–π–ª—É
        for i, file_path in enumerate(files, 1):
            relative_path = file_path.relative_to(root)

            print(f"  [{i}/{len(files)}] {relative_path}")

            f.write("\n" + "=" * 80 + "\n")
            f.write(f"–§–∞–π–ª {i}/{len(files)}: {relative_path}\n")
            f.write("-" * 80 + "\n")

            content = read_file_content(file_path)
            f.write(content)
            f.write("\n")

        # –ü—ñ–¥—Å—É–º–æ–∫
        f.write("\n" + "=" * 80 + "\n")
        f.write("–ö–Ü–ù–ï–¶–¨ –ï–ö–°–ü–û–†–¢–£\n")
        f.write("=" * 80 + "\n")

    file_size = Path(output_file).stat().st_size
    print(f"\n‚úÖ –ï–∫—Å–ø–æ—Ä—Ç –∑–∞–≤–µ—Ä—à–µ–Ω–æ!")
    print(f"üìÑ –§–∞–π–ª: {output_file}")
    print(f"üìä –†–æ–∑–º—ñ—Ä: {file_size / 1024:.1f} KB")
    print(f"üìÅ –§–∞–π–ª—ñ–≤ –æ–±—Ä–æ–±–ª–µ–Ω–æ: {len(files)}")


if __name__ == "__main__":
    import sys

    # –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è: python export_project.py [—à–ª—è—Ö_–¥–æ_–ø—Ä–æ—î–∫—Ç—É] [–≤–∏—Ö—ñ–¥–Ω–∏–π_—Ñ–∞–π–ª]
    project_path = sys.argv[1] if len(sys.argv) > 1 else "."
    output_file = sys.argv[2] if len(sys.argv) > 2 else None

    generate_project_export(project_path, output_file)


================================================================================
–§–∞–π–ª 3/21: GitCommitTool.py
--------------------------------------------------------------------------------
import customtkinter as ctk
from tkinter import messagebox, scrolledtext
import subprocess
import os
from pathlib import Path
from datetime import datetime


class GitCommitTool(ctk.CTk):
    def __init__(self):
        super().__init__()

        self.title("Git Commit Tool")
        self.geometry("600x700")
        self.resizable(False, False)

        # –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç–µ–º–∏
        ctk.set_appearance_mode("light")
        ctk.set_default_color_theme("blue")

        # –û—Ç—Ä–∏–º–∞–Ω–Ω—è –ø–æ—Ç–æ—á–Ω–æ—ó –≤–µ—Ä—Å—ñ—ó
        self.current_version = self.get_current_version()

        self.setup_ui()

    def setup_ui(self):
        """–°—Ç–≤–æ—Ä–µ–Ω–Ω—è UI"""

        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        title_label = ctk.CTkLabel(
            self,
            text="Git Commit Tool",
            font=ctk.CTkFont(size=24, weight="bold")
        )
        title_label.pack(pady=15)

        # –ü–æ—Ç–æ—á–Ω–∞ –≤–µ—Ä—Å—ñ—è
        version_frame = ctk.CTkFrame(self)
        version_frame.pack(pady=10, padx=20, fill="x")

        ctk.CTkLabel(
            version_frame,
            text="–ü–æ—Ç–æ—á–Ω–∞ –≤–µ—Ä—Å—ñ—è:",
            font=ctk.CTkFont(size=12, weight="bold")
        ).pack(side="left")

        ctk.CTkLabel(
            version_frame,
            text=f"v{self.current_version}",
            font=ctk.CTkFont(size=12),
            text_color="gray"
        ).pack(side="left", padx=10)

        # –ö–æ–º–µ–Ω—Ç–∞—Ä
        ctk.CTkLabel(
            self,
            text="–ö–æ–º–µ–Ω—Ç–∞—Ä (commit message):",
            font=ctk.CTkFont(size=12, weight="bold")
        ).pack(anchor="w", padx=20, pady=(10, 5))

        self.comment_entry = ctk.CTkEntry(
            self,
            placeholder_text="–û–ø–∏—à—ñ—Ç—å –≤–∞—à—ñ –∑–º—ñ–Ω–∏...",
            height=40,
            font=ctk.CTkFont(size=11)
        )
        self.comment_entry.pack(padx=20, fill="x", pady=(0, 15))

        # –ù–æ–≤–∞ –≤–µ—Ä—Å—ñ—è
        ctk.CTkLabel(
            self,
            text="–ù–æ–≤–∞ –≤–µ—Ä—Å—ñ—è (–¥–ª—è —Ç–∞–≥—É):",
            font=ctk.CTkFont(size=12, weight="bold")
        ).pack(anchor="w", padx=20, pady=(10, 5))

        version_frame2 = ctk.CTkFrame(self)
        version_frame2.pack(padx=20, fill="x", pady=(0, 15))

        ctk.CTkLabel(
            version_frame2,
            text="v",
            font=ctk.CTkFont(size=11)
        ).pack(side="left", padx=(0, 5))

        self.version_entry = ctk.CTkEntry(
            version_frame2,
            placeholder_text="1.1.0",
            height=35,
            font=ctk.CTkFont(size=11)
        )
        self.version_entry.pack(side="left", fill="x", expand=True)

        # –ß–µ–∫–±–æ–∫—Å –¥–ª—è —Ç–∞–≥—É
        self.tag_checkbox = ctk.CTkCheckBox(
            self,
            text="–°—Ç–≤–æ—Ä–∏—Ç–∏ —Ç–µ–≥ –≤–µ—Ä—Å—ñ—ó",
            font=ctk.CTkFont(size=11)
        )
        self.tag_checkbox.pack(anchor="w", padx=20, pady=(0, 20))
        self.tag_checkbox.select()

        # –ö–Ω–æ–ø–∫–∏
        button_frame = ctk.CTkFrame(self)
        button_frame.pack(padx=20, fill="x", pady=(0, 15))

        commit_btn = ctk.CTkButton(
            button_frame,
            text="‚úÖ Commit & Push",
            command=self.commit_and_push,
            font=ctk.CTkFont(size=12, weight="bold"),
            height=45,
            corner_radius=10
        )
        commit_btn.pack(side="left", fill="both", expand=True, padx=(0, 5))

        clear_btn = ctk.CTkButton(
            button_frame,
            text="üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç–∏",
            command=self.clear_fields,
            font=ctk.CTkFont(size=12),
            height=45,
            corner_radius=10,
            fg_color="gray30",
            hover_color="gray50"
        )
        clear_btn.pack(side="left", fill="both", expand=True, padx=(5, 0))

        # –õ–æ–≥–∏
        ctk.CTkLabel(
            self,
            text="–õ–æ–≥–∏ –æ–ø–µ—Ä–∞—Ü—ñ–π:",
            font=ctk.CTkFont(size=11, weight="bold")
        ).pack(anchor="w", padx=20, pady=(10, 5))

        self.log_text = scrolledtext.ScrolledText(
            self,
            height=10,
            width=70,
            font=("Courier", 9),
            bg="#f0f0f0",
            fg="#333333",
            relief="solid",
            borderwidth=1
        )
        self.log_text.pack(padx=20, pady=(0, 15), fill="both", expand=True)

        # –°—Ç–∞—Ç—É—Å
        self.status_label = ctk.CTkLabel(
            self,
            text="–ì–æ—Ç–æ–≤–æ –¥–æ —Ä–æ–±–æ—Ç–∏",
            font=ctk.CTkFont(size=10),
            text_color="gray"
        )
        self.status_label.pack(pady=(0, 10))

    def get_current_version(self):
        """–û—Ç—Ä–∏–º–∞–Ω–Ω—è –ø–æ—Ç–æ—á–Ω–æ—ó –≤–µ—Ä—Å—ñ—ó –∑ version.txt"""
        try:
            with open("version.txt", "r") as f:
                return f.read().strip()
        except:
            return "1.0.0"

    def log_message(self, message):
        """–î–æ–¥–∞–Ω–Ω—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –¥–æ –ª–æ–≥—ñ–≤"""
        timestamp = datetime.now().strftime("%H:%M:%S")
        self.log_text.insert("end", f"[{timestamp}] {message}\n")
        self.log_text.see("end")
        self.update()

    def run_git_command(self, command):
        """–í–∏–∫–æ–Ω–∞–Ω–Ω—è git –∫–æ–º–∞–Ω–¥–∏"""
        try:
            result = subprocess.run(
                command,
                shell=True,
                capture_output=True,
                text=True,
                cwd=os.getcwd()
            )

            if result.returncode == 0:
                if result.stdout:
                    self.log_message(f"‚úÖ {result.stdout.strip()}")
                return True
            else:
                error_msg = result.stderr.strip() if result.stderr else "–ù–µ–≤—ñ–¥–æ–º–∞ –ø–æ–º–∏–ª–∫–∞"
                self.log_message(f"‚ùå –ü–æ–º–∏–ª–∫–∞: {error_msg}")
                return False
        except Exception as e:
            self.log_message(f"‚ùå –ò—Å–∫–ª—é—á–µ–Ω–∏–µ: {str(e)}")
            return False

    def commit_and_push(self):
        """–û—Å–Ω–æ–≤–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è - commit, tag —ñ push"""

        comment = self.comment_entry.get().strip()
        new_version = self.version_entry.get().strip()
        create_tag = self.tag_checkbox.get()

        # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∏
        if not comment:
            messagebox.showwarning("–ü–æ–º–∏–ª–∫–∞", "–ù–∞–ø–∏—à—ñ—Ç—å –∫–æ–º–µ–Ω—Ç–∞—Ä –¥–æ –∫–æ–º—ñ—Ç—é!")
            return

        if create_tag and not new_version:
            messagebox.showwarning("–ü–æ–º–∏–ª–∫–∞", "–ù–∞–ø–∏—à—ñ—Ç—å –Ω–æ–≤—É –≤–µ—Ä—Å—ñ—é –¥–ª—è —Ç–∞–≥—É!")
            return

        self.status_label.configure(text="‚è≥ –û–±—Ä–æ–±–∫–∞...")
        self.update()

        self.log_message("=" * 50)
        self.log_message("üöÄ –†–æ–∑–ø–æ—á–∏–Ω–∞—î–º–æ commit & push –ø—Ä–æ—Ü–µ—Å...")
        self.log_message("=" * 50)

        # –ö—Ä–æ–∫ 1: –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å—É
        self.log_message("\nüìã –ö—Ä–æ–∫ 1: –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å—É —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—é...")
        self.run_git_command("git status --short")

        # –ö—Ä–æ–∫ 2: –î–æ–±–∞–≤–ª–µ–Ω–Ω—è –≤—Å—ñ—Ö —Ñ–∞–π–ª—ñ–≤
        self.log_message("\nüì¶ –ö—Ä–æ–∫ 2: –î–æ–¥–∞–≤–∞–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤...")
        if not self.run_git_command("git add ."):
            self.status_label.configure(text="‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –¥–æ–¥–∞–≤–∞–Ω–Ω—ñ —Ñ–∞–π–ª—ñ–≤")
            messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–ù–µ –≤–¥–∞–ª–æ—Å—è –¥–æ–¥–∞—Ç–∏ —Ñ–∞–π–ª–∏!")
            return

        # –ö—Ä–æ–∫ 3: –ö–æ–º—ñ—Ç
        self.log_message("\nüíæ –ö—Ä–æ–∫ 3: –ö–æ–º—ñ—Ç—É–≤–∞–Ω–Ω—è –∑–º—ñ–Ω...")
        if not self.run_git_command(f'git commit -m "{comment}"'):
            self.status_label.configure(text="‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –∫–æ–º—ñ—Ç—É–≤–∞–Ω–Ω—ñ")
            messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–ù–µ –≤–¥–∞–ª–æ—Å—è –∑–∞–∫–æ–º—ñ—Ç–∏—Ç–∏!")
            return

        # –ö—Ä–æ–∫ 4: Push
        self.log_message("\n‚¨ÜÔ∏è  –ö—Ä–æ–∫ 4: –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –Ω–∞ GitHub...")
        if not self.run_git_command("git push origin main"):
            self.status_label.configure(text="‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ push")
            messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–ù–µ –≤–¥–∞–ª–æ—Å—è –≤—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ –Ω–∞ GitHub!")
            return

        # –ö—Ä–æ–∫ 5: –¢–µ–≥ (—è–∫—â–æ –ø–æ—Ç—Ä—ñ–±–µ–Ω)
        if create_tag:
            self.log_message("\nüè∑Ô∏è  –ö—Ä–æ–∫ 5: –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–∞–≥—É...")
            if not self.run_git_command(f"git tag v{new_version}"):
                self.status_label.configure(text="‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—ñ —Ç–∞–≥—É")
                messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–ù–µ –≤–¥–∞–ª–æ—Å—è —Å—Ç–≤–æ—Ä–∏—Ç–∏ —Ç–µ–≥!")
                return

            self.log_message("\n‚¨ÜÔ∏è  –ö—Ä–æ–∫ 6: –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ç–∞–≥—É –Ω–∞ GitHub...")
            if not self.run_git_command(f"git push origin v{new_version}"):
                self.status_label.configure(text="‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ push —Ç–∞–≥—É")
                messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–ù–µ –≤–¥–∞–ª–æ—Å—è –≤—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ —Ç–µ–≥!")
                return

            # –û–Ω–æ–≤–ª–µ–Ω–Ω—è version.txt
            self.log_message("\nüìù –ö—Ä–æ–∫ 7: –û–Ω–æ–≤–ª–µ–Ω–Ω—è version.txt...")
            try:
                with open("version.txt", "w") as f:
                    f.write(new_version)
                self.log_message("‚úÖ version.txt –æ–Ω–æ–≤–ª–µ–Ω–æ")
                self.current_version = new_version
            except Exception as e:
                self.log_message(f"‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –æ–Ω–æ–≤–ª–µ–Ω–Ω—ñ version.txt: {str(e)}")

        self.log_message("\n" + "=" * 50)
        self.log_message("‚úÖ –í–°–ï –£–°–ü–Ü–®–ù–û! GitHub Actions –ø–æ—á–Ω–µ –∫–æ–º–ø—ñ–ª—é–≤–∞—Ç–∏...")
        self.log_message("=" * 50)

        self.status_label.configure(text="‚úÖ –£—Å–ø—ñ—à–Ω–æ! GitHub Actions –∑–∞–ø—É—â–µ–Ω–æ")
        messagebox.showinfo(
            "–£—Å–ø—ñ—Ö",
            f"‚úÖ –ö–æ–º—ñ—Ç —É—Å–ø—ñ—à–Ω–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ!\n\n"
            f"–ö–æ–º–µ–Ω—Ç–∞—Ä: {comment}\n"
            + (f"–í–µ—Ä—Å—ñ—è: v{new_version}\n\nGitHub Actions –ø–æ—á–Ω–µ –∫–æ–º–ø—ñ–ª—é–≤–∞—Ç–∏ EXE..." if create_tag else "")
        )

        self.clear_fields()

    def clear_fields(self):
        """–û—á–∏—Å—Ç–∫–∞ –ø–æ–ª—ñ–≤"""
        self.comment_entry.delete(0, "end")
        self.version_entry.delete(0, "end")
        self.tag_checkbox.select()
        self.status_label.configure(text="–ì–æ—Ç–æ–≤–æ –¥–æ —Ä–æ–±–æ—Ç–∏")


def main():
    app = GitCommitTool()
    app.mainloop()


if __name__ == "__main__":
    main()


================================================================================
–§–∞–π–ª 4/21: project_export_20251110_104446.txt
--------------------------------------------------------------------------------
================================================================================
–ï–ö–°–ü–û–†–¢ –ü–†–û–Ñ–ö–¢–£: RemoteHand
–î–∞—Ç–∞: 2025-11-10 10:44:46
–®–ª—è—Ö: D:\Python Projects\Prego\RemoteHand
================================================================================

üìÇ –°–¢–†–£–ö–¢–£–†–ê –ü–†–û–Ñ–ö–¢–£
--------------------------------------------------------------------------------
RemoteHand/
‚îú‚îÄ‚îÄ assets/
‚îÇ   ‚îî‚îÄ‚îÄ icon.ico
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ anydesk_manager.py
‚îÇ   ‚îú‚îÄ‚îÄ config.py
‚îÇ   ‚îú‚îÄ‚îÄ config_manager.py
‚îÇ   ‚îú‚îÄ‚îÄ main.py
‚îÇ   ‚îú‚îÄ‚îÄ network_test.py
‚îÇ   ‚îú‚îÄ‚îÄ rdp_manager.py
‚îÇ   ‚îú‚îÄ‚îÄ set_anydesk_password.py
‚îÇ   ‚îú‚îÄ‚îÄ setup_wizard.py
‚îÇ   ‚îú‚îÄ‚îÄ telegram_api.py
‚îÇ   ‚îú‚îÄ‚îÄ telegram_helper.py
‚îÇ   ‚îú‚îÄ‚îÄ update.bat
‚îÇ   ‚îú‚îÄ‚îÄ updater.py
‚îÇ   ‚îî‚îÄ‚îÄ utils.py
‚îú‚îÄ‚îÄ .env.example
‚îú‚îÄ‚îÄ 23.88.7.196_admin_session.rdp
‚îú‚îÄ‚îÄ dev_run.py
‚îú‚îÄ‚îÄ export.py
‚îú‚îÄ‚îÄ GitCommitTool.py
‚îú‚îÄ‚îÄ project_export_20251110_104446.txt
‚îú‚îÄ‚îÄ README.md
‚îú‚îÄ‚îÄ RemoteHand.spec
‚îú‚îÄ‚îÄ requirements.txt
‚îú‚îÄ‚îÄ version.txt
‚îú‚îÄ‚îÄ version_info.txt
‚îî‚îÄ‚îÄ –ê–∫—Ç–∏–≤–∞—Ü—ñ—è —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞.txt

üìÑ –í–ú–Ü–°–¢ –§–ê–ô–õ–Ü–í (21 —Ñ–∞–π–ª—ñ–≤)
================================================================================


================================================================================
–§–∞–π–ª 1/21: dev_run.py
--------------------------------------------------------------------------------
"""
DEV_RUN.PY - –õ–æ–∫–∞–ª—å–Ω–µ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è
"""

import sys
import os

# –í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ DEV —Ä–µ–∂–∏–º
os.environ['REMOTEHAND_DEV_MODE'] = '1'

# –î–æ–¥–∞—Ç–∏ src –≤ path
sys.path.insert(0, os.path.join(os.path.dirname(__file__), 'src'))

print("–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π...")
import subprocess
subprocess.run([sys.executable, "-m", "pip", "install", "-r", "requirements.txt", "-q"],
               capture_output=True)

print("üîß –ó–∞–ø—É—Å–∫ —É DEV —Ä–µ–∂–∏–º—ñ...")

# –ü—Ä—è–º–æ –∑–∞–ø—É—Å—Ç–∏—Ç–∏ main
if __name__ == "__main__":
    import main
    main.main()


================================================================================
–§–∞–π–ª 2/21: export.py
--------------------------------------------------------------------------------
#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Project Structure Exporter
–°—Ç–≤–æ—Ä—é—î –¥–µ—Ç–∞–ª—å–Ω–∏–π –æ–ø–∏—Å —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ –ø—Ä–æ—î–∫—Ç—É —Ç–∞ –≤–º—ñ—Å—Ç —Ñ–∞–π–ª—ñ–≤ —É –æ–¥–∏–Ω —Ñ–∞–π–ª
"""

import os
from pathlib import Path
from datetime import datetime

# –§–∞–π–ª–∏ —Ç–∞ –ø–∞–ø–∫–∏, —è–∫—ñ —Ç—Ä–µ–±–∞ —ñ–≥–Ω–æ—Ä—É–≤–∞—Ç–∏
IGNORE_PATTERNS = {
    # –ü–∞–ø–∫–∏
    '__pycache__', '.git', '.idea', '.vscode', 'node_modules',
    'venv', 'env', '.env', 'dist', 'build', '.pytest_cache',
    '.mypy_cache', 'htmlcov', '.coverage', 'logs', 'tmp',
    # –§–∞–π–ª–∏
    '.pyc', '.pyo', '.pyd', '.so', '.dll', '.dylib', '.exe',
    '.log', '.sqlite', '.db', '.pkl', '.pickle', '.DS_Store',
    'Thumbs.db', '.env', '.env.local', '.gitignore'
}

# –†–æ–∑—à–∏—Ä–µ–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤ –¥–ª—è —á–∏—Ç–∞–Ω–Ω—è (—Ç–µ–∫—Å—Ç–æ–≤—ñ —Ñ–∞–π–ª–∏)
TEXT_EXTENSIONS = {
    '.py', '.js', '.ts', '.jsx', '.tsx', '.html', '.css', '.scss',
    '.json', '.yaml', '.yml', '.toml', '.ini', '.cfg', '.conf',
    '.txt', '.md', '.rst', '.xml', '.sql', '.sh', '.bash',
    '.env.example', '.gitignore', 'Dockerfile', 'Makefile',
    '.java', '.c', '.cpp', '.h', '.go', '.rs', '.php', '.rb'
}

# –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∏–π —Ä–æ–∑–º—ñ—Ä —Ñ–∞–π–ª—É (1 MB)
MAX_FILE_SIZE = 1024 * 1024


def should_ignore(path: Path) -> bool:
    """–ü–µ—Ä–µ–≤—ñ—Ä—è—î, —á–∏ —Ç—Ä–µ–±–∞ —ñ–≥–Ω–æ—Ä—É–≤–∞—Ç–∏ —Ñ–∞–π–ª/–ø–∞–ø–∫—É"""
    name = path.name

    # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ç–æ—á–Ω–æ–≥–æ –∑–±—ñ–≥—É
    if name in IGNORE_PATTERNS:
        return True

    # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è
    if path.suffix in IGNORE_PATTERNS:
        return True

    # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø—Ä–∏—Ö–æ–≤–∞–Ω–∏—Ö —Ñ–∞–π–ª—ñ–≤ (–∫—Ä—ñ–º .env.example)
    if name.startswith('.') and name != '.env.example':
        return True

    return False


def is_text_file(path: Path) -> bool:
    """–ü–µ—Ä–µ–≤—ñ—Ä—è—î, —á–∏ —î —Ñ–∞–π–ª —Ç–µ–∫—Å—Ç–æ–≤–∏–º"""
    # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è
    if path.suffix.lower() in TEXT_EXTENSIONS:
        return True

    # –§–∞–π–ª–∏ –±–µ–∑ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è, —è–∫—ñ –∑–∞–∑–≤–∏—á–∞–π —Ç–µ–∫—Å—Ç–æ–≤—ñ
    if path.suffix == '' and path.name in {'Dockerfile', 'Makefile', 'README', 'LICENSE'}:
        return True

    return False


def get_tree_structure(root_path: Path, prefix: str = "", is_last: bool = True) -> list:
    """–ì–µ–Ω–µ—Ä—É—î –¥–µ—Ä–µ–≤–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ –ø—Ä–æ—î–∫—Ç—É"""
    lines = []

    try:
        items = sorted(root_path.iterdir(), key=lambda x: (not x.is_dir(), x.name.lower()))
        items = [item for item in items if not should_ignore(item)]

        for i, item in enumerate(items):
            is_last_item = i == len(items) - 1
            current_prefix = "‚îî‚îÄ‚îÄ " if is_last_item else "‚îú‚îÄ‚îÄ "
            lines.append(f"{prefix}{current_prefix}{item.name}{'/' if item.is_dir() else ''}")

            if item.is_dir():
                extension = "    " if is_last_item else "‚îÇ   "
                lines.extend(get_tree_structure(item, prefix + extension, is_last_item))

    except PermissionError:
        pass

    return lines


def read_file_content(file_path: Path) -> str:
    """–ß–∏—Ç–∞—î –≤–º—ñ—Å—Ç —Ñ–∞–π–ª—É"""
    try:
        # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ä–æ–∑–º—ñ—Ä—É
        if file_path.stat().st_size > MAX_FILE_SIZE:
            return f"[–§–∞–π–ª –∑–∞–Ω–∞–¥—Ç–æ –≤–µ–ª–∏–∫–∏–π: {file_path.stat().st_size / 1024:.1f} KB]"

        # –°–ø—Ä–æ–±–∞ –ø—Ä–æ—á–∏—Ç–∞—Ç–∏ —è–∫ —Ç–µ–∫—Å—Ç
        with open(file_path, 'r', encoding='utf-8') as f:
            return f.read()
    except UnicodeDecodeError:
        # –Ø–∫—â–æ –Ω–µ –≤–¥–∞–ª–æ—Å—è –ø—Ä–æ—á–∏—Ç–∞—Ç–∏ —è–∫ UTF-8
        try:
            with open(file_path, 'r', encoding='cp1251') as f:
                return f.read()
        except:
            return "[–ù–µ –≤–¥–∞–ª–æ—Å—è –ø—Ä–æ—á–∏—Ç–∞—Ç–∏ —Ñ–∞–π–ª - –±—ñ–Ω–∞—Ä–Ω–∏–π –∞–±–æ –Ω–µ–≤—ñ–¥–æ–º–µ –∫–æ–¥—É–≤–∞–Ω–Ω—è]"
    except Exception as e:
        return f"[–ü–æ–º–∏–ª–∫–∞ —á–∏—Ç–∞–Ω–Ω—è: {str(e)}]"


def collect_files(root_path: Path) -> list:
    """–ó–±–∏—Ä–∞—î –≤—Å—ñ —Ç–µ–∫—Å—Ç–æ–≤—ñ —Ñ–∞–π–ª–∏ –ø—Ä–æ—î–∫—Ç—É"""
    files = []

    for item in root_path.rglob('*'):
        if item.is_file() and not should_ignore(item) and is_text_file(item):
            # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞, —â–æ –≤—Å—ñ –±–∞—Ç—å–∫—ñ–≤—Å—å–∫—ñ –ø–∞–ø–∫–∏ –Ω–µ —ñ–≥–Ω–æ—Ä—É—é—Ç—å—Å—è
            if not any(should_ignore(parent) for parent in item.parents):
                files.append(item)

    return sorted(files)


def generate_project_export(project_path: str, output_file: str = None):
    """–ì–µ–Ω–µ—Ä—É—î –ø–æ–≤–Ω–∏–π –µ–∫—Å–ø–æ—Ä—Ç –ø—Ä–æ—î–∫—Ç—É"""
    root = Path(project_path).resolve()

    if not root.exists():
        print(f"‚ùå –ü–æ–º–∏–ª–∫–∞: –®–ª—è—Ö '{project_path}' –Ω–µ —ñ—Å–Ω—É—î!")
        return

    if output_file is None:
        timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
        output_file = f"project_export_{timestamp}.txt"

    print(f"üìÅ –ê–Ω–∞–ª—ñ–∑ –ø—Ä–æ—î–∫—Ç—É: {root.name}")
    print(f"üìù –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –µ–∫—Å–ø–æ—Ä—Ç—É...")

    with open(output_file, 'w', encoding='utf-8') as f:
        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        f.write("=" * 80 + "\n")
        f.write(f"–ï–ö–°–ü–û–†–¢ –ü–†–û–Ñ–ö–¢–£: {root.name}\n")
        f.write(f"–î–∞—Ç–∞: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}\n")
        f.write(f"–®–ª—è—Ö: {root}\n")
        f.write("=" * 80 + "\n\n")

        # –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ—î–∫—Ç—É
        f.write("üìÇ –°–¢–†–£–ö–¢–£–†–ê –ü–†–û–Ñ–ö–¢–£\n")
        f.write("-" * 80 + "\n")
        f.write(f"{root.name}/\n")
        tree_lines = get_tree_structure(root)
        f.write("\n".join(tree_lines))
        f.write("\n\n")

        # –ó–±—ñ—Ä —Ñ–∞–π–ª—ñ–≤
        files = collect_files(root)

        f.write(f"üìÑ –í–ú–Ü–°–¢ –§–ê–ô–õ–Ü–í ({len(files)} —Ñ–∞–π–ª—ñ–≤)\n")
        f.write("=" * 80 + "\n\n")

        # –í–º—ñ—Å—Ç –∫–æ–∂–Ω–æ–≥–æ —Ñ–∞–π–ª—É
        for i, file_path in enumerate(files, 1):
            relative_path = file_path.relative_to(root)

            print(f"  [{i}/{len(files)}] {relative_path}")

            f.write("\n" + "=" * 80 + "\n")
            f.write(f"–§–∞–π–ª {i}/{len(files)}: {relative_path}\n")
            f.write("-" * 80 + "\n")

            content = read_file_content(file_path)
            f.write(content)
            f.write("\n")

        # –ü—ñ–¥—Å—É–º–æ–∫
        f.write("\n" + "=" * 80 + "\n")
        f.write("–ö–Ü–ù–ï–¶–¨ –ï–ö–°–ü–û–†–¢–£\n")
        f.write("=" * 80 + "\n")

    file_size = Path(output_file).stat().st_size
    print(f"\n‚úÖ –ï–∫—Å–ø–æ—Ä—Ç –∑–∞–≤–µ—Ä—à–µ–Ω–æ!")
    print(f"üìÑ –§–∞–π–ª: {output_file}")
    print(f"üìä –†–æ–∑–º—ñ—Ä: {file_size / 1024:.1f} KB")
    print(f"üìÅ –§–∞–π–ª—ñ–≤ –æ–±—Ä–æ–±–ª–µ–Ω–æ: {len(files)}")


if __name__ == "__main__":
    import sys

    # –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è: python export_project.py [—à–ª—è—Ö_–¥–æ_–ø—Ä–æ—î–∫—Ç—É] [–≤–∏—Ö—ñ–¥–Ω–∏–π_—Ñ–∞–π–ª]
    project_path = sys.argv[1] if len(sys.argv) > 1 else "."
    output_file = sys.argv[2] if len(sys.argv) > 2 else None

    generate_project_export(project_path, output_file)


================================================================================
–§–∞–π–ª 3/21: GitCommitTool.py
--------------------------------------------------------------------------------
import customtkinter as ctk
from tkinter import messagebox, scrolledtext
import subprocess
import os
from pathlib import Path
from datetime import datetime


class GitCommitTool(ctk.CTk):
    def __init__(self):
        super().__init__()

        self.title("Git Commit Tool")
        self.geometry("600x700")
        self.resizable(False, False)

        # –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç–µ–º–∏
        ctk.set_appearance_mode("light")
        ctk.set_default_color_theme("blue")

        # –û—Ç—Ä–∏–º–∞–Ω–Ω—è –ø–æ—Ç–æ—á–Ω–æ—ó –≤–µ—Ä—Å—ñ—ó
        self.current_version = self.get_current_version()

        self.setup_ui()

    def setup_ui(self):
        """–°—Ç–≤–æ—Ä–µ–Ω–Ω—è UI"""

        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        title_label = ctk.CTkLabel(
            self,
            text="Git Commit Tool",
            font=ctk.CTkFont(size=24, weight="bold")
        )
        title_label.pack(pady=15)

        # –ü–æ—Ç–æ—á–Ω–∞ –≤–µ—Ä—Å—ñ—è
        version_frame = ctk.CTkFrame(self)
        version_frame.pack(pady=10, padx=20, fill="x")

        ctk.CTkLabel(
            version_frame,
            text="–ü–æ—Ç–æ—á–Ω–∞ –≤–µ—Ä—Å—ñ—è:",
            font=ctk.CTkFont(size=12, weight="bold")
        ).pack(side="left")

        ctk.CTkLabel(
            version_frame,
            text=f"v{self.current_version}",
            font=ctk.CTkFont(size=12),
            text_color="gray"
        ).pack(side="left", padx=10)

        # –ö–æ–º–µ–Ω—Ç–∞—Ä
        ctk.CTkLabel(
            self,
            text="–ö–æ–º–µ–Ω—Ç–∞—Ä (commit message):",
            font=ctk.CTkFont(size=12, weight="bold")
        ).pack(anchor="w", padx=20, pady=(10, 5))

        self.comment_entry = ctk.CTkEntry(
            self,
            placeholder_text="–û–ø–∏—à—ñ—Ç—å –≤–∞—à—ñ –∑–º—ñ–Ω–∏...",
            height=40,
            font=ctk.CTkFont(size=11)
        )
        self.comment_entry.pack(padx=20, fill="x", pady=(0, 15))

        # –ù–æ–≤–∞ –≤–µ—Ä—Å—ñ—è
        ctk.CTkLabel(
            self,
            text="–ù–æ–≤–∞ –≤–µ—Ä—Å—ñ—è (–¥–ª—è —Ç–∞–≥—É):",
            font=ctk.CTkFont(size=12, weight="bold")
        ).pack(anchor="w", padx=20, pady=(10, 5))

        version_frame2 = ctk.CTkFrame(self)
        version_frame2.pack(padx=20, fill="x", pady=(0, 15))

        ctk.CTkLabel(
            version_frame2,
            text="v",
            font=ctk.CTkFont(size=11)
        ).pack(side="left", padx=(0, 5))

        self.version_entry = ctk.CTkEntry(
            version_frame2,
            placeholder_text="1.1.0",
            height=35,
            font=ctk.CTkFont(size=11)
        )
        self.version_entry.pack(side="left", fill="x", expand=True)

        # –ß–µ–∫–±–æ–∫—Å –¥–ª—è —Ç–∞–≥—É
        self.tag_checkbox = ctk.CTkCheckBox(
            self,
            text="–°—Ç–≤–æ—Ä–∏—Ç–∏ —Ç–µ–≥ –≤–µ—Ä—Å—ñ—ó",
            font=ctk.CTkFont(size=11)
        )
        self.tag_checkbox.pack(anchor="w", padx=20, pady=(0, 20))
        self.tag_checkbox.select()

        # –ö–Ω–æ–ø–∫–∏
        button_frame = ctk.CTkFrame(self)
        button_frame.pack(padx=20, fill="x", pady=(0, 15))

        commit_btn = ctk.CTkButton(
            button_frame,
            text="‚úÖ Commit & Push",
            command=self.commit_and_push,
            font=ctk.CTkFont(size=12, weight="bold"),
            height=45,
            corner_radius=10
        )
        commit_btn.pack(side="left", fill="both", expand=True, padx=(0, 5))

        clear_btn = ctk.CTkButton(
            button_frame,
            text="üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç–∏",
            command=self.clear_fields,
            font=ctk.CTkFont(size=12),
            height=45,
            corner_radius=10,
            fg_color="gray30",
            hover_color="gray50"
        )
        clear_btn.pack(side="left", fill="both", expand=True, padx=(5, 0))

        # –õ–æ–≥–∏
        ctk.CTkLabel(
            self,
            text="–õ–æ–≥–∏ –æ–ø–µ—Ä–∞—Ü—ñ–π:",
            font=ctk.CTkFont(size=11, weight="bold")
        ).pack(anchor="w", padx=20, pady=(10, 5))

        self.log_text = scrolledtext.ScrolledText(
            self,
            height=10,
            width=70,
            font=("Courier", 9),
            bg="#f0f0f0",
            fg="#333333",
            relief="solid",
            borderwidth=1
        )
        self.log_text.pack(padx=20, pady=(0, 15), fill="both", expand=True)

        # –°—Ç–∞—Ç—É—Å
        self.status_label = ctk.CTkLabel(
            self,
            text="–ì–æ—Ç–æ–≤–æ –¥–æ —Ä–æ–±–æ—Ç–∏",
            font=ctk.CTkFont(size=10),
            text_color="gray"
        )
        self.status_label.pack(pady=(0, 10))

    def get_current_version(self):
        """–û—Ç—Ä–∏–º–∞–Ω–Ω—è –ø–æ—Ç–æ—á–Ω–æ—ó –≤–µ—Ä—Å—ñ—ó –∑ version.txt"""
        try:
            with open("version.txt", "r") as f:
                return f.read().strip()
        except:
            return "1.0.0"

    def log_message(self, message):
        """–î–æ–¥–∞–Ω–Ω—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –¥–æ –ª–æ–≥—ñ–≤"""
        timestamp = datetime.now().strftime("%H:%M:%S")
        self.log_text.insert("end", f"[{timestamp}] {message}\n")
        self.log_text.see("end")
        self.update()

    def run_git_command(self, command):
        """–í–∏–∫–æ–Ω–∞–Ω–Ω—è git –∫–æ–º–∞–Ω–¥–∏"""
        try:
            result = subprocess.run(
                command,
                shell=True,
                capture_output=True,
                text=True,
                cwd=os.getcwd()
            )

            if result.returncode == 0:
                if result.stdout:
                    self.log_message(f"‚úÖ {result.stdout.strip()}")
                return True
            else:
                error_msg = result.stderr.strip() if result.stderr else "–ù–µ–≤—ñ–¥–æ–º–∞ –ø–æ–º–∏–ª–∫–∞"
                self.log_message(f"‚ùå –ü–æ–º–∏–ª–∫–∞: {error_msg}")
                return False
        except Exception as e:
            self.log_message(f"‚ùå –ò—Å–∫–ª—é—á–µ–Ω–∏–µ: {str(e)}")
            return False

    def commit_and_push(self):
        """–û—Å–Ω–æ–≤–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è - commit, tag —ñ push"""

        comment = self.comment_entry.get().strip()
        new_version = self.version_entry.get().strip()
        create_tag = self.tag_checkbox.get()

        # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∏
        if not comment:
            messagebox.showwarning("–ü–æ–º–∏–ª–∫–∞", "–ù–∞–ø–∏—à—ñ—Ç—å –∫–æ–º–µ–Ω—Ç–∞—Ä –¥–æ –∫–æ–º—ñ—Ç—é!")
            return

        if create_tag and not new_version:
            messagebox.showwarning("–ü–æ–º–∏–ª–∫–∞", "–ù–∞–ø–∏—à—ñ—Ç—å –Ω–æ–≤—É –≤–µ—Ä—Å—ñ—é –¥–ª—è —Ç–∞–≥—É!")
            return

        self.status_label.configure(text="‚è≥ –û–±—Ä–æ–±–∫–∞...")
        self.update()

        self.log_message("=" * 50)
        self.log_message("üöÄ –†–æ–∑–ø–æ—á–∏–Ω–∞—î–º–æ commit & push –ø—Ä–æ—Ü–µ—Å...")
        self.log_message("=" * 50)

        # –ö—Ä–æ–∫ 1: –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å—É
        self.log_message("\nüìã –ö—Ä–æ–∫ 1: –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å—É —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—é...")
        self.run_git_command("git status --short")

        # –ö—Ä–æ–∫ 2: –î–æ–±–∞–≤–ª–µ–Ω–Ω—è –≤—Å—ñ—Ö —Ñ–∞–π–ª—ñ–≤
        self.log_message("\nüì¶ –ö—Ä–æ–∫ 2: –î–æ–¥–∞–≤–∞–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤...")
        if not self.run_git_command("git add ."):
            self.status_label.configure(text="‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –¥–æ–¥–∞–≤–∞–Ω–Ω—ñ —Ñ–∞–π–ª—ñ–≤")
            messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–ù–µ –≤–¥–∞–ª–æ—Å—è –¥–æ–¥–∞—Ç–∏ —Ñ–∞–π–ª–∏!")
            return

        # –ö—Ä–æ–∫ 3: –ö–æ–º—ñ—Ç
        self.log_message("\nüíæ –ö—Ä–æ–∫ 3: –ö–æ–º—ñ—Ç—É–≤–∞–Ω–Ω—è –∑–º—ñ–Ω...")
        if not self.run_git_command(f'git commit -m "{comment}"'):
            self.status_label.configure(text="‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –∫–æ–º—ñ—Ç—É–≤–∞–Ω–Ω—ñ")
            messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–ù–µ –≤–¥–∞–ª–æ—Å—è –∑–∞–∫–æ–º—ñ—Ç–∏—Ç–∏!")
            return

        # –ö—Ä–æ–∫ 4: Push
        self.log_message("\n‚¨ÜÔ∏è  –ö—Ä–æ–∫ 4: –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –Ω–∞ GitHub...")
        if not self.run_git_command("git push origin main"):
            self.status_label.configure(text="‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ push")
            messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–ù–µ –≤–¥–∞–ª–æ—Å—è –≤—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ –Ω–∞ GitHub!")
            return

        # –ö—Ä–æ–∫ 5: –¢–µ–≥ (—è–∫—â–æ –ø–æ—Ç—Ä—ñ–±–µ–Ω)
        if create_tag:
            self.log_message("\nüè∑Ô∏è  –ö—Ä–æ–∫ 5: –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–∞–≥—É...")
            if not self.run_git_command(f"git tag v{new_version}"):
                self.status_label.configure(text="‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—ñ —Ç–∞–≥—É")
                messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–ù–µ –≤–¥–∞–ª–æ—Å—è —Å—Ç–≤–æ—Ä–∏—Ç–∏ —Ç–µ–≥!")
                return

            self.log_message("\n‚¨ÜÔ∏è  –ö—Ä–æ–∫ 6: –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ç–∞–≥—É –Ω–∞ GitHub...")
            if not self.run_git_command(f"git push origin v{new_version}"):
                self.status_label.configure(text="‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ push —Ç–∞–≥—É")
                messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–ù–µ –≤–¥–∞–ª–æ—Å—è –≤—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ —Ç–µ–≥!")
                return

            # –û–Ω–æ–≤–ª–µ–Ω–Ω—è version.txt
            self.log_message("\nüìù –ö—Ä–æ–∫ 7: –û–Ω–æ–≤–ª–µ–Ω–Ω—è version.txt...")
            try:
                with open("version.txt", "w") as f:
                    f.write(new_version)
                self.log_message("‚úÖ version.txt –æ–Ω–æ–≤–ª–µ–Ω–æ")
                self.current_version = new_version
            except Exception as e:
                self.log_message(f"‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –æ–Ω–æ–≤–ª–µ–Ω–Ω—ñ version.txt: {str(e)}")

        self.log_message("\n" + "=" * 50)
        self.log_message("‚úÖ –í–°–ï –£–°–ü–Ü–®–ù–û! GitHub Actions –ø–æ—á–Ω–µ –∫–æ–º–ø—ñ–ª—é–≤–∞—Ç–∏...")
        self.log_message("=" * 50)

        self.status_label.configure(text="‚úÖ –£—Å–ø—ñ—à–Ω–æ! GitHub Actions –∑–∞–ø—É—â–µ–Ω–æ")
        messagebox.showinfo(
            "–£—Å–ø—ñ—Ö",
            f"‚úÖ –ö–æ–º—ñ—Ç —É—Å–ø—ñ—à–Ω–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ!\n\n"
            f"–ö–æ–º–µ–Ω—Ç–∞—Ä: {comment}\n"
            + (f"–í–µ—Ä—Å—ñ—è: v{new_version}\n\nGitHub Actions –ø–æ—á–Ω–µ –∫–æ–º–ø—ñ–ª—é–≤–∞—Ç–∏ EXE..." if create_tag else "")
        )

        self.clear_fields()

    def clear_fields(self):
        """–û—á–∏—Å—Ç–∫–∞ –ø–æ–ª—ñ–≤"""
        self.comment_entry.delete(0, "end")
        self.version_entry.delete(0, "end")
        self.tag_checkbox.select()
        self.status_label.configure(text="–ì–æ—Ç–æ–≤–æ –¥–æ —Ä–æ–±–æ—Ç–∏")


def main():
    app = GitCommitTool()
    app.mainloop()


if __name__ == "__main__":
    main()


================================================================================
–§–∞–π–ª 5/21: README.md
--------------------------------------------------------------------------------


================================================================================
–§–∞–π–ª 6/21: requirements.txt
--------------------------------------------------------------------------------
customtkinter==5.2.1
requests==2.31.0
psutil==5.9.6
keyring==24.1.0
python-telegram-bot==20.3
packaging>=24.0
pywin32>=300
python-dotenv

================================================================================
–§–∞–π–ª 7/21: src\anydesk_manager.py
--------------------------------------------------------------------------------
import os
import sys
import subprocess
import time
import logging
import psutil
import platform
import ctypes
import socket
from pathlib import Path
from typing import Optional, Tuple

logger = logging.getLogger(__name__)

UNATTENDED_PASSWORD = "r3moteh4nd"


class AnyDeskManager:
    """–ú–µ–Ω–µ–¥–∂–µ—Ä –¥–ª—è AnyDesk"""

    def __init__(self, config_manager, telegram_api):
        self.config = config_manager
        self.telegram = telegram_api
        self.anydesk_path = self.find_anydesk()
        self._is_running = False
        self.connection_id = None

    def find_anydesk(self) -> Optional[str]:
        """–ó–Ω–∞–π—Ç–∏ AnyDesk"""
        possible_paths = [
            r"C:\Program Files\AnyDesk\AnyDesk.exe",
            r"C:\Program Files (x86)\AnyDesk\AnyDesk.exe",
            os.path.expanduser("~\\AppData\\Local\\AnyDesk\\AnyDesk.exe"),
            os.path.expanduser("~\\AppData\\Roaming\\AnyDesk\\AnyDesk.exe"),
            os.path.expanduser("~\\Downloads\\AnyDesk.exe"),
            r"C:\ProgramData\AnyDesk\AnyDesk.exe",
        ]

        for path in possible_paths:
            if os.path.exists(path):
                logger.info(f"‚úÖ AnyDesk –∑–Ω–∞–π–¥–µ–Ω–æ: {path}")
                return path

        logger.warning("‚ö†Ô∏è AnyDesk –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ")
        return None

    def download_anydesk(self) -> bool:
        """–ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ AnyDesk"""
        if self.anydesk_path:
            return True

        logger.info("üì• –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è AnyDesk...")
        try:
            import urllib.request
            downloads_dir = os.path.expanduser("~\\Downloads")
            save_path = os.path.join(downloads_dir, "AnyDesk.exe")
            download_url = "https://download.anydesk.com/AnyDesk.exe"

            if not os.path.exists(save_path):
                logger.info(f"–ó–∞–≤–∞–Ω—Ç–∞–∂—É...")
                urllib.request.urlretrieve(download_url, save_path)

            logger.info("–ó–∞–ø—É—Å–∫ –≤—Å—Ç–∞–Ω–æ–≤–ª—é–≤–∞—á–∞...")
            subprocess.Popen([save_path])

            logger.info("–ß–µ–∫–∞—é –Ω–∞ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è (90 —Å–µ–∫)...")
            for i in range(90):
                time.sleep(1)
                self.anydesk_path = self.find_anydesk()
                if self.anydesk_path:
                    logger.info(f"‚úÖ AnyDesk –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ")
                    time.sleep(3)
                    return True

            return False
        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞: {e}")
            return False

    def check_if_running(self) -> bool:
        """–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —á–∏ AnyDesk –∑–∞–ø—É—â–µ–Ω–æ"""
        try:
            for proc in psutil.process_iter(['pid', 'name']):
                if 'anydesk' in proc.info['name'].lower():
                    logger.info(f"‚ÑπÔ∏è AnyDesk –∑–∞–ø—É—â–µ–Ω–æ (PID: {proc.info['pid']})")
                    self._is_running = True
                    return True
        except:
            pass
        self._is_running = False
        return False

    def launch_anydesk(self) -> bool:
        """–ó–∞–ø—É—Å—Ç–∏—Ç–∏ AnyDesk"""
        if self.check_if_running():
            return True

        if not self.anydesk_path or not Path(self.anydesk_path).exists():
            logger.error("–®–ª—è—Ö –Ω–µ–≤—ñ–¥–æ–º–∏–π")
            return False

        try:
            logger.info(f"üöÄ –ó–∞–ø—É—Å–∫–∞—é AnyDesk...")
            subprocess.Popen(self.anydesk_path)
            time.sleep(5)

            if self.check_if_running():
                logger.info("‚úÖ AnyDesk –∑–∞–ø—É—â–µ–Ω–æ")
                return True
            else:
                self._is_running = True
                return True
        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞: {e}")
            return False

    def set_password_with_admin(self) -> bool:
        """–í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –ø–∞—Ä–æ–ª—å —á–µ—Ä–µ–∑ –æ–∫—Ä–µ–º–∏–π —Å–∫—Ä–∏–ø—Ç –∑ –∞–¥–º—ñ–Ω –ø—Ä–∞–≤–∞–º–∏"""
        if not self.anydesk_path:
            logger.error("–®–ª—è—Ö –Ω–µ–≤—ñ–¥–æ–º–∏–π")
            return False

        try:
            logger.info(f"üîê –ó–∞–ø—É—Å–∫–∞—é –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –ø–∞—Ä–æ–ª—è –∑ –∞–¥–º—ñ–Ω –ø—Ä–∞–≤–∞–º–∏...")

            # –í–∏–∑–Ω–∞—á–∏—Ç–∏ —à–ª—è—Ö –¥–æ —Å–∫—Ä–∏–ø—Ç—É
            if getattr(sys, 'frozen', False):
                # –Ø–∫—â–æ EXE - —Å–∫—Ä–∏–ø—Ç –ø–æ—Ä—É—á
                script_path = os.path.join(os.path.dirname(sys.executable), "src", "set_anydesk_password.py")
            else:
                # –Ø–∫—â–æ DEV
                script_path = os.path.join(os.path.dirname(__file__), "set_anydesk_password.py")

            if not os.path.exists(script_path):
                logger.error(f"–°–∫—Ä–∏–ø—Ç –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ: {script_path}")
                return False

            # –ü–µ—Ä–µ–¥–∞—Ç–∏ –ø–∞—Ä–æ–ª—å —è–∫ –∑–º—ñ–Ω–Ω—É —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞
            env = os.environ.copy()
            env["ANYDESK_PASSWORD"] = UNATTENDED_PASSWORD

            # –ó–∞–ø—É—Å—Ç–∏—Ç–∏ —Å–∫—Ä–∏–ø—Ç –∑ –∞–¥–º—ñ–Ω –ø—Ä–∞–≤–∞–º–∏
            ctypes.windll.shell32.ShellExecuteW(
                None,
                "runas",
                sys.executable,
                f'"{script_path}" "{self.anydesk_path}"',
                None,
                1  # SW_SHOW - –ø–æ–∫–∞–∑–∞—Ç–∏ –≤—ñ–∫–Ω–æ
            )

            logger.info(f"‚úÖ –ó–∞–ø—Ä–æ—Å –∞–¥–º—ñ–Ω –ø—Ä–∞–≤ –Ω–∞–¥—ñ—Å–ª–∞–Ω–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—É")
            time.sleep(3)
            return True

        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞: {e}")
            import traceback
            traceback.print_exc()
            return False

    def get_connection_id(self) -> Optional[str]:
        """–û—Ç—Ä–∏–º–∞—Ç–∏ ID"""
        if not self.anydesk_path:
            return None

        try:
            logger.info("üìå –û—Ç—Ä–∏–º—É—é ID...")

            result = subprocess.run(
                [self.anydesk_path, '--get-id'],
                capture_output=True,
                text=True,
                timeout=10,
                creationflags=subprocess.CREATE_NO_WINDOW if platform.system() == "Windows" else 0
            )

            if result.returncode == 0:
                connection_id = result.stdout.strip()
                if connection_id and connection_id.isdigit():
                    logger.info(f"‚úÖ ID: {connection_id}")
                    self.connection_id = connection_id
                    return connection_id

        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞: {e}")

        return None

    def start(self, password: str = None) -> Tuple[Optional[str], Optional[str]]:
        """–ó–∞–ø—É—Å—Ç–∏—Ç–∏ AnyDesk"""
        password = UNATTENDED_PASSWORD

        # –ö—Ä–æ–∫ 1: –Ø–∫—â–æ –≤–∂–µ –∑–∞–ø—É—â–µ–Ω–æ
        if self.check_if_running():
            logger.info("AnyDesk –≤–∂–µ –∑–∞–ø—É—â–µ–Ω–æ")
            connection_id = self.get_connection_id()
            if connection_id:
                try:
                    # ‚ö†Ô∏è –î–û–î–ê–¢–ò –ü–Ü–ë
                    user_name = self.config.get("user_name", "")

                    self.telegram.send_anydesk_info(
                        self.config.store_location_text,
                        user_name,  # ‚¨ÖÔ∏è –ü–Ü–ë
                        socket.gethostname(),  # –ü–ö
                        connection_id,
                        password
                    )
                except Exception as e:
                    logger.error(f"‚ùå Telegram: {e}")
            return connection_id, password

        # –ö—Ä–æ–∫ 2: –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —è–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ
        if not self.anydesk_path:
            if not self.download_anydesk():
                return None, None

        # –ö—Ä–æ–∫ 3: –ó–∞–ø—É—Å—Ç–∏—Ç–∏
        if not self.launch_anydesk():
            return None, None

        # –ö—Ä–æ–∫ 4: –í–°–¢–ê–ù–û–í–ò–¢–ò –ü–ê–†–û–õ–¨ –ó –ê–î–ú–Ü–ù –ü–†–ê–í–ê–ú–ò
        logger.info("üîê –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –ø–∞—Ä–æ–ª—è...")
        time.sleep(2)
        self.set_password_with_admin()

        # –ö—Ä–æ–∫ 5: –û—Ç—Ä–∏–º–∞—Ç–∏ ID
        logger.info("üìå –û—Ç—Ä–∏–º–∞–Ω–Ω—è ID...")
        time.sleep(2)
        connection_id = self.get_connection_id()

        if not connection_id:
            time.sleep(3)
            connection_id = self.get_connection_id()

        # –ö—Ä–æ–∫ 6: –ù–∞–¥—ñ—Å–ª–∞—Ç–∏ –≤ Telegram –∑ –ü–Ü–ë
        try:
            # ‚ö†Ô∏è –î–û–î–ê–¢–ò –ü–Ü–ë
            user_name = self.config.get("user_name", "")

            self.telegram.send_anydesk_info(
                self.config.store_location_text,
                user_name,  # ‚¨ÖÔ∏è –ü–Ü–ë
                socket.gethostname(),  # –ü–ö
                connection_id if connection_id else "–Ω–µ –æ—Ç—Ä–∏–º–∞–Ω–æ",
                password
            )
            logger.info("‚úÖ –¢–µ–ª–µ–≥—Ä–∞–º —Å–ø–æ–≤—ñ—â–µ–Ω–æ")
        except Exception as e:
            logger.error(f"‚ùå –¢–µ–ª–µ–≥—Ä–∞–º –ø–æ–º–∏–ª–∫–∞: {e}")

        logger.info(f"‚úÖ –ì–æ—Ç–æ–≤–æ (ID: {connection_id})")
        return connection_id, password


================================================================================
–§–∞–π–ª 8/21: src\config.py
--------------------------------------------------------------------------------
import os
from pathlib import Path
from dotenv import load_dotenv

# –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ .env
load_dotenv()

APP_NAME = "RemoteHand"
RDP_HOST = "23.88.7.196"
RDP_PORT = 4420
PING_HOST = "23.88.7.196"

# üîí –ó–Ü –ó–ú–Ü–ù–ù–ò–• –°–ï–†–ï–î–û–í–ò–©–ê, –ê –ù–ï –ó .env!
TELEGRAM_TOKEN = os.getenv("TELEGRAM_TOKEN", "")
TELEGRAM_CHAT_ID = os.getenv("TELEGRAM_CHAT_ID", "")

# –§–∞–π–ª–∏
LOCK_FILE = Path.home() / ".remotehand" / "lock"


================================================================================
–§–∞–π–ª 9/21: src\config_manager.py
--------------------------------------------------------------------------------
import json
import os
from pathlib import Path
import logging

logger = logging.getLogger(__name__)


class ConfigManager:
    """–ú–µ–Ω–µ–¥–∂–µ—Ä –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó"""

    def __init__(self):
        self.config_dir = Path.home() / ".remotehand"
        self.config_dir.mkdir(exist_ok=True)
        self.config_file = self.config_dir / "config.json"

        self.config = self.load()

    def load(self):
        """–ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –∫–æ–Ω—Ñ—ñ–≥"""
        if self.config_file.exists():
            try:
                with open(self.config_file, 'r', encoding='utf-8') as f:
                    return json.load(f)
            except:
                pass
        return {}

    def save(self):
        """–ó–±–µ—Ä–µ–≥—Ç–∏ –∫–æ–Ω—Ñ—ñ–≥ –≤ JSON —Ñ–∞–π–ª"""
        try:
            with open(self.config_file, 'w', encoding='utf-8') as f:
                json.dump(self.config, f, ensure_ascii=False, indent=2)
        except Exception as e:
            logger.error(f"–ü–æ–º–∏–ª–∫–∞ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –∫–æ–Ω—Ñ—ñ–≥—É: {e}")

    def set(self, key, value):
        """–í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –∑–Ω–∞—á–µ–Ω–Ω—è"""
        self.config[key] = value
        self.save()

    def get(self, key, default=""):
        """–û—Ç—Ä–∏–º–∞—Ç–∏ –∑–Ω–∞—á–µ–Ω–Ω—è"""
        return self.config.get(key, default)

    def is_first_run(self):
        """–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —á–∏ –ø–µ—Ä—à–∏–π –∑–∞–ø—É—Å–∫"""
        store = self.config.get('store', '')
        location = self.config.get('location', '')
        return not store or not location

    @property
    def store_location_text(self):
        """–û—Ç—Ä–∏–º–∞—Ç–∏ —Ç–µ–∫—Å—Ç –º–∞–≥–∞–∑–∏–Ω—É/–ª–æ–∫–∞—Ü—ñ—ó"""
        store = self.config.get('store', '–ù–µ–≤—ñ–¥–æ–º–æ')
        location = self.config.get('location', '–ù–µ–≤—ñ–¥–æ–º–æ')
        return f"{store} / {location}"


================================================================================
–§–∞–π–ª 10/21: src\main.py
--------------------------------------------------------------------------------
import customtkinter as ctk
from tkinter import messagebox
import sys
import os
import threading
import logging
from pathlib import Path

# –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ .env —Ñ–∞–π–ª
from dotenv import load_dotenv

load_dotenv()

# –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –ª–æ–≥—É–≤–∞–Ω–Ω—è
logging.basicConfig(
    level=logging.INFO,
    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s'
)
logger = logging.getLogger(__name__)

# ============ –ü–ï–†–ï–í–Ü–†–ö–ê DEV –†–ï–ñ–ò–ú–£ ============
DEV_MODE = os.getenv('REMOTEHAND_DEV_MODE') == '1'
logger.info(f"{'üîß DEV –†–ï–ñ–ò–ú' if DEV_MODE else '‚úÖ PRODUCTION –†–ï–ñ–ò–ú'}")

if not DEV_MODE:
    # –¢–Ü–õ–¨–ö–ò –í PRODUCTION
    try:
        from updater import check_and_update

        check_and_update()
    except Exception as e:
        logger.warning(f"–ü–æ–º–∏–ª–∫–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –æ–Ω–æ–≤–ª–µ–Ω—å: {e}")

# ============ –Ü–ú–ü–û–†–¢–ò ============
from utils import close_all_rdp_sessions, test_connection
from config import RDP_HOST, RDP_PORT, PING_HOST, APP_NAME

# –ù–æ–≤—ñ —ñ–º–ø–æ—Ä—Ç–∏
from config_manager import ConfigManager
from telegram_api import TelegramAPI
from setup_wizard import SetupWizard
from network_test import NetworkTest

try:
    from rdp_manager import RDPManager

    rdp_manager_available = True
except ImportError as e:
    rdp_manager_available = False
    logger.warning(f"rdp_manager –Ω–µ –¥–æ—Å—Ç—É–ø–Ω–∞: {e}")

try:
    from anydesk_manager import AnyDeskManager

    anydesk_available = True
except ImportError as e:
    anydesk_available = False
    logger.warning(f"anydesk_manager –Ω–µ –¥–æ—Å—Ç—É–ø–Ω–∞: {e}")


class RemoteHandApp(ctk.CTk):
    def __init__(self):
        super().__init__()

        # –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –≤—ñ–∫–Ω–∞
        self.title(APP_NAME)
        self.geometry("520x800")
        self.resizable(True, True)

        # –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç–µ–º–∏
        ctk.set_appearance_mode("light")
        ctk.set_default_color_theme("blue")

        # –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è –º–µ–Ω–µ–¥–∂–µ—Ä—ñ–≤
        self.config = ConfigManager()

        # ‚ö†Ô∏è –ó–ê–í–ê–ù–¢–ê–ñ–ò–¢–ò –¢–û–ö–ï–ù–ò –ó .env –õ–ò CONFIG
        telegram_token = os.getenv("TELEGRAM_TOKEN") or self.config.get("telegram_token")
        telegram_chat_id = os.getenv("TELEGRAM_CHAT_ID") or self.config.get("telegram_chat_id")

        logger.info(f"Telegram token: {'‚úÖ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ' if telegram_token else '‚ùå –ù–ï –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ'}")
        logger.info(f"Telegram chat_id: {'‚úÖ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ' if telegram_chat_id else '‚ùå –ù–ï –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ'}")

        self.telegram = TelegramAPI(telegram_token, telegram_chat_id)

        if rdp_manager_available:
            self.rdp_manager = RDPManager(self.config, self.telegram)
        else:
            self.rdp_manager = None

        if anydesk_available:
            self.anydesk_manager = AnyDeskManager(self.config, self.telegram)
        else:
            self.anydesk_manager = None

        self.network_test = NetworkTest(self.config, self.telegram)

        # ‚ö†Ô∏è –°–¢–í–û–†–ò–¢–ò UI –í–°–Ü –†–ê–ó–ò, –∞ –ø–æ—Ç—ñ–º –ø–æ–∫–∞–∑–∞—Ç–∏ SetupWizard —è–∫—â–æ –ø–µ—Ä—à–∏–π –∑–∞–ø—É—Å–∫
        self.setup_ui()

        if self.config.is_first_run():
            self.show_setup_wizard()

    def get_app_version(self):
        """–û—Ç—Ä–∏–º–∞—Ç–∏ –≤–µ—Ä—Å—ñ—é –ø—Ä–æ–≥—Ä–∞–º–∏"""
        try:
            if getattr(sys, 'frozen', False):
                # –Ø–∫—â–æ EXE - —à—É–∫–∞—î–º–æ –ø–æ—Ä—É—á –∑ EXE
                base_path = Path(sys.executable).parent
            else:
                # –Ø–∫—â–æ DEV - —à—É–∫–∞—î–º–æ –≤ –∫–æ—Ä–µ–Ω—ñ –ø—Ä–æ–µ–∫—Ç—É
                base_path = Path(__file__).parent.parent

            version_file = base_path / "version.txt"

            if version_file.exists():
                return version_file.read_text(encoding='utf-8').strip()
        except Exception as e:
            logger.error(f"–ü–æ–º–∏–ª–∫–∞ —á–∏—Ç–∞–Ω–Ω—è –≤–µ—Ä—Å—ñ—ó: {e}")

        return "1.0.0"

    def show_setup_wizard(self):
        """–ü–æ–∫–∞–∑–∞—Ç–∏ –≤—ñ–∫–Ω–æ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –ø—Ä–∏ –ø–µ—Ä—à–æ–º—É –∑–∞–ø—É—Å–∫—É"""

        def on_setup_complete(result):
            self.config.set("store", result["store"])
            self.config.set("location", result["location"])
            if result.get("user_name"):
                self.config.set("user_name", result["user_name"])
            # ‚úÖ –û–Ω–æ–≤–∏—Ç–∏ UI –ø—ñ—Å–ª—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è
            self.refresh_ui()

        wizard = SetupWizard(self, on_setup_complete)
        self.wait_window(wizard)

    def refresh_ui(self):
        """–û–Ω–æ–≤–∏—Ç–∏ UI –ø—ñ—Å–ª—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è"""
        # –û–Ω–æ–≤–∏—Ç–∏ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –º–∞–≥–∞–∑–∏–Ω
        user_info = self.config.store_location_text
        user_name = self.config.get("user_name", "")
        if user_name:
            user_info += f" | üë§ {user_name}"

        self.info_label.configure(text=f"üìç {user_info}")

    def setup_ui(self):
        """–°—Ç–≤–æ—Ä–µ–Ω–Ω—è UI"""

        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        title_label = ctk.CTkLabel(
            self,
            text="RemoteHand",
            font=ctk.CTkFont(size=28, weight="bold")
        )
        title_label.pack(pady=15)

        # –Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ –º–∞–≥–∞–∑–∏–Ω/–ª–æ–∫–∞—Ü—ñ—é + –ü–Ü–ë
        user_info = self.config.store_location_text
        user_name = self.config.get("user_name", "")
        if user_name:
            user_info += f" | üë§ {user_name}"

        self.info_label = ctk.CTkLabel(
            self,
            text=f"üìç {user_info}",
            font=ctk.CTkFont(size=11),
            text_color="gray"
        )
        self.info_label.pack(pady=(0, 20))

        # ==================== RDP –ë–õ–û–ö ====================
        rdp_frame = ctk.CTkFrame(self)
        rdp_frame.pack(pady=15, padx=20, fill="x")

        ctk.CTkLabel(
            rdp_frame,
            text="üìã –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ 1–°",
            font=ctk.CTkFont(size=13, weight="bold")
        ).pack(anchor="w", pady=(0, 10))

        # –û—Å–Ω–æ–≤–Ω–∞ –∫–Ω–æ–ø–∫–∞ RDP
        rdp_btn = ctk.CTkButton(
            rdp_frame,
            text="üñ•Ô∏è –í—ñ–¥–∫—Ä–∏—Ç–∏ 1–° (RDP)",
            command=self.open_rdp,
            height=50,
            font=ctk.CTkFont(size=12, weight="bold"),
            corner_radius=12,
            fg_color="#007AFF",
            hover_color="#0051D5"
        )
        rdp_btn.pack(fill="x", pady=(0, 10))

        # ==================== –ó–ê–ö–†–ò–¢–¢–Ø –°–ï–°–Ü–ô ====================
        close_sessions_btn = ctk.CTkButton(
            self,
            text="‚ùå –ó–∞–∫—Ä–∏—Ç–∏ –≤—Å—ñ RDP —Å–µ—Å—ñ—ó",
            command=self.close_sessions_confirm,
            height=45,
            font=ctk.CTkFont(size=12, weight="bold"),
            corner_radius=12,
            fg_color="#FF3B30",
            hover_color="#D70015"
        )
        close_sessions_btn.pack(pady=15, padx=20, fill="x")

        # ==================== ANYDESK –ë–õ–û–ö ====================
        if anydesk_available:
            anydesk_frame = ctk.CTkFrame(self)
            anydesk_frame.pack(pady=15, padx=20, fill="x")

            ctk.CTkLabel(
                anydesk_frame,
                text="üåê –í—ñ–¥–¥–∞–ª–µ–Ω–∏–π –¥–æ—Å—Ç—É–ø",
                font=ctk.CTkFont(size=13, weight="bold")
            ).pack(anchor="w", pady=(0, 10))

            anydesk_btn = ctk.CTkButton(
                anydesk_frame,
                text="üöÄ –ó–∞–ø—É—Å—Ç–∏—Ç–∏ AnyDesk",
                command=self.start_anydesk,
                height=50,
                font=ctk.CTkFont(size=12, weight="bold"),
                corner_radius=12,
                fg_color="#FF6B35",
                hover_color="#CC5529"
            )
            anydesk_btn.pack(fill="x", pady=(0, 10))

        # ==================== –¢–ï–°–¢ –ú–ï–†–ï–ñ–Ü ====================
        test_frame = ctk.CTkFrame(self)
        test_frame.pack(pady=15, padx=20, fill="x")

        ctk.CTkLabel(
            test_frame,
            text="üîß –î—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∞",
            font=ctk.CTkFont(size=13, weight="bold")
        ).pack(anchor="w", pady=(0, 10))

        test_btn = ctk.CTkButton(
            test_frame,
            text="üì° –¢–µ—Å—Ç –∑'—î–¥–Ω–∞–Ω–Ω—è",
            command=self.run_network_test,
            height=50,
            font=ctk.CTkFont(size=12, weight="bold"),
            corner_radius=12,
            fg_color="#34C759",
            hover_color="#248A3D"
        )
        test_btn.pack(fill="x", pady=(0, 10))

        # ==================== –°–¢–ê–¢–£–° ====================
        self.status_label = ctk.CTkLabel(
            self,
            text="‚úÖ –ì–æ—Ç–æ–≤–æ –¥–æ —Ä–æ–±–æ—Ç–∏",
            font=ctk.CTkFont(size=10),
            text_color="gray"
        )
        self.status_label.pack(pady=10)

        # ==================== –ö–ù–û–ü–ö–ê –†–ï–î–ê–ì–£–í–ê–ù–ù–Ø –ú–ê–ì–ê–ó–ò–ù–£ ====================
        settings_frame = ctk.CTkFrame(self)
        settings_frame.pack(pady=10, padx=20, fill="x")

        settings_btn = ctk.CTkButton(
            settings_frame,
            text="‚öôÔ∏è –ó–º—ñ–Ω–∏—Ç–∏ –º–∞–≥–∞–∑–∏–Ω/–ª–æ–∫–∞—Ü—ñ—é/–ü–Ü–ë",
            command=self.show_setup_wizard,
            height=35,
            font=ctk.CTkFont(size=10),
            corner_radius=8,
            fg_color="#999999",
            hover_color="#666666"
        )
        settings_btn.pack(fill="x")

        # ==================== –í–ï–†–°–Ü–Ø + –°–¢–ê–¢–£–° –û–ù–û–í–õ–ï–ù–ù–Ø ====================
        version_frame = ctk.CTkFrame(self)
        version_frame.pack(anchor="se", padx=10, pady=10)

        version_label = ctk.CTkLabel(
            version_frame,
            text=f"v{self.get_app_version()}",
            font=ctk.CTkFont(size=9, weight="bold"),
            text_color="#333333"
        )
        version_label.pack(side="left", padx=5)

        self.update_status_label = ctk.CTkLabel(
            version_frame,
            text="‚úÖ",
            font=ctk.CTkFont(size=10),
            text_color="green"
        )
        self.update_status_label.pack(side="left", padx=5)

    def open_rdp(self):
        """–í—ñ–¥–∫—Ä–∏—Ç–∏ RDP"""
        if not self.rdp_manager:
            messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "RDP –º–µ–Ω–µ–¥–∂–µ—Ä –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω")
            return

        # –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —á–∏ –ø–∞—Ä–æ–ª—å –≤–∂–µ –∑–±–µ—Ä–µ–∂–µ–Ω–æ
        saved_password = self.rdp_manager.get_credentials(RDP_HOST, "admin")

        if saved_password:
            # –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –∑–±–µ—Ä–µ–∂–µ–Ω–∏–π –ø–∞—Ä–æ–ª—å
            self.set_status("‚è≥ –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è...", "processing")

            def connect():
                try:
                    if self.rdp_manager.connect_rdp(RDP_HOST, RDP_PORT, "admin", saved_password):
                        self.set_status("‚úÖ –ü—ñ–¥–∫–ª—é—á–µ–Ω–æ", "success")
                    else:
                        self.set_status("‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è", "error")
                except Exception as e:
                    logger.error(f"–ü–æ–º–∏–ª–∫–∞: {e}")
                    self.set_status("‚ùå –ö—Ä–∏—Ç–∏—á–Ω–∞ –ø–æ–º–∏–ª–∫–∞", "error")

            thread = threading.Thread(target=connect, daemon=True)
            thread.start()
        else:
            # –ó–∞–ø—Ä–æ—Å–∏—Ç–∏ –Ω–æ–≤–∏–π –ø–∞—Ä–æ–ª—å
            dialog = ctk.CTkInputDialog(
                text="–í–≤–µ–¥—ñ—Ç—å –ø–∞—Ä–æ–ª—å –¥–ª—è RDP:",
                title="–ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ 1–°"
            )
            password = dialog.get_input()

            if password:
                self.set_status("üíæ –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è –ø–∞—Ä–æ–ª—è...", "processing")

                # –°–ø—Ä–æ–±—É–≤–∞—Ç–∏ –ø—ñ–¥–∫–ª—é—á–∏—Ç–∏—Å—è
                if self.rdp_manager.connect_rdp(RDP_HOST, RDP_PORT, "admin", password):
                    # –Ø–∫—â–æ —É—Å–ø—ñ—à–Ω–æ, —Ç–æ –∑–±–µ—Ä–µ–≥—Ç–∏ –ø–∞—Ä–æ–ª—å
                    self.rdp_manager.save_credentials(RDP_HOST, "admin", password)
                    self.set_status("‚úÖ –£—Å–ø—ñ—à–Ω–æ –ø—ñ–¥–∫–ª—é—á–µ–Ω–æ", "success")
                else:
                    self.set_status("‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è", "error")

    def close_sessions_confirm(self):
        """–ü—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è –∑–∞–∫—Ä–∏—Ç—Ç—è —Å–µ—Å—ñ–π"""
        result = messagebox.askyesno(
            "–ü—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è",
            "–í–∏ –≤–ø–µ–≤–Ω–µ–Ω—ñ, —â–æ —Ö–æ—á–µ—Ç–µ –∑–∞–∫—Ä–∏—Ç–∏ –≤—Å—ñ RDP —Å–µ—Å—ñ—ó?"
        )
        if result:
            self.set_status("‚è≥ –ó–∞–∫—Ä–∏—Ç—Ç—è —Å–µ—Å—ñ–π...", "processing")
            close_all_rdp_sessions()
            self.set_status("‚úÖ –í—Å—ñ —Å–µ—Å—ñ—ó –∑–∞–∫—Ä–∏—Ç–æ", "success")

    def start_anydesk(self):
        """–ó–∞–ø—É—Å—Ç–∏—Ç–∏ AnyDesk - –ë–ï–ó –ø–æ–∫–∞–∑—É –ø–∞—Ä–æ–ª—è!"""
        if not self.anydesk_manager:
            messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "AnyDesk –º–µ–Ω–µ–¥–∂–µ—Ä –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω")
            return

        self.set_status("‚è≥ –ó–∞–ø—É—Å–∫ AnyDesk...", "processing")

        def anydesk_task():
            try:
                # –ó–∞–ø—É—Å—Ç–∏—Ç–∏ AnyDesk - –ø–∞—Ä–æ–ª—å –ù–ï –ø–µ—Ä–µ–¥–∞—î–º–æ —Ç–∞ –ù–ï –ø–æ–∫–∞–∑—É—î–º–æ!
                anydesk_id, pwd = self.anydesk_manager.start(None)

                if anydesk_id:
                    self.set_status(f"‚úÖ AnyDesk –∑–∞–ø—É—â–µ–Ω–æ\nüÜî ID: {anydesk_id}", "success")
                    messagebox.showinfo(
                        "‚úÖ AnyDesk –∑–∞–ø—É—â–µ–Ω–æ",
                        f"ID –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è: {anydesk_id}\n\n"
                        f"–î–∞–Ω—ñ –Ω–∞–¥—ñ—Å–ª–∞–Ω—ñ –≤ Telegram\n"
                        f"–ü–∞—Ä–æ–ª—å –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ"
                    )
                else:
                    self.set_status("‚ùå AnyDesk –≤–∂–µ –∑–∞–ø—É—â–µ–Ω–æ", "error")
                    messagebox.showwarning(
                        "‚ö†Ô∏è –£–≤–∞–≥–∞",
                        "AnyDesk –≤–∂–µ –∑–∞–ø—É—â–µ–Ω–æ –∞–±–æ –Ω–µ –≤–¥–∞–ª–æ—Å—è –∑–∞–ø—É—Å—Ç–∏—Ç–∏"
                    )
            except Exception as e:
                logger.error(f"–ü–æ–º–∏–ª–∫–∞: {e}")
                self.set_status("‚ùå –ü–æ–º–∏–ª–∫–∞ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è", "error")

        thread = threading.Thread(target=anydesk_task, daemon=True)
        thread.start()

    def run_network_test(self):
        """–ó–∞–ø—É—Å—Ç–∏—Ç–∏ —Ç–µ—Å—Ç –º–µ—Ä–µ–∂—ñ"""
        self.set_status("‚è≥ –¢–µ—Å—Ç –º–µ—Ä–µ–∂—ñ...", "processing")

        def test_task():
            try:
                result = self.network_test.run_full_test()
                self.set_status(f"{result['status']}", result['color'])
            except Exception as e:
                logger.error(f"–ü–æ–º–∏–ª–∫–∞ —Ç–µ—Å—Ç—É: {e}")
                self.set_status("‚ùå –ü–æ–º–∏–ª–∫–∞ —Ç–µ—Å—Ç—É", "error")

        thread = threading.Thread(target=test_task, daemon=True)
        thread.start()

    def set_status(self, text, status_type="info"):
        """–í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ —Å—Ç–∞—Ç—É—Å –∑ –∫–æ–ª—å–æ—Ä–æ–º"""
        color_map = {
            "success": "green",
            "error": "red",
            "processing": "blue",
            "info": "gray"
        }
        self.status_label.configure(text=text, text_color=color_map.get(status_type, "gray"))


def main():
    """–ì–æ–ª–æ–≤–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è"""
    logger.info("–ó–∞–ø—É—Å–∫ RemoteHand...")
    app = RemoteHandApp()
    app.mainloop()


if __name__ == "__main__":
    main()


================================================================================
–§–∞–π–ª 11/21: src\network_test.py
--------------------------------------------------------------------------------
import subprocess
import re
import socket
import logging
from pathlib import Path
import tempfile

logger = logging.getLogger(__name__)


class NetworkTest:
    """–¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è –º–µ—Ä–µ–∂—ñ –∑ –∑–≤—ñ—Ç–æ–º"""

    def __init__(self, config_manager, telegram_api):
        self.config = config_manager
        self.telegram = telegram_api

    def run_ping_test(self, host, count=20):
        """–í–∏–∫–æ–Ω–∞—Ç–∏ ping —Ç–µ—Å—Ç –Ω–∞ —Ö–æ—Å—Ç—É"""
        try:
            result = subprocess.run(
                ['ping', host, '-n', str(count)],
                capture_output=True,
                text=True,
                encoding='cp1252',
                timeout=60,
                creationflags=subprocess.CREATE_NO_WINDOW
            )
            return result.stdout
        except Exception as e:
            logger.error(f"–ü–æ–º–∏–ª–∫–∞ ping: {e}")
            return f"–ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—ñ {host}: {str(e)}"

    def parse_ping_loss(self, ping_output):
        """–í–∏—Ç—è–≥—Ç–∏ –≤—ñ–¥—Å–æ—Ç–æ–∫ –≤—Ç—Ä–∞—Ç–∏ –ø–∞–∫–µ—Ç—ñ–≤"""
        try:
            match = re.search(r'(\d+)%\s+(–ø–æ—Ç–µ—Ä—å|loss)', ping_output, re.IGNORECASE)
            if match:
                return int(match.group(1))
            return 0
        except:
            return -1

    def run_full_test(self):
        """–ó–∞–ø—É—Å—Ç–∏—Ç–∏ –ø–æ–≤–Ω–∏–π —Ç–µ—Å—Ç –º–µ—Ä–µ–∂—ñ"""
        pc_name = socket.gethostname()
        store_location = self.config.store_location_text

        hosts = {
            "1–° –°–µ—Ä–≤–µ—Ä": "23.88.7.196",
            "Google DNS": "8.8.8.8"
        }

        report_parts = []
        total_loss = 0

        for name, ip in hosts.items():
            ping_output = self.run_ping_test(ip)
            loss = self.parse_ping_loss(ping_output)

            if loss >= 0:
                status = "‚úÖ" if loss == 0 else ("‚ö†Ô∏è" if loss <= 15 else "‚ùå")
                report_parts.append(f"{status} {name} ({ip}): {loss}% –≤—Ç—Ä–∞—Ç–∏")
                total_loss += loss
            else:
                report_parts.append(f"‚ùå {name} ({ip}): –ü–æ–º–∏–ª–∫–∞ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è")

        avg_loss = total_loss / len(hosts) if hosts else 0

        if avg_loss == 0:
            status_text = "‚úÖ –ú–µ—Ä–µ–∂–∞ –≤ –Ω–æ—Ä–º—ñ"
            color = "green"
        elif avg_loss <= 15:
            status_text = "‚ö†Ô∏è –Ñ –Ω–µ–≤–µ–ª–∏–∫—ñ –ø—Ä–æ–±–ª–µ–º–∏"
            color = "orange"
        else:
            status_text = "‚ùå –°–µ—Ä–π–æ–∑–Ω—ñ –ø—Ä–æ–±–ª–µ–º–∏"
            color = "red"

        # –í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ –≤ Telegram
        test_report = "\n".join(report_parts)
        self.telegram.send_network_report(store_location, pc_name, test_report)

        return {
            "status": status_text,
            "color": color,
            "details": test_report
        }


================================================================================
–§–∞–π–ª 12/21: src\rdp_manager.py
--------------------------------------------------------------------------------
import os
import subprocess
import time
import winreg
import logging
import keyring
from pathlib import Path

logger = logging.getLogger(__name__)


class RDPManager:
    """–ú–µ–Ω–µ–¥–∂–µ—Ä –¥–ª—è RDP –ø—ñ–¥–∫–ª—é—á–µ–Ω—å –∑ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–º –ª–æ–≥—ñ–Ω–æ–º"""

    def __init__(self, config_manager, telegram_api):
        self.config = config_manager
        self.telegram = telegram_api

    def save_credentials(self, host, username, password):
        """–ó–±–µ—Ä–µ–≥—Ç–∏ RDP –¥–∞–Ω—ñ –≤ Windows Credential Manager"""
        try:
            keyring.set_password(f"RDP_{host}", username, password)
            self.config.set("rdp_password", password)
            logger.info(f"‚úÖ –î–∞–Ω—ñ –∑–±–µ—Ä–µ–∂–µ–Ω—ñ –¥–ª—è {host}")
            return True
        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è: {e}")
            return False

    def get_credentials(self, host, username):
        """–û—Ç—Ä–∏–º–∞—Ç–∏ –ø–∞—Ä–æ–ª—å –∑ Credential Manager"""
        try:
            password = keyring.get_password(f"RDP_{host}", username)
            return password
        except:
            return None

    def connect_rdp(self, host, port, username, password=None):
        """–ü—ñ–¥–∫–ª—é—á–∏—Ç–∏—Å—è –¥–æ RDP"""
        try:
            # –ö–æ–¥—É–≤–∞–Ω–Ω—è –ø–∞—Ä–æ–ª—è –¥–ª—è .RDP —Ñ–∞–π–ª—É
            encrypted_password = self._encrypt_rdp_password(password) if password else ""

            rdp_content = f"""screen mode id:i:2
use multimon:i:0
desktopwidth:i:1920
desktopheight:i:1080
session bpp:i:32
connection type:i:7
disable wallpaper:i:0
allow font smoothing:i:1
allow desktop composition:i:1
disable full window drag:i:0
disable menu anims:i:0
disable themes:i:0
disable cursor setting:i:0
bitmapcachepersistenable:i:1
full address:s:{host}:{port}
audiomode:i:0
redirectprinters:i:0
redirectcomports:i:0
redirectsmartcards:i:0
redirectclipboard:i:1
redirectposdevices:i:0
autoreconnection enabled:i:1
authentication level:i:0
prompt for credentials on client:i:0
negotiate security layer:i:1
enablecredsspsupport:i:1
username:s:{username}
password 51:b:{encrypted_password}
"""

            rdp_file = f"{host}_{username}_session.rdp"
            with open(rdp_file, "w") as f:
                f.write(rdp_content)

            subprocess.Popen(f"mstsc {rdp_file}")
            logger.info(f"‚úÖ RDP –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –∑–∞–ø—É—â–µ–Ω–æ")

            # –í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ –≤ Telegram
#            self.telegram.send_rdp_info(
#                self.config.store_location_text,
#                os.environ.get('COMPUTERNAME', 'Unknown')
#            )

            return True
        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è: {e}")
            return False

    def _encrypt_rdp_password(self, password):
        """–ü—Ä–æ—Å—Ç–æ–µ —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è –ø–∞—Ä–æ–ª—è –¥–ª—è .RDP"""
        encrypted = ""
        for char in password:
            encrypted += format(ord(char) ^ 0xAA, '02x')
        return encrypted


================================================================================
–§–∞–π–ª 13/21: src\set_anydesk_password.py
--------------------------------------------------------------------------------
#!/usr/bin/env python3
"""–í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –ø–∞—Ä–æ–ª—è AnyDesk –∑ –∞–¥–º—ñ–Ω –ø—Ä–∞–≤–∞–º–∏"""

import subprocess
import sys
import os
import time
import ctypes

ANYDESK_PATH = sys.argv[1] if len(sys.argv) > 1 else None
PASSWORD = os.getenv("ANYDESK_PASSWORD", "r3moteh4nd")

if not ANYDESK_PATH or not os.path.exists(ANYDESK_PATH):
    print("[!] AnyDesk –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ")
    sys.exit(1)

# –ü–µ—Ä–µ–≤—ñ—Ä–∏–º–æ —á–∏ –∑–∞–ø—É—â–µ–Ω–æ –∑ –∞–¥–º—ñ–Ω –ø—Ä–∞–≤–∞–º–∏
try:
    is_admin = ctypes.windll.shell32.IsUserAnAdmin()
    if not is_admin:
        print("[!] –ü–æ—Ç—Ä—ñ–±–Ω—ñ –∞–¥–º—ñ–Ω –ø—Ä–∞–≤–∞")
        # –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–∏ –∑ –∞–¥–º—ñ–Ω –ø—Ä–∞–≤–∞–º–∏
        ctypes.windll.shell32.ShellExecuteW(
            None,
            "runas",
            sys.executable,
            f'"{__file__}" "{ANYDESK_PATH}"',
            None,
            1  # SW_SHOW
        )
        sys.exit(0)
except:
    pass

try:
    print(f"[*] –í—Å—Ç–∞–Ω–æ–≤–ª—é—é –ø–∞—Ä–æ–ª—å AnyDesk (—É –∞–¥–º—ñ–Ω—ñ)...")
    time.sleep(1)

    # –í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ —á–µ—Ä–µ–∑ stdin
    cmd = [ANYDESK_PATH, "--set-password", "_full_access"]

    result = subprocess.run(
        cmd,
        input=PASSWORD + "\n",
        capture_output=True,
        text=True,
        timeout=10
    )

    print(f"[CODE] {result.returncode}")
    if result.returncode in [0, 8000]:
        print("[‚úì] –ü–∞—Ä–æ–ª—å –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ!")
    else:
        print(f"[!] –ö–æ–¥: {result.returncode}")

    sys.exit(0)

except Exception as e:
    print(f"[!] –ü–æ–º–∏–ª–∫–∞: {e}")
    sys.exit(1)


================================================================================
–§–∞–π–ª 14/21: src\setup_wizard.py
--------------------------------------------------------------------------------
import customtkinter as ctk
import tkinter.messagebox as messagebox


class SetupWizard(ctk.CTkToplevel):
    def __init__(self, parent, on_complete):
        super().__init__(parent)

        self.title("RemoteHand - –ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞")
        self.geometry("450x500")
        self.resizable(False, False)

        # –¶–µ–Ω—Ç—Ä—É–≤–∞—Ç–∏ –Ω–∞ –µ–∫—Ä–∞–Ω—ñ
        self.transient(parent)
        self.grab_set()

        # ‚ö†Ô∏è –ó–ê–ë–û–†–û–ù–ò–¢–ò –ó–ê–ö–†–ò–¢–¢–Ø –ë–ï–ó –ó–ë–ï–†–ï–ñ–ï–ù–ù–Ø
        self.protocol("WM_DELETE_WINDOW", self.on_closing)

        self.on_complete = on_complete
        self.setup_complete = False

        # –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç–µ–º–∏
        ctk.set_appearance_mode("light")
        ctk.set_default_color_theme("blue")

        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        title = ctk.CTkLabel(
            self,
            text="–ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞",
            font=ctk.CTkFont(size=18, weight="bold")
        )
        title.pack(pady=20)

        # ===== –ú–ê–ì–ê–ó–ò–ù (–í–´–ë–Ü–†) =====
        ctk.CTkLabel(
            self,
            text="–í–∏–±–µ—Ä—ñ—Ç—å –º–∞–≥–∞–∑–∏–Ω:",
            font=ctk.CTkFont(size=12, weight="bold")
        ).pack(anchor="w", padx=20, pady=(10, 5))

        self.store_var = ctk.StringVar(value="")
        store_options = [
            "0 / –û—Ñ—ñ—Å",
            "1 / –î—ñ–∞–ª–æ–≥",
            "5 / –ü–æ–ª—Ç–∞–≤–∞",
            "7 / –û–∞–∑–∏—Å",
            "8 / –•–º–µ–ª—å–Ω–∏—Ü—å–∫–∏–π",
            "9 / –ß–µ—Ä–Ω—ñ–≤—Ü—ñ",
            "17 / –ö—Ä–µ–º–µ–Ω—á—É–∫",
            "18 / –ü_–ö–æ—Ç–ª—è—Ä–µ–≤—Å—å–∫–æ–≥–æ",
            "20 / –©–∞—Å–ª–∏–≤–∏–π",
            "21 / –°–æ—Ñ—ñ—è –º–æ–ª–ª"
        ]

        self.store_menu = ctk.CTkComboBox(
            self,
            values=store_options,
            variable=self.store_var,
            font=ctk.CTkFont(size=11),
            height=35
        )
        self.store_menu.pack(padx=20, fill="x", pady=(0, 20))

        # ===== –õ–û–ö–ê–¶–Ü–Ø (–í–´–ë–Ü–†) =====
        ctk.CTkLabel(
            self,
            text="–í–∏–±–µ—Ä—ñ—Ç—å –ª–æ–∫–∞—Ü—ñ—é:",
            font=ctk.CTkFont(size=12, weight="bold")
        ).pack(anchor="w", padx=20, pady=(10, 5))

        self.location_var = ctk.StringVar(value="")
        location_options = [
            "–∫–∞—Å–∞",
            "–∫–∞—Å–∞ 2",
            "–ø—ñ–¥—Å–æ–±–∫–∞",
            "–æ—Å–æ–±–∏—Å—Ç–∏–π"
        ]

        self.location_menu = ctk.CTkComboBox(
            self,
            values=location_options,
            variable=self.location_var,
            font=ctk.CTkFont(size=11),
            height=35
        )
        self.location_menu.pack(padx=20, fill="x", pady=(0, 20))

        # ===== –ü–Ü–ë (–û–ü–¶–Ü–ô–ù–û) =====
        ctk.CTkLabel(
            self,
            text="–ü–Ü–ë –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ (–æ–ø—Ü—ñ–π–Ω–æ):",
            font=ctk.CTkFont(size=12, weight="bold")
        ).pack(anchor="w", padx=20, pady=(10, 5))

        self.user_name_entry = ctk.CTkEntry(
            self,
            placeholder_text="–ù–∞–ø—Ä–∏–∫–ª–∞–¥: –Ü–≤–∞–Ω –ü–µ—Ç—Ä–µ–Ω–∫–æ",
            height=35,
            font=ctk.CTkFont(size=11)
        )
        self.user_name_entry.pack(padx=20, fill="x", pady=(0, 30))

        # –ö–Ω–æ–ø–∫–∞
        btn = ctk.CTkButton(
            self,
            text="‚úÖ –ó–±–µ—Ä–µ–≥—Ç–∏",
            command=self.save_settings,
            height=45,
            font=ctk.CTkFont(size=12, weight="bold"),
            corner_radius=10
        )
        btn.pack(padx=20, fill="x", pady=10)

    def on_closing(self):
        """–ó–∞–±–æ—Ä–æ–Ω–∏—Ç–∏ –∑–∞–∫—Ä–∏—Ç—Ç—è –±–µ–∑ –≤–≤–µ–¥–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö"""
        if not self.setup_complete:
            messagebox.showwarning(
                "–ü–æ–º–∏–ª–∫–∞",
                "–í–∏–±–µ—Ä—ñ—Ç—å –º–∞–≥–∞–∑–∏–Ω —ñ –ª–æ–∫–∞—Ü—ñ—é –ø–µ—Ä–µ–¥ –∑–∞–∫—Ä–∏—Ç—Ç—è–º!"
            )
            return
        self.destroy()

    def save_settings(self):
        """–ó–±–µ—Ä–µ–≥—Ç–∏ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è - –æ–±–æ–≤'—è–∑–∫–æ–≤–æ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏"""
        store = self.store_var.get().strip()
        location = self.location_var.get().strip()
        user_name = self.user_name_entry.get().strip()

        # ‚ö†Ô∏è –û–ë–û–í'–Ø–ó–ö–û–í–ê –ü–ï–†–ï–í–Ü–†–ö–ê
        if not store:
            messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–í–∏–±–µ—Ä—ñ—Ç—å –º–∞–≥–∞–∑–∏–Ω!")
            return

        if not location:
            messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–í–∏–±–µ—Ä—ñ—Ç—å –ª–æ–∫–∞—Ü—ñ—é!")
            return

        # –í—Å–µ –æ–∫ - –∑–±–µ—Ä–µ–∂–µ–º–æ
        self.setup_complete = True
        self.on_complete({
            "store": store,
            "location": location,
            "user_name": user_name
        })
        self.destroy()


================================================================================
–§–∞–π–ª 15/21: src\telegram_api.py
--------------------------------------------------------------------------------
import requests
import logging
import time
import os
from pathlib import Path

logger = logging.getLogger(__name__)


class TelegramAPI:
    """–†–æ–∑—à–∏—Ä–µ–Ω–∞ Telegram API –¥–ª—è –∑–≤—ñ—Ç—É–≤–∞–Ω–Ω—è"""

    def __init__(self, token, chat_id):
        self.token = token
        self.chat_id = chat_id

        # ‚ö†Ô∏è –ü–ï–†–ï–í–Ü–†–ê –¢–û–ö–ï–ù–Ü–í
        if not token:
            logger.error("‚ùå Telegram —Ç–æ–∫–µ–Ω –Ω–µ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ!")
            self.api_url = None
        elif not chat_id:
            logger.error("‚ùå Telegram chat_id –Ω–µ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ!")
            self.api_url = None
        else:
            self.api_url = f"https://api.telegram.org/bot{token}"
            logger.info(f"‚úÖ Telegram –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–æ (—Ç–æ–∫–µ–Ω: {token[:20]}...)")

    def send_message(self, text, parse_mode="HTML"):
        """–í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ —Ç–µ–∫—Å—Ç–æ–≤–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è"""
        if not self.api_url:
            logger.error("‚ùå Telegram –Ω–µ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–æ")
            return False

        try:
            payload = {
                "chat_id": self.chat_id,
                "text": text,
                "parse_mode": parse_mode
            }
            response = requests.post(
                f"{self.api_url}/sendMessage",
                json=payload,
                timeout=10
            )
            response.raise_for_status()
            logger.info("‚úÖ –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –Ω–∞–¥—ñ—Å–ª–∞–Ω–æ –≤ Telegram")
            return True
        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞ –≤—ñ–¥–ø—Ä–∞–≤–∫–∏ Telegram: {e}")
            return False

    def send_file(self, file_path, caption="", file_type="document"):
        """–í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ —Ñ–∞–π–ª (document –∞–±–æ photo)"""
        if not self.api_url:
            logger.error("‚ùå Telegram –Ω–µ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–æ")
            return False

        try:
            with open(file_path, 'rb') as f:
                files = {file_type: f}
                payload = {
                    "chat_id": self.chat_id,
                    "caption": caption,
                    "parse_mode": "HTML"
                }
                endpoint = "sendDocument" if file_type == "document" else "sendPhoto"
                response = requests.post(
                    f"{self.api_url}/{endpoint}",
                    files=files,
                    data=payload,
                    timeout=30
                )
                response.raise_for_status()
            logger.info(f"‚úÖ –§–∞–π–ª –Ω–∞–¥—ñ—Å–ª–∞–Ω–æ –≤ Telegram")
            return True
        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞ –≤—ñ–¥–ø—Ä–∞–≤–∫–∏ —Ñ–∞–π–ª—É: {e}")
            return False

    def send_network_report(self, store_location, pc_name, test_results):
        """–í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ –∑–≤—ñ—Ç –ø—Ä–æ —Å—Ç–∞–Ω –º–µ—Ä–µ–∂—ñ"""
        report = (
            f"<b>üìä –ó–≤—ñ—Ç –ø—Ä–æ —Å—Ç–∞–Ω –º–µ—Ä–µ–∂—ñ</b>\n\n"
            f"<b>–ú–∞–≥–∞–∑–∏–Ω/–õ–æ–∫–∞—Ü—ñ—è:</b> {store_location}\n"
            f"<b>–ü–ö:</b> <code>{pc_name}</code>\n"
            f"<b>–ß–∞—Å:</b> {time.strftime('%Y-%m-%d %H:%M:%S')}\n\n"
            f"<b>–†–µ–∑—É–ª—å—Ç–∞—Ç–∏:</b>\n"
            f"{test_results}"
        )
        return self.send_message(report)

    def send_anydesk_info(self, store_location, user_name, pc_name, anydesk_id, password):
        """–í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ AnyDesk —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é"""

        # –î–æ–¥–∞—Ç–∏ –ü–Ü–ë —è–∫—â–æ —î
        user_info = f"\n<b>üë§ –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á:</b> {user_name}" if user_name else ""

        message = (
            f"<b>üåê AnyDesk - –ó–∞–ø—Ä–æ—Å –Ω–∞ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è</b>\n\n"
            f"<b>üìç –ú–∞–≥–∞–∑–∏–Ω/–õ–æ–∫–∞—Ü—ñ—è:</b> {store_location}{user_info}\n"
            f"<b>üíª –ü–ö:</b> <code>{pc_name}</code>\n\n"
            f"<b>üÜî ID:</b> <code>{anydesk_id}</code>\n"
            f"<b>üîê –ü–∞—Ä–æ–ª—å:</b> <code>{password}</code>"
        )
        return self.send_message(message)

    def send_rdp_info(self, store_location, pc_name):
        """–í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è –ø—Ä–æ RDP –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è"""
        message = (
            f"<b>üñ•Ô∏è RDP –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è</b>\n\n"
            f"<b>–ú–∞–≥–∞–∑–∏–Ω/–õ–æ–∫–∞—Ü—ñ—è:</b> {store_location}\n"
            f"<b>–ü–ö:</b> <code>{pc_name}</code>\n"
            f"<b>–ß–∞—Å:</b> {time.strftime('%Y-%m-%d %H:%M:%S')}\n\n"
            f"‚úÖ –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –ø—ñ–¥–∫–ª—é—á–∏–≤—Å—è –¥–æ 1–°"
        )
        return self.send_message(message)

    def send_error_report(self, store_location, pc_name, error_text):
        """–í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ –∑–≤—ñ—Ç –ø—Ä–æ –ø–æ–º–∏–ª–∫—É"""
        message = (
            f"<b>‚ùå –ü–æ–º–∏–ª–∫–∞</b>\n\n"
            f"<b>–ú–∞–≥–∞–∑–∏–Ω/–õ–æ–∫–∞—Ü—ñ—è:</b> {store_location}\n"
            f"<b>–ü–ö:</b> <code>{pc_name}</code>\n"
            f"<b>–ß–∞—Å:</b> {time.strftime('%Y-%m-%d %H:%M:%S')}\n\n"
            f"<b>–î–µ—Ç–∞–ª—ñ:</b>\n<code>{error_text}</code>"
        )
        return self.send_message(message)


================================================================================
–§–∞–π–ª 16/21: src\telegram_helper.py
--------------------------------------------------------------------------------
import asyncio
import json
import logging
from telegram import Bot

logger = logging.getLogger(__name__)


class TelegramHelper:
    """–î–æ–ø–æ–º—ñ–∂–Ω–∏–∫ –¥–ª—è –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å –≤ Telegram"""

    def __init__(self, config_path="bot_config.json"):
        self.config_path = config_path
        self.config = self.load_config()

    def load_config(self):
        """–ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –∫–æ–Ω—Ñ—ñ–≥"""
        try:
            with open(self.config_path, "r", encoding="utf-8") as f:
                return json.load(f)
        except:
            return {}

    async def send_anydesk_code(self, anydesk_id, password):
        """–í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ AnyDesk –¥–∞–Ω—ñ –≤ Telegram"""
        try:
            token = self.config.get("TELEGRAM_TOKEN")
            chat_id = self.config.get("CHAT_ID")

            if not token or not chat_id:
                logger.error("‚ùå –ù–µ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ñ TELEGRAM_TOKEN –∞–±–æ CHAT_ID")
                return False

            bot = Bot(token=token)

            message = (
                f"üñ•Ô∏è **AnyDesk —Å–µ—Å—ñ—è –∞–∫—Ç–∏–≤–æ–≤–∞–Ω–∞**\n\n"
                f"üÜî ID: `{anydesk_id}`\n"
                f"üîê –ü–∞—Ä–æ–ª—å: `{password}`\n\n"
                f"–î–ª—è –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ —Ü—ñ –¥–∞–Ω—ñ."
            )

            await bot.send_message(
                chat_id=chat_id,
                text=message,
                parse_mode="Markdown"
            )

            logger.info("‚úÖ –î–∞–Ω—ñ –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω—ñ –≤ Telegram")
            return True

        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞ –≤—ñ–¥–ø—Ä–∞–≤–∫–∏: {e}")
            return False

    async def send_message(self, text):
        """–í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ –¥–æ–≤—ñ–ª—å–Ω–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è"""
        try:
            token = self.config.get("TELEGRAM_TOKEN")
            chat_id = self.config.get("CHAT_ID")

            if not token or not chat_id:
                return False

            bot = Bot(token=token)
            await bot.send_message(chat_id=chat_id, text=text)

            return True

        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞: {e}")
            return False

    def send_anydesk_code_sync(self, anydesk_id, password):
        """–°–∏–Ω—Ö—Ä–æ–Ω–Ω–∞ –≤–µ—Ä—Å—ñ—è (–¥–ª—è GUI)"""
        try:
            loop = asyncio.new_event_loop()
            asyncio.set_event_loop(loop)
            result = loop.run_until_complete(
                self.send_anydesk_code(anydesk_id, password)
            )
            loop.close()
            return result
        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞: {e}")
            return False


================================================================================
–§–∞–π–ª 17/21: src\updater.py
--------------------------------------------------------------------------------
import os
import sys
import requests
import subprocess
import time
import logging
from pathlib import Path

logger = logging.getLogger(__name__)


class UpdaterManager:
    """–ú–µ–Ω–µ–¥–∂–µ—Ä –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ —Ç–∞ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –æ–Ω–æ–≤–ª–µ–Ω—å"""

    GITHUB_REPO = "ShevchukVI/RemoteHand"
    GITHUB_API_URL = f"https://api.github.com/repos/{GITHUB_REPO}/releases/latest"

    def __init__(self):
        self.app_dir = Path(__file__).parent.parent
        self.version_file = self.app_dir / "version.txt"
        self.current_version = self.get_current_version()

    def get_current_version(self):
        """–û—Ç—Ä–∏–º–∞—Ç–∏ –ø–æ—Ç–æ—á–Ω—É –≤–µ—Ä—Å—ñ—é"""
        if self.version_file.exists():
            try:
                with open(self.version_file, 'r', encoding='utf-8') as f:
                    return f.read().strip()
            except:
                pass
        return "1.0.0"

    def get_latest_version(self):
        """–û—Ç—Ä–∏–º–∞—Ç–∏ –Ω–∞–π–Ω–æ–≤—ñ—à—É –≤–µ—Ä—Å—ñ—é –∑ GitHub"""
        try:
            response = requests.get(self.GITHUB_API_URL, timeout=10)
            response.raise_for_status()
            data = response.json()
            tag = data.get('tag_name', 'v1.0.0')
            return tag.lstrip('v')
        except Exception as e:
            logger.warning(f"–ù–µ –≤–¥–∞–ª–æ—Å—è –æ—Ç—Ä–∏–º–∞—Ç–∏ –≤–µ—Ä—Å—ñ—é –∑ GitHub: {e}")
            return None

    def compare_versions(self, current, latest):
        """–ü–æ—Ä—ñ–≤–Ω—è—Ç–∏ –≤–µ—Ä—Å—ñ—ó"""
        try:
            current_parts = [int(x) for x in current.split('.')]
            latest_parts = [int(x) for x in latest.split('.')]
            return latest_parts > current_parts
        except:
            return False

    def download_and_update(self, latest_version):
        """–ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —Ç–∞ –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –Ω–æ–≤—É –≤–µ—Ä—Å—ñ—é"""
        try:
            logger.info(f"üì• –ó–∞–≤–∞–Ω—Ç–∞–∂—É—é RemoteHand v{latest_version}...")

            download_url = f"https://github.com/{self.GITHUB_REPO}/releases/download/v{latest_version}/RemoteHand.exe"

            # –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –Ω–æ–≤—É –≤–µ—Ä—Å—ñ—é
            response = requests.get(download_url, timeout=30)
            response.raise_for_status()

            # –í–∏–∑–Ω–∞—á–∏—Ç–∏ —à–ª—è—Ö –¥–ª—è –Ω–æ–≤–æ—ó –≤–µ—Ä—Å—ñ—ó
            if getattr(sys, 'frozen', False):
                # –Ø–∫—â–æ –∑–∞–ø—É—â–µ–Ω–æ —è–∫ EXE
                current_exe = Path(sys.executable)
                new_exe = current_exe.parent / "RemoteHand_new.exe"
            else:
                # –Ø–∫—â–æ –∑–∞–ø—É—â–µ–Ω–æ —è–∫ Python —Å–∫—Ä–∏–ø—Ç (DEV)
                new_exe = Path.cwd() / "RemoteHand_new.exe"

            # –ó–±–µ—Ä–µ–≥—Ç–∏ –Ω–æ–≤—É –≤–µ—Ä—Å—ñ—é
            with open(new_exe, 'wb') as f:
                f.write(response.content)

            logger.info(f"‚úÖ RemoteHand v{latest_version} –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ")
            return str(new_exe)

        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è: {e}")
            return None

    def check_and_update(self):
        """–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —Ç–∞ –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è"""
        # –ù–ï –æ–Ω–æ–≤–ª—é–≤–∞—Ç–∏ –≤ DEV —Ä–µ–∂–∏–º—ñ!
        if os.getenv('REMOTEHAND_DEV_MODE') == '1':
            logger.info("üîß DEV —Ä–µ–∂–∏–º - –ø—Ä–æ–ø—É—Å–∫–∞—î–º–æ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è")
            return False

        logger.info("üîç –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –æ–Ω–æ–≤–ª–µ–Ω—å...")

        latest_version = self.get_latest_version()
        if not latest_version:
            logger.info("‚ö†Ô∏è –ù–µ –≤–¥–∞–ª–æ—Å—è –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è")
            return False

        if self.compare_versions(self.current_version, latest_version):
            logger.info(f"üì¶ –î–æ—Å—Ç—É–ø–Ω–µ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è: {latest_version}")
            logger.info(f"üìå –ü–æ—Ç–æ—á–Ω–∞ –≤–µ—Ä—Å—ñ—è: {self.current_version}")

            # –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –Ω–æ–≤—É –≤–µ—Ä—Å—ñ—é
            new_exe = self.download_and_update(latest_version)

            if new_exe and os.path.exists(new_exe):
                logger.info(f"‚úÖ –ù–æ–≤–∞ –≤–µ—Ä—Å—ñ—è –≥–æ—Ç–æ–≤–∞!")
                logger.info(f"üîÑ –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫...")

                # ‚ö†Ô∏è –ê–í–¢–û–ú–ê–¢–ò–ß–ù–ò–ô –ü–ï–†–ï–ó–ê–ü–£–°–ö
                try:
                    # –ó–∞–ø—É—Å—Ç–∏—Ç–∏ –Ω–æ–≤—É –≤–µ—Ä—Å—ñ—é
                    subprocess.Popen([new_exe], shell=False)

                    # –ß–µ–∫–∞—Ç–∏ 1 —Å–µ–∫—É–Ω–¥—É
                    time.sleep(1)

                    # –ó–∞–∫—Ä–∏—Ç–∏ –ø–æ—Ç–æ—á–Ω—É –≤–µ—Ä—Å—ñ—é
                    logger.info("üëã –ó–∞–≤–µ—Ä—à–µ–Ω–Ω—è —Ä–æ–±–æ—Ç–∏ —Å—Ç–∞—Ä–æ—ó –≤–µ—Ä—Å—ñ—ó")
                    sys.exit(0)

                except Exception as e:
                    logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫—É: {e}")
                    logger.info(f"–ó–∞–ø—É—Å—Ç—ñ—Ç—å –≤—Ä—É—á–Ω—É: {new_exe}")
                    return False

                return True

        logger.info(f"‚úÖ –í–µ—Ä—Å—ñ—è –∞–∫—Ç—É–∞–ª—å–Ω–∞: {self.current_version}")
        return False


def check_and_update():
    """–§—É–Ω–∫—Ü—ñ—è –¥–ª—è —ñ–º–ø–æ—Ä—Ç—É –≤ main.py"""
    updater = UpdaterManager()
    return updater.check_and_update()


================================================================================
–§–∞–π–ª 18/21: src\utils.py
--------------------------------------------------------------------------------
import os
import sys
import subprocess
import psutil
from pathlib import Path
from config import LOCK_FILE, APP_NAME


class SingleInstance:
    """–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –Ω–∞ —î–¥–∏–Ω–∏–π –µ–∫–∑–µ–º–ø–ª—è—Ä –ø—Ä–æ–≥—Ä–∞–º–∏"""

    def __init__(self):
        self.lock_file = LOCK_FILE
        self.fp = None

    def is_running(self):
        """–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —á–∏ –ø—Ä–æ–≥—Ä–∞–º–∞ –≤–∂–µ –∑–∞–ø—É—â–µ–Ω–∞"""
        if sys.platform == 'win32':
            import win32event
            import win32api
            import winerror

            self.mutex = win32event.CreateMutex(None, False, APP_NAME)
            if win32api.GetLastError() == winerror.ERROR_ALREADY_EXISTS:
                return True
        else:
            try:
                self.fp = open(self.lock_file, 'w')
                import fcntl
                fcntl.flock(self.fp, fcntl.LOCK_EX | fcntl.LOCK_NB)
            except IOError:
                return True
        return False


def open_rdp_connection(host, port):
    """–í—ñ–¥–∫—Ä–∏—Ç—Ç—è RDP –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è"""
    rdp_command = f'mstsc /v:{host}:{port}'
    subprocess.Popen(rdp_command, shell=True)


def close_all_rdp_sessions():
    """–ó–∞–∫—Ä–∏—Ç—Ç—è –≤—Å—ñ—Ö RDP —Å–µ—Å—ñ–π"""
    for proc in psutil.process_iter(['name']):
        try:
            if proc.info['name'].lower() == 'mstsc.exe':
                proc.kill()
        except (psutil.NoSuchProcess, psutil.AccessDenied):
            pass


def test_connection(host):
    """–¢–µ—Å—Ç –∑'—î–¥–Ω–∞–Ω–Ω—è —á–µ—Ä–µ–∑ ping"""
    param = '-n' if sys.platform == 'win32' else '-c'
    command = ['ping', param, '1', host]
    result = subprocess.run(command, capture_output=True, text=True)
    return result.returncode == 0

================================================================================
–§–∞–π–ª 19/21: version.txt
--------------------------------------------------------------------------------
—è—é1 . 0 . 4 
 
 

================================================================================
–§–∞–π–ª 20/21: version_info.txt
--------------------------------------------------------------------------------
VSVersionInfo(
  ffi=FixedFileInfo(mask=0x3f,
    mask_values=[(0, 63), (0, 63), (0, 63), (0, 63)],
    CV_VSVersionInfo=[(0, '0'), (0, '3'), (0, '0'), (0, '0')]),
  StringFileInfo([(u'040904B0',
    StringTable(u'040904B0',
      [StringEntry(u'CompanyName', u'RemoteHand'),
       StringEntry(u'FileDescription', u'RemoteHand - RDP & AnyDesk Manager'),
       StringEntry(u'FileVersion', u'1.0.3.0'),
       StringEntry(u'ProductName', u'RemoteHand'),
       StringEntry(u'ProductVersion', u'1.0.3')]))]),
  VarFileInfo([VarEntry(u'Translation', [1033, 1200])])
)


================================================================================
–§–∞–π–ª 21/21: –ê–∫—Ç–∏–≤–∞—Ü—ñ—è —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞.txt
--------------------------------------------------------------------------------
.venvScriptsActivate.ps1

================================================================================
–ö–Ü–ù–ï–¶–¨ –ï–ö–°–ü–û–†–¢–£
================================================================================


================================================================================
–§–∞–π–ª 6/20: README.md
--------------------------------------------------------------------------------


================================================================================
–§–∞–π–ª 7/20: requirements.txt
--------------------------------------------------------------------------------
customtkinter==5.2.1
requests==2.31.0
psutil==5.9.6
keyring==24.1.0
python-telegram-bot==20.3
packaging>=24.0
pywin32>=300
python-dotenv

================================================================================
–§–∞–π–ª 8/20: src\anydesk_manager.py
--------------------------------------------------------------------------------
import os
import sys
import subprocess
import time
import logging
import psutil
import platform
import ctypes
import socket
from pathlib import Path
from typing import Optional, Tuple

logger = logging.getLogger(__name__)

UNATTENDED_PASSWORD = "r3moteh4nd"


class AnyDeskManager:
    """–ú–µ–Ω–µ–¥–∂–µ—Ä –¥–ª—è AnyDesk"""

    def __init__(self, config_manager, telegram_api):
        self.config = config_manager
        self.telegram = telegram_api
        self.anydesk_path = self.find_anydesk()
        self._is_running = False
        self.connection_id = None

    def find_anydesk(self) -> Optional[str]:
        """–ó–Ω–∞–π—Ç–∏ AnyDesk"""
        possible_paths = [
            r"C:\Program Files\AnyDesk\AnyDesk.exe",
            r"C:\Program Files (x86)\AnyDesk\AnyDesk.exe",
            os.path.expanduser("~\\AppData\\Local\\AnyDesk\\AnyDesk.exe"),
            os.path.expanduser("~\\AppData\\Roaming\\AnyDesk\\AnyDesk.exe"),
            os.path.expanduser("~\\Downloads\\AnyDesk.exe"),
            r"C:\ProgramData\AnyDesk\AnyDesk.exe",
        ]

        for path in possible_paths:
            if os.path.exists(path):
                logger.info(f"‚úÖ AnyDesk –∑–Ω–∞–π–¥–µ–Ω–æ: {path}")
                return path

        logger.warning("‚ö†Ô∏è AnyDesk –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ")
        return None

    def download_anydesk(self) -> bool:
        """–ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ AnyDesk"""
        if self.anydesk_path:
            return True

        logger.info("üì• –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è AnyDesk...")
        try:
            import urllib.request
            downloads_dir = os.path.expanduser("~\\Downloads")
            save_path = os.path.join(downloads_dir, "AnyDesk.exe")
            download_url = "https://download.anydesk.com/AnyDesk.exe"

            if not os.path.exists(save_path):
                logger.info(f"–ó–∞–≤–∞–Ω—Ç–∞–∂—É...")
                urllib.request.urlretrieve(download_url, save_path)

            logger.info("–ó–∞–ø—É—Å–∫ –≤—Å—Ç–∞–Ω–æ–≤–ª—é–≤–∞—á–∞...")
            subprocess.Popen([save_path])

            logger.info("–ß–µ–∫–∞—é –Ω–∞ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è (90 —Å–µ–∫)...")
            for i in range(90):
                time.sleep(1)
                self.anydesk_path = self.find_anydesk()
                if self.anydesk_path:
                    logger.info(f"‚úÖ AnyDesk –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ")
                    time.sleep(3)
                    return True

            return False
        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞: {e}")
            return False

    def check_if_running(self) -> bool:
        """–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —á–∏ AnyDesk –∑–∞–ø—É—â–µ–Ω–æ"""
        try:
            for proc in psutil.process_iter(['pid', 'name']):
                if 'anydesk' in proc.info['name'].lower():
                    logger.info(f"‚ÑπÔ∏è AnyDesk –∑–∞–ø—É—â–µ–Ω–æ (PID: {proc.info['pid']})")
                    self._is_running = True
                    return True
        except:
            pass
        self._is_running = False
        return False

    def launch_anydesk(self) -> bool:
        """–ó–∞–ø—É—Å—Ç–∏—Ç–∏ AnyDesk"""
        if self.check_if_running():
            return True

        if not self.anydesk_path or not Path(self.anydesk_path).exists():
            logger.error("–®–ª—è—Ö –Ω–µ–≤—ñ–¥–æ–º–∏–π")
            return False

        try:
            logger.info(f"üöÄ –ó–∞–ø—É—Å–∫–∞—é AnyDesk...")
            subprocess.Popen(self.anydesk_path)
            time.sleep(5)

            if self.check_if_running():
                logger.info("‚úÖ AnyDesk –∑–∞–ø—É—â–µ–Ω–æ")
                return True
            else:
                self._is_running = True
                return True
        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞: {e}")
            return False

    def set_password_with_admin(self) -> bool:
        """
        –ó–∞–ø—É—Å–∫–∞—î *—Å–∞–º—É —Å–µ–±–µ* –∑ –∞–¥–º—ñ–Ω –ø—Ä–∞–≤–∞–º–∏ –¥–ª—è –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –ø–∞—Ä–æ–ª—è.
        –ö–æ—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–æ–±–ª—è—î DEV-—Ä–µ–∂–∏–º.
        """
        if not self.anydesk_path:
            logger.error("–®–ª—è—Ö AnyDesk –Ω–µ–≤—ñ–¥–æ–º–∏–π, –Ω–µ –º–æ–∂—É –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –ø–∞—Ä–æ–ª—å")
            return False

        try:
            logger.info(f"üîê –ó–∞–ø—É—Å–∫–∞—é –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –ø–∞—Ä–æ–ª—è –∑ –∞–¥–º—ñ–Ω –ø—Ä–∞–≤–∞–º–∏...")

            # –ü–µ—Ä–µ–¥–∞—Ç–∏ –ø–∞—Ä–æ–ª—å —è–∫ –∑–º—ñ–Ω–Ω—É —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞
            env = os.environ.copy()
            env["ANYDESK_PASSWORD"] = UNATTENDED_PASSWORD

            if getattr(sys, 'frozen', False):
                # –†–µ–∂–∏–º EXE: –∑–∞–ø—É—Å–∫–∞—î–º–æ —Å–∞–º .exe
                executable = sys.executable
                arguments = f'--set-anydesk-password "{self.anydesk_path}"'
                logger.info(f"EXE Mode Admin Lauch: {executable} {arguments}")
            else:
                # –†–µ–∂–∏–º DEV: –∑–∞–ø—É—Å–∫–∞—î–º–æ python.exe + [—Å–∫—Ä–∏–ø—Ç] + [–∞—Ä–≥—É–º–µ–Ω—Ç–∏]
                executable = sys.executable  # python.exe
                script_path = os.path.abspath(sys.argv[0])
                arguments = f'"{script_path}" --set-anydesk-password "{self.anydesk_path}"'
                logger.info(f"DEV Mode Admin Lauch: {executable} {arguments}")

            # –ó–∞–ø—É—Å—Ç–∏—Ç–∏ —Å–∫—Ä–∏–ø—Ç –∑ –∞–¥–º—ñ–Ω –ø—Ä–∞–≤–∞–º–∏
            ctypes.windll.shell32.ShellExecuteW(
                None,
                "runas",  # –ó–∞–ø–∏—Ç –∞–¥–º—ñ–Ω –ø—Ä–∞–≤
                executable,  # RemoteHand.exe –∞–±–æ python.exe
                arguments,  # –ê—Ä–≥—É–º–µ–Ω—Ç–∏
                None,
                1  # SW_SHOW - –ø–æ–∫–∞–∑–∞—Ç–∏ –≤—ñ–∫–Ω–æ (UAC)
            )

            logger.info(f"‚úÖ –ó–∞–ø—Ä–æ—Å –∞–¥–º—ñ–Ω –ø—Ä–∞–≤ –Ω–∞–¥—ñ—Å–ª–∞–Ω–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—É")
            return True

        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞ –∑–∞–ø—É—Å–∫—É –∞–¥–º—ñ–Ω-–ø—Ä–æ—Ü–µ—Å—É: {e}")
            import traceback
            traceback.print_exc()
            return False

    def get_connection_id(self) -> Optional[str]:
        """–û—Ç—Ä–∏–º–∞—Ç–∏ ID"""
        if not self.anydesk_path:
            return None

        try:
            logger.info("üìå –û—Ç—Ä–∏–º—É—é ID...")

            result = subprocess.run(
                [self.anydesk_path, '--get-id'],
                capture_output=True,
                text=True,
                timeout=10,
                creationflags=subprocess.CREATE_NO_WINDOW if platform.system() == "Windows" else 0
            )

            if result.returncode == 0:
                connection_id = result.stdout.strip()
                if connection_id and connection_id.isdigit():
                    logger.info(f"‚úÖ ID: {connection_id}")
                    self.connection_id = connection_id
                    return connection_id

        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞: {e}")

        return None

    def start(self, password: str = None) -> Tuple[Optional[str], Optional[str]]:
        """(–û–ù–û–í–õ–ï–ù–û) –ó–∞–ø—É—Å—Ç–∏—Ç–∏ AnyDesk –∑ –æ—á—ñ–∫—É–≤–∞–Ω–Ω—è–º –∞–¥–º—ñ–Ω-–ø—Ä–æ—Ü–µ—Å—É"""
        password = UNATTENDED_PASSWORD

        # –ö—Ä–æ–∫ 1: –Ø–∫—â–æ –≤–∂–µ –∑–∞–ø—É—â–µ–Ω–æ (–Ω—ñ—á–æ–≥–æ –Ω–µ –∑–º—ñ–Ω–∏–ª–æ—Å—å)
        if self.check_if_running():
            logger.info("AnyDesk –≤–∂–µ –∑–∞–ø—É—â–µ–Ω–æ")
            connection_id = self.get_connection_id()
            if connection_id:
                try:
                    user_name = self.config.get("user_name", "")
                    self.telegram.send_anydesk_info(
                        self.config.store_location_text,
                        user_name, socket.gethostname(), connection_id, password
                    )
                except Exception as e:
                    logger.error(f"‚ùå Telegram: {e}")
            return connection_id, password

        # –ö—Ä–æ–∫ 2: –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —è–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ
        if not self.anydesk_path:
            if not self.download_anydesk():
                return None, None

        # –ö—Ä–æ–∫ 3: –ó–∞–ø—É—Å—Ç–∏—Ç–∏
        if not self.launch_anydesk():
            return None, None

        # –ö—Ä–æ–∫ 4: –í–°–¢–ê–ù–û–í–ò–¢–ò –ü–ê–†–û–õ–¨ (–ó –û–ß–Ü–ö–£–í–ê–ù–ù–Ø–ú)
        logger.info("üîê –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –ø–∞—Ä–æ–ª—è...")

        # (–ù–û–í–ï) –®–ª—è—Ö –¥–æ –ø—Ä–∞–ø–æ—Ä—Ü—è —Ç–∞ –æ—á–∏—â–µ–Ω–Ω—è —Å—Ç–∞—Ä–æ–≥–æ, —è–∫—â–æ —î
        flag_file = Path(os.environ.get("TEMP", Path.home())) / ".rh_pass_set_flag"
        if flag_file.exists():
            try:
                os.remove(flag_file)
            except Exception as e:
                logger.warning(f"–ù–µ –≤–¥–∞–ª–æ—Å—è –≤–∏–¥–∞–ª–∏—Ç–∏ —Å—Ç–∞—Ä–∏–π –ø—Ä–∞–ø–æ—Ä–µ—Ü—å: {e}")

        # –ó–∞–ø—É—Å–∫–∞—î–º–æ –∞–¥–º—ñ–Ω-–ø—Ä–æ—Ü–µ—Å
        if not self.set_password_with_admin():
            logger.error("–ù–µ –≤–¥–∞–ª–æ—Å—è –∑–∞–ø—É—Å—Ç–∏—Ç–∏ –∞–¥–º—ñ–Ω-–ø—Ä–æ—Ü–µ—Å.")
            # –ü—Ä–æ–±—É—î–º–æ –ø—Ä–æ–¥–æ–≤–∂–∏—Ç–∏ –±–µ–∑ –ø–∞—Ä–æ–ª—è (—Ö–æ—á–∞ –± ID)
            pass

        # (–ù–û–í–ï) –ß–µ–∫–∞—î–º–æ –Ω–∞ –∞–¥–º—ñ–Ω-–ø—Ä–æ—Ü–µ—Å (–¥–æ 30 —Å–µ–∫)
        logger.info("–ß–µ–∫–∞—é –Ω–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è —Ä–æ–±–æ—Ç–∏ –∞–¥–º—ñ–Ω-–ø—Ä–æ—Ü–µ—Å—É (–¥–æ 30 —Å–µ–∫)...")
        password_set = False
        for i in range(30):
            if flag_file.exists():
                logger.info("‚úÖ –ê–¥–º—ñ–Ω-–ø—Ä–æ—Ü–µ—Å –∑–∞–≤–µ—Ä—à–∏–≤ —Ä–æ–±–æ—Ç—É.")
                try:
                    os.remove(flag_file)
                except:
                    pass
                password_set = True
                break
            time.sleep(1)

        if not password_set:
            logger.warning("‚ö†Ô∏è –ê–¥–º—ñ–Ω-–ø—Ä–æ—Ü–µ—Å –Ω–µ –≤—ñ–¥–ø–æ–≤—ñ–≤ (timeout). –ü—Ä–æ–±—É—é –ø—Ä–æ–¥–æ–≤–∂–∏—Ç–∏...")

        # –ö—Ä–æ–∫ 5: –û—Ç—Ä–∏–º–∞—Ç–∏ ID
        logger.info("üìå –û—Ç—Ä–∏–º–∞–Ω–Ω—è ID...")
        time.sleep(1)  # –î–∞–º–æ AnyDesk —Å–µ–∫—É–Ω–¥—É
        connection_id = self.get_connection_id()

        if not connection_id:
            logger.info("–ü–æ–≤—Ç–æ—Ä–Ω–∞ —Å–ø—Ä–æ–±–∞ –æ—Ç—Ä–∏–º–∞—Ç–∏ ID...")
            time.sleep(3)
            connection_id = self.get_connection_id()

        # –ö—Ä–æ–∫ 6: –ù–∞–¥—ñ—Å–ª–∞—Ç–∏ –≤ Telegram
        try:
            user_name = self.config.get("user_name", "")
            self.telegram.send_anydesk_info(
                self.config.store_location_text,
                user_name,
                socket.gethostname(),
                connection_id if connection_id else "–ù–ï –û–¢–†–ò–ú–ê–ù–û",
                password if password_set else "(–ù–ï –í–°–¢–ê–ù–û–í–õ–ï–ù–û!)"
            )
            logger.info("‚úÖ –¢–µ–ª–µ–≥—Ä–∞–º —Å–ø–æ–≤—ñ—â–µ–Ω–æ")
        except Exception as e:
            logger.error(f"‚ùå –¢–µ–ª–µ–≥—Ä–∞–º –ø–æ–º–∏–ª–∫–∞: {e}")

        logger.info(f"‚úÖ –ì–æ—Ç–æ–≤–æ (ID: {connection_id})")
        return connection_id, password

================================================================================
–§–∞–π–ª 9/20: src\config.py
--------------------------------------------------------------------------------
import os
from pathlib import Path
from dotenv import load_dotenv

# –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ .env
load_dotenv()

APP_NAME = "RemoteHand"
RDP_HOST = "23.88.7.196"
RDP_PORT = 4420
PING_HOST = "23.88.7.196"

# üîí –ó–Ü –ó–ú–Ü–ù–ù–ò–• –°–ï–†–ï–î–û–í–ò–©–ê, –ê –ù–ï –ó .env!
TELEGRAM_TOKEN = os.getenv("TELEGRAM_TOKEN", "")
TELEGRAM_CHAT_ID = os.getenv("TELEGRAM_CHAT_ID", "")

# –§–∞–π–ª–∏
LOCK_FILE = Path.home() / ".remotehand" / "lock"


================================================================================
–§–∞–π–ª 10/20: src\config_manager.py
--------------------------------------------------------------------------------
import json
import os
from pathlib import Path
import logging

logger = logging.getLogger(__name__)


class ConfigManager:
    """–ú–µ–Ω–µ–¥–∂–µ—Ä –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó"""

    def __init__(self):
        self.config_dir = Path.home() / ".remotehand"
        self.config_dir.mkdir(exist_ok=True)
        self.config_file = self.config_dir / "config.json"

        self.config = self.load()

    def load(self):
        """–ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –∫–æ–Ω—Ñ—ñ–≥"""
        if self.config_file.exists():
            try:
                with open(self.config_file, 'r', encoding='utf-8') as f:
                    return json.load(f)
            except:
                pass
        return {}

    def save(self):
        """–ó–±–µ—Ä–µ–≥—Ç–∏ –∫–æ–Ω—Ñ—ñ–≥ –≤ JSON —Ñ–∞–π–ª"""
        try:
            with open(self.config_file, 'w', encoding='utf-8') as f:
                json.dump(self.config, f, ensure_ascii=False, indent=2)
        except Exception as e:
            logger.error(f"–ü–æ–º–∏–ª–∫–∞ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –∫–æ–Ω—Ñ—ñ–≥—É: {e}")

    def set(self, key, value):
        """–í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –∑–Ω–∞—á–µ–Ω–Ω—è"""
        self.config[key] = value
        self.save()

    def get(self, key, default=""):
        """–û—Ç—Ä–∏–º–∞—Ç–∏ –∑–Ω–∞—á–µ–Ω–Ω—è"""
        return self.config.get(key, default)

    def is_first_run(self):
        """–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —á–∏ –ø–µ—Ä—à–∏–π –∑–∞–ø—É—Å–∫"""
        store = self.config.get('store', '')
        location = self.config.get('location', '')
        return not store or not location

    @property
    def store_location_text(self):
        """–û—Ç—Ä–∏–º–∞—Ç–∏ —Ç–µ–∫—Å—Ç –º–∞–≥–∞–∑–∏–Ω—É/–ª–æ–∫–∞—Ü—ñ—ó"""
        store = self.config.get('store', '–ù–µ–≤—ñ–¥–æ–º–æ')
        location = self.config.get('location', '–ù–µ–≤—ñ–¥–æ–º–æ')
        return f"{store} / {location}"


================================================================================
–§–∞–π–ª 11/20: src\main.py
--------------------------------------------------------------------------------
import customtkinter as ctk
from tkinter import messagebox
import sys
import os
import threading
import logging
from pathlib import Path
import ctypes
import subprocess
import time

# –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ .env —Ñ–∞–π–ª
from dotenv import load_dotenv

load_dotenv()

# –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –ª–æ–≥—É–≤–∞–Ω–Ω—è
logging.basicConfig(
    level=logging.INFO,
    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s'
)
logger = logging.getLogger(__name__)

# ============ –ü–ï–†–ï–í–Ü–†–ö–ê DEV –†–ï–ñ–ò–ú–£ ============
DEV_MODE = os.getenv('REMOTEHAND_DEV_MODE') == '1'
logger.info(f"{'üîß DEV –†–ï–ñ–òM' if DEV_MODE else '‚úÖ PRODUCTION –†–ï–ñ–ò–ú'}")

if not DEV_MODE:
    # –¢–Ü–õ–¨–ö–ò –í PRODUCTION
    try:
        from updater import check_and_update

        check_and_update()
    except Exception as e:
        logger.warning(f"–ü–æ–º–∏–ª–∫–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –æ–Ω–æ–≤–ª–µ–Ω—å: {e}")

# ============ –Ü–ú–ü–û–†–¢–ò ============
from utils import close_all_rdp_sessions, test_connection
from config import RDP_HOST, RDP_PORT, PING_HOST, APP_NAME

# –ù–æ–≤—ñ —ñ–º–ø–æ—Ä—Ç–∏
from config_manager import ConfigManager
from telegram_api import TelegramAPI
from setup_wizard import SetupWizard
from network_test import NetworkTest

try:
    from rdp_manager import RDPManager

    rdp_manager_available = True
except ImportError as e:
    rdp_manager_available = False
    logger.warning(f"rdp_manager –Ω–µ –¥–æ—Å—Ç—É–ø–Ω–∞: {e}")

try:
    from anydesk_manager import AnyDeskManager

    anydesk_available = True
except ImportError as e:
    anydesk_available = False
    logger.warning(f"anydesk_manager –Ω–µ –¥–æ—Å—Ç—É–ø–Ω–∞: {e}")

# ============ –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —Å—Ç–∏–ª—é iOS ============
IOS_BG_COLOR = "#f2f2f7"  # –°–≤—ñ—Ç–ª–æ-—Å—ñ—Ä–∏–π —Ñ–æ–Ω
IOS_CARD_COLOR = "#ffffff"  # –ë—ñ–ª—ñ –∫–∞—Ä—Ç–∫–∏
IOS_TEXT_COLOR = "#000000"  # –ß–æ—Ä–Ω–∏–π —Ç–µ–∫—Å—Ç
IOS_SUBTEXT_COLOR = "#8A8A8E"  # –°—ñ—Ä–∏–π –ø—ñ–¥–ø–∏—Å
IOS_CARD_BORDER = "#E0E0E0"  # –õ–µ–¥—å –ø–æ–º—ñ—Ç–Ω–∞ —Ä–∞–º–∫–∞ –∫–∞—Ä—Ç–∫–∏
IOS_CARD_RADIUS = 15
IOS_BUTTON_RADIUS = 12


class RemoteHandApp(ctk.CTk):
    def __init__(self):
        super().__init__()

        # –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –≤—ñ–∫–Ω–∞
        self.title(APP_NAME)
        self.geometry("520x800")
        self.resizable(True, True)

        ctk.set_appearance_mode("light")
        ctk.set_default_color_theme("blue")
        self.configure(fg_color=IOS_BG_COLOR)

        # –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è –º–µ–Ω–µ–¥–∂–µ—Ä—ñ–≤
        self.config = ConfigManager()

        telegram_token = os.getenv("TELEGRAM_TOKEN") or self.config.get("telegram_token")
        telegram_chat_id = os.getenv("TELEGRAM_CHAT_ID") or self.config.get("telegram_chat_id")

        logger.info(f"Telegram token: {'‚úÖ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ' if telegram_token else '‚ùå –ù–ï –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ'}")
        logger.info(f"Telegram chat_id: {'‚úÖ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ' if telegram_chat_id else '‚ùå –ù–ï –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ'}")

        self.telegram = TelegramAPI(telegram_token, telegram_chat_id)

        if rdp_manager_available:
            self.rdp_manager = RDPManager(self.config, self.telegram)
        else:
            self.rdp_manager = None

        if anydesk_available:
            self.anydesk_manager = AnyDeskManager(self.config, self.telegram)
        else:
            self.anydesk_manager = None

        self.network_test = NetworkTest(self.config, self.telegram)

        self.setup_ui()

        if self.config.is_first_run():
            self.show_setup_wizard()

    def get_app_version(self):
        """–û—Ç—Ä–∏–º–∞—Ç–∏ –≤–µ—Ä—Å—ñ—é –ø—Ä–æ–≥—Ä–∞–º–∏ (–∑ –æ–±—Ä–æ–±–∫–æ—é –∫–æ–¥—É–≤–∞–Ω—å)"""
        try:
            if getattr(sys, 'frozen', False):
                # –Ø–∫—â–æ EXE (—Å–∫–æ–º–ø—ñ–ª—å–æ–≤–∞–Ω–æ)
                base_path = Path(sys._MEIPASS)
            else:
                # –Ø–∫—â–æ DEV (–∑–∞–ø—É—Å–∫ –∑ dev_run.py)
                base_path = Path.cwd()  # –ü–æ—Ç–æ—á–Ω–∞ —Ä–æ–±–æ—á–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—è (–∫–æ—Ä—ñ–Ω—å –ø—Ä–æ—î–∫—Ç—É)

            version_file = base_path / "version.txt"

            if not version_file.exists():
                logger.warning(f"–ù–µ –∑–Ω–∞–π–¥–µ–Ω–æ version.txt —É {base_path}")
                base_path = Path(sys.executable).parent
                version_file = base_path / "version.txt"
                if not version_file.exists():
                    logger.warning(f"–ù–µ –∑–Ω–∞–π–¥–µ–Ω–æ version.txt —ñ —É {base_path}")
                    return "1.0.0"  # Fallback

            try:
                # –°–ø—Ä–æ–±—É–≤–∞—Ç–∏ UTF-8-SIG (—Å—Ç–∞–Ω–¥–∞—Ä—Ç –∑ BOM)
                return version_file.read_text(encoding='utf-8-sig').strip()
            except UnicodeDecodeError:
                try:
                    # –Ø–∫—â–æ –Ω–µ –≤–∏–π—à–ª–æ (byte 0xff), —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ UTF-16
                    logger.warning("version.txt –Ω–µ –≤ UTF-8, –ø—Ä–æ–±—É—é UTF-16...")
                    return version_file.read_text(encoding='utf-16').strip()
                except Exception as e_inner:
                    logger.error(f"–ù–µ –≤–¥–∞–ª–æ—Å—è –ø—Ä–æ—á–∏—Ç–∞—Ç–∏ version.txt –Ω—ñ –≤ UTF-8, –Ω—ñ –≤ UTF-16: {e_inner}")
            except Exception as e_outer:
                logger.error(f"–ü–æ–º–∏–ª–∫–∞ —á–∏—Ç–∞–Ω–Ω—è –≤–µ—Ä—Å—ñ—ó: {e_outer}")

        except Exception as e:
            logger.error(f"–ö—Ä–∏—Ç–∏—á–Ω–∞ –ø–æ–º–∏–ª–∫–∞ get_app_version: {e}")

        return "1.0.0"  # –ó–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º

    def show_setup_wizard(self):
        """–ü–æ–∫–∞–∑–∞—Ç–∏ –≤—ñ–∫–Ω–æ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –ø—Ä–∏ –ø–µ—Ä—à–æ–º—É –∑–∞–ø—É—Å–∫—É"""

        def on_setup_complete(result):
            self.config.set("store", result["store"])
            self.config.set("location", result["location"])
            if result.get("user_name"):
                self.config.set("user_name", result["user_name"])
            self.refresh_ui()

        wizard = SetupWizard(self, on_setup_complete)
        self.wait_window(wizard)

    def refresh_ui(self):
        """–û–Ω–æ–≤–∏—Ç–∏ UI –ø—ñ—Å–ª—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è"""
        user_info = self.config.store_location_text
        user_name = self.config.get("user_name", "")
        if user_name:
            user_info += f" | üë§ {user_name}"

        self.info_label.configure(text=f"üìç {user_info}")

    def setup_ui(self):
        """–°—Ç–≤–æ—Ä–µ–Ω–Ω—è UI –≤ —Å—Ç–∏–ª—ñ iOS (–∫–æ–º–ø–∞–∫—Ç–Ω–æ)"""

        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        title_label = ctk.CTkLabel(
            self,
            text="RemoteHand",
            font=ctk.CTkFont(size=28, weight="bold"),
            text_color=IOS_TEXT_COLOR
        )
        title_label.pack(pady=(10, 0), padx=20, anchor="w")

        # –Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ –º–∞–≥–∞–∑–∏–Ω/–ª–æ–∫–∞—Ü—ñ—é + –ü–Ü–ë
        user_info = self.config.store_location_text
        user_name = self.config.get("user_name", "")
        if user_name:
            user_info += f" | üë§ {user_name}"

        self.info_label = ctk.CTkLabel(
            self,
            text=f"üìç {user_info}",
            font=ctk.CTkFont(size=12),
            text_color=IOS_SUBTEXT_COLOR
        )
        self.info_label.pack(pady=(0, 15), padx=20, anchor="w")

        # ==================== RDP –ë–õ–û–ö (–ö–ê–†–¢–ö–ê 1) ====================
        rdp_frame = ctk.CTkFrame(
            self,
            fg_color=IOS_CARD_COLOR,
            corner_radius=IOS_CARD_RADIUS,
            border_width=1,
            border_color=IOS_CARD_BORDER
        )
        rdp_frame.pack(pady=8, padx=20, fill="x")

        ctk.CTkLabel(
            rdp_frame,
            text="–ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ 1–°",
            font=ctk.CTkFont(size=13, weight="bold"),
            text_color=IOS_TEXT_COLOR
        ).pack(anchor="w", pady=(10, 10), padx=15)

        rdp_btn = ctk.CTkButton(
            rdp_frame,
            text="üñ•Ô∏è –í—ñ–¥–∫—Ä–∏—Ç–∏ 1–° (RDP)",
            command=self.open_rdp,
            height=50,
            font=ctk.CTkFont(size=12, weight="bold"),
            corner_radius=IOS_BUTTON_RADIUS,
            fg_color="#007AFF",
            hover_color="#0051D5"
        )
        rdp_btn.pack(fill="x", pady=(0, 15), padx=15)

        # ==================== ANYDESK –ë–õ–û–ö (–ö–ê–†–¢–ö–ê 2) ====================
        if anydesk_available:
            anydesk_frame = ctk.CTkFrame(
                self,
                fg_color=IOS_CARD_COLOR,
                corner_radius=IOS_CARD_RADIUS,
                border_width=1,
                border_color=IOS_CARD_BORDER
            )
            anydesk_frame.pack(pady=8, padx=20, fill="x")

            ctk.CTkLabel(
                anydesk_frame,
                text="–í—ñ–¥–¥–∞–ª–µ–Ω–∏–π –¥–æ—Å—Ç—É–ø",
                font=ctk.CTkFont(size=13, weight="bold"),
                text_color=IOS_TEXT_COLOR
            ).pack(anchor="w", pady=(10, 10), padx=15)

            anydesk_btn = ctk.CTkButton(
                anydesk_frame,
                text="üöÄ –ó–∞–ø—É—Å—Ç–∏—Ç–∏ AnyDesk",
                command=self.start_anydesk,
                height=50,
                font=ctk.CTkFont(size=12, weight="bold"),
                corner_radius=IOS_BUTTON_RADIUS,
                fg_color="#FF6B35",
                hover_color="#CC5529"
            )
            anydesk_btn.pack(fill="x", pady=(0, 15), padx=15)

        # ==================== –î–Ü–ê–ì–ù–û–°–¢–ò–ö–ê (–ö–ê–†–¢–ö–ê 3) ====================
        test_frame = ctk.CTkFrame(
            self,
            fg_color=IOS_CARD_COLOR,
            corner_radius=IOS_CARD_RADIUS,
            border_width=1,
            border_color=IOS_CARD_BORDER
        )
        test_frame.pack(pady=8, padx=20, fill="x")

        ctk.CTkLabel(
            test_frame,
            text="–î—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —Ç–∞ –£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è",
            font=ctk.CTkFont(size=13, weight="bold"),
            text_color=IOS_TEXT_COLOR
        ).pack(anchor="w", pady=(10, 10), padx=15)

        test_btn = ctk.CTkButton(
            test_frame,
            text="üì° –¢–µ—Å—Ç –∑'—î–¥–Ω–∞–Ω–Ω—è",
            command=self.run_network_test,
            height=50,
            font=ctk.CTkFont(size=12, weight="bold"),
            corner_radius=IOS_BUTTON_RADIUS,
            fg_color="#34C759",
            hover_color="#248A3D"
        )
        test_btn.pack(fill="x", pady=(0, 10), padx=15)

        # –†–æ–∑–¥—ñ–ª—é–≤–∞—á
        separator = ctk.CTkFrame(test_frame, height=1, fg_color=IOS_CARD_BORDER)
        separator.pack(fill="x", padx=15, pady=5)

        close_sessions_btn = ctk.CTkButton(
            test_frame,
            text="‚ùå –ó–∞–∫—Ä–∏—Ç–∏ –≤—Å—ñ RDP —Å–µ—Å—ñ—ó",
            command=self.close_sessions_confirm,
            height=45,
            font=ctk.CTkFont(size=12, weight="bold"),
            corner_radius=IOS_BUTTON_RADIUS,
            fg_color="#FF3B30",
            hover_color="#D70015"
        )
        close_sessions_btn.pack(fill="x", pady=(10, 15), padx=15)

        # ==================== –ù–ê–õ–ê–®–¢–£–í–ê–ù–ù–Ø (–ö–ê–†–¢–ö–ê 4) ====================
        settings_frame = ctk.CTkFrame(
            self,
            fg_color=IOS_CARD_COLOR,
            corner_radius=IOS_CARD_RADIUS,
            border_width=1,
            border_color=IOS_CARD_BORDER
        )
        settings_frame.pack(pady=8, padx=20, fill="x")

        settings_btn = ctk.CTkButton(
            settings_frame,
            text="‚öôÔ∏è –ó–º—ñ–Ω–∏—Ç–∏ –º–∞–≥–∞–∑–∏–Ω/–ª–æ–∫–∞—Ü—ñ—é/–ü–Ü–ë",
            command=self.show_setup_wizard,
            height=40,
            font=ctk.CTkFont(size=11),
            corner_radius=IOS_BUTTON_RADIUS,
            fg_color="#999999",
            hover_color="#666666"
        )
        settings_btn.pack(fill="x", pady=15, padx=15)

        # ==================== –°–¢–ê–¢–£–° (–í–Ω–∏–∑—É) ====================
        self.status_label = ctk.CTkLabel(
            self,
            text="‚úÖ –ì–æ—Ç–æ–≤–æ –¥–æ —Ä–æ–±–æ—Ç–∏",
            font=ctk.CTkFont(size=10),
            text_color=IOS_SUBTEXT_COLOR
        )
        self.status_label.pack(pady=8)

        # ==================== –í–ï–†–°–Ü–Ø (–í–Ω–∏–∑—É) ====================
        version_frame = ctk.CTkFrame(self, fg_color="transparent")
        version_frame.pack(anchor="s", pady=(0, 8))

        version_label = ctk.CTkLabel(
            version_frame,
            text=f"v{self.get_app_version()}",
            font=ctk.CTkFont(size=9, weight="bold"),
            text_color=IOS_SUBTEXT_COLOR
        )
        version_label.pack(side="left", padx=5)

        self.update_status_label = ctk.CTkLabel(
            version_frame,
            text="‚úÖ",
            font=ctk.CTkFont(size=10),
            text_color="green"
        )
        self.update_status_label.pack(side="left", padx=5)

    def open_rdp(self):
        """–í—ñ–¥–∫—Ä–∏—Ç–∏ RDP"""
        if not self.rdp_manager:
            messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "RDP –º–µ–Ω–µ–¥–∂–µ—Ä –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω")
            return

        saved_password = self.rdp_manager.get_credentials(RDP_HOST, "admin")

        if saved_password:
            self.set_status("‚è≥ –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è...", "processing")

            def connect():
                try:
                    if self.rdp_manager.connect_rdp(RDP_HOST, RDP_PORT, "admin", saved_password):
                        self.set_status("‚úÖ –ü—ñ–¥–∫–ª—é—á–µ–Ω–æ", "success")
                    else:
                        self.set_status("‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è", "error")
                except Exception as e:
                    logger.error(f"–ü–æ–º–∏–ª–∫–∞: {e}")
                    self.set_status("‚ùå –ö—Ä–∏—Ç–∏—á–Ω–∞ –ø–æ–º–∏–ª–∫–∞", "error")

            thread = threading.Thread(target=connect, daemon=True)
            thread.start()
        else:
            dialog = ctk.CTkInputDialog(
                text="–í–≤–µ–¥—ñ—Ç—å –ø–∞—Ä–æ–ª—å –¥–ª—è RDP:",
                title="–ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ 1–°"
            )
            password = dialog.get_input()

            if password:
                self.set_status("üíæ –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è –ø–∞—Ä–æ–ª—è...", "processing")
                if self.rdp_manager.connect_rdp(RDP_HOST, RDP_PORT, "admin", password):
                    self.rdp_manager.save_credentials(RDP_HOST, "admin", password)
                    self.set_status("‚úÖ –£—Å–ø—ñ—à–Ω–æ –ø—ñ–¥–∫–ª—é—á–µ–Ω–æ", "success")
                else:
                    self.set_status("‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è", "error")

    def close_sessions_confirm(self):
        """–ü—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è –∑–∞–∫—Ä–∏—Ç—Ç—è —Å–µ—Å—ñ–π"""
        result = messagebox.askyesno(
            "–ü—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è",
            "–í–∏ –≤–ø–µ–≤–Ω–µ–Ω—ñ, —â–æ —Ö–æ—á–µ—Ç–µ –∑–∞–∫—Ä–∏—Ç–∏ –≤—Å—ñ RDP —Å–µ—Å—ñ—ó?"
        )
        if result:
            self.set_status("‚è≥ –ó–∞–∫—Ä–∏—Ç—Ç—è —Å–µ—Å—ñ–π...", "processing")
            close_all_rdp_sessions()
            self.set_status("‚úÖ –í—Å—ñ —Å–µ—Å—ñ—ó –∑–∞–∫—Ä–∏—Ç–æ", "success")

    def start_anydesk(self):
        """–ó–∞–ø—É—Å—Ç–∏—Ç–∏ AnyDesk - –ë–ï–ó –ø–æ–∫–∞–∑—É –ø–∞—Ä–æ–ª—è!"""
        if not self.anydesk_manager:
            messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "AnyDesk –º–µ–Ω–µ–¥–∂–µ—Ä –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω")
            return

        self.set_status("‚è≥ –ó–∞–ø—É—Å–∫ AnyDesk...", "processing")

        def anydesk_task():
            try:
                anydesk_id, pwd = self.anydesk_manager.start(None)

                if anydesk_id:
                    self.set_status(f"‚úÖ AnyDesk –∑–∞–ø—É—â–µ–Ω–æ\nüÜî ID: {anydesk_id}", "success")
                    messagebox.showinfo(
                        "‚úÖ AnyDesk –∑–∞–ø—É—â–µ–Ω–æ",
                        f"ID –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è: {anydesk_id}\n\n"
                        f"–î–∞–Ω—ñ –Ω–∞–¥—ñ—Å–ª–∞–Ω—ñ –≤ Telegram\n"
                        f"–ü–∞—Ä–æ–ª—å –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ"
                    )
                else:
                    self.set_status("‚ùå –ü–æ–º–∏–ª–∫–∞ AnyDesk", "error")
                    messagebox.showwarning(
                        "‚ö†Ô∏è –£–≤–∞–≥–∞",
                        "–ù–µ –≤–¥–∞–ª–æ—Å—è –∑–∞–ø—É—Å—Ç–∏—Ç–∏ AnyDesk –∞–±–æ –æ—Ç—Ä–∏–º–∞—Ç–∏ ID."
                    )
            except Exception as e:
                logger.error(f"–ü–æ–º–∏–ª–∫–∞: {e}")
                self.set_status("‚ùå –ü–æ–º–∏–ª–∫–∞ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è", "error")

        thread = threading.Thread(target=anydesk_task, daemon=True)
        thread.start()

    def run_network_test(self):
        """–ó–∞–ø—É—Å—Ç–∏—Ç–∏ —Ç–µ—Å—Ç –º–µ—Ä–µ–∂—ñ"""
        self.set_status("‚è≥ –¢–µ—Å—Ç –º–µ—Ä–µ–∂—ñ...", "processing")

        def test_task():
            try:
                result = self.network_test.run_full_test()
                self.set_status(f"{result['status']}", result['color'])
            except Exception as e:
                logger.error(f"–ü–æ–º–∏–ª–∫–∞ —Ç–µ—Å—Ç—É: {e}")
                self.set_status("‚ùå –ü–æ–º–∏–ª–∫–∞ —Ç–µ—Å—Ç—É", "error")

        thread = threading.Thread(target=test_task, daemon=True)
        thread.start()

    def set_status(self, text, status_type="info"):
        """–í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ —Å—Ç–∞—Ç—É—Å –∑ –∫–æ–ª—å–æ—Ä–æ–º"""
        color_map = {
            "success": "green",
            "error": "red",
            "processing": "blue",
            "info": "gray"
        }
        self.status_label.configure(text=text, text_color=color_map.get(status_type, "gray"))


def run_password_setter(anydesk_path, password):
    """
    (–û–ù–û–í–õ–ï–ù–û)
    –¶—è —Ñ—É–Ω–∫—Ü—ñ—è –≤–∏–∫–æ–Ω—É—î –ª–æ–≥—ñ–∫—É –∑ set_anydesk_password.py.
    –í–æ–Ω–∞ –∑–∞–ø—É—Å–∫–∞—î—Ç—å—Å—è –¢–Ü–õ–¨–ö–ò –∫–æ–ª–∏ –ø—Ä–æ–≥—Ä–∞–º–∞ –∑–∞–ø—É—â–µ–Ω–∞ –∑ –∞–¥–º—ñ–Ω –ø—Ä–∞–≤–∞–º–∏
    —Ç–∞ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–º --set-anydesk-password.
    –°–¢–í–û–†–Æ–Ñ –§–ê–ô–õ-–ü–†–ê–ü–û–†–ï–¶–¨ –ü–Ü–°–õ–Ø –ó–ê–í–ï–†–®–ï–ù–ù–Ø.
    """

    # (–ù–û–í–ï) –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ —Ç–∏–º—á–∞—Å–æ–≤—É –ø–∞–ø–∫—É –¥–ª—è –ø—Ä–∞–ø–æ—Ä—Ü—è
    FLAG_FILE_PATH = Path(os.environ.get("TEMP", Path.home())) / ".rh_pass_set_flag"

    logger.info(f"[*] –ó–∞–ø—É—Å–∫ –≤ —Ä–µ–∂–∏–º—ñ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –ø–∞—Ä–æ–ª—è –¥–ª—è: {anydesk_path}")

    try:
        is_admin = ctypes.windll.shell32.IsUserAnAdmin()
        if not is_admin:
            logger.error("[!] –ü–æ—Ç—Ä—ñ–±–Ω—ñ –∞–¥–º—ñ–Ω –ø—Ä–∞–≤–∞ –¥–ª—è --set-anydesk-password")
            sys.exit(1)
    except Exception as e:
        logger.error(f"[!] –ù–µ –≤–¥–∞–ª–æ—Å—è –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –ø—Ä–∞–≤–∞: {e}")
        sys.exit(1)

    if not anydesk_path or not os.path.exists(anydesk_path):
        logger.error(f"[!] –®–ª—è—Ö AnyDesk –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ: {anydesk_path}")
        sys.exit(1)

    try:
        logger.info(f"[*] –í—Å—Ç–∞–Ω–æ–≤–ª—é—é –ø–∞—Ä–æ–ª—å AnyDesk (—É –∞–¥–º—ñ–Ω —Ä–µ–∂–∏–º—ñ)...")
        time.sleep(1)

        cmd = [anydesk_path, "--set-password", "_full_access"]

        result = subprocess.run(
            cmd,
            input=password + "\n",
            capture_output=True,
            text=True,
            timeout=10,
            creationflags=subprocess.CREATE_NO_WINDOW
        )

        logger.info(f"[CODE] {result.returncode}")
        if result.returncode in [0, 8000]:
            logger.info("[‚úì] –ü–∞—Ä–æ–ª—å –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ!")
        else:
            logger.error(f"[!] –ö–æ–¥ –ø–æ–º–∏–ª–∫–∏: {result.returncode}")
            logger.error(f"[STDOUT] {result.stdout}")
            logger.error(f"[STDERR] {result.stderr}")

        # (–ù–û–í–ï) –°—Ç–≤–æ—Ä—é—î–º–æ –ø—Ä–∞–ø–æ—Ä–µ—Ü—å, —â–æ —Ä–æ–±–æ—Ç–∞ –≤–∏–∫–æ–Ω–∞–Ω–∞
        try:
            with open(FLAG_FILE_PATH, 'w') as f:
                f.write('ok')
            logger.info(f"–°—Ç–≤–æ—Ä–µ–Ω–æ –ø—Ä–∞–ø–æ—Ä–µ—Ü—å: {FLAG_FILE_PATH}")
        except Exception as e:
            logger.error(f"–ù–µ –≤–¥–∞–ª–æ—Å—è —Å—Ç–≤–æ—Ä–∏—Ç–∏ –ø—Ä–∞–ø–æ—Ä–µ—Ü—å: {e}")

        sys.exit(0)

    except Exception as e:
        logger.error(f"[!] –ö—Ä–∏—Ç–∏—á–Ω–∞ –ø–æ–º–∏–ª–∫–∞: {e}")
        sys.exit(1)


def main():
    """–ì–æ–ª–æ–≤–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è"""
    if len(sys.argv) > 1 and sys.argv[1] == '--set-anydesk-password':
        try:
            anydesk_path = sys.argv[2] if len(sys.argv) > 2 else None
            password = os.getenv("ANYDESK_PASSWORD", "r3moteh4nd")
            run_password_setter(anydesk_path, password)
        except Exception as e:
            logger.error(f"–ü–æ–º–∏–ª–∫–∞ –∑–∞–ø—É—Å–∫—É password_setter: {e}")
            sys.exit(1)
        sys.exit(0)

    logger.info("–ó–∞–ø—É—Å–∫ RemoteHand...")
    app = RemoteHandApp()
    app.mainloop()


if __name__ == "__main__":
    main()

================================================================================
–§–∞–π–ª 12/20: src\network_test.py
--------------------------------------------------------------------------------
import subprocess
import re
import socket
import logging
from pathlib import Path
import tempfile

logger = logging.getLogger(__name__)


class NetworkTest:
    """–¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è –º–µ—Ä–µ–∂—ñ –∑ –∑–≤—ñ—Ç–æ–º"""

    def __init__(self, config_manager, telegram_api):
        self.config = config_manager
        self.telegram = telegram_api

    def run_ping_test(self, host, count=20):
        """–í–∏–∫–æ–Ω–∞—Ç–∏ ping —Ç–µ—Å—Ç –Ω–∞ —Ö–æ—Å—Ç—É"""
        try:
            result = subprocess.run(
                ['ping', host, '-n', str(count)],
                capture_output=True,
                text=True,
                encoding='cp1252',
                timeout=60,
                creationflags=subprocess.CREATE_NO_WINDOW
            )
            return result.stdout
        except Exception as e:
            logger.error(f"–ü–æ–º–∏–ª–∫–∞ ping: {e}")
            return f"–ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—ñ {host}: {str(e)}"

    def parse_ping_loss(self, ping_output):
        """–í–∏—Ç—è–≥—Ç–∏ –≤—ñ–¥—Å–æ—Ç–æ–∫ –≤—Ç—Ä–∞—Ç–∏ –ø–∞–∫–µ—Ç—ñ–≤"""
        try:
            match = re.search(r'(\d+)%\s+(–ø–æ—Ç–µ—Ä—å|loss)', ping_output, re.IGNORECASE)
            if match:
                return int(match.group(1))
            return 0
        except:
            return -1

    def run_full_test(self):
        """(–û–ù–û–í–õ–ï–ù–û) –ó–∞–ø—É—Å—Ç–∏—Ç–∏ –ø–æ–≤–Ω–∏–π —Ç–µ—Å—Ç –º–µ—Ä–µ–∂—ñ"""
        pc_name = socket.gethostname()
        store_location = self.config.store_location_text
        # (–ù–û–í–ï) –û—Ç—Ä–∏–º—É—î–º–æ –ü–Ü–ë
        user_name = self.config.get("user_name", "")

        hosts = {
            "1–° –°–µ—Ä–≤–µ—Ä": "23.88.7.196",
            "Google DNS": "8.8.8.8"
        }

        report_parts = []
        total_loss = 0

        for name, ip in hosts.items():
            ping_output = self.run_ping_test(ip)
            loss = self.parse_ping_loss(ping_output)

            if loss >= 0:
                status = "‚úÖ" if loss == 0 else ("‚ö†Ô∏è" if loss <= 15 else "‚ùå")
                report_parts.append(f"{status} {name} ({ip}): {loss}% –≤—Ç—Ä–∞—Ç–∏")
                total_loss += loss
            else:
                report_parts.append(f"‚ùå {name} ({ip}): –ü–æ–º–∏–ª–∫–∞ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è")

        avg_loss = total_loss / len(hosts) if hosts else 0

        if avg_loss == 0:
            status_text = "‚úÖ –ú–µ—Ä–µ–∂–∞ –≤ –Ω–æ—Ä–º—ñ"
            color = "green"
        elif avg_loss <= 15:
            status_text = "‚ö†Ô∏è –Ñ –Ω–µ–≤–µ–ª–∏–∫—ñ –ø—Ä–æ–±–ª–µ–º–∏"
            color = "orange"
        else:
            status_text = "‚ùå –°–µ—Ä–π–æ–∑–Ω—ñ –ø—Ä–æ–±–ª–µ–º–∏"
            color = "red"

        # (–û–ù–û–í–õ–ï–ù–û) –í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ –≤ Telegram —Ä–∞–∑–æ–º –∑ –ü–Ü–ë
        test_report = "\n".join(report_parts)
        self.telegram.send_network_report(store_location, pc_name, test_report, user_name)

        return {
            "status": status_text,
            "color": color,
            "details": test_report
        }

================================================================================
–§–∞–π–ª 13/20: src\rdp_manager.py
--------------------------------------------------------------------------------
import os
import subprocess
import time
import winreg
import logging
import keyring
from pathlib import Path

logger = logging.getLogger(__name__)


class RDPManager:
    """–ú–µ–Ω–µ–¥–∂–µ—Ä –¥–ª—è RDP –ø—ñ–¥–∫–ª—é—á–µ–Ω—å –∑ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–º –ª–æ–≥—ñ–Ω–æ–º"""

    def __init__(self, config_manager, telegram_api):
        self.config = config_manager
        self.telegram = telegram_api

    def save_credentials(self, host, username, password):
        """–ó–±–µ—Ä–µ–≥—Ç–∏ RDP –¥–∞–Ω—ñ –≤ Windows Credential Manager"""
        try:
            keyring.set_password(f"RDP_{host}", username, password)
            self.config.set("rdp_password", password)
            logger.info(f"‚úÖ –î–∞–Ω—ñ –∑–±–µ—Ä–µ–∂–µ–Ω—ñ –¥–ª—è {host}")
            return True
        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è: {e}")
            return False

    def get_credentials(self, host, username):
        """–û—Ç—Ä–∏–º–∞—Ç–∏ –ø–∞—Ä–æ–ª—å –∑ Credential Manager"""
        try:
            password = keyring.get_password(f"RDP_{host}", username)
            return password
        except:
            return None

    def connect_rdp(self, host, port, username, password=None):
        """–ü—ñ–¥–∫–ª—é—á–∏—Ç–∏—Å—è –¥–æ RDP"""
        try:
            # –ö–æ–¥—É–≤–∞–Ω–Ω—è –ø–∞—Ä–æ–ª—è –¥–ª—è .RDP —Ñ–∞–π–ª—É
            encrypted_password = self._encrypt_rdp_password(password) if password else ""

            rdp_content = f"""screen mode id:i:2
use multimon:i:0
desktopwidth:i:1920
desktopheight:i:1080
session bpp:i:32
connection type:i:7
disable wallpaper:i:0
allow font smoothing:i:1
allow desktop composition:i:1
disable full window drag:i:0
disable menu anims:i:0
disable themes:i:0
disable cursor setting:i:0
bitmapcachepersistenable:i:1
full address:s:{host}:{port}
audiomode:i:0
redirectprinters:i:0
redirectcomports:i:0
redirectsmartcards:i:0
redirectclipboard:i:1
redirectposdevices:i:0
autoreconnection enabled:i:1
authentication level:i:0
prompt for credentials on client:i:0
negotiate security layer:i:1
enablecredsspsupport:i:1
username:s:{username}
password 51:b:{encrypted_password}
"""

            rdp_file = f"{host}_{username}_session.rdp"
            with open(rdp_file, "w") as f:
                f.write(rdp_content)

            subprocess.Popen(f"mstsc {rdp_file}")
            logger.info(f"‚úÖ RDP –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –∑–∞–ø—É—â–µ–Ω–æ")

            # –í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ –≤ Telegram
#            self.telegram.send_rdp_info(
#                self.config.store_location_text,
#                os.environ.get('COMPUTERNAME', 'Unknown')
#            )

            return True
        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è: {e}")
            return False

    def _encrypt_rdp_password(self, password):
        """–ü—Ä–æ—Å—Ç–æ–µ —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è –ø–∞—Ä–æ–ª—è –¥–ª—è .RDP"""
        encrypted = ""
        for char in password:
            encrypted += format(ord(char) ^ 0xAA, '02x')
        return encrypted


================================================================================
–§–∞–π–ª 14/20: src\setup_wizard.py
--------------------------------------------------------------------------------
import customtkinter as ctk
import tkinter.messagebox as messagebox

# (–ù–û–í–ï) –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —Å—Ç–∏–ª—é iOS
IOS_BG_COLOR = "#f2f2f7"
IOS_CARD_COLOR = "#ffffff"
IOS_TEXT_COLOR = "#000000"
IOS_CARD_BORDER = "#E0E0E0"
IOS_CARD_RADIUS = 15
IOS_BUTTON_RADIUS = 12


class SetupWizard(ctk.CTkToplevel):
    def __init__(self, parent, on_complete):
        super().__init__(parent)

        self.title("RemoteHand - –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è")
        self.geometry("450x520")
        self.resizable(False, False)

        # (–û–ù–û–í–õ–ï–ù–û) –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è —Ñ–æ–Ω—É
        self.configure(fg_color=IOS_BG_COLOR)

        self.transient(parent)
        self.grab_set()
        self.protocol("WM_DELETE_WINDOW", self.on_closing)

        self.on_complete = on_complete
        self.setup_complete = False

        ctk.set_appearance_mode("light")
        ctk.set_default_color_theme("blue")

        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        title = ctk.CTkLabel(
            self,
            text="–ü–µ—Ä—à–µ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è",
            font=ctk.CTkFont(size=22, weight="bold"),
            text_color=IOS_TEXT_COLOR
        )
        title.pack(pady=20, padx=20, anchor="w")

        subtitle = ctk.CTkLabel(
            self,
            text="–í–∫–∞–∂—ñ—Ç—å, –¥–µ –∑–Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è —Ü–µ–π –∫–æ–º–ø'—é—Ç–µ—Ä.",
            font=ctk.CTkFont(size=13),
            text_color="#8A8A8E"
        )
        subtitle.pack(pady=(0, 20), padx=20, anchor="w")

        # (–ù–û–í–ï) –ö–∞—Ä—Ç–∫–∞ –¥–ª—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å
        main_frame = ctk.CTkFrame(
            self,
            fg_color=IOS_CARD_COLOR,
            corner_radius=IOS_CARD_RADIUS,
            border_width=1,
            border_color=IOS_CARD_BORDER
        )
        main_frame.pack(fill="x", padx=20)

        # ===== –ú–ê–ì–ê–ó–ò–ù (–í–ò–ë–Ü–†) =====
        ctk.CTkLabel(
            main_frame,
            text="–í–∏–±–µ—Ä—ñ—Ç—å –º–∞–≥–∞–∑–∏–Ω:",
            font=ctk.CTkFont(size=12, weight="bold"),
            text_color=IOS_TEXT_COLOR
        ).pack(anchor="w", padx=15, pady=(15, 5))

        self.store_var = ctk.StringVar(value="")
        store_options = [
            "0 / –û—Ñ—ñ—Å", "1 / –î—ñ–∞–ª–æ–≥", "5 / –ü–æ–ª—Ç–∞–≤–∞", "7 / –û–∞–∑–∏—Å",
            "8 / –•–º–µ–ª—å–Ω–∏—Ü—å–∫–∏–π", "9 / –ß–µ—Ä–Ω—ñ–≤—Ü—ñ", "17 / –ö—Ä–µ–º–µ–Ω—á—É–∫",
            "18 / –ü_–ö–æ—Ç–ª—è—Ä–µ–≤—Å—å–∫–æ–≥–æ", "20 / –©–∞—Å–ª–∏–≤–∏–π", "21 / –°–æ—Ñ—ñ—è –º–æ–ª–ª"
        ]

        self.store_menu = ctk.CTkComboBox(
            main_frame,
            values=store_options,
            variable=self.store_var,
            font=ctk.CTkFont(size=11),
            height=35,
            corner_radius=IOS_BUTTON_RADIUS
        )
        self.store_menu.pack(padx=15, fill="x")

        # ===== –õ–û–ö–ê–¶–Ü–Ø (–í–ò–ë–Ü–†) =====
        ctk.CTkLabel(
            main_frame,
            text="–í–∏–±–µ—Ä—ñ—Ç—å –ª–æ–∫–∞—Ü—ñ—é:",
            font=ctk.CTkFont(size=12, weight="bold"),
            text_color=IOS_TEXT_COLOR
        ).pack(anchor="w", padx=15, pady=(15, 5))

        self.location_var = ctk.StringVar(value="")
        location_options = [
            "–∫–∞—Å–∞", "–∫–∞—Å–∞ 2", "–ø—ñ–¥—Å–æ–±–∫–∞", "–æ—Å–æ–±–∏—Å—Ç–∏–π"
        ]

        self.location_menu = ctk.CTkComboBox(
            main_frame,
            values=location_options,
            variable=self.location_var,
            font=ctk.CTkFont(size=11),
            height=35,
            corner_radius=IOS_BUTTON_RADIUS
        )
        self.location_menu.pack(padx=15, fill="x")

        # ===== –ü–Ü–ë (–û–ü–¶–Ü–ô–ù–û) =====
        ctk.CTkLabel(
            main_frame,
            text="–ü–Ü–ë –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ (–æ–ø—Ü—ñ–π–Ω–æ):",
            font=ctk.CTkFont(size=12, weight="bold"),
            text_color=IOS_TEXT_COLOR
        ).pack(anchor="w", padx=15, pady=(15, 5))

        self.user_name_entry = ctk.CTkEntry(
            main_frame,
            placeholder_text="–ù–∞–ø—Ä–∏–∫–ª–∞–¥: –Ü–≤–∞–Ω –ü–µ—Ç—Ä–µ–Ω–∫–æ",
            height=35,
            font=ctk.CTkFont(size=11),
            corner_radius=IOS_BUTTON_RADIUS
        )
        self.user_name_entry.pack(padx=15, fill="x", pady=(0, 20))

        # –ö–Ω–æ–ø–∫–∞ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è
        btn = ctk.CTkButton(
            self,
            text="‚úÖ –ó–±–µ—Ä–µ–≥—Ç–∏",
            command=self.save_settings,
            height=45,
            font=ctk.CTkFont(size=12, weight="bold"),
            corner_radius=IOS_BUTTON_RADIUS
        )
        btn.pack(padx=20, fill="x", pady=20)

    def on_closing(self):
        """–ó–∞–±–æ—Ä–æ–Ω–∏—Ç–∏ –∑–∞–∫—Ä–∏—Ç—Ç—è –±–µ–∑ –≤–≤–µ–¥–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö"""
        if not self.setup_complete:
            messagebox.showwarning(
                "–ü–æ–º–∏–ª–∫–∞",
                "–í–∏–±–µ—Ä—ñ—Ç—å –º–∞–≥–∞–∑–∏–Ω —ñ –ª–æ–∫–∞—Ü—ñ—é –ø–µ—Ä–µ–¥ –∑–∞–∫—Ä–∏—Ç—Ç—è–º!"
            )
            return
        self.destroy()

    def save_settings(self):
        """–ó–±–µ—Ä–µ–≥—Ç–∏ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è - –æ–±–æ–≤'—è–∑–∫–æ–≤–æ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏"""
        store = self.store_var.get().strip()
        location = self.location_var.get().strip()
        user_name = self.user_name_entry.get().strip()

        if not store:
            messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–í–∏–±–µ—Ä—ñ—Ç—å –º–∞–≥–∞–∑–∏–Ω!")
            return

        if not location:
            messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–í–∏–±–µ—Ä—ñ—Ç—å –ª–æ–∫–∞—Ü—ñ—é!")
            return

        self.setup_complete = True
        self.on_complete({
            "store": store,
            "location": location,
            "user_name": user_name
        })
        self.destroy()

================================================================================
–§–∞–π–ª 15/20: src\telegram_api.py
--------------------------------------------------------------------------------
import requests
import logging
import time
import os
from pathlib import Path

logger = logging.getLogger(__name__)


class TelegramAPI:
    """–†–æ–∑—à–∏—Ä–µ–Ω–∞ Telegram API –¥–ª—è –∑–≤—ñ—Ç—É–≤–∞–Ω–Ω—è"""

    def __init__(self, token, chat_id):
        self.token = token
        self.chat_id = chat_id

        # ‚ö†Ô∏è –ü–ï–†–ï–í–Ü–†–ê –¢–û–ö–ï–ù–Ü–í
        if not token:
            logger.error("‚ùå Telegram —Ç–æ–∫–µ–Ω –Ω–µ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ!")
            self.api_url = None
        elif not chat_id:
            logger.error("‚ùå Telegram chat_id –Ω–µ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ!")
            self.api_url = None
        else:
            self.api_url = f"https://api.telegram.org/bot{token}"
            logger.info(f"‚úÖ Telegram –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–æ (—Ç–æ–∫–µ–Ω: {token[:20]}...)")

    def send_message(self, text, parse_mode="HTML"):
        """–í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ —Ç–µ–∫—Å—Ç–æ–≤–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è"""
        if not self.api_url:
            logger.error("‚ùå Telegram –Ω–µ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–æ")
            return False

        try:
            payload = {
                "chat_id": self.chat_id,
                "text": text,
                "parse_mode": parse_mode
            }
            response = requests.post(
                f"{self.api_url}/sendMessage",
                json=payload,
                timeout=10
            )
            response.raise_for_status()
            logger.info("‚úÖ –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –Ω–∞–¥—ñ—Å–ª–∞–Ω–æ –≤ Telegram")
            return True
        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞ –≤—ñ–¥–ø—Ä–∞–≤–∫–∏ Telegram: {e}")
            return False

    def send_file(self, file_path, caption="", file_type="document"):
        """–í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ —Ñ–∞–π–ª (document –∞–±–æ photo)"""
        if not self.api_url:
            logger.error("‚ùå Telegram –Ω–µ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–æ")
            return False

        try:
            with open(file_path, 'rb') as f:
                files = {file_type: f}
                payload = {
                    "chat_id": self.chat_id,
                    "caption": caption,
                    "parse_mode": "HTML"
                }
                endpoint = "sendDocument" if file_type == "document" else "sendPhoto"
                response = requests.post(
                    f"{self.api_url}/{endpoint}",
                    files=files,
                    data=payload,
                    timeout=30
                )
                response.raise_for_status()
            logger.info(f"‚úÖ –§–∞–π–ª –Ω–∞–¥—ñ—Å–ª–∞–Ω–æ –≤ Telegram")
            return True
        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞ –≤—ñ–¥–ø—Ä–∞–≤–∫–∏ —Ñ–∞–π–ª—É: {e}")
            return False

    def send_network_report(self, store_location, pc_name, test_results, user_name=""):
        """(–û–ù–û–í–õ–ï–ù–û) –í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ –∑–≤—ñ—Ç –ø—Ä–æ —Å—Ç–∞–Ω –º–µ—Ä–µ–∂—ñ"""

        # (–ù–û–í–ï) –î–æ–¥–∞—Ç–∏ –ü–Ü–ë —è–∫—â–æ —î
        user_info = f"\n<b>üë§ –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á:</b> {user_name}" if user_name else ""

        report = (
            f"<b>üìä –ó–≤—ñ—Ç –ø—Ä–æ —Å—Ç–∞–Ω –º–µ—Ä–µ–∂—ñ</b>\n\n"
            f"<b>–ú–∞–≥–∞–∑–∏–Ω/–õ–æ–∫–∞—Ü—ñ—è:</b> {store_location}{user_info}\n"  # <-- –û–ù–û–í–õ–ï–ù–û
            f"<b>–ü–ö:</b> <code>{pc_name}</code>\n"
            f"<b>–ß–∞—Å:</b> {time.strftime('%Y-%m-%d %H:%M:%S')}\n\n"
            f"<b>–†–µ–∑—É–ª—å—Ç–∞—Ç–∏:</b>\n"
            f"{test_results}"
        )
        return self.send_message(report)

    def send_anydesk_info(self, store_location, user_name, pc_name, anydesk_id, password):
        """
        –í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ AnyDesk —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é (–ø–æ–∫—Ä–∞—â–µ–Ω–µ —Ñ–æ—Ä–º–∞—Ç—É–≤–∞–Ω–Ω—è)
        """
        user_info = f"\n<b>üë§ –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á:</b> {user_name}" if user_name else ""

        message = (
            f"<b>üåê –ó–∞–ø–∏—Ç –Ω–∞ AnyDesk</b>\n\n"
            f"<b>üìç –ú–∞–≥–∞–∑–∏–Ω:</b> {store_location}\n"
            f"<b>üíª –ö–æ–º–ø'—é—Ç–µ—Ä:</b> <code>{pc_name}</code>"
            f"{user_info}\n\n"
            f"<b>--- –î–∞–Ω—ñ –¥–ª—è –≤—Ö–æ–¥—É ---</b>\n"
            f"<b>üÜî ID:</b> <code>{anydesk_id}</code>\n"
            f"<b>üîê –ü–∞—Ä–æ–ª—å:</b> <code>{password}</code>"
        )
        return self.send_message(message)

    def send_rdp_info(self, store_location, pc_name):
        """–í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è –ø—Ä–æ RDP –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è"""
        message = (
            f"<b>üñ•Ô∏è RDP –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è</b>\n\n"
            f"<b>–ú–∞–≥–∞–∑–∏–Ω/–õ–æ–∫–∞—Ü—ñ—è:</b> {store_location}\n"
            f"<b>–ü–ö:</b> <code>{pc_name}</code>\n"
            f"<b>–ß–∞—Å:</b> {time.strftime('%Y-%m-%d %H:%M:%S')}\n\n"
            f"‚úÖ –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –ø—ñ–¥–∫–ª—é—á–∏–≤—Å—è –¥–æ 1–°"
        )
        return self.send_message(message)

    def send_error_report(self, store_location, pc_name, error_text):
        """–í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ –∑–≤—ñ—Ç –ø—Ä–æ –ø–æ–º–∏–ª–∫—É"""
        message = (
            f"<b>‚ùå –ü–æ–º–∏–ª–∫–∞</b>\n\n"
            f"<b>–ú–∞–≥–∞–∑–∏–Ω/–õ–æ–∫–∞—Ü—ñ—è:</b> {store_location}\n"
            f"<b>–ü–ö:</b> <code>{pc_name}</code>\n"
            f"<b>–ß–∞—Å:</b> {time.strftime('%Y-%m-%d %H:%M:%S')}\n\n"
            f"<b>–î–µ—Ç–∞–ª—ñ:</b>\n<code>{error_text}</code>"
        )
        return self.send_message(message)

================================================================================
–§–∞–π–ª 16/20: src\updater.py
--------------------------------------------------------------------------------
import os
import sys
import requests
import subprocess
import time
import logging
from pathlib import Path

logger = logging.getLogger(__name__)


class UpdaterManager:
    """–ú–µ–Ω–µ–¥–∂–µ—Ä –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ —Ç–∞ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –æ–Ω–æ–≤–ª–µ–Ω—å"""

    GITHUB_REPO = "ShevchukVI/RemoteHand"
    GITHUB_API_URL = f"https://api.github.com/repos/{GITHUB_REPO}/releases/latest"

    def __init__(self):
        if getattr(sys, 'frozen', False):
            self.current_exe_path = Path(sys.executable)
            self.app_dir = self.current_exe_path.parent
        else:
            self.current_exe_path = None
            self.app_dir = Path(__file__).parent.parent

        self.version_file = self.app_dir / "version.txt"
        self.current_version = self.get_current_version()

    def get_current_version(self):
        """–û—Ç—Ä–∏–º–∞—Ç–∏ –ø–æ—Ç–æ—á–Ω—É –≤–µ—Ä—Å—ñ—é"""
        if self.version_file.exists():
            try:
                # –°–ø—Ä–æ–±—É–≤–∞—Ç–∏ UTF-8-SIG (—Å—Ç–∞–Ω–¥–∞—Ä—Ç –∑ BOM)
                return self.version_file.read_text(encoding='utf-8-sig').strip()
            except UnicodeDecodeError:
                try:
                    # –Ø–∫—â–æ –Ω–µ –≤–∏–π—à–ª–æ (byte 0xff), —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ UTF-16
                    return self.version_file.read_text(encoding='utf-16').strip()
                except Exception:
                    pass  # –ü–µ—Ä–µ–π–¥–µ–º–æ –¥–æ fallback
            except Exception:
                pass  # –ü–µ—Ä–µ–π–¥–µ–º–æ –¥–æ fallback

        return "1.0.0"  # Fallback

    def get_latest_version(self):
        """–û—Ç—Ä–∏–º–∞—Ç–∏ –Ω–∞–π–Ω–æ–≤—ñ—à—É –≤–µ—Ä—Å—ñ—é –∑ GitHub"""
        try:
            response = requests.get(self.GITHUB_API_URL, timeout=10)
            response.raise_for_status()
            data = response.json()
            tag = data.get('tag_name', 'v1.0.0')
            return tag.lstrip('v')
        except Exception as e:
            logger.warning(f"–ù–µ –≤–¥–∞–ª–æ—Å—è –æ—Ç—Ä–∏–º–∞—Ç–∏ –≤–µ—Ä—Å—ñ—é –∑ GitHub: {e}")
            return None

    def compare_versions(self, current, latest):
        """–ü–æ—Ä—ñ–≤–Ω—è—Ç–∏ –≤–µ—Ä—Å—ñ—ó"""
        try:
            from packaging.version import parse
            return parse(latest) > parse(current)
        except ImportError:
            try:
                current_parts = [int(x) for x in current.split('.')]
                latest_parts = [int(x) for x in latest.split('.')]
                return latest_parts > current_parts
            except:
                return False
        except Exception:
            return False

    def download_update(self, latest_version):
        """–ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –Ω–æ–≤—É –≤–µ—Ä—Å—ñ—é"""
        try:
            logger.info(f"üì• –ó–∞–≤–∞–Ω—Ç–∞–∂—É—é RemoteHand v{latest_version}...")
            download_url = f"https://github.com/{self.GITHUB_REPO}/releases/download/v{latest_version}/RemoteHand.exe"

            response = requests.get(download_url, timeout=60, stream=True)
            response.raise_for_status()

            new_exe_path = self.app_dir / "RemoteHand_new.exe"

            with open(new_exe_path, 'wb') as f:
                for chunk in response.iter_content(chunk_size=8192):
                    f.write(chunk)

            logger.info(f"‚úÖ RemoteHand v{latest_version} –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ: {new_exe_path}")
            return new_exe_path

        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è: {e}")
            return None

    def run_update_batch(self, new_exe_path: Path):
        """
        (–û–ù–û–í–õ–ï–ù–û)
        –°—Ç–≤–æ—Ä—é—î —Ç–∞ –∑–∞–ø—É—Å–∫–∞—î .bat —Ñ–∞–π–ª, —è–∫–∏–π –ø—Ä–∏–º—É—Å–æ–≤–æ
        –≤–±–∏–≤–∞—î —Å—Ç–∞—Ä–∏–π –ø—Ä–æ—Ü–µ—Å –ø–µ—Ä–µ–¥ –∑–∞–º—ñ–Ω–æ—é.
        """
        if not self.current_exe_path:
            logger.warning("–ù–µ –º–æ–∂—É –∑–∞–ø—É—Å—Ç–∏—Ç–∏ .bat –≤ DEV —Ä–µ–∂–∏–º—ñ.")
            return

        bat_path = self.app_dir / "update.bat"
        current_exe_name = self.current_exe_path.name
        new_exe_name = new_exe_path.name

        # (–ù–û–í–ê –õ–û–ì–Ü–ö–ê .BAT)
        # TASKKILL - –ü—Ä–∏–º—É—Å–æ–≤–æ –≤–±–∏–≤–∞—î –∑–∞–±–ª–æ–∫–æ–≤–∞–Ω–∏–π –ø—Ä–æ—Ü–µ—Å
        # ping (–∑–∞–º—ñ—Å—Ç—å TIMEOUT) - –Ω–∞–¥—ñ–π–Ω–µ –æ—á—ñ–∫—É–≤–∞–Ω–Ω—è
        # MOVE /Y - –ê—Ç–æ–º–Ω–∞ –∑–∞–º—ñ–Ω–∞ —Ñ–∞–π–ª—É
        # (goto) 2>nul & del "%~f0" - –ù–∞–¥—ñ–π–Ω–∏–π —Ç—Ä—é–∫ –¥–ª—è —Å–∞–º–æ–≤–∏–¥–∞–ª–µ–Ω–Ω—è
        bat_content = f"""@ECHO OFF
TITLE –û–Ω–æ–≤–ª–µ–Ω–Ω—è RemoteHand...
ECHO –ó–∞–∫—Ä–∏–≤–∞—é –ø–æ–ø–µ—Ä–µ–¥–Ω—é –≤–µ—Ä—Å—ñ—é (TASKKILL)...
TASKKILL /F /IM "{current_exe_name}" > nul
ECHO –ß–µ–∫–∞—é 3 —Å–µ–∫—É–Ω–¥–∏...
ping 127.0.0.1 -n 4 > nul

ECHO –û–Ω–æ–≤–ª—é—é —Ñ–∞–π–ª...
MOVE /Y "{new_exe_name}" "{current_exe_name}"

ECHO –ó–∞–ø—É—Å–∫–∞—é –æ–Ω–æ–≤–ª–µ–Ω—É –≤–µ—Ä—Å—ñ—é...
START "" "{current_exe_name}"

REM –°–∞–º–æ–≤–∏–¥–∞–ª–µ–Ω–Ω—è
(goto) 2>nul & del "%~f0"
"""
        try:
            with open(bat_path, "w", encoding='cp866') as f:
                f.write(bat_content)

            logger.info(f"‚úÖ –°—Ç–≤–æ—Ä–µ–Ω–æ update.bat")

            # –ó–∞–ø—É—Å–∫–∞—î–º–æ .bat —ñ –≤—ñ–¥'—î–¥–Ω—É—î–º–æ –π–æ–≥–æ –≤—ñ–¥ –Ω–∞—à–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—É
            subprocess.Popen(
                [str(bat_path)],
                creationflags=subprocess.DETACHED_PROCESS | subprocess.CREATE_NEW_PROCESS_GROUP,
                close_fds=True,
                shell=True
            )
            logger.info(f"üîÑ –ó–∞–ø—É—â–µ–Ω–æ update.bat. –ó–∞–≤–µ—Ä—à—É—é —Ä–æ–±–æ—Ç—É...")

            # –ù–µ–≥–∞–π–Ω–æ –∑–∞–∫—Ä–∏–≤–∞—î–º–æ –ø–æ—Ç–æ—á–Ω—É –ø—Ä–æ–≥—Ä–∞–º—É
            sys.exit(0)

        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è/–∑–∞–ø—É—Å–∫—É update.bat: {e}")

    def check_and_update(self):
        """–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —Ç–∞ –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è"""
        if os.getenv('REMOTEHAND_DEV_MODE') == '1' or not getattr(sys, 'frozen', False):
            logger.info("üîß DEV —Ä–µ–∂–∏–º - –ø—Ä–æ–ø—É—Å–∫–∞—î–º–æ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è")
            return False

        logger.info("üîç –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –æ–Ω–æ–≤–ª–µ–Ω—å...")

        latest_version = self.get_latest_version()
        if not latest_version:
            logger.info("‚ö†Ô∏è –ù–µ –≤–¥–∞–ª–æ—Å—è –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è")
            return False

        logger.info(f"üìå –ü–æ—Ç–æ—á–Ω–∞ –≤–µ—Ä—Å—ñ—è: {self.current_version}")
        logger.info(f"üì¶ –û—Å—Ç–∞–Ω–Ω—è –≤–µ—Ä—Å—ñ—è: {latest_version}")

        if self.compare_versions(self.current_version, latest_version):
            logger.info(f"üì¶ –î–æ—Å—Ç—É–ø–Ω–µ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è: {latest_version}")

            new_exe = self.download_update(latest_version)

            if new_exe and new_exe.exists():
                logger.info(f"‚úÖ –ù–æ–≤–∞ –≤–µ—Ä—Å—ñ—è –≥–æ—Ç–æ–≤–∞!")
                self.run_update_batch(new_exe)
                return True
            else:
                logger.error("‚ùå –ù–µ –≤–¥–∞–ª–æ—Å—è –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è.")

        logger.info(f"‚úÖ –í–µ—Ä—Å—ñ—è –∞–∫—Ç—É–∞–ª—å–Ω–∞: {self.current_version}")
        return False


def check_and_update():
    """–§—É–Ω–∫—Ü—ñ—è –¥–ª—è —ñ–º–ø–æ—Ä—Ç—É –≤ main.py"""
    updater = UpdaterManager()
    return updater.check_and_update()

================================================================================
–§–∞–π–ª 17/20: src\utils.py
--------------------------------------------------------------------------------
import os
import sys
import subprocess
import psutil
from pathlib import Path
from config import LOCK_FILE, APP_NAME


class SingleInstance:
    """–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –Ω–∞ —î–¥–∏–Ω–∏–π –µ–∫–∑–µ–º–ø–ª—è—Ä –ø—Ä–æ–≥—Ä–∞–º–∏"""

    def __init__(self):
        self.lock_file = LOCK_FILE
        self.fp = None

    def is_running(self):
        """–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —á–∏ –ø—Ä–æ–≥—Ä–∞–º–∞ –≤–∂–µ –∑–∞–ø—É—â–µ–Ω–∞"""
        if sys.platform == 'win32':
            import win32event
            import win32api
            import winerror

            self.mutex = win32event.CreateMutex(None, False, APP_NAME)
            if win32api.GetLastError() == winerror.ERROR_ALREADY_EXISTS:
                return True
        else:
            try:
                self.fp = open(self.lock_file, 'w')
                import fcntl
                fcntl.flock(self.fp, fcntl.LOCK_EX | fcntl.LOCK_NB)
            except IOError:
                return True
        return False


def open_rdp_connection(host, port):
    """–í—ñ–¥–∫—Ä–∏—Ç—Ç—è RDP –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è"""
    rdp_command = f'mstsc /v:{host}:{port}'
    subprocess.Popen(rdp_command, shell=True)


def close_all_rdp_sessions():
    """–ó–∞–∫—Ä–∏—Ç—Ç—è –≤—Å—ñ—Ö RDP —Å–µ—Å—ñ–π"""
    for proc in psutil.process_iter(['name']):
        try:
            if proc.info['name'].lower() == 'mstsc.exe':
                proc.kill()
        except (psutil.NoSuchProcess, psutil.AccessDenied):
            pass


def test_connection(host):
    """–¢–µ—Å—Ç –∑'—î–¥–Ω–∞–Ω–Ω—è —á–µ—Ä–µ–∑ ping"""
    param = '-n' if sys.platform == 'win32' else '-c'
    command = ['ping', param, '1', host]
    result = subprocess.run(command, capture_output=True, text=True)
    return result.returncode == 0

================================================================================
–§–∞–π–ª 18/20: version.txt
--------------------------------------------------------------------------------
1.0.10

================================================================================
–§–∞–π–ª 19/20: version_info.txt
--------------------------------------------------------------------------------
VSVersionInfo(
  ffi=FixedFileInfo(mask=0x3f,
    mask_values=[(0, 63), (0, 63), (0, 63), (0, 63)],
    CV_VSVersionInfo=[(0, '0'), (0, '3'), (0, '0'), (0, '0')]),
  StringFileInfo([(u'040904B0',
    StringTable(u'040904B0',
      [StringEntry(u'CompanyName', u'RemoteHand'),
       StringEntry(u'FileDescription', u'RemoteHand - RDP & AnyDesk Manager'),
       StringEntry(u'FileVersion', u'1.0.3.0'),
       StringEntry(u'ProductName', u'RemoteHand'),
       StringEntry(u'ProductVersion', u'1.0.3')]))]),
  VarFileInfo([VarEntry(u'Translation', [1033, 1200])])
)


================================================================================
–§–∞–π–ª 20/20: –ê–∫—Ç–∏–≤–∞—Ü—ñ—è —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞.txt
--------------------------------------------------------------------------------
.venvScriptsActivate.ps1

================================================================================
–ö–Ü–ù–ï–¶–¨ –ï–ö–°–ü–û–†–¢–£
================================================================================


================================================================================
–§–∞–π–ª 6/21: project_export_20251110_155823.txt
--------------------------------------------------------------------------------
================================================================================
–ï–ö–°–ü–û–†–¢ –ü–†–û–Ñ–ö–¢–£: RemoteHand
–î–∞—Ç–∞: 2025-11-10 15:58:23
–®–ª—è—Ö: D:\Python Projects\Prego\RemoteHand
================================================================================

üìÇ –°–¢–†–£–ö–¢–£–†–ê –ü–†–û–Ñ–ö–¢–£
--------------------------------------------------------------------------------
RemoteHand/
‚îú‚îÄ‚îÄ assets/
‚îÇ   ‚îî‚îÄ‚îÄ icon.ico
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ anydesk_manager.py
‚îÇ   ‚îú‚îÄ‚îÄ config.py
‚îÇ   ‚îú‚îÄ‚îÄ config_manager.py
‚îÇ   ‚îú‚îÄ‚îÄ main.py
‚îÇ   ‚îú‚îÄ‚îÄ network_test.py
‚îÇ   ‚îú‚îÄ‚îÄ rdp_manager.py
‚îÇ   ‚îú‚îÄ‚îÄ setup_wizard.py
‚îÇ   ‚îú‚îÄ‚îÄ telegram_api.py
‚îÇ   ‚îú‚îÄ‚îÄ updater.py
‚îÇ   ‚îî‚îÄ‚îÄ utils.py
‚îú‚îÄ‚îÄ .env.example
‚îú‚îÄ‚îÄ 23.88.7.196_admin_session.rdp
‚îú‚îÄ‚îÄ dev_run.py
‚îú‚îÄ‚îÄ export.py
‚îú‚îÄ‚îÄ GitCommitTool.py
‚îú‚îÄ‚îÄ project_export_20251110_104446.txt
‚îú‚îÄ‚îÄ project_export_20251110_151306.txt
‚îú‚îÄ‚îÄ project_export_20251110_155823.txt
‚îú‚îÄ‚îÄ README.md
‚îú‚îÄ‚îÄ RemoteHand.spec
‚îú‚îÄ‚îÄ requirements.txt
‚îú‚îÄ‚îÄ version.txt
‚îú‚îÄ‚îÄ version_info.txt
‚îî‚îÄ‚îÄ –ê–∫—Ç–∏–≤–∞—Ü—ñ—è —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞.txt

üìÑ –í–ú–Ü–°–¢ –§–ê–ô–õ–Ü–í (21 —Ñ–∞–π–ª—ñ–≤)
================================================================================


================================================================================
–§–∞–π–ª 1/21: dev_run.py
--------------------------------------------------------------------------------
"""
DEV_RUN.PY - –õ–æ–∫–∞–ª—å–Ω–µ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è
"""

import sys
import os

# –í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ DEV —Ä–µ–∂–∏–º
os.environ['REMOTEHAND_DEV_MODE'] = '1'

# –î–æ–¥–∞—Ç–∏ src –≤ path
sys.path.insert(0, os.path.join(os.path.dirname(__file__), 'src'))

print("–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π...")
import subprocess
subprocess.run([sys.executable, "-m", "pip", "install", "-r", "requirements.txt", "-q"],
               capture_output=True)

print("üîß –ó–∞–ø—É—Å–∫ —É DEV —Ä–µ–∂–∏–º—ñ...")

# –ü—Ä—è–º–æ –∑–∞–ø—É—Å—Ç–∏—Ç–∏ main
if __name__ == "__main__":
    import main
    main.main()


================================================================================
–§–∞–π–ª 2/21: export.py
--------------------------------------------------------------------------------
#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Project Structure Exporter
–°—Ç–≤–æ—Ä—é—î –¥–µ—Ç–∞–ª—å–Ω–∏–π –æ–ø–∏—Å —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ –ø—Ä–æ—î–∫—Ç—É —Ç–∞ –≤–º—ñ—Å—Ç —Ñ–∞–π–ª—ñ–≤ —É –æ–¥–∏–Ω —Ñ–∞–π–ª
"""

import os
from pathlib import Path
from datetime import datetime

# –§–∞–π–ª–∏ —Ç–∞ –ø–∞–ø–∫–∏, —è–∫—ñ —Ç—Ä–µ–±–∞ —ñ–≥–Ω–æ—Ä—É–≤–∞—Ç–∏
IGNORE_PATTERNS = {
    # –ü–∞–ø–∫–∏
    '__pycache__', '.git', '.idea', '.vscode', 'node_modules',
    'venv', 'env', '.env', 'dist', 'build', '.pytest_cache',
    '.mypy_cache', 'htmlcov', '.coverage', 'logs', 'tmp',
    # –§–∞–π–ª–∏
    '.pyc', '.pyo', '.pyd', '.so', '.dll', '.dylib', '.exe',
    '.log', '.sqlite', '.db', '.pkl', '.pickle', '.DS_Store',
    'Thumbs.db', '.env', '.env.local', '.gitignore'
}

# –†–æ–∑—à–∏—Ä–µ–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤ –¥–ª—è —á–∏—Ç–∞–Ω–Ω—è (—Ç–µ–∫—Å—Ç–æ–≤—ñ —Ñ–∞–π–ª–∏)
TEXT_EXTENSIONS = {
    '.py', '.js', '.ts', '.jsx', '.tsx', '.html', '.css', '.scss',
    '.json', '.yaml', '.yml', '.toml', '.ini', '.cfg', '.conf',
    '.txt', '.md', '.rst', '.xml', '.sql', '.sh', '.bash',
    '.env.example', '.gitignore', 'Dockerfile', 'Makefile',
    '.java', '.c', '.cpp', '.h', '.go', '.rs', '.php', '.rb'
}

# –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∏–π —Ä–æ–∑–º—ñ—Ä —Ñ–∞–π–ª—É (1 MB)
MAX_FILE_SIZE = 1024 * 1024


def should_ignore(path: Path) -> bool:
    """–ü–µ—Ä–µ–≤—ñ—Ä—è—î, —á–∏ —Ç—Ä–µ–±–∞ —ñ–≥–Ω–æ—Ä—É–≤–∞—Ç–∏ —Ñ–∞–π–ª/–ø–∞–ø–∫—É"""
    name = path.name

    # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ç–æ—á–Ω–æ–≥–æ –∑–±—ñ–≥—É
    if name in IGNORE_PATTERNS:
        return True

    # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è
    if path.suffix in IGNORE_PATTERNS:
        return True

    # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø—Ä–∏—Ö–æ–≤–∞–Ω–∏—Ö —Ñ–∞–π–ª—ñ–≤ (–∫—Ä—ñ–º .env.example)
    if name.startswith('.') and name != '.env.example':
        return True

    return False


def is_text_file(path: Path) -> bool:
    """–ü–µ—Ä–µ–≤—ñ—Ä—è—î, —á–∏ —î —Ñ–∞–π–ª —Ç–µ–∫—Å—Ç–æ–≤–∏–º"""
    # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è
    if path.suffix.lower() in TEXT_EXTENSIONS:
        return True

    # –§–∞–π–ª–∏ –±–µ–∑ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è, —è–∫—ñ –∑–∞–∑–≤–∏—á–∞–π —Ç–µ–∫—Å—Ç–æ–≤—ñ
    if path.suffix == '' and path.name in {'Dockerfile', 'Makefile', 'README', 'LICENSE'}:
        return True

    return False


def get_tree_structure(root_path: Path, prefix: str = "", is_last: bool = True) -> list:
    """–ì–µ–Ω–µ—Ä—É—î –¥–µ—Ä–µ–≤–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ –ø—Ä–æ—î–∫—Ç—É"""
    lines = []

    try:
        items = sorted(root_path.iterdir(), key=lambda x: (not x.is_dir(), x.name.lower()))
        items = [item for item in items if not should_ignore(item)]

        for i, item in enumerate(items):
            is_last_item = i == len(items) - 1
            current_prefix = "‚îî‚îÄ‚îÄ " if is_last_item else "‚îú‚îÄ‚îÄ "
            lines.append(f"{prefix}{current_prefix}{item.name}{'/' if item.is_dir() else ''}")

            if item.is_dir():
                extension = "    " if is_last_item else "‚îÇ   "
                lines.extend(get_tree_structure(item, prefix + extension, is_last_item))

    except PermissionError:
        pass

    return lines


def read_file_content(file_path: Path) -> str:
    """–ß–∏—Ç–∞—î –≤–º—ñ—Å—Ç —Ñ–∞–π–ª—É"""
    try:
        # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ä–æ–∑–º—ñ—Ä—É
        if file_path.stat().st_size > MAX_FILE_SIZE:
            return f"[–§–∞–π–ª –∑–∞–Ω–∞–¥—Ç–æ –≤–µ–ª–∏–∫–∏–π: {file_path.stat().st_size / 1024:.1f} KB]"

        # –°–ø—Ä–æ–±–∞ –ø—Ä–æ—á–∏—Ç–∞—Ç–∏ —è–∫ —Ç–µ–∫—Å—Ç
        with open(file_path, 'r', encoding='utf-8') as f:
            return f.read()
    except UnicodeDecodeError:
        # –Ø–∫—â–æ –Ω–µ –≤–¥–∞–ª–æ—Å—è –ø—Ä–æ—á–∏—Ç–∞—Ç–∏ —è–∫ UTF-8
        try:
            with open(file_path, 'r', encoding='cp1251') as f:
                return f.read()
        except:
            return "[–ù–µ –≤–¥–∞–ª–æ—Å—è –ø—Ä–æ—á–∏—Ç–∞—Ç–∏ —Ñ–∞–π–ª - –±—ñ–Ω–∞—Ä–Ω–∏–π –∞–±–æ –Ω–µ–≤—ñ–¥–æ–º–µ –∫–æ–¥—É–≤–∞–Ω–Ω—è]"
    except Exception as e:
        return f"[–ü–æ–º–∏–ª–∫–∞ —á–∏—Ç–∞–Ω–Ω—è: {str(e)}]"


def collect_files(root_path: Path) -> list:
    """–ó–±–∏—Ä–∞—î –≤—Å—ñ —Ç–µ–∫—Å—Ç–æ–≤—ñ —Ñ–∞–π–ª–∏ –ø—Ä–æ—î–∫—Ç—É"""
    files = []

    for item in root_path.rglob('*'):
        if item.is_file() and not should_ignore(item) and is_text_file(item):
            # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞, —â–æ –≤—Å—ñ –±–∞—Ç—å–∫—ñ–≤—Å—å–∫—ñ –ø–∞–ø–∫–∏ –Ω–µ —ñ–≥–Ω–æ—Ä—É—é—Ç—å—Å—è
            if not any(should_ignore(parent) for parent in item.parents):
                files.append(item)

    return sorted(files)


def generate_project_export(project_path: str, output_file: str = None):
    """–ì–µ–Ω–µ—Ä—É—î –ø–æ–≤–Ω–∏–π –µ–∫—Å–ø–æ—Ä—Ç –ø—Ä–æ—î–∫—Ç—É"""
    root = Path(project_path).resolve()

    if not root.exists():
        print(f"‚ùå –ü–æ–º–∏–ª–∫–∞: –®–ª—è—Ö '{project_path}' –Ω–µ —ñ—Å–Ω—É—î!")
        return

    if output_file is None:
        timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
        output_file = f"project_export_{timestamp}.txt"

    print(f"üìÅ –ê–Ω–∞–ª—ñ–∑ –ø—Ä–æ—î–∫—Ç—É: {root.name}")
    print(f"üìù –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –µ–∫—Å–ø–æ—Ä—Ç—É...")

    with open(output_file, 'w', encoding='utf-8') as f:
        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        f.write("=" * 80 + "\n")
        f.write(f"–ï–ö–°–ü–û–†–¢ –ü–†–û–Ñ–ö–¢–£: {root.name}\n")
        f.write(f"–î–∞—Ç–∞: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}\n")
        f.write(f"–®–ª—è—Ö: {root}\n")
        f.write("=" * 80 + "\n\n")

        # –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ—î–∫—Ç—É
        f.write("üìÇ –°–¢–†–£–ö–¢–£–†–ê –ü–†–û–Ñ–ö–¢–£\n")
        f.write("-" * 80 + "\n")
        f.write(f"{root.name}/\n")
        tree_lines = get_tree_structure(root)
        f.write("\n".join(tree_lines))
        f.write("\n\n")

        # –ó–±—ñ—Ä —Ñ–∞–π–ª—ñ–≤
        files = collect_files(root)

        f.write(f"üìÑ –í–ú–Ü–°–¢ –§–ê–ô–õ–Ü–í ({len(files)} —Ñ–∞–π–ª—ñ–≤)\n")
        f.write("=" * 80 + "\n\n")

        # –í–º—ñ—Å—Ç –∫–æ–∂–Ω–æ–≥–æ —Ñ–∞–π–ª—É
        for i, file_path in enumerate(files, 1):
            relative_path = file_path.relative_to(root)

            print(f"  [{i}/{len(files)}] {relative_path}")

            f.write("\n" + "=" * 80 + "\n")
            f.write(f"–§–∞–π–ª {i}/{len(files)}: {relative_path}\n")
            f.write("-" * 80 + "\n")

            content = read_file_content(file_path)
            f.write(content)
            f.write("\n")

        # –ü—ñ–¥—Å—É–º–æ–∫
        f.write("\n" + "=" * 80 + "\n")
        f.write("–ö–Ü–ù–ï–¶–¨ –ï–ö–°–ü–û–†–¢–£\n")
        f.write("=" * 80 + "\n")

    file_size = Path(output_file).stat().st_size
    print(f"\n‚úÖ –ï–∫—Å–ø–æ—Ä—Ç –∑–∞–≤–µ—Ä—à–µ–Ω–æ!")
    print(f"üìÑ –§–∞–π–ª: {output_file}")
    print(f"üìä –†–æ–∑–º—ñ—Ä: {file_size / 1024:.1f} KB")
    print(f"üìÅ –§–∞–π–ª—ñ–≤ –æ–±—Ä–æ–±–ª–µ–Ω–æ: {len(files)}")


if __name__ == "__main__":
    import sys

    # –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è: python export_project.py [—à–ª—è—Ö_–¥–æ_–ø—Ä–æ—î–∫—Ç—É] [–≤–∏—Ö—ñ–¥–Ω–∏–π_—Ñ–∞–π–ª]
    project_path = sys.argv[1] if len(sys.argv) > 1 else "."
    output_file = sys.argv[2] if len(sys.argv) > 2 else None

    generate_project_export(project_path, output_file)


================================================================================
–§–∞–π–ª 3/21: GitCommitTool.py
--------------------------------------------------------------------------------
import customtkinter as ctk
from tkinter import messagebox, scrolledtext
import subprocess
import os
import re
from pathlib import Path
from datetime import datetime
from packaging.version import parse as parse_version


class GitCommitTool(ctk.CTk):
    def __init__(self):
        super().__init__()

        self.title("Git Commit Tool")
        self.geometry("600x750")
        self.resizable(False, False)
        self.is_running = False  # –ü—Ä–∞–ø–æ—Ä–µ—Ü—å –¥–ª—è –±–ª–æ–∫—É–≤–∞–Ω–Ω—è UI

        # –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç–µ–º–∏
        ctk.set_appearance_mode("dark")  # –ó–º—ñ–Ω–µ–Ω–æ –Ω–∞ —Ç–µ–º–Ω—É
        ctk.set_default_color_theme("blue")

        # –û—Ç—Ä–∏–º–∞–Ω–Ω—è –ø–æ—Ç–æ—á–Ω–æ—ó –≤–µ—Ä—Å—ñ—ó
        self.current_version = self.get_current_version()

        # –°–ø–∏—Å–æ–∫ –µ–ª–µ–º–µ–Ω—Ç—ñ–≤ UI –¥–ª—è –±–ª–æ–∫—É–≤–∞–Ω–Ω—è
        self.interactive_widgets = []

        self.setup_ui()
        self.toggle_version_fields()  # –ü–æ—á–∞—Ç–∫–æ–≤–µ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —Å—Ç–∞–Ω—É UI

    def setup_ui(self):
        """(–û–ù–û–í–õ–ï–ù–û) –°—Ç–≤–æ—Ä–µ–Ω–Ω—è UI"""

        main_frame = ctk.CTkFrame(self, fg_color="transparent")
        main_frame.pack(fill="both", expand=True, padx=20, pady=15)

        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        title_label = ctk.CTkLabel(
            main_frame,
            text="Git Commit Tool",
            font=ctk.CTkFont(size=24, weight="bold")
        )
        title_label.pack(pady=10)

        # –ü–æ—Ç–æ—á–Ω–∞ –≤–µ—Ä—Å—ñ—è
        version_frame = ctk.CTkFrame(main_frame)
        version_frame.pack(pady=10, fill="x")

        ctk.CTkLabel(
            version_frame,
            text="–ü–æ—Ç–æ—á–Ω–∞ –≤–µ—Ä—Å—ñ—è:",
            font=ctk.CTkFont(size=12, weight="bold")
        ).pack(side="left", padx=(10, 0))

        self.current_version_label = ctk.CTkLabel(
            version_frame,
            text=f"v{self.current_version}",
            font=ctk.CTkFont(size=12),
            text_color="gray"
        )
        self.current_version_label.pack(side="left", padx=10)

        # –ö–æ–º–µ–Ω—Ç–∞—Ä
        ctk.CTkLabel(
            main_frame,
            text="–ö–æ–º–µ–Ω—Ç–∞—Ä (commit message):",
            font=ctk.CTkFont(size=12, weight="bold")
        ).pack(anchor="w", pady=(10, 5))

        self.comment_entry = ctk.CTkEntry(
            main_frame,
            placeholder_text="–û–ø–∏—à—ñ—Ç—å –≤–∞—à—ñ –∑–º—ñ–Ω–∏...",
            height=40,
            font=ctk.CTkFont(size=11)
        )
        self.comment_entry.pack(fill="x", pady=(0, 15))
        self.interactive_widgets.append(self.comment_entry)

        # --- –ë–ª–æ–∫ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –≤–µ—Ä—Å—ñ—ó ---

        # –ß–µ–∫–±–æ–∫—Å –¥–ª—è —Ç–∞–≥—É
        self.tag_checkbox = ctk.CTkCheckBox(
            main_frame,
            text="–°—Ç–≤–æ—Ä–∏—Ç–∏ –Ω–æ–≤–∏–π —Ç–µ–≥ –≤–µ—Ä—Å—ñ—ó",
            font=ctk.CTkFont(size=11),
            command=self.toggle_version_fields
        )
        self.tag_checkbox.pack(anchor="w", pady=(0, 10))
        self.tag_checkbox.select()
        self.interactive_widgets.append(self.tag_checkbox)

        # –ù–æ–≤–∞ –≤–µ—Ä—Å—ñ—è
        self.version_frame_new = ctk.CTkFrame(main_frame)
        self.version_frame_new.pack(fill="x", pady=(0, 15))

        ctk.CTkLabel(
            self.version_frame_new,
            text="–ù–æ–≤–∞ –≤–µ—Ä—Å—ñ—è (–¥–ª—è —Ç–∞–≥—É):",
            font=ctk.CTkFont(size=12, weight="bold")
        ).pack(anchor="w", pady=(0, 5), padx=10)

        version_entry_frame = ctk.CTkFrame(self.version_frame_new, fg_color="transparent")
        version_entry_frame.pack(fill="x", padx=10)

        ctk.CTkLabel(
            version_entry_frame,
            text="v",
            font=ctk.CTkFont(size=11)
        ).pack(side="left", padx=(0, 5))

        self.version_entry = ctk.CTkEntry(
            version_entry_frame,
            placeholder_text="1.1.0",
            height=35,
            font=ctk.CTkFont(size=11)
        )
        self.version_entry.pack(side="left", fill="x", expand=True)
        self.version_entry.insert(0, self.current_version)  # –ü–æ–ø–µ—Ä–µ–¥–Ω—å–æ –∑–∞–ø–æ–≤–Ω—é—î–º–æ
        self.interactive_widgets.append(self.version_entry)

        # (–ù–û–í–ï) –ö–Ω–æ–ø–∫–∏ –¥–ª—è "–±–∞–º–ø—É" –≤–µ—Ä—Å—ñ—ó
        self.bump_button_frame = ctk.CTkFrame(self.version_frame_new, fg_color="transparent")
        self.bump_button_frame.pack(fill="x", padx=10, pady=10)

        bump_patch_btn = ctk.CTkButton(
            self.bump_button_frame, text="Patch (+0.0.1)",
            command=lambda: self.bump_version('patch'),
            font=ctk.CTkFont(size=10, weight="bold"), height=25
        )
        bump_patch_btn.pack(side="left", fill="x", expand=True, padx=2)

        bump_minor_btn = ctk.CTkButton(
            self.bump_button_frame, text="Minor (+0.1.0)",
            command=lambda: self.bump_version('minor'),
            font=ctk.CTkFont(size=10, weight="bold"), height=25
        )
        bump_minor_btn.pack(side="left", fill="x", expand=True, padx=2)

        bump_major_btn = ctk.CTkButton(
            self.bump_button_frame, text="Major (+1.0.0)",
            command=lambda: self.bump_version('major'),
            font=ctk.CTkFont(size=10, weight="bold"), height=25
        )
        bump_major_btn.pack(side="left", fill="x", expand=True, padx=2)

        self.interactive_widgets.extend([bump_patch_btn, bump_minor_btn, bump_major_btn])

        # –ö–Ω–æ–ø–∫–∏
        button_frame = ctk.CTkFrame(main_frame, fg_color="transparent")
        button_frame.pack(fill="x", pady=(0, 15))

        self.commit_btn = ctk.CTkButton(
            button_frame,
            text="‚úÖ Commit & Push",
            command=self.commit_and_push_thread,
            font=ctk.CTkFont(size=12, weight="bold"),
            height=45,
            corner_radius=10
        )
        self.commit_btn.pack(side="left", fill="both", expand=True, padx=(0, 5))
        self.interactive_widgets.append(self.commit_btn)

        clear_btn = ctk.CTkButton(
            button_frame,
            text="üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç–∏",
            command=self.clear_fields,
            font=ctk.CTkFont(size=12),
            height=45,
            corner_radius=10,
            fg_color="gray30",
            hover_color="gray50"
        )
        clear_btn.pack(side="left", fill="both", expand=True, padx=(5, 0))
        self.interactive_widgets.append(clear_btn)

        # –õ–æ–≥–∏
        ctk.CTkLabel(
            main_frame,
            text="–õ–æ–≥–∏ –æ–ø–µ—Ä–∞—Ü—ñ–π:",
            font=ctk.CTkFont(size=11, weight="bold")
        ).pack(anchor="w", pady=(10, 5))

        log_frame = ctk.CTkFrame(main_frame, fg_color="transparent")
        log_frame.pack(fill="both", expand=True)

        self.log_text = scrolledtext.ScrolledText(
            log_frame,
            height=10,
            width=70,
            font=("Courier", 10),
            bg="#2B2B2B",  # –¢–µ–º–Ω–∏–π —Ñ–æ–Ω
            fg="#E0E0E0",  # –°–≤—ñ—Ç–ª–∏–π —Ç–µ–∫—Å—Ç
            relief="solid",
            borderwidth=1,
            bd=0
        )
        self.log_text.pack(fill="both", expand=True)
        # (–ù–û–í–ï) –¢–µ–≥–∏ –¥–ª—è –∫–æ–ª—å–æ—Ä—ñ–≤
        self.log_text.tag_config("info", foreground="#89CFF0")
        self.log_text.tag_config("success", foreground="#7FFF7F")
        self.log_text.tag_config("error", foreground="#FF6B6B")
        self.log_text.tag_config("warning", foreground="#FFA500")

        # –°—Ç–∞—Ç—É—Å
        self.status_label = ctk.CTkLabel(
            main_frame,
            text="–ì–æ—Ç–æ–≤–æ –¥–æ —Ä–æ–±–æ—Ç–∏",
            font=ctk.CTkFont(size=10),
            text_color="gray"
        )
        self.status_label.pack(pady=(10, 0))

    def get_current_version(self):
        """–û—Ç—Ä–∏–º–∞–Ω–Ω—è –ø–æ—Ç–æ—á–Ω–æ—ó –≤–µ—Ä—Å—ñ—ó –∑ version.txt"""
        try:
            with open("version.txt", "r") as f:
                version = f.read().strip()
                # (–ù–û–í–ï) –í–∞–ª—ñ–¥–∞—Ü—ñ—è –≤–µ—Ä—Å—ñ—ó
                if re.match(r"^\d+\.\d+\.\d+$", version):
                    return version
                else:
                    return "1.0.0"  # Fallback
        except:
            return "1.0.0"

    def toggle_version_fields(self):
        """(–ù–û–í–ï) –í–º–∏–∫–∞—î/–≤–∏–º–∏–∫–∞—î –±–ª–æ–∫ –≤–µ—Ä—Å—ñ—ó"""
        is_enabled = self.tag_checkbox.get()
        state = "normal" if is_enabled else "disabled"

        self.version_entry.configure(state=state)
        for btn in self.bump_button_frame.winfo_children():
            btn.configure(state=state)

        # (–ù–û–í–ï) –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –ø—Ä–æ–ø–æ–Ω—É—î–º–æ patch-bump
        if is_enabled:
            self.bump_version('patch', auto_fill=True)

    def bump_version(self, part="patch", auto_fill=False):
        """(–ù–û–í–ï) –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∑–±—ñ–ª—å—à—É—î –≤–µ—Ä—Å—ñ—é"""
        try:
            current_v = parse_version(self.get_current_version())
            parts = list(current_v.release)

            if part == 'major':
                parts[0] += 1
                parts[1] = 0
                parts[2] = 0
            elif part == 'minor':
                parts[1] += 1
                parts[2] = 0
            else:  # patch
                parts[2] += 1

            new_version = f"{parts[0]}.{parts[1]}.{parts[2]}"

            if not auto_fill or self.version_entry.get() != new_version:
                self.version_entry.delete(0, "end")
                self.version_entry.insert(0, new_version)

        except Exception as e:
            self.log_message(f"‚ùå –ü–æ–º–∏–ª–∫–∞ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –≤–µ—Ä—Å—ñ—ó: {str(e)}", "error")

    def log_message(self, message, tag="info"):
        """(–û–ù–û–í–õ–ï–ù–û) –î–æ–¥–∞–Ω–Ω—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –¥–æ –ª–æ–≥—ñ–≤ –∑ —Ç–µ–≥–æ–º"""
        timestamp = datetime.now().strftime("%H:%M:%S")
        self.log_text.configure(state="normal")
        self.log_text.insert("end", f"[{timestamp}] {message}\n", tag)
        self.log_text.configure(state="disabled")
        self.log_text.see("end")
        self.update_idletasks()

    def set_ui_state(self, is_enabled):
        """(–ù–û–í–ï) –í–º–∏–∫–∞—î/–≤–∏–º–∏–∫–∞—î –≤–µ—Å—å UI"""
        state = "normal" if is_enabled else "disabled"
        for widget in self.interactive_widgets:
            widget.configure(state=state)
        self.is_running = not is_enabled
        if is_enabled:
            self.toggle_version_fields()  # –ü–æ–≤–µ—Ä—Ç–∞—î–º–æ –∫–æ—Ä–µ–∫—Ç–Ω–∏–π —Å—Ç–∞–Ω –ø–æ–ª—ñ–≤ –≤–µ—Ä—Å—ñ—ó

    def run_git_command(self, command, log_output=True):
        """(–û–ù–û–í–õ–ï–ù–û) –í–∏–∫–æ–Ω–∞–Ω–Ω—è git –∫–æ–º–∞–Ω–¥–∏, –ø–æ–≤–µ—Ä—Ç–∞—î (success, output)"""
        self.log_message(f"$ {command}", "info")
        try:
            result = subprocess.run(
                command,
                shell=True,
                capture_output=True,
                text=True,
                encoding='utf-8',  # –í—Å—Ç–∞–Ω–æ–≤–ª—é—î–º–æ –∫–æ–¥—É–≤–∞–Ω–Ω—è
                cwd=os.getcwd()
            )

            if result.returncode == 0:
                if result.stdout and log_output:
                    self.log_message(f"{result.stdout.strip()}", "success")
                return True, result.stdout.strip()
            else:
                error_msg = result.stderr.strip() if result.stderr else "–ù–µ–≤—ñ–¥–æ–º–∞ –ø–æ–º–∏–ª–∫–∞"
                if log_output:
                    self.log_message(f"‚ùå –ü–æ–º–∏–ª–∫–∞: {error_msg}", "error")
                return False, error_msg
        except Exception as e:
            self.log_message(f"‚ùå –í–∏–Ω—è—Ç–æ–∫: {str(e)}", "error")
            return False, str(e)

    def get_current_branch(self):
        """(–ù–û–í–ï) –û—Ç—Ä–∏–º—É—î –ø–æ—Ç–æ—á–Ω—É –≥—ñ–ª–∫—É git"""
        success, output = self.run_git_command("git rev-parse --abbrev-ref HEAD", log_output=False)
        if success:
            return output
        return "main"  # Fallback

    def commit_and_push_thread(self):
        """(–ù–û–í–ï) –ó–∞–ø—É—Å–∫–∞—î –ø—Ä–æ—Ü–µ—Å –≤ –æ–∫—Ä–µ–º–æ–º—É –ø–æ—Ç–æ—Ü—ñ, —â–æ–± UI –Ω–µ "–∑–∞–≤–∏—Å–∞–≤" """
        if self.is_running:
            self.log_message("‚è≥ –û–ø–µ—Ä–∞—Ü—ñ—è –≤–∂–µ –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è...", "warning")
            return

        # –ó–∞–ø—É—Å–∫–∞—î–º–æ –≤ –æ–∫—Ä–µ–º–æ–º—É –ø–æ—Ç–æ—Ü—ñ
        import threading
        threading.Thread(target=self.commit_and_push, daemon=True).start()

    def commit_and_push(self):
        """(–û–ù–û–í–õ–ï–ù–û) –û—Å–Ω–æ–≤–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è - commit, tag —ñ push"""

        self.set_ui_state(False)
        self.status_label.configure(text="‚è≥ –û–±—Ä–æ–±–∫–∞...")

        try:
            comment = self.comment_entry.get().strip()
            new_version = self.version_entry.get().strip()
            create_tag = self.tag_checkbox.get()

            # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∏
            if not comment:
                messagebox.showwarning("–ü–æ–º–∏–ª–∫–∞", "–ù–∞–ø–∏—à—ñ—Ç—å –∫–æ–º–µ–Ω—Ç–∞—Ä –¥–æ –∫–æ–º—ñ—Ç—é!")
                self.log_message("‚ùå –ö–æ–º–µ–Ω—Ç–∞—Ä –Ω–µ –º–æ–∂–µ –±—É—Ç–∏ –ø–æ—Ä–æ–∂–Ω—ñ–º", "error")
                return

            if create_tag and not new_version:
                messagebox.showwarning("–ü–æ–º–∏–ª–∫–∞", "–ù–∞–ø–∏—à—ñ—Ç—å –Ω–æ–≤—É –≤–µ—Ä—Å—ñ—é –¥–ª—è —Ç–∞–≥—É!")
                self.log_message("‚ùå –ù–æ–º–µ—Ä –≤–µ—Ä—Å—ñ—ó –Ω–µ –º–æ–∂–µ –±—É—Ç–∏ –ø–æ—Ä–æ–∂–Ω—ñ–º", "error")
                return

            self.log_message("=" * 50, "info")
            self.log_message("üöÄ –†–æ–∑–ø–æ—á–∏–Ω–∞—î–º–æ commit & push –ø—Ä–æ—Ü–µ—Å...", "info")
            self.log_message("=" * 50, "info")

            # –ö—Ä–æ–∫ 1: –û—Ç—Ä–∏–º–∞–Ω–Ω—è –ø–æ—Ç–æ—á–Ω–æ—ó –≥—ñ–ª–∫–∏
            self.log_message("\nüìã –ö—Ä–æ–∫ 1: –í–∏–∑–Ω–∞—á–µ–Ω–Ω—è –ø–æ—Ç–æ—á–Ω–æ—ó –≥—ñ–ª–∫–∏...", "info")
            current_branch = self.get_current_branch()
            self.log_message(f"–ü–æ—Ç–æ—á–Ω–∞ –≥—ñ–ª–∫–∞: {current_branch}", "success")

            # –ö—Ä–æ–∫ 2: –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å—É
            self.log_message("\nüìã –ö—Ä–æ–∫ 2: –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å—É —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—é...", "info")
            success, status_output = self.run_git_command("git status --short")
            if not status_output:
                self.log_message("‚úÖ –ù–µ–º–∞—î –∑–º—ñ–Ω –¥–ª—è –∫–æ–º—ñ—Ç—É. –í—Å–µ —á–∏—Å—Ç–æ!", "success")
                self.status_label.configure(text="‚úÖ –ù–µ–º–∞—î –∑–º—ñ–Ω")
                return

            # –ö—Ä–æ–∫ 3: –î–æ–¥–∞–≤–∞–Ω–Ω—è –≤—Å—ñ—Ö —Ñ–∞–π–ª—ñ–≤
            self.log_message("\nüì¶ –ö—Ä–æ–∫ 3: –î–æ–¥–∞–≤–∞–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤ (git add .)...", "info")
            if not self.run_git_command("git add .")[0]:
                self.status_label.configure(text="‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ 'git add'")
                messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–ù–µ –≤–¥–∞–ª–æ—Å—è –¥–æ–¥–∞—Ç–∏ —Ñ–∞–π–ª–∏!")
                return

            # –ö—Ä–æ–∫ 4: –ö–æ–º—ñ—Ç
            self.log_message("\nüíæ –ö—Ä–æ–∫ 4: –ö–æ–º—ñ—Ç—É–≤–∞–Ω–Ω—è –∑–º—ñ–Ω...", "info")
            if not self.run_git_command(f'git commit -m "{comment}"')[0]:
                self.status_label.configure(text="‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –∫–æ–º—ñ—Ç—É–≤–∞–Ω–Ω—ñ")
                # (–º–æ–∂–ª–∏–≤–æ, –Ω–µ –±—É–ª–æ –∑–º—ñ–Ω)
                return

            # –ö—Ä–æ–∫ 5: Push
            self.log_message(f"\n‚¨ÜÔ∏è  –ö—Ä–æ–∫ 5: –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –Ω–∞ GitHub (git push origin {current_branch})...", "info")
            if not self.run_git_command(f"git push origin {current_branch}")[0]:
                self.status_label.configure(text="‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ 'git push'")
                messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–ù–µ –≤–¥–∞–ª–æ—Å—è –≤—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ –Ω–∞ GitHub!")
                return

            # –ö—Ä–æ–∫ 6: –¢–µ–≥ (—è–∫—â–æ –ø–æ—Ç—Ä—ñ–±–µ–Ω)
            if create_tag:
                self.log_message(f"\nüè∑Ô∏è  –ö—Ä–æ–∫ 6: –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–∞–≥—É v{new_version}...", "info")
                if not self.run_git_command(f"git tag v{new_version}")[0]:
                    self.status_label.configure(text="‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—ñ —Ç–∞–≥—É")
                    messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–ù–µ –≤–¥–∞–ª–æ—Å—è —Å—Ç–≤–æ—Ä–∏—Ç–∏ —Ç–µ–≥! –ú–æ–∂–ª–∏–≤–æ, –≤—ñ–Ω –≤–∂–µ —ñ—Å–Ω—É—î.")
                    return

                self.log_message(f"\n‚¨ÜÔ∏è  –ö—Ä–æ–∫ 7: –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ç–∞–≥—É –Ω–∞ GitHub...", "info")
                if not self.run_git_command(f"git push origin v{new_version}")[0]:
                    self.status_label.configure(text="‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ 'git push' —Ç–∞–≥—É")
                    messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–ù–µ –≤–¥–∞–ª–æ—Å—è –≤—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ —Ç–µ–≥!")
                    return

                # –û–Ω–æ–≤–ª–µ–Ω–Ω—è version.txt
                self.log_message("\nüìù –ö—Ä–æ–∫ 8: –û–Ω–æ–≤–ª–µ–Ω–Ω—è version.txt...", "info")
                try:
                    with open("version.txt", "w") as f:
                        f.write(new_version)
                    self.log_message("‚úÖ version.txt –æ–Ω–æ–≤–ª–µ–Ω–æ", "success")
                    self.current_version = new_version
                    self.current_version_label.configure(text=f"v{self.current_version}")
                except Exception as e:
                    self.log_message(f"‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –æ–Ω–æ–≤–ª–µ–Ω–Ω—ñ version.txt: {str(e)}", "error")

            self.log_message("\n" + "=" * 50, "success")
            self.log_message("‚úÖ –í–°–ï –£–°–ü–Ü–®–ù–û! GitHub Actions –ø–æ—á–Ω–µ –∫–æ–º–ø—ñ–ª—é–≤–∞—Ç–∏...", "success")
            self.log_message("=" * 50, "success")

            self.status_label.configure(text="‚úÖ –£—Å–ø—ñ—à–Ω–æ! GitHub Actions –∑–∞–ø—É—â–µ–Ω–æ")
            messagebox.showinfo(
                "–£—Å–ø—ñ—Ö",
                f"‚úÖ –ö–æ–º—ñ—Ç —É—Å–ø—ñ—à–Ω–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ!\n\n"
                f"–ö–æ–º–µ–Ω—Ç–∞—Ä: {comment}\n"
                + (f"–í–µ—Ä—Å—ñ—è: v{new_version}\n\nGitHub Actions –ø–æ—á–Ω–µ –∫–æ–º–ø—ñ–ª—é–≤–∞—Ç–∏ EXE..." if create_tag else "")
            )

            self.clear_fields()

        finally:
            # (–ù–û–í–ï) –ó–∞–≤–∂–¥–∏ –≤–º–∏–∫–∞—î–º–æ UI –Ω–∞–∑–∞–¥, –Ω–∞–≤—ñ—Ç—å —è–∫—â–æ –±—É–ª–∞ –ø–æ–º–∏–ª–∫–∞
            self.set_ui_state(True)
            if '–ü–æ–º–∏–ª–∫–∞' not in self.status_label.cget("text"):
                self.status_label.configure(text="–ì–æ—Ç–æ–≤–æ –¥–æ —Ä–æ–±–æ—Ç–∏")

    def clear_fields(self):
        """–û—á–∏—Å—Ç–∫–∞ –ø–æ–ª—ñ–≤"""
        self.comment_entry.delete(0, "end")
        self.version_entry.delete(0, "end")
        self.tag_checkbox.select()
        self.toggle_version_fields()  # –û–Ω–æ–≤–ª—é—î–º–æ —Å—Ç–∞–Ω –ø–æ–ª—ñ–≤ –≤–µ—Ä—Å—ñ—ó
        self.status_label.configure(text="–ì–æ—Ç–æ–≤–æ –¥–æ —Ä–æ–±–æ—Ç–∏")


def main():
    app = GitCommitTool()
    app.mainloop()


if __name__ == "__main__":
    main()

================================================================================
–§–∞–π–ª 4/21: project_export_20251110_104446.txt
--------------------------------------------------------------------------------
================================================================================
–ï–ö–°–ü–û–†–¢ –ü–†–û–Ñ–ö–¢–£: RemoteHand
–î–∞—Ç–∞: 2025-11-10 10:44:46
–®–ª—è—Ö: D:\Python Projects\Prego\RemoteHand
================================================================================

üìÇ –°–¢–†–£–ö–¢–£–†–ê –ü–†–û–Ñ–ö–¢–£
--------------------------------------------------------------------------------
RemoteHand/
‚îú‚îÄ‚îÄ assets/
‚îÇ   ‚îî‚îÄ‚îÄ icon.ico
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ anydesk_manager.py
‚îÇ   ‚îú‚îÄ‚îÄ config.py
‚îÇ   ‚îú‚îÄ‚îÄ config_manager.py
‚îÇ   ‚îú‚îÄ‚îÄ main.py
‚îÇ   ‚îú‚îÄ‚îÄ network_test.py
‚îÇ   ‚îú‚îÄ‚îÄ rdp_manager.py
‚îÇ   ‚îú‚îÄ‚îÄ set_anydesk_password.py
‚îÇ   ‚îú‚îÄ‚îÄ setup_wizard.py
‚îÇ   ‚îú‚îÄ‚îÄ telegram_api.py
‚îÇ   ‚îú‚îÄ‚îÄ telegram_helper.py
‚îÇ   ‚îú‚îÄ‚îÄ update.bat
‚îÇ   ‚îú‚îÄ‚îÄ updater.py
‚îÇ   ‚îî‚îÄ‚îÄ utils.py
‚îú‚îÄ‚îÄ .env.example
‚îú‚îÄ‚îÄ 23.88.7.196_admin_session.rdp
‚îú‚îÄ‚îÄ dev_run.py
‚îú‚îÄ‚îÄ export.py
‚îú‚îÄ‚îÄ GitCommitTool.py
‚îú‚îÄ‚îÄ project_export_20251110_104446.txt
‚îú‚îÄ‚îÄ README.md
‚îú‚îÄ‚îÄ RemoteHand.spec
‚îú‚îÄ‚îÄ requirements.txt
‚îú‚îÄ‚îÄ version.txt
‚îú‚îÄ‚îÄ version_info.txt
‚îî‚îÄ‚îÄ –ê–∫—Ç–∏–≤–∞—Ü—ñ—è —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞.txt

üìÑ –í–ú–Ü–°–¢ –§–ê–ô–õ–Ü–í (21 —Ñ–∞–π–ª—ñ–≤)
================================================================================


================================================================================
–§–∞–π–ª 1/21: dev_run.py
--------------------------------------------------------------------------------
"""
DEV_RUN.PY - –õ–æ–∫–∞–ª—å–Ω–µ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è
"""

import sys
import os

# –í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ DEV —Ä–µ–∂–∏–º
os.environ['REMOTEHAND_DEV_MODE'] = '1'

# –î–æ–¥–∞—Ç–∏ src –≤ path
sys.path.insert(0, os.path.join(os.path.dirname(__file__), 'src'))

print("–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π...")
import subprocess
subprocess.run([sys.executable, "-m", "pip", "install", "-r", "requirements.txt", "-q"],
               capture_output=True)

print("üîß –ó–∞–ø—É—Å–∫ —É DEV —Ä–µ–∂–∏–º—ñ...")

# –ü—Ä—è–º–æ –∑–∞–ø—É—Å—Ç–∏—Ç–∏ main
if __name__ == "__main__":
    import main
    main.main()


================================================================================
–§–∞–π–ª 2/21: export.py
--------------------------------------------------------------------------------
#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Project Structure Exporter
–°—Ç–≤–æ—Ä—é—î –¥–µ—Ç–∞–ª—å–Ω–∏–π –æ–ø–∏—Å —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ –ø—Ä–æ—î–∫—Ç—É —Ç–∞ –≤–º—ñ—Å—Ç —Ñ–∞–π–ª—ñ–≤ —É –æ–¥–∏–Ω —Ñ–∞–π–ª
"""

import os
from pathlib import Path
from datetime import datetime

# –§–∞–π–ª–∏ —Ç–∞ –ø–∞–ø–∫–∏, —è–∫—ñ —Ç—Ä–µ–±–∞ —ñ–≥–Ω–æ—Ä—É–≤–∞—Ç–∏
IGNORE_PATTERNS = {
    # –ü–∞–ø–∫–∏
    '__pycache__', '.git', '.idea', '.vscode', 'node_modules',
    'venv', 'env', '.env', 'dist', 'build', '.pytest_cache',
    '.mypy_cache', 'htmlcov', '.coverage', 'logs', 'tmp',
    # –§–∞–π–ª–∏
    '.pyc', '.pyo', '.pyd', '.so', '.dll', '.dylib', '.exe',
    '.log', '.sqlite', '.db', '.pkl', '.pickle', '.DS_Store',
    'Thumbs.db', '.env', '.env.local', '.gitignore'
}

# –†–æ–∑—à–∏—Ä–µ–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤ –¥–ª—è —á–∏—Ç–∞–Ω–Ω—è (—Ç–µ–∫—Å—Ç–æ–≤—ñ —Ñ–∞–π–ª–∏)
TEXT_EXTENSIONS = {
    '.py', '.js', '.ts', '.jsx', '.tsx', '.html', '.css', '.scss',
    '.json', '.yaml', '.yml', '.toml', '.ini', '.cfg', '.conf',
    '.txt', '.md', '.rst', '.xml', '.sql', '.sh', '.bash',
    '.env.example', '.gitignore', 'Dockerfile', 'Makefile',
    '.java', '.c', '.cpp', '.h', '.go', '.rs', '.php', '.rb'
}

# –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∏–π —Ä–æ–∑–º—ñ—Ä —Ñ–∞–π–ª—É (1 MB)
MAX_FILE_SIZE = 1024 * 1024


def should_ignore(path: Path) -> bool:
    """–ü–µ—Ä–µ–≤—ñ—Ä—è—î, —á–∏ —Ç—Ä–µ–±–∞ —ñ–≥–Ω–æ—Ä—É–≤–∞—Ç–∏ —Ñ–∞–π–ª/–ø–∞–ø–∫—É"""
    name = path.name

    # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ç–æ—á–Ω–æ–≥–æ –∑–±—ñ–≥—É
    if name in IGNORE_PATTERNS:
        return True

    # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è
    if path.suffix in IGNORE_PATTERNS:
        return True

    # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø—Ä–∏—Ö–æ–≤–∞–Ω–∏—Ö —Ñ–∞–π–ª—ñ–≤ (–∫—Ä—ñ–º .env.example)
    if name.startswith('.') and name != '.env.example':
        return True

    return False


def is_text_file(path: Path) -> bool:
    """–ü–µ—Ä–µ–≤—ñ—Ä—è—î, —á–∏ —î —Ñ–∞–π–ª —Ç–µ–∫—Å—Ç–æ–≤–∏–º"""
    # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è
    if path.suffix.lower() in TEXT_EXTENSIONS:
        return True

    # –§–∞–π–ª–∏ –±–µ–∑ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è, —è–∫—ñ –∑–∞–∑–≤–∏—á–∞–π —Ç–µ–∫—Å—Ç–æ–≤—ñ
    if path.suffix == '' and path.name in {'Dockerfile', 'Makefile', 'README', 'LICENSE'}:
        return True

    return False


def get_tree_structure(root_path: Path, prefix: str = "", is_last: bool = True) -> list:
    """–ì–µ–Ω–µ—Ä—É—î –¥–µ—Ä–µ–≤–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ –ø—Ä–æ—î–∫—Ç—É"""
    lines = []

    try:
        items = sorted(root_path.iterdir(), key=lambda x: (not x.is_dir(), x.name.lower()))
        items = [item for item in items if not should_ignore(item)]

        for i, item in enumerate(items):
            is_last_item = i == len(items) - 1
            current_prefix = "‚îî‚îÄ‚îÄ " if is_last_item else "‚îú‚îÄ‚îÄ "
            lines.append(f"{prefix}{current_prefix}{item.name}{'/' if item.is_dir() else ''}")

            if item.is_dir():
                extension = "    " if is_last_item else "‚îÇ   "
                lines.extend(get_tree_structure(item, prefix + extension, is_last_item))

    except PermissionError:
        pass

    return lines


def read_file_content(file_path: Path) -> str:
    """–ß–∏—Ç–∞—î –≤–º—ñ—Å—Ç —Ñ–∞–π–ª—É"""
    try:
        # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ä–æ–∑–º—ñ—Ä—É
        if file_path.stat().st_size > MAX_FILE_SIZE:
            return f"[–§–∞–π–ª –∑–∞–Ω–∞–¥—Ç–æ –≤–µ–ª–∏–∫–∏–π: {file_path.stat().st_size / 1024:.1f} KB]"

        # –°–ø—Ä–æ–±–∞ –ø—Ä–æ—á–∏—Ç–∞—Ç–∏ —è–∫ —Ç–µ–∫—Å—Ç
        with open(file_path, 'r', encoding='utf-8') as f:
            return f.read()
    except UnicodeDecodeError:
        # –Ø–∫—â–æ –Ω–µ –≤–¥–∞–ª–æ—Å—è –ø—Ä–æ—á–∏—Ç–∞—Ç–∏ —è–∫ UTF-8
        try:
            with open(file_path, 'r', encoding='cp1251') as f:
                return f.read()
        except:
            return "[–ù–µ –≤–¥–∞–ª–æ—Å—è –ø—Ä–æ—á–∏—Ç–∞—Ç–∏ —Ñ–∞–π–ª - –±—ñ–Ω–∞—Ä–Ω–∏–π –∞–±–æ –Ω–µ–≤—ñ–¥–æ–º–µ –∫–æ–¥—É–≤–∞–Ω–Ω—è]"
    except Exception as e:
        return f"[–ü–æ–º–∏–ª–∫–∞ —á–∏—Ç–∞–Ω–Ω—è: {str(e)}]"


def collect_files(root_path: Path) -> list:
    """–ó–±–∏—Ä–∞—î –≤—Å—ñ —Ç–µ–∫—Å—Ç–æ–≤—ñ —Ñ–∞–π–ª–∏ –ø—Ä–æ—î–∫—Ç—É"""
    files = []

    for item in root_path.rglob('*'):
        if item.is_file() and not should_ignore(item) and is_text_file(item):
            # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞, —â–æ –≤—Å—ñ –±–∞—Ç—å–∫—ñ–≤—Å—å–∫—ñ –ø–∞–ø–∫–∏ –Ω–µ —ñ–≥–Ω–æ—Ä—É—é—Ç—å—Å—è
            if not any(should_ignore(parent) for parent in item.parents):
                files.append(item)

    return sorted(files)


def generate_project_export(project_path: str, output_file: str = None):
    """–ì–µ–Ω–µ—Ä—É—î –ø–æ–≤–Ω–∏–π –µ–∫—Å–ø–æ—Ä—Ç –ø—Ä–æ—î–∫—Ç—É"""
    root = Path(project_path).resolve()

    if not root.exists():
        print(f"‚ùå –ü–æ–º–∏–ª–∫–∞: –®–ª—è—Ö '{project_path}' –Ω–µ —ñ—Å–Ω—É—î!")
        return

    if output_file is None:
        timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
        output_file = f"project_export_{timestamp}.txt"

    print(f"üìÅ –ê–Ω–∞–ª—ñ–∑ –ø—Ä–æ—î–∫—Ç—É: {root.name}")
    print(f"üìù –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –µ–∫—Å–ø–æ—Ä—Ç—É...")

    with open(output_file, 'w', encoding='utf-8') as f:
        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        f.write("=" * 80 + "\n")
        f.write(f"–ï–ö–°–ü–û–†–¢ –ü–†–û–Ñ–ö–¢–£: {root.name}\n")
        f.write(f"–î–∞—Ç–∞: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}\n")
        f.write(f"–®–ª—è—Ö: {root}\n")
        f.write("=" * 80 + "\n\n")

        # –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ—î–∫—Ç—É
        f.write("üìÇ –°–¢–†–£–ö–¢–£–†–ê –ü–†–û–Ñ–ö–¢–£\n")
        f.write("-" * 80 + "\n")
        f.write(f"{root.name}/\n")
        tree_lines = get_tree_structure(root)
        f.write("\n".join(tree_lines))
        f.write("\n\n")

        # –ó–±—ñ—Ä —Ñ–∞–π–ª—ñ–≤
        files = collect_files(root)

        f.write(f"üìÑ –í–ú–Ü–°–¢ –§–ê–ô–õ–Ü–í ({len(files)} —Ñ–∞–π–ª—ñ–≤)\n")
        f.write("=" * 80 + "\n\n")

        # –í–º—ñ—Å—Ç –∫–æ–∂–Ω–æ–≥–æ —Ñ–∞–π–ª—É
        for i, file_path in enumerate(files, 1):
            relative_path = file_path.relative_to(root)

            print(f"  [{i}/{len(files)}] {relative_path}")

            f.write("\n" + "=" * 80 + "\n")
            f.write(f"–§–∞–π–ª {i}/{len(files)}: {relative_path}\n")
            f.write("-" * 80 + "\n")

            content = read_file_content(file_path)
            f.write(content)
            f.write("\n")

        # –ü—ñ–¥—Å—É–º–æ–∫
        f.write("\n" + "=" * 80 + "\n")
        f.write("–ö–Ü–ù–ï–¶–¨ –ï–ö–°–ü–û–†–¢–£\n")
        f.write("=" * 80 + "\n")

    file_size = Path(output_file).stat().st_size
    print(f"\n‚úÖ –ï–∫—Å–ø–æ—Ä—Ç –∑–∞–≤–µ—Ä—à–µ–Ω–æ!")
    print(f"üìÑ –§–∞–π–ª: {output_file}")
    print(f"üìä –†–æ–∑–º—ñ—Ä: {file_size / 1024:.1f} KB")
    print(f"üìÅ –§–∞–π–ª—ñ–≤ –æ–±—Ä–æ–±–ª–µ–Ω–æ: {len(files)}")


if __name__ == "__main__":
    import sys

    # –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è: python export_project.py [—à–ª—è—Ö_–¥–æ_–ø—Ä–æ—î–∫—Ç—É] [–≤–∏—Ö—ñ–¥–Ω–∏–π_—Ñ–∞–π–ª]
    project_path = sys.argv[1] if len(sys.argv) > 1 else "."
    output_file = sys.argv[2] if len(sys.argv) > 2 else None

    generate_project_export(project_path, output_file)


================================================================================
–§–∞–π–ª 3/21: GitCommitTool.py
--------------------------------------------------------------------------------
import customtkinter as ctk
from tkinter import messagebox, scrolledtext
import subprocess
import os
from pathlib import Path
from datetime import datetime


class GitCommitTool(ctk.CTk):
    def __init__(self):
        super().__init__()

        self.title("Git Commit Tool")
        self.geometry("600x700")
        self.resizable(False, False)

        # –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç–µ–º–∏
        ctk.set_appearance_mode("light")
        ctk.set_default_color_theme("blue")

        # –û—Ç—Ä–∏–º–∞–Ω–Ω—è –ø–æ—Ç–æ—á–Ω–æ—ó –≤–µ—Ä—Å—ñ—ó
        self.current_version = self.get_current_version()

        self.setup_ui()

    def setup_ui(self):
        """–°—Ç–≤–æ—Ä–µ–Ω–Ω—è UI"""

        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        title_label = ctk.CTkLabel(
            self,
            text="Git Commit Tool",
            font=ctk.CTkFont(size=24, weight="bold")
        )
        title_label.pack(pady=15)

        # –ü–æ—Ç–æ—á–Ω–∞ –≤–µ—Ä—Å—ñ—è
        version_frame = ctk.CTkFrame(self)
        version_frame.pack(pady=10, padx=20, fill="x")

        ctk.CTkLabel(
            version_frame,
            text="–ü–æ—Ç–æ—á–Ω–∞ –≤–µ—Ä—Å—ñ—è:",
            font=ctk.CTkFont(size=12, weight="bold")
        ).pack(side="left")

        ctk.CTkLabel(
            version_frame,
            text=f"v{self.current_version}",
            font=ctk.CTkFont(size=12),
            text_color="gray"
        ).pack(side="left", padx=10)

        # –ö–æ–º–µ–Ω—Ç–∞—Ä
        ctk.CTkLabel(
            self,
            text="–ö–æ–º–µ–Ω—Ç–∞—Ä (commit message):",
            font=ctk.CTkFont(size=12, weight="bold")
        ).pack(anchor="w", padx=20, pady=(10, 5))

        self.comment_entry = ctk.CTkEntry(
            self,
            placeholder_text="–û–ø–∏—à—ñ—Ç—å –≤–∞—à—ñ –∑–º—ñ–Ω–∏...",
            height=40,
            font=ctk.CTkFont(size=11)
        )
        self.comment_entry.pack(padx=20, fill="x", pady=(0, 15))

        # –ù–æ–≤–∞ –≤–µ—Ä—Å—ñ—è
        ctk.CTkLabel(
            self,
            text="–ù–æ–≤–∞ –≤–µ—Ä—Å—ñ—è (–¥–ª—è —Ç–∞–≥—É):",
            font=ctk.CTkFont(size=12, weight="bold")
        ).pack(anchor="w", padx=20, pady=(10, 5))

        version_frame2 = ctk.CTkFrame(self)
        version_frame2.pack(padx=20, fill="x", pady=(0, 15))

        ctk.CTkLabel(
            version_frame2,
            text="v",
            font=ctk.CTkFont(size=11)
        ).pack(side="left", padx=(0, 5))

        self.version_entry = ctk.CTkEntry(
            version_frame2,
            placeholder_text="1.1.0",
            height=35,
            font=ctk.CTkFont(size=11)
        )
        self.version_entry.pack(side="left", fill="x", expand=True)

        # –ß–µ–∫–±–æ–∫—Å –¥–ª—è —Ç–∞–≥—É
        self.tag_checkbox = ctk.CTkCheckBox(
            self,
            text="–°—Ç–≤–æ—Ä–∏—Ç–∏ —Ç–µ–≥ –≤–µ—Ä—Å—ñ—ó",
            font=ctk.CTkFont(size=11)
        )
        self.tag_checkbox.pack(anchor="w", padx=20, pady=(0, 20))
        self.tag_checkbox.select()

        # –ö–Ω–æ–ø–∫–∏
        button_frame = ctk.CTkFrame(self)
        button_frame.pack(padx=20, fill="x", pady=(0, 15))

        commit_btn = ctk.CTkButton(
            button_frame,
            text="‚úÖ Commit & Push",
            command=self.commit_and_push,
            font=ctk.CTkFont(size=12, weight="bold"),
            height=45,
            corner_radius=10
        )
        commit_btn.pack(side="left", fill="both", expand=True, padx=(0, 5))

        clear_btn = ctk.CTkButton(
            button_frame,
            text="üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç–∏",
            command=self.clear_fields,
            font=ctk.CTkFont(size=12),
            height=45,
            corner_radius=10,
            fg_color="gray30",
            hover_color="gray50"
        )
        clear_btn.pack(side="left", fill="both", expand=True, padx=(5, 0))

        # –õ–æ–≥–∏
        ctk.CTkLabel(
            self,
            text="–õ–æ–≥–∏ –æ–ø–µ—Ä–∞—Ü—ñ–π:",
            font=ctk.CTkFont(size=11, weight="bold")
        ).pack(anchor="w", padx=20, pady=(10, 5))

        self.log_text = scrolledtext.ScrolledText(
            self,
            height=10,
            width=70,
            font=("Courier", 9),
            bg="#f0f0f0",
            fg="#333333",
            relief="solid",
            borderwidth=1
        )
        self.log_text.pack(padx=20, pady=(0, 15), fill="both", expand=True)

        # –°—Ç–∞—Ç—É—Å
        self.status_label = ctk.CTkLabel(
            self,
            text="–ì–æ—Ç–æ–≤–æ –¥–æ —Ä–æ–±–æ—Ç–∏",
            font=ctk.CTkFont(size=10),
            text_color="gray"
        )
        self.status_label.pack(pady=(0, 10))

    def get_current_version(self):
        """–û—Ç—Ä–∏–º–∞–Ω–Ω—è –ø–æ—Ç–æ—á–Ω–æ—ó –≤–µ—Ä—Å—ñ—ó –∑ version.txt"""
        try:
            with open("version.txt", "r") as f:
                return f.read().strip()
        except:
            return "1.0.0"

    def log_message(self, message):
        """–î–æ–¥–∞–Ω–Ω—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –¥–æ –ª–æ–≥—ñ–≤"""
        timestamp = datetime.now().strftime("%H:%M:%S")
        self.log_text.insert("end", f"[{timestamp}] {message}\n")
        self.log_text.see("end")
        self.update()

    def run_git_command(self, command):
        """–í–∏–∫–æ–Ω–∞–Ω–Ω—è git –∫–æ–º–∞–Ω–¥–∏"""
        try:
            result = subprocess.run(
                command,
                shell=True,
                capture_output=True,
                text=True,
                cwd=os.getcwd()
            )

            if result.returncode == 0:
                if result.stdout:
                    self.log_message(f"‚úÖ {result.stdout.strip()}")
                return True
            else:
                error_msg = result.stderr.strip() if result.stderr else "–ù–µ–≤—ñ–¥–æ–º–∞ –ø–æ–º–∏–ª–∫–∞"
                self.log_message(f"‚ùå –ü–æ–º–∏–ª–∫–∞: {error_msg}")
                return False
        except Exception as e:
            self.log_message(f"‚ùå –ò—Å–∫–ª—é—á–µ–Ω–∏–µ: {str(e)}")
            return False

    def commit_and_push(self):
        """–û—Å–Ω–æ–≤–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è - commit, tag —ñ push"""

        comment = self.comment_entry.get().strip()
        new_version = self.version_entry.get().strip()
        create_tag = self.tag_checkbox.get()

        # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∏
        if not comment:
            messagebox.showwarning("–ü–æ–º–∏–ª–∫–∞", "–ù–∞–ø–∏—à—ñ—Ç—å –∫–æ–º–µ–Ω—Ç–∞—Ä –¥–æ –∫–æ–º—ñ—Ç—é!")
            return

        if create_tag and not new_version:
            messagebox.showwarning("–ü–æ–º–∏–ª–∫–∞", "–ù–∞–ø–∏—à—ñ—Ç—å –Ω–æ–≤—É –≤–µ—Ä—Å—ñ—é –¥–ª—è —Ç–∞–≥—É!")
            return

        self.status_label.configure(text="‚è≥ –û–±—Ä–æ–±–∫–∞...")
        self.update()

        self.log_message("=" * 50)
        self.log_message("üöÄ –†–æ–∑–ø–æ—á–∏–Ω–∞—î–º–æ commit & push –ø—Ä–æ—Ü–µ—Å...")
        self.log_message("=" * 50)

        # –ö—Ä–æ–∫ 1: –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å—É
        self.log_message("\nüìã –ö—Ä–æ–∫ 1: –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å—É —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—é...")
        self.run_git_command("git status --short")

        # –ö—Ä–æ–∫ 2: –î–æ–±–∞–≤–ª–µ–Ω–Ω—è –≤—Å—ñ—Ö —Ñ–∞–π–ª—ñ–≤
        self.log_message("\nüì¶ –ö—Ä–æ–∫ 2: –î–æ–¥–∞–≤–∞–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤...")
        if not self.run_git_command("git add ."):
            self.status_label.configure(text="‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –¥–æ–¥–∞–≤–∞–Ω–Ω—ñ —Ñ–∞–π–ª—ñ–≤")
            messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–ù–µ –≤–¥–∞–ª–æ—Å—è –¥–æ–¥–∞—Ç–∏ —Ñ–∞–π–ª–∏!")
            return

        # –ö—Ä–æ–∫ 3: –ö–æ–º—ñ—Ç
        self.log_message("\nüíæ –ö—Ä–æ–∫ 3: –ö–æ–º—ñ—Ç—É–≤–∞–Ω–Ω—è –∑–º—ñ–Ω...")
        if not self.run_git_command(f'git commit -m "{comment}"'):
            self.status_label.configure(text="‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –∫–æ–º—ñ—Ç—É–≤–∞–Ω–Ω—ñ")
            messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–ù–µ –≤–¥–∞–ª–æ—Å—è –∑–∞–∫–æ–º—ñ—Ç–∏—Ç–∏!")
            return

        # –ö—Ä–æ–∫ 4: Push
        self.log_message("\n‚¨ÜÔ∏è  –ö—Ä–æ–∫ 4: –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –Ω–∞ GitHub...")
        if not self.run_git_command("git push origin main"):
            self.status_label.configure(text="‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ push")
            messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–ù–µ –≤–¥–∞–ª–æ—Å—è –≤—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ –Ω–∞ GitHub!")
            return

        # –ö—Ä–æ–∫ 5: –¢–µ–≥ (—è–∫—â–æ –ø–æ—Ç—Ä—ñ–±–µ–Ω)
        if create_tag:
            self.log_message("\nüè∑Ô∏è  –ö—Ä–æ–∫ 5: –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–∞–≥—É...")
            if not self.run_git_command(f"git tag v{new_version}"):
                self.status_label.configure(text="‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—ñ —Ç–∞–≥—É")
                messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–ù–µ –≤–¥–∞–ª–æ—Å—è —Å—Ç–≤–æ—Ä–∏—Ç–∏ —Ç–µ–≥!")
                return

            self.log_message("\n‚¨ÜÔ∏è  –ö—Ä–æ–∫ 6: –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ç–∞–≥—É –Ω–∞ GitHub...")
            if not self.run_git_command(f"git push origin v{new_version}"):
                self.status_label.configure(text="‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ push —Ç–∞–≥—É")
                messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–ù–µ –≤–¥–∞–ª–æ—Å—è –≤—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ —Ç–µ–≥!")
                return

            # –û–Ω–æ–≤–ª–µ–Ω–Ω—è version.txt
            self.log_message("\nüìù –ö—Ä–æ–∫ 7: –û–Ω–æ–≤–ª–µ–Ω–Ω—è version.txt...")
            try:
                with open("version.txt", "w") as f:
                    f.write(new_version)
                self.log_message("‚úÖ version.txt –æ–Ω–æ–≤–ª–µ–Ω–æ")
                self.current_version = new_version
            except Exception as e:
                self.log_message(f"‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –æ–Ω–æ–≤–ª–µ–Ω–Ω—ñ version.txt: {str(e)}")

        self.log_message("\n" + "=" * 50)
        self.log_message("‚úÖ –í–°–ï –£–°–ü–Ü–®–ù–û! GitHub Actions –ø–æ—á–Ω–µ –∫–æ–º–ø—ñ–ª—é–≤–∞—Ç–∏...")
        self.log_message("=" * 50)

        self.status_label.configure(text="‚úÖ –£—Å–ø—ñ—à–Ω–æ! GitHub Actions –∑–∞–ø—É—â–µ–Ω–æ")
        messagebox.showinfo(
            "–£—Å–ø—ñ—Ö",
            f"‚úÖ –ö–æ–º—ñ—Ç —É—Å–ø—ñ—à–Ω–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ!\n\n"
            f"–ö–æ–º–µ–Ω—Ç–∞—Ä: {comment}\n"
            + (f"–í–µ—Ä—Å—ñ—è: v{new_version}\n\nGitHub Actions –ø–æ—á–Ω–µ –∫–æ–º–ø—ñ–ª—é–≤–∞—Ç–∏ EXE..." if create_tag else "")
        )

        self.clear_fields()

    def clear_fields(self):
        """–û—á–∏—Å—Ç–∫–∞ –ø–æ–ª—ñ–≤"""
        self.comment_entry.delete(0, "end")
        self.version_entry.delete(0, "end")
        self.tag_checkbox.select()
        self.status_label.configure(text="–ì–æ—Ç–æ–≤–æ –¥–æ —Ä–æ–±–æ—Ç–∏")


def main():
    app = GitCommitTool()
    app.mainloop()


if __name__ == "__main__":
    main()


================================================================================
–§–∞–π–ª 4/21: project_export_20251110_104446.txt
--------------------------------------------------------------------------------
================================================================================
–ï–ö–°–ü–û–†–¢ –ü–†–û–Ñ–ö–¢–£: RemoteHand
–î–∞—Ç–∞: 2025-11-10 10:44:46
–®–ª—è—Ö: D:\Python Projects\Prego\RemoteHand
================================================================================

üìÇ –°–¢–†–£–ö–¢–£–†–ê –ü–†–û–Ñ–ö–¢–£
--------------------------------------------------------------------------------
RemoteHand/
‚îú‚îÄ‚îÄ assets/
‚îÇ   ‚îî‚îÄ‚îÄ icon.ico
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ anydesk_manager.py
‚îÇ   ‚îú‚îÄ‚îÄ config.py
‚îÇ   ‚îú‚îÄ‚îÄ config_manager.py
‚îÇ   ‚îú‚îÄ‚îÄ main.py
‚îÇ   ‚îú‚îÄ‚îÄ network_test.py
‚îÇ   ‚îú‚îÄ‚îÄ rdp_manager.py
‚îÇ   ‚îú‚îÄ‚îÄ set_anydesk_password.py
‚îÇ   ‚îú‚îÄ‚îÄ setup_wizard.py
‚îÇ   ‚îú‚îÄ‚îÄ telegram_api.py
‚îÇ   ‚îú‚îÄ‚îÄ telegram_helper.py
‚îÇ   ‚îú‚îÄ‚îÄ update.bat
‚îÇ   ‚îú‚îÄ‚îÄ updater.py
‚îÇ   ‚îî‚îÄ‚îÄ utils.py
‚îú‚îÄ‚îÄ .env.example
‚îú‚îÄ‚îÄ 23.88.7.196_admin_session.rdp
‚îú‚îÄ‚îÄ dev_run.py
‚îú‚îÄ‚îÄ export.py
‚îú‚îÄ‚îÄ GitCommitTool.py
‚îú‚îÄ‚îÄ project_export_20251110_104446.txt
‚îú‚îÄ‚îÄ README.md
‚îú‚îÄ‚îÄ RemoteHand.spec
‚îú‚îÄ‚îÄ requirements.txt
‚îú‚îÄ‚îÄ version.txt
‚îú‚îÄ‚îÄ version_info.txt
‚îî‚îÄ‚îÄ –ê–∫—Ç–∏–≤–∞—Ü—ñ—è —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞.txt

üìÑ –í–ú–Ü–°–¢ –§–ê–ô–õ–Ü–í (21 —Ñ–∞–π–ª—ñ–≤)
================================================================================


================================================================================
–§–∞–π–ª 1/21: dev_run.py
--------------------------------------------------------------------------------
"""
DEV_RUN.PY - –õ–æ–∫–∞–ª—å–Ω–µ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è
"""

import sys
import os

# –í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ DEV —Ä–µ–∂–∏–º
os.environ['REMOTEHAND_DEV_MODE'] = '1'

# –î–æ–¥–∞—Ç–∏ src –≤ path
sys.path.insert(0, os.path.join(os.path.dirname(__file__), 'src'))

print("–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π...")
import subprocess
subprocess.run([sys.executable, "-m", "pip", "install", "-r", "requirements.txt", "-q"],
               capture_output=True)

print("üîß –ó–∞–ø—É—Å–∫ —É DEV —Ä–µ–∂–∏–º—ñ...")

# –ü—Ä—è–º–æ –∑–∞–ø—É—Å—Ç–∏—Ç–∏ main
if __name__ == "__main__":
    import main
    main.main()


================================================================================
–§–∞–π–ª 2/21: export.py
--------------------------------------------------------------------------------
#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Project Structure Exporter
–°—Ç–≤–æ—Ä—é—î –¥–µ—Ç–∞–ª—å–Ω–∏–π –æ–ø–∏—Å —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ –ø—Ä–æ—î–∫—Ç—É —Ç–∞ –≤–º—ñ—Å—Ç —Ñ–∞–π–ª—ñ–≤ —É –æ–¥–∏–Ω —Ñ–∞–π–ª
"""

import os
from pathlib import Path
from datetime import datetime

# –§–∞–π–ª–∏ —Ç–∞ –ø–∞–ø–∫–∏, —è–∫—ñ —Ç—Ä–µ–±–∞ —ñ–≥–Ω–æ—Ä—É–≤–∞—Ç–∏
IGNORE_PATTERNS = {
    # –ü–∞–ø–∫–∏
    '__pycache__', '.git', '.idea', '.vscode', 'node_modules',
    'venv', 'env', '.env', 'dist', 'build', '.pytest_cache',
    '.mypy_cache', 'htmlcov', '.coverage', 'logs', 'tmp',
    # –§–∞–π–ª–∏
    '.pyc', '.pyo', '.pyd', '.so', '.dll', '.dylib', '.exe',
    '.log', '.sqlite', '.db', '.pkl', '.pickle', '.DS_Store',
    'Thumbs.db', '.env', '.env.local', '.gitignore'
}

# –†–æ–∑—à–∏—Ä–µ–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤ –¥–ª—è —á–∏—Ç–∞–Ω–Ω—è (—Ç–µ–∫—Å—Ç–æ–≤—ñ —Ñ–∞–π–ª–∏)
TEXT_EXTENSIONS = {
    '.py', '.js', '.ts', '.jsx', '.tsx', '.html', '.css', '.scss',
    '.json', '.yaml', '.yml', '.toml', '.ini', '.cfg', '.conf',
    '.txt', '.md', '.rst', '.xml', '.sql', '.sh', '.bash',
    '.env.example', '.gitignore', 'Dockerfile', 'Makefile',
    '.java', '.c', '.cpp', '.h', '.go', '.rs', '.php', '.rb'
}

# –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∏–π —Ä–æ–∑–º—ñ—Ä —Ñ–∞–π–ª—É (1 MB)
MAX_FILE_SIZE = 1024 * 1024


def should_ignore(path: Path) -> bool:
    """–ü–µ—Ä–µ–≤—ñ—Ä—è—î, —á–∏ —Ç—Ä–µ–±–∞ —ñ–≥–Ω–æ—Ä—É–≤–∞—Ç–∏ —Ñ–∞–π–ª/–ø–∞–ø–∫—É"""
    name = path.name

    # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ç–æ—á–Ω–æ–≥–æ –∑–±—ñ–≥—É
    if name in IGNORE_PATTERNS:
        return True

    # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è
    if path.suffix in IGNORE_PATTERNS:
        return True

    # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø—Ä–∏—Ö–æ–≤–∞–Ω–∏—Ö —Ñ–∞–π–ª—ñ–≤ (–∫—Ä—ñ–º .env.example)
    if name.startswith('.') and name != '.env.example':
        return True

    return False


def is_text_file(path: Path) -> bool:
    """–ü–µ—Ä–µ–≤—ñ—Ä—è—î, —á–∏ —î —Ñ–∞–π–ª —Ç–µ–∫—Å—Ç–æ–≤–∏–º"""
    # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è
    if path.suffix.lower() in TEXT_EXTENSIONS:
        return True

    # –§–∞–π–ª–∏ –±–µ–∑ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è, —è–∫—ñ –∑–∞–∑–≤–∏—á–∞–π —Ç–µ–∫—Å—Ç–æ–≤—ñ
    if path.suffix == '' and path.name in {'Dockerfile', 'Makefile', 'README', 'LICENSE'}:
        return True

    return False


def get_tree_structure(root_path: Path, prefix: str = "", is_last: bool = True) -> list:
    """–ì–µ–Ω–µ—Ä—É—î –¥–µ—Ä–µ–≤–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ –ø—Ä–æ—î–∫—Ç—É"""
    lines = []

    try:
        items = sorted(root_path.iterdir(), key=lambda x: (not x.is_dir(), x.name.lower()))
        items = [item for item in items if not should_ignore(item)]

        for i, item in enumerate(items):
            is_last_item = i == len(items) - 1
            current_prefix = "‚îî‚îÄ‚îÄ " if is_last_item else "‚îú‚îÄ‚îÄ "
            lines.append(f"{prefix}{current_prefix}{item.name}{'/' if item.is_dir() else ''}")

            if item.is_dir():
                extension = "    " if is_last_item else "‚îÇ   "
                lines.extend(get_tree_structure(item, prefix + extension, is_last_item))

    except PermissionError:
        pass

    return lines


def read_file_content(file_path: Path) -> str:
    """–ß–∏—Ç–∞—î –≤–º—ñ—Å—Ç —Ñ–∞–π–ª—É"""
    try:
        # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ä–æ–∑–º—ñ—Ä—É
        if file_path.stat().st_size > MAX_FILE_SIZE:
            return f"[–§–∞–π–ª –∑–∞–Ω–∞–¥—Ç–æ –≤–µ–ª–∏–∫–∏–π: {file_path.stat().st_size / 1024:.1f} KB]"

        # –°–ø—Ä–æ–±–∞ –ø—Ä–æ—á–∏—Ç–∞—Ç–∏ —è–∫ —Ç–µ–∫—Å—Ç
        with open(file_path, 'r', encoding='utf-8') as f:
            return f.read()
    except UnicodeDecodeError:
        # –Ø–∫—â–æ –Ω–µ –≤–¥–∞–ª–æ—Å—è –ø—Ä–æ—á–∏—Ç–∞—Ç–∏ —è–∫ UTF-8
        try:
            with open(file_path, 'r', encoding='cp1251') as f:
                return f.read()
        except:
            return "[–ù–µ –≤–¥–∞–ª–æ—Å—è –ø—Ä–æ—á–∏—Ç–∞—Ç–∏ —Ñ–∞–π–ª - –±—ñ–Ω–∞—Ä–Ω–∏–π –∞–±–æ –Ω–µ–≤—ñ–¥–æ–º–µ –∫–æ–¥—É–≤–∞–Ω–Ω—è]"
    except Exception as e:
        return f"[–ü–æ–º–∏–ª–∫–∞ —á–∏—Ç–∞–Ω–Ω—è: {str(e)}]"


def collect_files(root_path: Path) -> list:
    """–ó–±–∏—Ä–∞—î –≤—Å—ñ —Ç–µ–∫—Å—Ç–æ–≤—ñ —Ñ–∞–π–ª–∏ –ø—Ä–æ—î–∫—Ç—É"""
    files = []

    for item in root_path.rglob('*'):
        if item.is_file() and not should_ignore(item) and is_text_file(item):
            # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞, —â–æ –≤—Å—ñ –±–∞—Ç—å–∫—ñ–≤—Å—å–∫—ñ –ø–∞–ø–∫–∏ –Ω–µ —ñ–≥–Ω–æ—Ä—É—é—Ç—å—Å—è
            if not any(should_ignore(parent) for parent in item.parents):
                files.append(item)

    return sorted(files)


def generate_project_export(project_path: str, output_file: str = None):
    """–ì–µ–Ω–µ—Ä—É—î –ø–æ–≤–Ω–∏–π –µ–∫—Å–ø–æ—Ä—Ç –ø—Ä–æ—î–∫—Ç—É"""
    root = Path(project_path).resolve()

    if not root.exists():
        print(f"‚ùå –ü–æ–º–∏–ª–∫–∞: –®–ª—è—Ö '{project_path}' –Ω–µ —ñ—Å–Ω—É—î!")
        return

    if output_file is None:
        timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
        output_file = f"project_export_{timestamp}.txt"

    print(f"üìÅ –ê–Ω–∞–ª—ñ–∑ –ø—Ä–æ—î–∫—Ç—É: {root.name}")
    print(f"üìù –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –µ–∫—Å–ø–æ—Ä—Ç—É...")

    with open(output_file, 'w', encoding='utf-8') as f:
        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        f.write("=" * 80 + "\n")
        f.write(f"–ï–ö–°–ü–û–†–¢ –ü–†–û–Ñ–ö–¢–£: {root.name}\n")
        f.write(f"–î–∞—Ç–∞: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}\n")
        f.write(f"–®–ª—è—Ö: {root}\n")
        f.write("=" * 80 + "\n\n")

        # –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ—î–∫—Ç—É
        f.write("üìÇ –°–¢–†–£–ö–¢–£–†–ê –ü–†–û–Ñ–ö–¢–£\n")
        f.write("-" * 80 + "\n")
        f.write(f"{root.name}/\n")
        tree_lines = get_tree_structure(root)
        f.write("\n".join(tree_lines))
        f.write("\n\n")

        # –ó–±—ñ—Ä —Ñ–∞–π–ª—ñ–≤
        files = collect_files(root)

        f.write(f"üìÑ –í–ú–Ü–°–¢ –§–ê–ô–õ–Ü–í ({len(files)} —Ñ–∞–π–ª—ñ–≤)\n")
        f.write("=" * 80 + "\n\n")

        # –í–º—ñ—Å—Ç –∫–æ–∂–Ω–æ–≥–æ —Ñ–∞–π–ª—É
        for i, file_path in enumerate(files, 1):
            relative_path = file_path.relative_to(root)

            print(f"  [{i}/{len(files)}] {relative_path}")

            f.write("\n" + "=" * 80 + "\n")
            f.write(f"–§–∞–π–ª {i}/{len(files)}: {relative_path}\n")
            f.write("-" * 80 + "\n")

            content = read_file_content(file_path)
            f.write(content)
            f.write("\n")

        # –ü—ñ–¥—Å—É–º–æ–∫
        f.write("\n" + "=" * 80 + "\n")
        f.write("–ö–Ü–ù–ï–¶–¨ –ï–ö–°–ü–û–†–¢–£\n")
        f.write("=" * 80 + "\n")

    file_size = Path(output_file).stat().st_size
    print(f"\n‚úÖ –ï–∫—Å–ø–æ—Ä—Ç –∑–∞–≤–µ—Ä—à–µ–Ω–æ!")
    print(f"üìÑ –§–∞–π–ª: {output_file}")
    print(f"üìä –†–æ–∑–º—ñ—Ä: {file_size / 1024:.1f} KB")
    print(f"üìÅ –§–∞–π–ª—ñ–≤ –æ–±—Ä–æ–±–ª–µ–Ω–æ: {len(files)}")


if __name__ == "__main__":
    import sys

    # –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è: python export_project.py [—à–ª—è—Ö_–¥–æ_–ø—Ä–æ—î–∫—Ç—É] [–≤–∏—Ö—ñ–¥–Ω–∏–π_—Ñ–∞–π–ª]
    project_path = sys.argv[1] if len(sys.argv) > 1 else "."
    output_file = sys.argv[2] if len(sys.argv) > 2 else None

    generate_project_export(project_path, output_file)


================================================================================
–§–∞–π–ª 3/21: GitCommitTool.py
--------------------------------------------------------------------------------
import customtkinter as ctk
from tkinter import messagebox, scrolledtext
import subprocess
import os
from pathlib import Path
from datetime import datetime


class GitCommitTool(ctk.CTk):
    def __init__(self):
        super().__init__()

        self.title("Git Commit Tool")
        self.geometry("600x700")
        self.resizable(False, False)

        # –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç–µ–º–∏
        ctk.set_appearance_mode("light")
        ctk.set_default_color_theme("blue")

        # –û—Ç—Ä–∏–º–∞–Ω–Ω—è –ø–æ—Ç–æ—á–Ω–æ—ó –≤–µ—Ä—Å—ñ—ó
        self.current_version = self.get_current_version()

        self.setup_ui()

    def setup_ui(self):
        """–°—Ç–≤–æ—Ä–µ–Ω–Ω—è UI"""

        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        title_label = ctk.CTkLabel(
            self,
            text="Git Commit Tool",
            font=ctk.CTkFont(size=24, weight="bold")
        )
        title_label.pack(pady=15)

        # –ü–æ—Ç–æ—á–Ω–∞ –≤–µ—Ä—Å—ñ—è
        version_frame = ctk.CTkFrame(self)
        version_frame.pack(pady=10, padx=20, fill="x")

        ctk.CTkLabel(
            version_frame,
            text="–ü–æ—Ç–æ—á–Ω–∞ –≤–µ—Ä—Å—ñ—è:",
            font=ctk.CTkFont(size=12, weight="bold")
        ).pack(side="left")

        ctk.CTkLabel(
            version_frame,
            text=f"v{self.current_version}",
            font=ctk.CTkFont(size=12),
            text_color="gray"
        ).pack(side="left", padx=10)

        # –ö–æ–º–µ–Ω—Ç–∞—Ä
        ctk.CTkLabel(
            self,
            text="–ö–æ–º–µ–Ω—Ç–∞—Ä (commit message):",
            font=ctk.CTkFont(size=12, weight="bold")
        ).pack(anchor="w", padx=20, pady=(10, 5))

        self.comment_entry = ctk.CTkEntry(
            self,
            placeholder_text="–û–ø–∏—à—ñ—Ç—å –≤–∞—à—ñ –∑–º—ñ–Ω–∏...",
            height=40,
            font=ctk.CTkFont(size=11)
        )
        self.comment_entry.pack(padx=20, fill="x", pady=(0, 15))

        # –ù–æ–≤–∞ –≤–µ—Ä—Å—ñ—è
        ctk.CTkLabel(
            self,
            text="–ù–æ–≤–∞ –≤–µ—Ä—Å—ñ—è (–¥–ª—è —Ç–∞–≥—É):",
            font=ctk.CTkFont(size=12, weight="bold")
        ).pack(anchor="w", padx=20, pady=(10, 5))

        version_frame2 = ctk.CTkFrame(self)
        version_frame2.pack(padx=20, fill="x", pady=(0, 15))

        ctk.CTkLabel(
            version_frame2,
            text="v",
            font=ctk.CTkFont(size=11)
        ).pack(side="left", padx=(0, 5))

        self.version_entry = ctk.CTkEntry(
            version_frame2,
            placeholder_text="1.1.0",
            height=35,
            font=ctk.CTkFont(size=11)
        )
        self.version_entry.pack(side="left", fill="x", expand=True)

        # –ß–µ–∫–±–æ–∫—Å –¥–ª—è —Ç–∞–≥—É
        self.tag_checkbox = ctk.CTkCheckBox(
            self,
            text="–°—Ç–≤–æ—Ä–∏—Ç–∏ —Ç–µ–≥ –≤–µ—Ä—Å—ñ—ó",
            font=ctk.CTkFont(size=11)
        )
        self.tag_checkbox.pack(anchor="w", padx=20, pady=(0, 20))
        self.tag_checkbox.select()

        # –ö–Ω–æ–ø–∫–∏
        button_frame = ctk.CTkFrame(self)
        button_frame.pack(padx=20, fill="x", pady=(0, 15))

        commit_btn = ctk.CTkButton(
            button_frame,
            text="‚úÖ Commit & Push",
            command=self.commit_and_push,
            font=ctk.CTkFont(size=12, weight="bold"),
            height=45,
            corner_radius=10
        )
        commit_btn.pack(side="left", fill="both", expand=True, padx=(0, 5))

        clear_btn = ctk.CTkButton(
            button_frame,
            text="üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç–∏",
            command=self.clear_fields,
            font=ctk.CTkFont(size=12),
            height=45,
            corner_radius=10,
            fg_color="gray30",
            hover_color="gray50"
        )
        clear_btn.pack(side="left", fill="both", expand=True, padx=(5, 0))

        # –õ–æ–≥–∏
        ctk.CTkLabel(
            self,
            text="–õ–æ–≥–∏ –æ–ø–µ—Ä–∞—Ü—ñ–π:",
            font=ctk.CTkFont(size=11, weight="bold")
        ).pack(anchor="w", padx=20, pady=(10, 5))

        self.log_text = scrolledtext.ScrolledText(
            self,
            height=10,
            width=70,
            font=("Courier", 9),
            bg="#f0f0f0",
            fg="#333333",
            relief="solid",
            borderwidth=1
        )
        self.log_text.pack(padx=20, pady=(0, 15), fill="both", expand=True)

        # –°—Ç–∞—Ç—É—Å
        self.status_label = ctk.CTkLabel(
            self,
            text="–ì–æ—Ç–æ–≤–æ –¥–æ —Ä–æ–±–æ—Ç–∏",
            font=ctk.CTkFont(size=10),
            text_color="gray"
        )
        self.status_label.pack(pady=(0, 10))

    def get_current_version(self):
        """–û—Ç—Ä–∏–º–∞–Ω–Ω—è –ø–æ—Ç–æ—á–Ω–æ—ó –≤–µ—Ä—Å—ñ—ó –∑ version.txt"""
        try:
            with open("version.txt", "r") as f:
                return f.read().strip()
        except:
            return "1.0.0"

    def log_message(self, message):
        """–î–æ–¥–∞–Ω–Ω—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –¥–æ –ª–æ–≥—ñ–≤"""
        timestamp = datetime.now().strftime("%H:%M:%S")
        self.log_text.insert("end", f"[{timestamp}] {message}\n")
        self.log_text.see("end")
        self.update()

    def run_git_command(self, command):
        """–í–∏–∫–æ–Ω–∞–Ω–Ω—è git –∫–æ–º–∞–Ω–¥–∏"""
        try:
            result = subprocess.run(
                command,
                shell=True,
                capture_output=True,
                text=True,
                cwd=os.getcwd()
            )

            if result.returncode == 0:
                if result.stdout:
                    self.log_message(f"‚úÖ {result.stdout.strip()}")
                return True
            else:
                error_msg = result.stderr.strip() if result.stderr else "–ù–µ–≤—ñ–¥–æ–º–∞ –ø–æ–º–∏–ª–∫–∞"
                self.log_message(f"‚ùå –ü–æ–º–∏–ª–∫–∞: {error_msg}")
                return False
        except Exception as e:
            self.log_message(f"‚ùå –ò—Å–∫–ª—é—á–µ–Ω–∏–µ: {str(e)}")
            return False

    def commit_and_push(self):
        """–û—Å–Ω–æ–≤–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è - commit, tag —ñ push"""

        comment = self.comment_entry.get().strip()
        new_version = self.version_entry.get().strip()
        create_tag = self.tag_checkbox.get()

        # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∏
        if not comment:
            messagebox.showwarning("–ü–æ–º–∏–ª–∫–∞", "–ù–∞–ø–∏—à—ñ—Ç—å –∫–æ–º–µ–Ω—Ç–∞—Ä –¥–æ –∫–æ–º—ñ—Ç—é!")
            return

        if create_tag and not new_version:
            messagebox.showwarning("–ü–æ–º–∏–ª–∫–∞", "–ù–∞–ø–∏—à—ñ—Ç—å –Ω–æ–≤—É –≤–µ—Ä—Å—ñ—é –¥–ª—è —Ç–∞–≥—É!")
            return

        self.status_label.configure(text="‚è≥ –û–±—Ä–æ–±–∫–∞...")
        self.update()

        self.log_message("=" * 50)
        self.log_message("üöÄ –†–æ–∑–ø–æ—á–∏–Ω–∞—î–º–æ commit & push –ø—Ä–æ—Ü–µ—Å...")
        self.log_message("=" * 50)

        # –ö—Ä–æ–∫ 1: –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å—É
        self.log_message("\nüìã –ö—Ä–æ–∫ 1: –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å—É —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—é...")
        self.run_git_command("git status --short")

        # –ö—Ä–æ–∫ 2: –î–æ–±–∞–≤–ª–µ–Ω–Ω—è –≤—Å—ñ—Ö —Ñ–∞–π–ª—ñ–≤
        self.log_message("\nüì¶ –ö—Ä–æ–∫ 2: –î–æ–¥–∞–≤–∞–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤...")
        if not self.run_git_command("git add ."):
            self.status_label.configure(text="‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –¥–æ–¥–∞–≤–∞–Ω–Ω—ñ —Ñ–∞–π–ª—ñ–≤")
            messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–ù–µ –≤–¥–∞–ª–æ—Å—è –¥–æ–¥–∞—Ç–∏ —Ñ–∞–π–ª–∏!")
            return

        # –ö—Ä–æ–∫ 3: –ö–æ–º—ñ—Ç
        self.log_message("\nüíæ –ö—Ä–æ–∫ 3: –ö–æ–º—ñ—Ç—É–≤–∞–Ω–Ω—è –∑–º—ñ–Ω...")
        if not self.run_git_command(f'git commit -m "{comment}"'):
            self.status_label.configure(text="‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –∫–æ–º—ñ—Ç—É–≤–∞–Ω–Ω—ñ")
            messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–ù–µ –≤–¥–∞–ª–æ—Å—è –∑–∞–∫–æ–º—ñ—Ç–∏—Ç–∏!")
            return

        # –ö—Ä–æ–∫ 4: Push
        self.log_message("\n‚¨ÜÔ∏è  –ö—Ä–æ–∫ 4: –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –Ω–∞ GitHub...")
        if not self.run_git_command("git push origin main"):
            self.status_label.configure(text="‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ push")
            messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–ù–µ –≤–¥–∞–ª–æ—Å—è –≤—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ –Ω–∞ GitHub!")
            return

        # –ö—Ä–æ–∫ 5: –¢–µ–≥ (—è–∫—â–æ –ø–æ—Ç—Ä—ñ–±–µ–Ω)
        if create_tag:
            self.log_message("\nüè∑Ô∏è  –ö—Ä–æ–∫ 5: –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–∞–≥—É...")
            if not self.run_git_command(f"git tag v{new_version}"):
                self.status_label.configure(text="‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—ñ —Ç–∞–≥—É")
                messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–ù–µ –≤–¥–∞–ª–æ—Å—è —Å—Ç–≤–æ—Ä–∏—Ç–∏ —Ç–µ–≥!")
                return

            self.log_message("\n‚¨ÜÔ∏è  –ö—Ä–æ–∫ 6: –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ç–∞–≥—É –Ω–∞ GitHub...")
            if not self.run_git_command(f"git push origin v{new_version}"):
                self.status_label.configure(text="‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ push —Ç–∞–≥—É")
                messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–ù–µ –≤–¥–∞–ª–æ—Å—è –≤—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ —Ç–µ–≥!")
                return

            # –û–Ω–æ–≤–ª–µ–Ω–Ω—è version.txt
            self.log_message("\nüìù –ö—Ä–æ–∫ 7: –û–Ω–æ–≤–ª–µ–Ω–Ω—è version.txt...")
            try:
                with open("version.txt", "w") as f:
                    f.write(new_version)
                self.log_message("‚úÖ version.txt –æ–Ω–æ–≤–ª–µ–Ω–æ")
                self.current_version = new_version
            except Exception as e:
                self.log_message(f"‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –æ–Ω–æ–≤–ª–µ–Ω–Ω—ñ version.txt: {str(e)}")

        self.log_message("\n" + "=" * 50)
        self.log_message("‚úÖ –í–°–ï –£–°–ü–Ü–®–ù–û! GitHub Actions –ø–æ—á–Ω–µ –∫–æ–º–ø—ñ–ª—é–≤–∞—Ç–∏...")
        self.log_message("=" * 50)

        self.status_label.configure(text="‚úÖ –£—Å–ø—ñ—à–Ω–æ! GitHub Actions –∑–∞–ø—É—â–µ–Ω–æ")
        messagebox.showinfo(
            "–£—Å–ø—ñ—Ö",
            f"‚úÖ –ö–æ–º—ñ—Ç —É—Å–ø—ñ—à–Ω–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ!\n\n"
            f"–ö–æ–º–µ–Ω—Ç–∞—Ä: {comment}\n"
            + (f"–í–µ—Ä—Å—ñ—è: v{new_version}\n\nGitHub Actions –ø–æ—á–Ω–µ –∫–æ–º–ø—ñ–ª—é–≤–∞—Ç–∏ EXE..." if create_tag else "")
        )

        self.clear_fields()

    def clear_fields(self):
        """–û—á–∏—Å—Ç–∫–∞ –ø–æ–ª—ñ–≤"""
        self.comment_entry.delete(0, "end")
        self.version_entry.delete(0, "end")
        self.tag_checkbox.select()
        self.status_label.configure(text="–ì–æ—Ç–æ–≤–æ –¥–æ —Ä–æ–±–æ—Ç–∏")


def main():
    app = GitCommitTool()
    app.mainloop()


if __name__ == "__main__":
    main()


================================================================================
–§–∞–π–ª 5/21: README.md
--------------------------------------------------------------------------------


================================================================================
–§–∞–π–ª 6/21: requirements.txt
--------------------------------------------------------------------------------
customtkinter==5.2.1
requests==2.31.0
psutil==5.9.6
keyring==24.1.0
python-telegram-bot==20.3
packaging>=24.0
pywin32>=300
python-dotenv

================================================================================
–§–∞–π–ª 7/21: src\anydesk_manager.py
--------------------------------------------------------------------------------
import os
import sys
import subprocess
import time
import logging
import psutil
import platform
import ctypes
import socket
from pathlib import Path
from typing import Optional, Tuple

logger = logging.getLogger(__name__)

UNATTENDED_PASSWORD = "r3moteh4nd"


class AnyDeskManager:
    """–ú–µ–Ω–µ–¥–∂–µ—Ä –¥–ª—è AnyDesk"""

    def __init__(self, config_manager, telegram_api):
        self.config = config_manager
        self.telegram = telegram_api
        self.anydesk_path = self.find_anydesk()
        self._is_running = False
        self.connection_id = None

    def find_anydesk(self) -> Optional[str]:
        """–ó–Ω–∞–π—Ç–∏ AnyDesk"""
        possible_paths = [
            r"C:\Program Files\AnyDesk\AnyDesk.exe",
            r"C:\Program Files (x86)\AnyDesk\AnyDesk.exe",
            os.path.expanduser("~\\AppData\\Local\\AnyDesk\\AnyDesk.exe"),
            os.path.expanduser("~\\AppData\\Roaming\\AnyDesk\\AnyDesk.exe"),
            os.path.expanduser("~\\Downloads\\AnyDesk.exe"),
            r"C:\ProgramData\AnyDesk\AnyDesk.exe",
        ]

        for path in possible_paths:
            if os.path.exists(path):
                logger.info(f"‚úÖ AnyDesk –∑–Ω–∞–π–¥–µ–Ω–æ: {path}")
                return path

        logger.warning("‚ö†Ô∏è AnyDesk –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ")
        return None

    def download_anydesk(self) -> bool:
        """–ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ AnyDesk"""
        if self.anydesk_path:
            return True

        logger.info("üì• –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è AnyDesk...")
        try:
            import urllib.request
            downloads_dir = os.path.expanduser("~\\Downloads")
            save_path = os.path.join(downloads_dir, "AnyDesk.exe")
            download_url = "https://download.anydesk.com/AnyDesk.exe"

            if not os.path.exists(save_path):
                logger.info(f"–ó–∞–≤–∞–Ω—Ç–∞–∂—É...")
                urllib.request.urlretrieve(download_url, save_path)

            logger.info("–ó–∞–ø—É—Å–∫ –≤—Å—Ç–∞–Ω–æ–≤–ª—é–≤–∞—á–∞...")
            subprocess.Popen([save_path])

            logger.info("–ß–µ–∫–∞—é –Ω–∞ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è (90 —Å–µ–∫)...")
            for i in range(90):
                time.sleep(1)
                self.anydesk_path = self.find_anydesk()
                if self.anydesk_path:
                    logger.info(f"‚úÖ AnyDesk –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ")
                    time.sleep(3)
                    return True

            return False
        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞: {e}")
            return False

    def check_if_running(self) -> bool:
        """–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —á–∏ AnyDesk –∑–∞–ø—É—â–µ–Ω–æ"""
        try:
            for proc in psutil.process_iter(['pid', 'name']):
                if 'anydesk' in proc.info['name'].lower():
                    logger.info(f"‚ÑπÔ∏è AnyDesk –∑–∞–ø—É—â–µ–Ω–æ (PID: {proc.info['pid']})")
                    self._is_running = True
                    return True
        except:
            pass
        self._is_running = False
        return False

    def launch_anydesk(self) -> bool:
        """–ó–∞–ø—É—Å—Ç–∏—Ç–∏ AnyDesk"""
        if self.check_if_running():
            return True

        if not self.anydesk_path or not Path(self.anydesk_path).exists():
            logger.error("–®–ª—è—Ö –Ω–µ–≤—ñ–¥–æ–º–∏–π")
            return False

        try:
            logger.info(f"üöÄ –ó–∞–ø—É—Å–∫–∞—é AnyDesk...")
            subprocess.Popen(self.anydesk_path)
            time.sleep(5)

            if self.check_if_running():
                logger.info("‚úÖ AnyDesk –∑–∞–ø—É—â–µ–Ω–æ")
                return True
            else:
                self._is_running = True
                return True
        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞: {e}")
            return False

    def set_password_with_admin(self) -> bool:
        """–í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –ø–∞—Ä–æ–ª—å —á–µ—Ä–µ–∑ –æ–∫—Ä–µ–º–∏–π —Å–∫—Ä–∏–ø—Ç –∑ –∞–¥–º—ñ–Ω –ø—Ä–∞–≤–∞–º–∏"""
        if not self.anydesk_path:
            logger.error("–®–ª—è—Ö –Ω–µ–≤—ñ–¥–æ–º–∏–π")
            return False

        try:
            logger.info(f"üîê –ó–∞–ø—É—Å–∫–∞—é –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –ø–∞—Ä–æ–ª—è –∑ –∞–¥–º—ñ–Ω –ø—Ä–∞–≤–∞–º–∏...")

            # –í–∏–∑–Ω–∞—á–∏—Ç–∏ —à–ª—è—Ö –¥–æ —Å–∫—Ä–∏–ø—Ç—É
            if getattr(sys, 'frozen', False):
                # –Ø–∫—â–æ EXE - —Å–∫—Ä–∏–ø—Ç –ø–æ—Ä—É—á
                script_path = os.path.join(os.path.dirname(sys.executable), "src", "set_anydesk_password.py")
            else:
                # –Ø–∫—â–æ DEV
                script_path = os.path.join(os.path.dirname(__file__), "set_anydesk_password.py")

            if not os.path.exists(script_path):
                logger.error(f"–°–∫—Ä–∏–ø—Ç –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ: {script_path}")
                return False

            # –ü–µ—Ä–µ–¥–∞—Ç–∏ –ø–∞—Ä–æ–ª—å —è–∫ –∑–º—ñ–Ω–Ω—É —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞
            env = os.environ.copy()
            env["ANYDESK_PASSWORD"] = UNATTENDED_PASSWORD

            # –ó–∞–ø—É—Å—Ç–∏—Ç–∏ —Å–∫—Ä–∏–ø—Ç –∑ –∞–¥–º—ñ–Ω –ø—Ä–∞–≤–∞–º–∏
            ctypes.windll.shell32.ShellExecuteW(
                None,
                "runas",
                sys.executable,
                f'"{script_path}" "{self.anydesk_path}"',
                None,
                1  # SW_SHOW - –ø–æ–∫–∞–∑–∞—Ç–∏ –≤—ñ–∫–Ω–æ
            )

            logger.info(f"‚úÖ –ó–∞–ø—Ä–æ—Å –∞–¥–º—ñ–Ω –ø—Ä–∞–≤ –Ω–∞–¥—ñ—Å–ª–∞–Ω–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—É")
            time.sleep(3)
            return True

        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞: {e}")
            import traceback
            traceback.print_exc()
            return False

    def get_connection_id(self) -> Optional[str]:
        """–û—Ç—Ä–∏–º–∞—Ç–∏ ID"""
        if not self.anydesk_path:
            return None

        try:
            logger.info("üìå –û—Ç—Ä–∏–º—É—é ID...")

            result = subprocess.run(
                [self.anydesk_path, '--get-id'],
                capture_output=True,
                text=True,
                timeout=10,
                creationflags=subprocess.CREATE_NO_WINDOW if platform.system() == "Windows" else 0
            )

            if result.returncode == 0:
                connection_id = result.stdout.strip()
                if connection_id and connection_id.isdigit():
                    logger.info(f"‚úÖ ID: {connection_id}")
                    self.connection_id = connection_id
                    return connection_id

        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞: {e}")

        return None

    def start(self, password: str = None) -> Tuple[Optional[str], Optional[str]]:
        """–ó–∞–ø—É—Å—Ç–∏—Ç–∏ AnyDesk"""
        password = UNATTENDED_PASSWORD

        # –ö—Ä–æ–∫ 1: –Ø–∫—â–æ –≤–∂–µ –∑–∞–ø—É—â–µ–Ω–æ
        if self.check_if_running():
            logger.info("AnyDesk –≤–∂–µ –∑–∞–ø—É—â–µ–Ω–æ")
            connection_id = self.get_connection_id()
            if connection_id:
                try:
                    # ‚ö†Ô∏è –î–û–î–ê–¢–ò –ü–Ü–ë
                    user_name = self.config.get("user_name", "")

                    self.telegram.send_anydesk_info(
                        self.config.store_location_text,
                        user_name,  # ‚¨ÖÔ∏è –ü–Ü–ë
                        socket.gethostname(),  # –ü–ö
                        connection_id,
                        password
                    )
                except Exception as e:
                    logger.error(f"‚ùå Telegram: {e}")
            return connection_id, password

        # –ö—Ä–æ–∫ 2: –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —è–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ
        if not self.anydesk_path:
            if not self.download_anydesk():
                return None, None

        # –ö—Ä–æ–∫ 3: –ó–∞–ø—É—Å—Ç–∏—Ç–∏
        if not self.launch_anydesk():
            return None, None

        # –ö—Ä–æ–∫ 4: –í–°–¢–ê–ù–û–í–ò–¢–ò –ü–ê–†–û–õ–¨ –ó –ê–î–ú–Ü–ù –ü–†–ê–í–ê–ú–ò
        logger.info("üîê –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –ø–∞—Ä–æ–ª—è...")
        time.sleep(2)
        self.set_password_with_admin()

        # –ö—Ä–æ–∫ 5: –û—Ç—Ä–∏–º–∞—Ç–∏ ID
        logger.info("üìå –û—Ç—Ä–∏–º–∞–Ω–Ω—è ID...")
        time.sleep(2)
        connection_id = self.get_connection_id()

        if not connection_id:
            time.sleep(3)
            connection_id = self.get_connection_id()

        # –ö—Ä–æ–∫ 6: –ù–∞–¥—ñ—Å–ª–∞—Ç–∏ –≤ Telegram –∑ –ü–Ü–ë
        try:
            # ‚ö†Ô∏è –î–û–î–ê–¢–ò –ü–Ü–ë
            user_name = self.config.get("user_name", "")

            self.telegram.send_anydesk_info(
                self.config.store_location_text,
                user_name,  # ‚¨ÖÔ∏è –ü–Ü–ë
                socket.gethostname(),  # –ü–ö
                connection_id if connection_id else "–Ω–µ –æ—Ç—Ä–∏–º–∞–Ω–æ",
                password
            )
            logger.info("‚úÖ –¢–µ–ª–µ–≥—Ä–∞–º —Å–ø–æ–≤—ñ—â–µ–Ω–æ")
        except Exception as e:
            logger.error(f"‚ùå –¢–µ–ª–µ–≥—Ä–∞–º –ø–æ–º–∏–ª–∫–∞: {e}")

        logger.info(f"‚úÖ –ì–æ—Ç–æ–≤–æ (ID: {connection_id})")
        return connection_id, password


================================================================================
–§–∞–π–ª 8/21: src\config.py
--------------------------------------------------------------------------------
import os
from pathlib import Path
from dotenv import load_dotenv

# –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ .env
load_dotenv()

APP_NAME = "RemoteHand"
RDP_HOST = "23.88.7.196"
RDP_PORT = 4420
PING_HOST = "23.88.7.196"

# üîí –ó–Ü –ó–ú–Ü–ù–ù–ò–• –°–ï–†–ï–î–û–í–ò–©–ê, –ê –ù–ï –ó .env!
TELEGRAM_TOKEN = os.getenv("TELEGRAM_TOKEN", "")
TELEGRAM_CHAT_ID = os.getenv("TELEGRAM_CHAT_ID", "")

# –§–∞–π–ª–∏
LOCK_FILE = Path.home() / ".remotehand" / "lock"


================================================================================
–§–∞–π–ª 9/21: src\config_manager.py
--------------------------------------------------------------------------------
import json
import os
from pathlib import Path
import logging

logger = logging.getLogger(__name__)


class ConfigManager:
    """–ú–µ–Ω–µ–¥–∂–µ—Ä –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó"""

    def __init__(self):
        self.config_dir = Path.home() / ".remotehand"
        self.config_dir.mkdir(exist_ok=True)
        self.config_file = self.config_dir / "config.json"

        self.config = self.load()

    def load(self):
        """–ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –∫–æ–Ω—Ñ—ñ–≥"""
        if self.config_file.exists():
            try:
                with open(self.config_file, 'r', encoding='utf-8') as f:
                    return json.load(f)
            except:
                pass
        return {}

    def save(self):
        """–ó–±–µ—Ä–µ–≥—Ç–∏ –∫–æ–Ω—Ñ—ñ–≥ –≤ JSON —Ñ–∞–π–ª"""
        try:
            with open(self.config_file, 'w', encoding='utf-8') as f:
                json.dump(self.config, f, ensure_ascii=False, indent=2)
        except Exception as e:
            logger.error(f"–ü–æ–º–∏–ª–∫–∞ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –∫–æ–Ω—Ñ—ñ–≥—É: {e}")

    def set(self, key, value):
        """–í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –∑–Ω–∞—á–µ–Ω–Ω—è"""
        self.config[key] = value
        self.save()

    def get(self, key, default=""):
        """–û—Ç—Ä–∏–º–∞—Ç–∏ –∑–Ω–∞—á–µ–Ω–Ω—è"""
        return self.config.get(key, default)

    def is_first_run(self):
        """–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —á–∏ –ø–µ—Ä—à–∏–π –∑–∞–ø—É—Å–∫"""
        store = self.config.get('store', '')
        location = self.config.get('location', '')
        return not store or not location

    @property
    def store_location_text(self):
        """–û—Ç—Ä–∏–º–∞—Ç–∏ —Ç–µ–∫—Å—Ç –º–∞–≥–∞–∑–∏–Ω—É/–ª–æ–∫–∞—Ü—ñ—ó"""
        store = self.config.get('store', '–ù–µ–≤—ñ–¥–æ–º–æ')
        location = self.config.get('location', '–ù–µ–≤—ñ–¥–æ–º–æ')
        return f"{store} / {location}"


================================================================================
–§–∞–π–ª 10/21: src\main.py
--------------------------------------------------------------------------------
import customtkinter as ctk
from tkinter import messagebox
import sys
import os
import threading
import logging
from pathlib import Path

# –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ .env —Ñ–∞–π–ª
from dotenv import load_dotenv

load_dotenv()

# –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –ª–æ–≥—É–≤–∞–Ω–Ω—è
logging.basicConfig(
    level=logging.INFO,
    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s'
)
logger = logging.getLogger(__name__)

# ============ –ü–ï–†–ï–í–Ü–†–ö–ê DEV –†–ï–ñ–ò–ú–£ ============
DEV_MODE = os.getenv('REMOTEHAND_DEV_MODE') == '1'
logger.info(f"{'üîß DEV –†–ï–ñ–ò–ú' if DEV_MODE else '‚úÖ PRODUCTION –†–ï–ñ–ò–ú'}")

if not DEV_MODE:
    # –¢–Ü–õ–¨–ö–ò –í PRODUCTION
    try:
        from updater import check_and_update

        check_and_update()
    except Exception as e:
        logger.warning(f"–ü–æ–º–∏–ª–∫–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –æ–Ω–æ–≤–ª–µ–Ω—å: {e}")

# ============ –Ü–ú–ü–û–†–¢–ò ============
from utils import close_all_rdp_sessions, test_connection
from config import RDP_HOST, RDP_PORT, PING_HOST, APP_NAME

# –ù–æ–≤—ñ —ñ–º–ø–æ—Ä—Ç–∏
from config_manager import ConfigManager
from telegram_api import TelegramAPI
from setup_wizard import SetupWizard
from network_test import NetworkTest

try:
    from rdp_manager import RDPManager

    rdp_manager_available = True
except ImportError as e:
    rdp_manager_available = False
    logger.warning(f"rdp_manager –Ω–µ –¥–æ—Å—Ç—É–ø–Ω–∞: {e}")

try:
    from anydesk_manager import AnyDeskManager

    anydesk_available = True
except ImportError as e:
    anydesk_available = False
    logger.warning(f"anydesk_manager –Ω–µ –¥–æ—Å—Ç—É–ø–Ω–∞: {e}")


class RemoteHandApp(ctk.CTk):
    def __init__(self):
        super().__init__()

        # –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –≤—ñ–∫–Ω–∞
        self.title(APP_NAME)
        self.geometry("520x800")
        self.resizable(True, True)

        # –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç–µ–º–∏
        ctk.set_appearance_mode("light")
        ctk.set_default_color_theme("blue")

        # –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è –º–µ–Ω–µ–¥–∂–µ—Ä—ñ–≤
        self.config = ConfigManager()

        # ‚ö†Ô∏è –ó–ê–í–ê–ù–¢–ê–ñ–ò–¢–ò –¢–û–ö–ï–ù–ò –ó .env –õ–ò CONFIG
        telegram_token = os.getenv("TELEGRAM_TOKEN") or self.config.get("telegram_token")
        telegram_chat_id = os.getenv("TELEGRAM_CHAT_ID") or self.config.get("telegram_chat_id")

        logger.info(f"Telegram token: {'‚úÖ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ' if telegram_token else '‚ùå –ù–ï –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ'}")
        logger.info(f"Telegram chat_id: {'‚úÖ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ' if telegram_chat_id else '‚ùå –ù–ï –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ'}")

        self.telegram = TelegramAPI(telegram_token, telegram_chat_id)

        if rdp_manager_available:
            self.rdp_manager = RDPManager(self.config, self.telegram)
        else:
            self.rdp_manager = None

        if anydesk_available:
            self.anydesk_manager = AnyDeskManager(self.config, self.telegram)
        else:
            self.anydesk_manager = None

        self.network_test = NetworkTest(self.config, self.telegram)

        # ‚ö†Ô∏è –°–¢–í–û–†–ò–¢–ò UI –í–°–Ü –†–ê–ó–ò, –∞ –ø–æ—Ç—ñ–º –ø–æ–∫–∞–∑–∞—Ç–∏ SetupWizard —è–∫—â–æ –ø–µ—Ä—à–∏–π –∑–∞–ø—É—Å–∫
        self.setup_ui()

        if self.config.is_first_run():
            self.show_setup_wizard()

    def get_app_version(self):
        """–û—Ç—Ä–∏–º–∞—Ç–∏ –≤–µ—Ä—Å—ñ—é –ø—Ä–æ–≥—Ä–∞–º–∏"""
        try:
            if getattr(sys, 'frozen', False):
                # –Ø–∫—â–æ EXE - —à—É–∫–∞—î–º–æ –ø–æ—Ä—É—á –∑ EXE
                base_path = Path(sys.executable).parent
            else:
                # –Ø–∫—â–æ DEV - —à—É–∫–∞—î–º–æ –≤ –∫–æ—Ä–µ–Ω—ñ –ø—Ä–æ–µ–∫—Ç—É
                base_path = Path(__file__).parent.parent

            version_file = base_path / "version.txt"

            if version_file.exists():
                return version_file.read_text(encoding='utf-8').strip()
        except Exception as e:
            logger.error(f"–ü–æ–º–∏–ª–∫–∞ —á–∏—Ç–∞–Ω–Ω—è –≤–µ—Ä—Å—ñ—ó: {e}")

        return "1.0.0"

    def show_setup_wizard(self):
        """–ü–æ–∫–∞–∑–∞—Ç–∏ –≤—ñ–∫–Ω–æ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –ø—Ä–∏ –ø–µ—Ä—à–æ–º—É –∑–∞–ø—É—Å–∫—É"""

        def on_setup_complete(result):
            self.config.set("store", result["store"])
            self.config.set("location", result["location"])
            if result.get("user_name"):
                self.config.set("user_name", result["user_name"])
            # ‚úÖ –û–Ω–æ–≤–∏—Ç–∏ UI –ø—ñ—Å–ª—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è
            self.refresh_ui()

        wizard = SetupWizard(self, on_setup_complete)
        self.wait_window(wizard)

    def refresh_ui(self):
        """–û–Ω–æ–≤–∏—Ç–∏ UI –ø—ñ—Å–ª—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è"""
        # –û–Ω–æ–≤–∏—Ç–∏ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –º–∞–≥–∞–∑–∏–Ω
        user_info = self.config.store_location_text
        user_name = self.config.get("user_name", "")
        if user_name:
            user_info += f" | üë§ {user_name}"

        self.info_label.configure(text=f"üìç {user_info}")

    def setup_ui(self):
        """–°—Ç–≤–æ—Ä–µ–Ω–Ω—è UI"""

        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        title_label = ctk.CTkLabel(
            self,
            text="RemoteHand",
            font=ctk.CTkFont(size=28, weight="bold")
        )
        title_label.pack(pady=15)

        # –Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ –º–∞–≥–∞–∑–∏–Ω/–ª–æ–∫–∞—Ü—ñ—é + –ü–Ü–ë
        user_info = self.config.store_location_text
        user_name = self.config.get("user_name", "")
        if user_name:
            user_info += f" | üë§ {user_name}"

        self.info_label = ctk.CTkLabel(
            self,
            text=f"üìç {user_info}",
            font=ctk.CTkFont(size=11),
            text_color="gray"
        )
        self.info_label.pack(pady=(0, 20))

        # ==================== RDP –ë–õ–û–ö ====================
        rdp_frame = ctk.CTkFrame(self)
        rdp_frame.pack(pady=15, padx=20, fill="x")

        ctk.CTkLabel(
            rdp_frame,
            text="üìã –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ 1–°",
            font=ctk.CTkFont(size=13, weight="bold")
        ).pack(anchor="w", pady=(0, 10))

        # –û—Å–Ω–æ–≤–Ω–∞ –∫–Ω–æ–ø–∫–∞ RDP
        rdp_btn = ctk.CTkButton(
            rdp_frame,
            text="üñ•Ô∏è –í—ñ–¥–∫—Ä–∏—Ç–∏ 1–° (RDP)",
            command=self.open_rdp,
            height=50,
            font=ctk.CTkFont(size=12, weight="bold"),
            corner_radius=12,
            fg_color="#007AFF",
            hover_color="#0051D5"
        )
        rdp_btn.pack(fill="x", pady=(0, 10))

        # ==================== –ó–ê–ö–†–ò–¢–¢–Ø –°–ï–°–Ü–ô ====================
        close_sessions_btn = ctk.CTkButton(
            self,
            text="‚ùå –ó–∞–∫—Ä–∏—Ç–∏ –≤—Å—ñ RDP —Å–µ—Å—ñ—ó",
            command=self.close_sessions_confirm,
            height=45,
            font=ctk.CTkFont(size=12, weight="bold"),
            corner_radius=12,
            fg_color="#FF3B30",
            hover_color="#D70015"
        )
        close_sessions_btn.pack(pady=15, padx=20, fill="x")

        # ==================== ANYDESK –ë–õ–û–ö ====================
        if anydesk_available:
            anydesk_frame = ctk.CTkFrame(self)
            anydesk_frame.pack(pady=15, padx=20, fill="x")

            ctk.CTkLabel(
                anydesk_frame,
                text="üåê –í—ñ–¥–¥–∞–ª–µ–Ω–∏–π –¥–æ—Å—Ç—É–ø",
                font=ctk.CTkFont(size=13, weight="bold")
            ).pack(anchor="w", pady=(0, 10))

            anydesk_btn = ctk.CTkButton(
                anydesk_frame,
                text="üöÄ –ó–∞–ø—É—Å—Ç–∏—Ç–∏ AnyDesk",
                command=self.start_anydesk,
                height=50,
                font=ctk.CTkFont(size=12, weight="bold"),
                corner_radius=12,
                fg_color="#FF6B35",
                hover_color="#CC5529"
            )
            anydesk_btn.pack(fill="x", pady=(0, 10))

        # ==================== –¢–ï–°–¢ –ú–ï–†–ï–ñ–Ü ====================
        test_frame = ctk.CTkFrame(self)
        test_frame.pack(pady=15, padx=20, fill="x")

        ctk.CTkLabel(
            test_frame,
            text="üîß –î—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∞",
            font=ctk.CTkFont(size=13, weight="bold")
        ).pack(anchor="w", pady=(0, 10))

        test_btn = ctk.CTkButton(
            test_frame,
            text="üì° –¢–µ—Å—Ç –∑'—î–¥–Ω–∞–Ω–Ω—è",
            command=self.run_network_test,
            height=50,
            font=ctk.CTkFont(size=12, weight="bold"),
            corner_radius=12,
            fg_color="#34C759",
            hover_color="#248A3D"
        )
        test_btn.pack(fill="x", pady=(0, 10))

        # ==================== –°–¢–ê–¢–£–° ====================
        self.status_label = ctk.CTkLabel(
            self,
            text="‚úÖ –ì–æ—Ç–æ–≤–æ –¥–æ —Ä–æ–±–æ—Ç–∏",
            font=ctk.CTkFont(size=10),
            text_color="gray"
        )
        self.status_label.pack(pady=10)

        # ==================== –ö–ù–û–ü–ö–ê –†–ï–î–ê–ì–£–í–ê–ù–ù–Ø –ú–ê–ì–ê–ó–ò–ù–£ ====================
        settings_frame = ctk.CTkFrame(self)
        settings_frame.pack(pady=10, padx=20, fill="x")

        settings_btn = ctk.CTkButton(
            settings_frame,
            text="‚öôÔ∏è –ó–º—ñ–Ω–∏—Ç–∏ –º–∞–≥–∞–∑–∏–Ω/–ª–æ–∫–∞—Ü—ñ—é/–ü–Ü–ë",
            command=self.show_setup_wizard,
            height=35,
            font=ctk.CTkFont(size=10),
            corner_radius=8,
            fg_color="#999999",
            hover_color="#666666"
        )
        settings_btn.pack(fill="x")

        # ==================== –í–ï–†–°–Ü–Ø + –°–¢–ê–¢–£–° –û–ù–û–í–õ–ï–ù–ù–Ø ====================
        version_frame = ctk.CTkFrame(self)
        version_frame.pack(anchor="se", padx=10, pady=10)

        version_label = ctk.CTkLabel(
            version_frame,
            text=f"v{self.get_app_version()}",
            font=ctk.CTkFont(size=9, weight="bold"),
            text_color="#333333"
        )
        version_label.pack(side="left", padx=5)

        self.update_status_label = ctk.CTkLabel(
            version_frame,
            text="‚úÖ",
            font=ctk.CTkFont(size=10),
            text_color="green"
        )
        self.update_status_label.pack(side="left", padx=5)

    def open_rdp(self):
        """–í—ñ–¥–∫—Ä–∏—Ç–∏ RDP"""
        if not self.rdp_manager:
            messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "RDP –º–µ–Ω–µ–¥–∂–µ—Ä –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω")
            return

        # –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —á–∏ –ø–∞—Ä–æ–ª—å –≤–∂–µ –∑–±–µ—Ä–µ–∂–µ–Ω–æ
        saved_password = self.rdp_manager.get_credentials(RDP_HOST, "admin")

        if saved_password:
            # –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –∑–±–µ—Ä–µ–∂–µ–Ω–∏–π –ø–∞—Ä–æ–ª—å
            self.set_status("‚è≥ –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è...", "processing")

            def connect():
                try:
                    if self.rdp_manager.connect_rdp(RDP_HOST, RDP_PORT, "admin", saved_password):
                        self.set_status("‚úÖ –ü—ñ–¥–∫–ª—é—á–µ–Ω–æ", "success")
                    else:
                        self.set_status("‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è", "error")
                except Exception as e:
                    logger.error(f"–ü–æ–º–∏–ª–∫–∞: {e}")
                    self.set_status("‚ùå –ö—Ä–∏—Ç–∏—á–Ω–∞ –ø–æ–º–∏–ª–∫–∞", "error")

            thread = threading.Thread(target=connect, daemon=True)
            thread.start()
        else:
            # –ó–∞–ø—Ä–æ—Å–∏—Ç–∏ –Ω–æ–≤–∏–π –ø–∞—Ä–æ–ª—å
            dialog = ctk.CTkInputDialog(
                text="–í–≤–µ–¥—ñ—Ç—å –ø–∞—Ä–æ–ª—å –¥–ª—è RDP:",
                title="–ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ 1–°"
            )
            password = dialog.get_input()

            if password:
                self.set_status("üíæ –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è –ø–∞—Ä–æ–ª—è...", "processing")

                # –°–ø—Ä–æ–±—É–≤–∞—Ç–∏ –ø—ñ–¥–∫–ª—é—á–∏—Ç–∏—Å—è
                if self.rdp_manager.connect_rdp(RDP_HOST, RDP_PORT, "admin", password):
                    # –Ø–∫—â–æ —É—Å–ø—ñ—à–Ω–æ, —Ç–æ –∑–±–µ—Ä–µ–≥—Ç–∏ –ø–∞—Ä–æ–ª—å
                    self.rdp_manager.save_credentials(RDP_HOST, "admin", password)
                    self.set_status("‚úÖ –£—Å–ø—ñ—à–Ω–æ –ø—ñ–¥–∫–ª—é—á–µ–Ω–æ", "success")
                else:
                    self.set_status("‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è", "error")

    def close_sessions_confirm(self):
        """–ü—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è –∑–∞–∫—Ä–∏—Ç—Ç—è —Å–µ—Å—ñ–π"""
        result = messagebox.askyesno(
            "–ü—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è",
            "–í–∏ –≤–ø–µ–≤–Ω–µ–Ω—ñ, —â–æ —Ö–æ—á–µ—Ç–µ –∑–∞–∫—Ä–∏—Ç–∏ –≤—Å—ñ RDP —Å–µ—Å—ñ—ó?"
        )
        if result:
            self.set_status("‚è≥ –ó–∞–∫—Ä–∏—Ç—Ç—è —Å–µ—Å—ñ–π...", "processing")
            close_all_rdp_sessions()
            self.set_status("‚úÖ –í—Å—ñ —Å–µ—Å—ñ—ó –∑–∞–∫—Ä–∏—Ç–æ", "success")

    def start_anydesk(self):
        """–ó–∞–ø—É—Å—Ç–∏—Ç–∏ AnyDesk - –ë–ï–ó –ø–æ–∫–∞–∑—É –ø–∞—Ä–æ–ª—è!"""
        if not self.anydesk_manager:
            messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "AnyDesk –º–µ–Ω–µ–¥–∂–µ—Ä –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω")
            return

        self.set_status("‚è≥ –ó–∞–ø—É—Å–∫ AnyDesk...", "processing")

        def anydesk_task():
            try:
                # –ó–∞–ø—É—Å—Ç–∏—Ç–∏ AnyDesk - –ø–∞—Ä–æ–ª—å –ù–ï –ø–µ—Ä–µ–¥–∞—î–º–æ —Ç–∞ –ù–ï –ø–æ–∫–∞–∑—É—î–º–æ!
                anydesk_id, pwd = self.anydesk_manager.start(None)

                if anydesk_id:
                    self.set_status(f"‚úÖ AnyDesk –∑–∞–ø—É—â–µ–Ω–æ\nüÜî ID: {anydesk_id}", "success")
                    messagebox.showinfo(
                        "‚úÖ AnyDesk –∑–∞–ø—É—â–µ–Ω–æ",
                        f"ID –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è: {anydesk_id}\n\n"
                        f"–î–∞–Ω—ñ –Ω–∞–¥—ñ—Å–ª–∞–Ω—ñ –≤ Telegram\n"
                        f"–ü–∞—Ä–æ–ª—å –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ"
                    )
                else:
                    self.set_status("‚ùå AnyDesk –≤–∂–µ –∑–∞–ø—É—â–µ–Ω–æ", "error")
                    messagebox.showwarning(
                        "‚ö†Ô∏è –£–≤–∞–≥–∞",
                        "AnyDesk –≤–∂–µ –∑–∞–ø—É—â–µ–Ω–æ –∞–±–æ –Ω–µ –≤–¥–∞–ª–æ—Å—è –∑–∞–ø—É—Å—Ç–∏—Ç–∏"
                    )
            except Exception as e:
                logger.error(f"–ü–æ–º–∏–ª–∫–∞: {e}")
                self.set_status("‚ùå –ü–æ–º–∏–ª–∫–∞ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è", "error")

        thread = threading.Thread(target=anydesk_task, daemon=True)
        thread.start()

    def run_network_test(self):
        """–ó–∞–ø—É—Å—Ç–∏—Ç–∏ —Ç–µ—Å—Ç –º–µ—Ä–µ–∂—ñ"""
        self.set_status("‚è≥ –¢–µ—Å—Ç –º–µ—Ä–µ–∂—ñ...", "processing")

        def test_task():
            try:
                result = self.network_test.run_full_test()
                self.set_status(f"{result['status']}", result['color'])
            except Exception as e:
                logger.error(f"–ü–æ–º–∏–ª–∫–∞ —Ç–µ—Å—Ç—É: {e}")
                self.set_status("‚ùå –ü–æ–º–∏–ª–∫–∞ —Ç–µ—Å—Ç—É", "error")

        thread = threading.Thread(target=test_task, daemon=True)
        thread.start()

    def set_status(self, text, status_type="info"):
        """–í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ —Å—Ç–∞—Ç—É—Å –∑ –∫–æ–ª—å–æ—Ä–æ–º"""
        color_map = {
            "success": "green",
            "error": "red",
            "processing": "blue",
            "info": "gray"
        }
        self.status_label.configure(text=text, text_color=color_map.get(status_type, "gray"))


def main():
    """–ì–æ–ª–æ–≤–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è"""
    logger.info("–ó–∞–ø—É—Å–∫ RemoteHand...")
    app = RemoteHandApp()
    app.mainloop()


if __name__ == "__main__":
    main()


================================================================================
–§–∞–π–ª 11/21: src\network_test.py
--------------------------------------------------------------------------------
import subprocess
import re
import socket
import logging
from pathlib import Path
import tempfile

logger = logging.getLogger(__name__)


class NetworkTest:
    """–¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è –º–µ—Ä–µ–∂—ñ –∑ –∑–≤—ñ—Ç–æ–º"""

    def __init__(self, config_manager, telegram_api):
        self.config = config_manager
        self.telegram = telegram_api

    def run_ping_test(self, host, count=20):
        """–í–∏–∫–æ–Ω–∞—Ç–∏ ping —Ç–µ—Å—Ç –Ω–∞ —Ö–æ—Å—Ç—É"""
        try:
            result = subprocess.run(
                ['ping', host, '-n', str(count)],
                capture_output=True,
                text=True,
                encoding='cp1252',
                timeout=60,
                creationflags=subprocess.CREATE_NO_WINDOW
            )
            return result.stdout
        except Exception as e:
            logger.error(f"–ü–æ–º–∏–ª–∫–∞ ping: {e}")
            return f"–ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—ñ {host}: {str(e)}"

    def parse_ping_loss(self, ping_output):
        """–í–∏—Ç—è–≥—Ç–∏ –≤—ñ–¥—Å–æ—Ç–æ–∫ –≤—Ç—Ä–∞—Ç–∏ –ø–∞–∫–µ—Ç—ñ–≤"""
        try:
            match = re.search(r'(\d+)%\s+(–ø–æ—Ç–µ—Ä—å|loss)', ping_output, re.IGNORECASE)
            if match:
                return int(match.group(1))
            return 0
        except:
            return -1

    def run_full_test(self):
        """–ó–∞–ø—É—Å—Ç–∏—Ç–∏ –ø–æ–≤–Ω–∏–π —Ç–µ—Å—Ç –º–µ—Ä–µ–∂—ñ"""
        pc_name = socket.gethostname()
        store_location = self.config.store_location_text

        hosts = {
            "1–° –°–µ—Ä–≤–µ—Ä": "23.88.7.196",
            "Google DNS": "8.8.8.8"
        }

        report_parts = []
        total_loss = 0

        for name, ip in hosts.items():
            ping_output = self.run_ping_test(ip)
            loss = self.parse_ping_loss(ping_output)

            if loss >= 0:
                status = "‚úÖ" if loss == 0 else ("‚ö†Ô∏è" if loss <= 15 else "‚ùå")
                report_parts.append(f"{status} {name} ({ip}): {loss}% –≤—Ç—Ä–∞—Ç–∏")
                total_loss += loss
            else:
                report_parts.append(f"‚ùå {name} ({ip}): –ü–æ–º–∏–ª–∫–∞ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è")

        avg_loss = total_loss / len(hosts) if hosts else 0

        if avg_loss == 0:
            status_text = "‚úÖ –ú–µ—Ä–µ–∂–∞ –≤ –Ω–æ—Ä–º—ñ"
            color = "green"
        elif avg_loss <= 15:
            status_text = "‚ö†Ô∏è –Ñ –Ω–µ–≤–µ–ª–∏–∫—ñ –ø—Ä–æ–±–ª–µ–º–∏"
            color = "orange"
        else:
            status_text = "‚ùå –°–µ—Ä–π–æ–∑–Ω—ñ –ø—Ä–æ–±–ª–µ–º–∏"
            color = "red"

        # –í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ –≤ Telegram
        test_report = "\n".join(report_parts)
        self.telegram.send_network_report(store_location, pc_name, test_report)

        return {
            "status": status_text,
            "color": color,
            "details": test_report
        }


================================================================================
–§–∞–π–ª 12/21: src\rdp_manager.py
--------------------------------------------------------------------------------
import os
import subprocess
import time
import winreg
import logging
import keyring
from pathlib import Path

logger = logging.getLogger(__name__)


class RDPManager:
    """–ú–µ–Ω–µ–¥–∂–µ—Ä –¥–ª—è RDP –ø—ñ–¥–∫–ª—é—á–µ–Ω—å –∑ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–º –ª–æ–≥—ñ–Ω–æ–º"""

    def __init__(self, config_manager, telegram_api):
        self.config = config_manager
        self.telegram = telegram_api

    def save_credentials(self, host, username, password):
        """–ó–±–µ—Ä–µ–≥—Ç–∏ RDP –¥–∞–Ω—ñ –≤ Windows Credential Manager"""
        try:
            keyring.set_password(f"RDP_{host}", username, password)
            self.config.set("rdp_password", password)
            logger.info(f"‚úÖ –î–∞–Ω—ñ –∑–±–µ—Ä–µ–∂–µ–Ω—ñ –¥–ª—è {host}")
            return True
        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è: {e}")
            return False

    def get_credentials(self, host, username):
        """–û—Ç—Ä–∏–º–∞—Ç–∏ –ø–∞—Ä–æ–ª—å –∑ Credential Manager"""
        try:
            password = keyring.get_password(f"RDP_{host}", username)
            return password
        except:
            return None

    def connect_rdp(self, host, port, username, password=None):
        """–ü—ñ–¥–∫–ª—é—á–∏—Ç–∏—Å—è –¥–æ RDP"""
        try:
            # –ö–æ–¥—É–≤–∞–Ω–Ω—è –ø–∞—Ä–æ–ª—è –¥–ª—è .RDP —Ñ–∞–π–ª—É
            encrypted_password = self._encrypt_rdp_password(password) if password else ""

            rdp_content = f"""screen mode id:i:2
use multimon:i:0
desktopwidth:i:1920
desktopheight:i:1080
session bpp:i:32
connection type:i:7
disable wallpaper:i:0
allow font smoothing:i:1
allow desktop composition:i:1
disable full window drag:i:0
disable menu anims:i:0
disable themes:i:0
disable cursor setting:i:0
bitmapcachepersistenable:i:1
full address:s:{host}:{port}
audiomode:i:0
redirectprinters:i:0
redirectcomports:i:0
redirectsmartcards:i:0
redirectclipboard:i:1
redirectposdevices:i:0
autoreconnection enabled:i:1
authentication level:i:0
prompt for credentials on client:i:0
negotiate security layer:i:1
enablecredsspsupport:i:1
username:s:{username}
password 51:b:{encrypted_password}
"""

            rdp_file = f"{host}_{username}_session.rdp"
            with open(rdp_file, "w") as f:
                f.write(rdp_content)

            subprocess.Popen(f"mstsc {rdp_file}")
            logger.info(f"‚úÖ RDP –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –∑–∞–ø—É—â–µ–Ω–æ")

            # –í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ –≤ Telegram
#            self.telegram.send_rdp_info(
#                self.config.store_location_text,
#                os.environ.get('COMPUTERNAME', 'Unknown')
#            )

            return True
        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è: {e}")
            return False

    def _encrypt_rdp_password(self, password):
        """–ü—Ä–æ—Å—Ç–æ–µ —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è –ø–∞—Ä–æ–ª—è –¥–ª—è .RDP"""
        encrypted = ""
        for char in password:
            encrypted += format(ord(char) ^ 0xAA, '02x')
        return encrypted


================================================================================
–§–∞–π–ª 13/21: src\set_anydesk_password.py
--------------------------------------------------------------------------------
#!/usr/bin/env python3
"""–í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –ø–∞—Ä–æ–ª—è AnyDesk –∑ –∞–¥–º—ñ–Ω –ø—Ä–∞–≤–∞–º–∏"""

import subprocess
import sys
import os
import time
import ctypes

ANYDESK_PATH = sys.argv[1] if len(sys.argv) > 1 else None
PASSWORD = os.getenv("ANYDESK_PASSWORD", "r3moteh4nd")

if not ANYDESK_PATH or not os.path.exists(ANYDESK_PATH):
    print("[!] AnyDesk –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ")
    sys.exit(1)

# –ü–µ—Ä–µ–≤—ñ—Ä–∏–º–æ —á–∏ –∑–∞–ø—É—â–µ–Ω–æ –∑ –∞–¥–º—ñ–Ω –ø—Ä–∞–≤–∞–º–∏
try:
    is_admin = ctypes.windll.shell32.IsUserAnAdmin()
    if not is_admin:
        print("[!] –ü–æ—Ç—Ä—ñ–±–Ω—ñ –∞–¥–º—ñ–Ω –ø—Ä–∞–≤–∞")
        # –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–∏ –∑ –∞–¥–º—ñ–Ω –ø—Ä–∞–≤–∞–º–∏
        ctypes.windll.shell32.ShellExecuteW(
            None,
            "runas",
            sys.executable,
            f'"{__file__}" "{ANYDESK_PATH}"',
            None,
            1  # SW_SHOW
        )
        sys.exit(0)
except:
    pass

try:
    print(f"[*] –í—Å—Ç–∞–Ω–æ–≤–ª—é—é –ø–∞—Ä–æ–ª—å AnyDesk (—É –∞–¥–º—ñ–Ω—ñ)...")
    time.sleep(1)

    # –í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ —á–µ—Ä–µ–∑ stdin
    cmd = [ANYDESK_PATH, "--set-password", "_full_access"]

    result = subprocess.run(
        cmd,
        input=PASSWORD + "\n",
        capture_output=True,
        text=True,
        timeout=10
    )

    print(f"[CODE] {result.returncode}")
    if result.returncode in [0, 8000]:
        print("[‚úì] –ü–∞—Ä–æ–ª—å –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ!")
    else:
        print(f"[!] –ö–æ–¥: {result.returncode}")

    sys.exit(0)

except Exception as e:
    print(f"[!] –ü–æ–º–∏–ª–∫–∞: {e}")
    sys.exit(1)


================================================================================
–§–∞–π–ª 14/21: src\setup_wizard.py
--------------------------------------------------------------------------------
import customtkinter as ctk
import tkinter.messagebox as messagebox


class SetupWizard(ctk.CTkToplevel):
    def __init__(self, parent, on_complete):
        super().__init__(parent)

        self.title("RemoteHand - –ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞")
        self.geometry("450x500")
        self.resizable(False, False)

        # –¶–µ–Ω—Ç—Ä—É–≤–∞—Ç–∏ –Ω–∞ –µ–∫—Ä–∞–Ω—ñ
        self.transient(parent)
        self.grab_set()

        # ‚ö†Ô∏è –ó–ê–ë–û–†–û–ù–ò–¢–ò –ó–ê–ö–†–ò–¢–¢–Ø –ë–ï–ó –ó–ë–ï–†–ï–ñ–ï–ù–ù–Ø
        self.protocol("WM_DELETE_WINDOW", self.on_closing)

        self.on_complete = on_complete
        self.setup_complete = False

        # –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç–µ–º–∏
        ctk.set_appearance_mode("light")
        ctk.set_default_color_theme("blue")

        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        title = ctk.CTkLabel(
            self,
            text="–ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞",
            font=ctk.CTkFont(size=18, weight="bold")
        )
        title.pack(pady=20)

        # ===== –ú–ê–ì–ê–ó–ò–ù (–í–´–ë–Ü–†) =====
        ctk.CTkLabel(
            self,
            text="–í–∏–±–µ—Ä—ñ—Ç—å –º–∞–≥–∞–∑–∏–Ω:",
            font=ctk.CTkFont(size=12, weight="bold")
        ).pack(anchor="w", padx=20, pady=(10, 5))

        self.store_var = ctk.StringVar(value="")
        store_options = [
            "0 / –û—Ñ—ñ—Å",
            "1 / –î—ñ–∞–ª–æ–≥",
            "5 / –ü–æ–ª—Ç–∞–≤–∞",
            "7 / –û–∞–∑–∏—Å",
            "8 / –•–º–µ–ª—å–Ω–∏—Ü—å–∫–∏–π",
            "9 / –ß–µ—Ä–Ω—ñ–≤—Ü—ñ",
            "17 / –ö—Ä–µ–º–µ–Ω—á—É–∫",
            "18 / –ü_–ö–æ—Ç–ª—è—Ä–µ–≤—Å—å–∫–æ–≥–æ",
            "20 / –©–∞—Å–ª–∏–≤–∏–π",
            "21 / –°–æ—Ñ—ñ—è –º–æ–ª–ª"
        ]

        self.store_menu = ctk.CTkComboBox(
            self,
            values=store_options,
            variable=self.store_var,
            font=ctk.CTkFont(size=11),
            height=35
        )
        self.store_menu.pack(padx=20, fill="x", pady=(0, 20))

        # ===== –õ–û–ö–ê–¶–Ü–Ø (–í–´–ë–Ü–†) =====
        ctk.CTkLabel(
            self,
            text="–í–∏–±–µ—Ä—ñ—Ç—å –ª–æ–∫–∞—Ü—ñ—é:",
            font=ctk.CTkFont(size=12, weight="bold")
        ).pack(anchor="w", padx=20, pady=(10, 5))

        self.location_var = ctk.StringVar(value="")
        location_options = [
            "–∫–∞—Å–∞",
            "–∫–∞—Å–∞ 2",
            "–ø—ñ–¥—Å–æ–±–∫–∞",
            "–æ—Å–æ–±–∏—Å—Ç–∏–π"
        ]

        self.location_menu = ctk.CTkComboBox(
            self,
            values=location_options,
            variable=self.location_var,
            font=ctk.CTkFont(size=11),
            height=35
        )
        self.location_menu.pack(padx=20, fill="x", pady=(0, 20))

        # ===== –ü–Ü–ë (–û–ü–¶–Ü–ô–ù–û) =====
        ctk.CTkLabel(
            self,
            text="–ü–Ü–ë –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ (–æ–ø—Ü—ñ–π–Ω–æ):",
            font=ctk.CTkFont(size=12, weight="bold")
        ).pack(anchor="w", padx=20, pady=(10, 5))

        self.user_name_entry = ctk.CTkEntry(
            self,
            placeholder_text="–ù–∞–ø—Ä–∏–∫–ª–∞–¥: –Ü–≤–∞–Ω –ü–µ—Ç—Ä–µ–Ω–∫–æ",
            height=35,
            font=ctk.CTkFont(size=11)
        )
        self.user_name_entry.pack(padx=20, fill="x", pady=(0, 30))

        # –ö–Ω–æ–ø–∫–∞
        btn = ctk.CTkButton(
            self,
            text="‚úÖ –ó–±–µ—Ä–µ–≥—Ç–∏",
            command=self.save_settings,
            height=45,
            font=ctk.CTkFont(size=12, weight="bold"),
            corner_radius=10
        )
        btn.pack(padx=20, fill="x", pady=10)

    def on_closing(self):
        """–ó–∞–±–æ—Ä–æ–Ω–∏—Ç–∏ –∑–∞–∫—Ä–∏—Ç—Ç—è –±–µ–∑ –≤–≤–µ–¥–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö"""
        if not self.setup_complete:
            messagebox.showwarning(
                "–ü–æ–º–∏–ª–∫–∞",
                "–í–∏–±–µ—Ä—ñ—Ç—å –º–∞–≥–∞–∑–∏–Ω —ñ –ª–æ–∫–∞—Ü—ñ—é –ø–µ—Ä–µ–¥ –∑–∞–∫—Ä–∏—Ç—Ç—è–º!"
            )
            return
        self.destroy()

    def save_settings(self):
        """–ó–±–µ—Ä–µ–≥—Ç–∏ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è - –æ–±–æ–≤'—è–∑–∫–æ–≤–æ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏"""
        store = self.store_var.get().strip()
        location = self.location_var.get().strip()
        user_name = self.user_name_entry.get().strip()

        # ‚ö†Ô∏è –û–ë–û–í'–Ø–ó–ö–û–í–ê –ü–ï–†–ï–í–Ü–†–ö–ê
        if not store:
            messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–í–∏–±–µ—Ä—ñ—Ç—å –º–∞–≥–∞–∑–∏–Ω!")
            return

        if not location:
            messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–í–∏–±–µ—Ä—ñ—Ç—å –ª–æ–∫–∞—Ü—ñ—é!")
            return

        # –í—Å–µ –æ–∫ - –∑–±–µ—Ä–µ–∂–µ–º–æ
        self.setup_complete = True
        self.on_complete({
            "store": store,
            "location": location,
            "user_name": user_name
        })
        self.destroy()


================================================================================
–§–∞–π–ª 15/21: src\telegram_api.py
--------------------------------------------------------------------------------
import requests
import logging
import time
import os
from pathlib import Path

logger = logging.getLogger(__name__)


class TelegramAPI:
    """–†–æ–∑—à–∏—Ä–µ–Ω–∞ Telegram API –¥–ª—è –∑–≤—ñ—Ç—É–≤–∞–Ω–Ω—è"""

    def __init__(self, token, chat_id):
        self.token = token
        self.chat_id = chat_id

        # ‚ö†Ô∏è –ü–ï–†–ï–í–Ü–†–ê –¢–û–ö–ï–ù–Ü–í
        if not token:
            logger.error("‚ùå Telegram —Ç–æ–∫–µ–Ω –Ω–µ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ!")
            self.api_url = None
        elif not chat_id:
            logger.error("‚ùå Telegram chat_id –Ω–µ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ!")
            self.api_url = None
        else:
            self.api_url = f"https://api.telegram.org/bot{token}"
            logger.info(f"‚úÖ Telegram –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–æ (—Ç–æ–∫–µ–Ω: {token[:20]}...)")

    def send_message(self, text, parse_mode="HTML"):
        """–í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ —Ç–µ–∫—Å—Ç–æ–≤–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è"""
        if not self.api_url:
            logger.error("‚ùå Telegram –Ω–µ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–æ")
            return False

        try:
            payload = {
                "chat_id": self.chat_id,
                "text": text,
                "parse_mode": parse_mode
            }
            response = requests.post(
                f"{self.api_url}/sendMessage",
                json=payload,
                timeout=10
            )
            response.raise_for_status()
            logger.info("‚úÖ –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –Ω–∞–¥—ñ—Å–ª–∞–Ω–æ –≤ Telegram")
            return True
        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞ –≤—ñ–¥–ø—Ä–∞–≤–∫–∏ Telegram: {e}")
            return False

    def send_file(self, file_path, caption="", file_type="document"):
        """–í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ —Ñ–∞–π–ª (document –∞–±–æ photo)"""
        if not self.api_url:
            logger.error("‚ùå Telegram –Ω–µ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–æ")
            return False

        try:
            with open(file_path, 'rb') as f:
                files = {file_type: f}
                payload = {
                    "chat_id": self.chat_id,
                    "caption": caption,
                    "parse_mode": "HTML"
                }
                endpoint = "sendDocument" if file_type == "document" else "sendPhoto"
                response = requests.post(
                    f"{self.api_url}/{endpoint}",
                    files=files,
                    data=payload,
                    timeout=30
                )
                response.raise_for_status()
            logger.info(f"‚úÖ –§–∞–π–ª –Ω–∞–¥—ñ—Å–ª–∞–Ω–æ –≤ Telegram")
            return True
        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞ –≤—ñ–¥–ø—Ä–∞–≤–∫–∏ —Ñ–∞–π–ª—É: {e}")
            return False

    def send_network_report(self, store_location, pc_name, test_results):
        """–í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ –∑–≤—ñ—Ç –ø—Ä–æ —Å—Ç–∞–Ω –º–µ—Ä–µ–∂—ñ"""
        report = (
            f"<b>üìä –ó–≤—ñ—Ç –ø—Ä–æ —Å—Ç–∞–Ω –º–µ—Ä–µ–∂—ñ</b>\n\n"
            f"<b>–ú–∞–≥–∞–∑–∏–Ω/–õ–æ–∫–∞—Ü—ñ—è:</b> {store_location}\n"
            f"<b>–ü–ö:</b> <code>{pc_name}</code>\n"
            f"<b>–ß–∞—Å:</b> {time.strftime('%Y-%m-%d %H:%M:%S')}\n\n"
            f"<b>–†–µ–∑—É–ª—å—Ç–∞—Ç–∏:</b>\n"
            f"{test_results}"
        )
        return self.send_message(report)

    def send_anydesk_info(self, store_location, user_name, pc_name, anydesk_id, password):
        """–í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ AnyDesk —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é"""

        # –î–æ–¥–∞—Ç–∏ –ü–Ü–ë —è–∫—â–æ —î
        user_info = f"\n<b>üë§ –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á:</b> {user_name}" if user_name else ""

        message = (
            f"<b>üåê AnyDesk - –ó–∞–ø—Ä–æ—Å –Ω–∞ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è</b>\n\n"
            f"<b>üìç –ú–∞–≥–∞–∑–∏–Ω/–õ–æ–∫–∞—Ü—ñ—è:</b> {store_location}{user_info}\n"
            f"<b>üíª –ü–ö:</b> <code>{pc_name}</code>\n\n"
            f"<b>üÜî ID:</b> <code>{anydesk_id}</code>\n"
            f"<b>üîê –ü–∞—Ä–æ–ª—å:</b> <code>{password}</code>"
        )
        return self.send_message(message)

    def send_rdp_info(self, store_location, pc_name):
        """–í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è –ø—Ä–æ RDP –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è"""
        message = (
            f"<b>üñ•Ô∏è RDP –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è</b>\n\n"
            f"<b>–ú–∞–≥–∞–∑–∏–Ω/–õ–æ–∫–∞—Ü—ñ—è:</b> {store_location}\n"
            f"<b>–ü–ö:</b> <code>{pc_name}</code>\n"
            f"<b>–ß–∞—Å:</b> {time.strftime('%Y-%m-%d %H:%M:%S')}\n\n"
            f"‚úÖ –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –ø—ñ–¥–∫–ª—é—á–∏–≤—Å—è –¥–æ 1–°"
        )
        return self.send_message(message)

    def send_error_report(self, store_location, pc_name, error_text):
        """–í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ –∑–≤—ñ—Ç –ø—Ä–æ –ø–æ–º–∏–ª–∫—É"""
        message = (
            f"<b>‚ùå –ü–æ–º–∏–ª–∫–∞</b>\n\n"
            f"<b>–ú–∞–≥–∞–∑–∏–Ω/–õ–æ–∫–∞—Ü—ñ—è:</b> {store_location}\n"
            f"<b>–ü–ö:</b> <code>{pc_name}</code>\n"
            f"<b>–ß–∞—Å:</b> {time.strftime('%Y-%m-%d %H:%M:%S')}\n\n"
            f"<b>–î–µ—Ç–∞–ª—ñ:</b>\n<code>{error_text}</code>"
        )
        return self.send_message(message)


================================================================================
–§–∞–π–ª 16/21: src\telegram_helper.py
--------------------------------------------------------------------------------
import asyncio
import json
import logging
from telegram import Bot

logger = logging.getLogger(__name__)


class TelegramHelper:
    """–î–æ–ø–æ–º—ñ–∂–Ω–∏–∫ –¥–ª—è –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å –≤ Telegram"""

    def __init__(self, config_path="bot_config.json"):
        self.config_path = config_path
        self.config = self.load_config()

    def load_config(self):
        """–ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –∫–æ–Ω—Ñ—ñ–≥"""
        try:
            with open(self.config_path, "r", encoding="utf-8") as f:
                return json.load(f)
        except:
            return {}

    async def send_anydesk_code(self, anydesk_id, password):
        """–í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ AnyDesk –¥–∞–Ω—ñ –≤ Telegram"""
        try:
            token = self.config.get("TELEGRAM_TOKEN")
            chat_id = self.config.get("CHAT_ID")

            if not token or not chat_id:
                logger.error("‚ùå –ù–µ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ñ TELEGRAM_TOKEN –∞–±–æ CHAT_ID")
                return False

            bot = Bot(token=token)

            message = (
                f"üñ•Ô∏è **AnyDesk —Å–µ—Å—ñ—è –∞–∫—Ç–∏–≤–æ–≤–∞–Ω–∞**\n\n"
                f"üÜî ID: `{anydesk_id}`\n"
                f"üîê –ü–∞—Ä–æ–ª—å: `{password}`\n\n"
                f"–î–ª—è –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ —Ü—ñ –¥–∞–Ω—ñ."
            )

            await bot.send_message(
                chat_id=chat_id,
                text=message,
                parse_mode="Markdown"
            )

            logger.info("‚úÖ –î–∞–Ω—ñ –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω—ñ –≤ Telegram")
            return True

        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞ –≤—ñ–¥–ø—Ä–∞–≤–∫–∏: {e}")
            return False

    async def send_message(self, text):
        """–í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ –¥–æ–≤—ñ–ª—å–Ω–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è"""
        try:
            token = self.config.get("TELEGRAM_TOKEN")
            chat_id = self.config.get("CHAT_ID")

            if not token or not chat_id:
                return False

            bot = Bot(token=token)
            await bot.send_message(chat_id=chat_id, text=text)

            return True

        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞: {e}")
            return False

    def send_anydesk_code_sync(self, anydesk_id, password):
        """–°–∏–Ω—Ö—Ä–æ–Ω–Ω–∞ –≤–µ—Ä—Å—ñ—è (–¥–ª—è GUI)"""
        try:
            loop = asyncio.new_event_loop()
            asyncio.set_event_loop(loop)
            result = loop.run_until_complete(
                self.send_anydesk_code(anydesk_id, password)
            )
            loop.close()
            return result
        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞: {e}")
            return False


================================================================================
–§–∞–π–ª 17/21: src\updater.py
--------------------------------------------------------------------------------
import os
import sys
import requests
import subprocess
import time
import logging
from pathlib import Path

logger = logging.getLogger(__name__)


class UpdaterManager:
    """–ú–µ–Ω–µ–¥–∂–µ—Ä –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ —Ç–∞ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –æ–Ω–æ–≤–ª–µ–Ω—å"""

    GITHUB_REPO = "ShevchukVI/RemoteHand"
    GITHUB_API_URL = f"https://api.github.com/repos/{GITHUB_REPO}/releases/latest"

    def __init__(self):
        self.app_dir = Path(__file__).parent.parent
        self.version_file = self.app_dir / "version.txt"
        self.current_version = self.get_current_version()

    def get_current_version(self):
        """–û—Ç—Ä–∏–º–∞—Ç–∏ –ø–æ—Ç–æ—á–Ω—É –≤–µ—Ä—Å—ñ—é"""
        if self.version_file.exists():
            try:
                with open(self.version_file, 'r', encoding='utf-8') as f:
                    return f.read().strip()
            except:
                pass
        return "1.0.0"

    def get_latest_version(self):
        """–û—Ç—Ä–∏–º–∞—Ç–∏ –Ω–∞–π–Ω–æ–≤—ñ—à—É –≤–µ—Ä—Å—ñ—é –∑ GitHub"""
        try:
            response = requests.get(self.GITHUB_API_URL, timeout=10)
            response.raise_for_status()
            data = response.json()
            tag = data.get('tag_name', 'v1.0.0')
            return tag.lstrip('v')
        except Exception as e:
            logger.warning(f"–ù–µ –≤–¥–∞–ª–æ—Å—è –æ—Ç—Ä–∏–º–∞—Ç–∏ –≤–µ—Ä—Å—ñ—é –∑ GitHub: {e}")
            return None

    def compare_versions(self, current, latest):
        """–ü–æ—Ä—ñ–≤–Ω—è—Ç–∏ –≤–µ—Ä—Å—ñ—ó"""
        try:
            current_parts = [int(x) for x in current.split('.')]
            latest_parts = [int(x) for x in latest.split('.')]
            return latest_parts > current_parts
        except:
            return False

    def download_and_update(self, latest_version):
        """–ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —Ç–∞ –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –Ω–æ–≤—É –≤–µ—Ä—Å—ñ—é"""
        try:
            logger.info(f"üì• –ó–∞–≤–∞–Ω—Ç–∞–∂—É—é RemoteHand v{latest_version}...")

            download_url = f"https://github.com/{self.GITHUB_REPO}/releases/download/v{latest_version}/RemoteHand.exe"

            # –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –Ω–æ–≤—É –≤–µ—Ä—Å—ñ—é
            response = requests.get(download_url, timeout=30)
            response.raise_for_status()

            # –í–∏–∑–Ω–∞—á–∏—Ç–∏ —à–ª—è—Ö –¥–ª—è –Ω–æ–≤–æ—ó –≤–µ—Ä—Å—ñ—ó
            if getattr(sys, 'frozen', False):
                # –Ø–∫—â–æ –∑–∞–ø—É—â–µ–Ω–æ —è–∫ EXE
                current_exe = Path(sys.executable)
                new_exe = current_exe.parent / "RemoteHand_new.exe"
            else:
                # –Ø–∫—â–æ –∑–∞–ø—É—â–µ–Ω–æ —è–∫ Python —Å–∫—Ä–∏–ø—Ç (DEV)
                new_exe = Path.cwd() / "RemoteHand_new.exe"

            # –ó–±–µ—Ä–µ–≥—Ç–∏ –Ω–æ–≤—É –≤–µ—Ä—Å—ñ—é
            with open(new_exe, 'wb') as f:
                f.write(response.content)

            logger.info(f"‚úÖ RemoteHand v{latest_version} –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ")
            return str(new_exe)

        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è: {e}")
            return None

    def check_and_update(self):
        """–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —Ç–∞ –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è"""
        # –ù–ï –æ–Ω–æ–≤–ª—é–≤–∞—Ç–∏ –≤ DEV —Ä–µ–∂–∏–º—ñ!
        if os.getenv('REMOTEHAND_DEV_MODE') == '1':
            logger.info("üîß DEV —Ä–µ–∂–∏–º - –ø—Ä–æ–ø—É—Å–∫–∞—î–º–æ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è")
            return False

        logger.info("üîç –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –æ–Ω–æ–≤–ª–µ–Ω—å...")

        latest_version = self.get_latest_version()
        if not latest_version:
            logger.info("‚ö†Ô∏è –ù–µ –≤–¥–∞–ª–æ—Å—è –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è")
            return False

        if self.compare_versions(self.current_version, latest_version):
            logger.info(f"üì¶ –î–æ—Å—Ç—É–ø–Ω–µ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è: {latest_version}")
            logger.info(f"üìå –ü–æ—Ç–æ—á–Ω–∞ –≤–µ—Ä—Å—ñ—è: {self.current_version}")

            # –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –Ω–æ–≤—É –≤–µ—Ä—Å—ñ—é
            new_exe = self.download_and_update(latest_version)

            if new_exe and os.path.exists(new_exe):
                logger.info(f"‚úÖ –ù–æ–≤–∞ –≤–µ—Ä—Å—ñ—è –≥–æ—Ç–æ–≤–∞!")
                logger.info(f"üîÑ –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫...")

                # ‚ö†Ô∏è –ê–í–¢–û–ú–ê–¢–ò–ß–ù–ò–ô –ü–ï–†–ï–ó–ê–ü–£–°–ö
                try:
                    # –ó–∞–ø—É—Å—Ç–∏—Ç–∏ –Ω–æ–≤—É –≤–µ—Ä—Å—ñ—é
                    subprocess.Popen([new_exe], shell=False)

                    # –ß–µ–∫–∞—Ç–∏ 1 —Å–µ–∫—É–Ω–¥—É
                    time.sleep(1)

                    # –ó–∞–∫—Ä–∏—Ç–∏ –ø–æ—Ç–æ—á–Ω—É –≤–µ—Ä—Å—ñ—é
                    logger.info("üëã –ó–∞–≤–µ—Ä—à–µ–Ω–Ω—è —Ä–æ–±–æ—Ç–∏ —Å—Ç–∞—Ä–æ—ó –≤–µ—Ä—Å—ñ—ó")
                    sys.exit(0)

                except Exception as e:
                    logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫—É: {e}")
                    logger.info(f"–ó–∞–ø—É—Å—Ç—ñ—Ç—å –≤—Ä—É—á–Ω—É: {new_exe}")
                    return False

                return True

        logger.info(f"‚úÖ –í–µ—Ä—Å—ñ—è –∞–∫—Ç—É–∞–ª—å–Ω–∞: {self.current_version}")
        return False


def check_and_update():
    """–§—É–Ω–∫—Ü—ñ—è –¥–ª—è —ñ–º–ø–æ—Ä—Ç—É –≤ main.py"""
    updater = UpdaterManager()
    return updater.check_and_update()


================================================================================
–§–∞–π–ª 18/21: src\utils.py
--------------------------------------------------------------------------------
import os
import sys
import subprocess
import psutil
from pathlib import Path
from config import LOCK_FILE, APP_NAME


class SingleInstance:
    """–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –Ω–∞ —î–¥–∏–Ω–∏–π –µ–∫–∑–µ–º–ø–ª—è—Ä –ø—Ä–æ–≥—Ä–∞–º–∏"""

    def __init__(self):
        self.lock_file = LOCK_FILE
        self.fp = None

    def is_running(self):
        """–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —á–∏ –ø—Ä–æ–≥—Ä–∞–º–∞ –≤–∂–µ –∑–∞–ø—É—â–µ–Ω–∞"""
        if sys.platform == 'win32':
            import win32event
            import win32api
            import winerror

            self.mutex = win32event.CreateMutex(None, False, APP_NAME)
            if win32api.GetLastError() == winerror.ERROR_ALREADY_EXISTS:
                return True
        else:
            try:
                self.fp = open(self.lock_file, 'w')
                import fcntl
                fcntl.flock(self.fp, fcntl.LOCK_EX | fcntl.LOCK_NB)
            except IOError:
                return True
        return False


def open_rdp_connection(host, port):
    """–í—ñ–¥–∫—Ä–∏—Ç—Ç—è RDP –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è"""
    rdp_command = f'mstsc /v:{host}:{port}'
    subprocess.Popen(rdp_command, shell=True)


def close_all_rdp_sessions():
    """–ó–∞–∫—Ä–∏—Ç—Ç—è –≤—Å—ñ—Ö RDP —Å–µ—Å—ñ–π"""
    for proc in psutil.process_iter(['name']):
        try:
            if proc.info['name'].lower() == 'mstsc.exe':
                proc.kill()
        except (psutil.NoSuchProcess, psutil.AccessDenied):
            pass


def test_connection(host):
    """–¢–µ—Å—Ç –∑'—î–¥–Ω–∞–Ω–Ω—è —á–µ—Ä–µ–∑ ping"""
    param = '-n' if sys.platform == 'win32' else '-c'
    command = ['ping', param, '1', host]
    result = subprocess.run(command, capture_output=True, text=True)
    return result.returncode == 0

================================================================================
–§–∞–π–ª 19/21: version.txt
--------------------------------------------------------------------------------
—è—é1 . 0 . 4 
 
 

================================================================================
–§–∞–π–ª 20/21: version_info.txt
--------------------------------------------------------------------------------
VSVersionInfo(
  ffi=FixedFileInfo(mask=0x3f,
    mask_values=[(0, 63), (0, 63), (0, 63), (0, 63)],
    CV_VSVersionInfo=[(0, '0'), (0, '3'), (0, '0'), (0, '0')]),
  StringFileInfo([(u'040904B0',
    StringTable(u'040904B0',
      [StringEntry(u'CompanyName', u'RemoteHand'),
       StringEntry(u'FileDescription', u'RemoteHand - RDP & AnyDesk Manager'),
       StringEntry(u'FileVersion', u'1.0.3.0'),
       StringEntry(u'ProductName', u'RemoteHand'),
       StringEntry(u'ProductVersion', u'1.0.3')]))]),
  VarFileInfo([VarEntry(u'Translation', [1033, 1200])])
)


================================================================================
–§–∞–π–ª 21/21: –ê–∫—Ç–∏–≤–∞—Ü—ñ—è —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞.txt
--------------------------------------------------------------------------------
.venvScriptsActivate.ps1

================================================================================
–ö–Ü–ù–ï–¶–¨ –ï–ö–°–ü–û–†–¢–£
================================================================================


================================================================================
–§–∞–π–ª 5/21: project_export_20251110_151306.txt
--------------------------------------------------------------------------------
================================================================================
–ï–ö–°–ü–û–†–¢ –ü–†–û–Ñ–ö–¢–£: RemoteHand
–î–∞—Ç–∞: 2025-11-10 15:13:06
–®–ª—è—Ö: D:\Python Projects\Prego\RemoteHand
================================================================================

üìÇ –°–¢–†–£–ö–¢–£–†–ê –ü–†–û–Ñ–ö–¢–£
--------------------------------------------------------------------------------
RemoteHand/
‚îú‚îÄ‚îÄ assets/
‚îÇ   ‚îî‚îÄ‚îÄ icon.ico
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ anydesk_manager.py
‚îÇ   ‚îú‚îÄ‚îÄ config.py
‚îÇ   ‚îú‚îÄ‚îÄ config_manager.py
‚îÇ   ‚îú‚îÄ‚îÄ main.py
‚îÇ   ‚îú‚îÄ‚îÄ network_test.py
‚îÇ   ‚îú‚îÄ‚îÄ rdp_manager.py
‚îÇ   ‚îú‚îÄ‚îÄ setup_wizard.py
‚îÇ   ‚îú‚îÄ‚îÄ telegram_api.py
‚îÇ   ‚îú‚îÄ‚îÄ updater.py
‚îÇ   ‚îî‚îÄ‚îÄ utils.py
‚îú‚îÄ‚îÄ .env.example
‚îú‚îÄ‚îÄ 23.88.7.196_admin_session.rdp
‚îú‚îÄ‚îÄ dev_run.py
‚îú‚îÄ‚îÄ export.py
‚îú‚îÄ‚îÄ GitCommitTool.py
‚îú‚îÄ‚îÄ project_export_20251110_104446.txt
‚îú‚îÄ‚îÄ project_export_20251110_151306.txt
‚îú‚îÄ‚îÄ README.md
‚îú‚îÄ‚îÄ RemoteHand.spec
‚îú‚îÄ‚îÄ requirements.txt
‚îú‚îÄ‚îÄ version.txt
‚îú‚îÄ‚îÄ version_info.txt
‚îî‚îÄ‚îÄ –ê–∫—Ç–∏–≤–∞—Ü—ñ—è —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞.txt

üìÑ –í–ú–Ü–°–¢ –§–ê–ô–õ–Ü–í (20 —Ñ–∞–π–ª—ñ–≤)
================================================================================


================================================================================
–§–∞–π–ª 1/20: dev_run.py
--------------------------------------------------------------------------------
"""
DEV_RUN.PY - –õ–æ–∫–∞–ª—å–Ω–µ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è
"""

import sys
import os

# –í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ DEV —Ä–µ–∂–∏–º
os.environ['REMOTEHAND_DEV_MODE'] = '1'

# –î–æ–¥–∞—Ç–∏ src –≤ path
sys.path.insert(0, os.path.join(os.path.dirname(__file__), 'src'))

print("–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π...")
import subprocess
subprocess.run([sys.executable, "-m", "pip", "install", "-r", "requirements.txt", "-q"],
               capture_output=True)

print("üîß –ó–∞–ø—É—Å–∫ —É DEV —Ä–µ–∂–∏–º—ñ...")

# –ü—Ä—è–º–æ –∑–∞–ø—É—Å—Ç–∏—Ç–∏ main
if __name__ == "__main__":
    import main
    main.main()


================================================================================
–§–∞–π–ª 2/20: export.py
--------------------------------------------------------------------------------
#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Project Structure Exporter
–°—Ç–≤–æ—Ä—é—î –¥–µ—Ç–∞–ª—å–Ω–∏–π –æ–ø–∏—Å —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ –ø—Ä–æ—î–∫—Ç—É —Ç–∞ –≤–º—ñ—Å—Ç —Ñ–∞–π–ª—ñ–≤ —É –æ–¥–∏–Ω —Ñ–∞–π–ª
"""

import os
from pathlib import Path
from datetime import datetime

# –§–∞–π–ª–∏ —Ç–∞ –ø–∞–ø–∫–∏, —è–∫—ñ —Ç—Ä–µ–±–∞ —ñ–≥–Ω–æ—Ä—É–≤–∞—Ç–∏
IGNORE_PATTERNS = {
    # –ü–∞–ø–∫–∏
    '__pycache__', '.git', '.idea', '.vscode', 'node_modules',
    'venv', 'env', '.env', 'dist', 'build', '.pytest_cache',
    '.mypy_cache', 'htmlcov', '.coverage', 'logs', 'tmp',
    # –§–∞–π–ª–∏
    '.pyc', '.pyo', '.pyd', '.so', '.dll', '.dylib', '.exe',
    '.log', '.sqlite', '.db', '.pkl', '.pickle', '.DS_Store',
    'Thumbs.db', '.env', '.env.local', '.gitignore'
}

# –†–æ–∑—à–∏—Ä–µ–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤ –¥–ª—è —á–∏—Ç–∞–Ω–Ω—è (—Ç–µ–∫—Å—Ç–æ–≤—ñ —Ñ–∞–π–ª–∏)
TEXT_EXTENSIONS = {
    '.py', '.js', '.ts', '.jsx', '.tsx', '.html', '.css', '.scss',
    '.json', '.yaml', '.yml', '.toml', '.ini', '.cfg', '.conf',
    '.txt', '.md', '.rst', '.xml', '.sql', '.sh', '.bash',
    '.env.example', '.gitignore', 'Dockerfile', 'Makefile',
    '.java', '.c', '.cpp', '.h', '.go', '.rs', '.php', '.rb'
}

# –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∏–π —Ä–æ–∑–º—ñ—Ä —Ñ–∞–π–ª—É (1 MB)
MAX_FILE_SIZE = 1024 * 1024


def should_ignore(path: Path) -> bool:
    """–ü–µ—Ä–µ–≤—ñ—Ä—è—î, —á–∏ —Ç—Ä–µ–±–∞ —ñ–≥–Ω–æ—Ä—É–≤–∞—Ç–∏ —Ñ–∞–π–ª/–ø–∞–ø–∫—É"""
    name = path.name

    # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ç–æ—á–Ω–æ–≥–æ –∑–±—ñ–≥—É
    if name in IGNORE_PATTERNS:
        return True

    # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è
    if path.suffix in IGNORE_PATTERNS:
        return True

    # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø—Ä–∏—Ö–æ–≤–∞–Ω–∏—Ö —Ñ–∞–π–ª—ñ–≤ (–∫—Ä—ñ–º .env.example)
    if name.startswith('.') and name != '.env.example':
        return True

    return False


def is_text_file(path: Path) -> bool:
    """–ü–µ—Ä–µ–≤—ñ—Ä—è—î, —á–∏ —î —Ñ–∞–π–ª —Ç–µ–∫—Å—Ç–æ–≤–∏–º"""
    # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è
    if path.suffix.lower() in TEXT_EXTENSIONS:
        return True

    # –§–∞–π–ª–∏ –±–µ–∑ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è, —è–∫—ñ –∑–∞–∑–≤–∏—á–∞–π —Ç–µ–∫—Å—Ç–æ–≤—ñ
    if path.suffix == '' and path.name in {'Dockerfile', 'Makefile', 'README', 'LICENSE'}:
        return True

    return False


def get_tree_structure(root_path: Path, prefix: str = "", is_last: bool = True) -> list:
    """–ì–µ–Ω–µ—Ä—É—î –¥–µ—Ä–µ–≤–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ –ø—Ä–æ—î–∫—Ç—É"""
    lines = []

    try:
        items = sorted(root_path.iterdir(), key=lambda x: (not x.is_dir(), x.name.lower()))
        items = [item for item in items if not should_ignore(item)]

        for i, item in enumerate(items):
            is_last_item = i == len(items) - 1
            current_prefix = "‚îî‚îÄ‚îÄ " if is_last_item else "‚îú‚îÄ‚îÄ "
            lines.append(f"{prefix}{current_prefix}{item.name}{'/' if item.is_dir() else ''}")

            if item.is_dir():
                extension = "    " if is_last_item else "‚îÇ   "
                lines.extend(get_tree_structure(item, prefix + extension, is_last_item))

    except PermissionError:
        pass

    return lines


def read_file_content(file_path: Path) -> str:
    """–ß–∏—Ç–∞—î –≤–º—ñ—Å—Ç —Ñ–∞–π–ª—É"""
    try:
        # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ä–æ–∑–º—ñ—Ä—É
        if file_path.stat().st_size > MAX_FILE_SIZE:
            return f"[–§–∞–π–ª –∑–∞–Ω–∞–¥—Ç–æ –≤–µ–ª–∏–∫–∏–π: {file_path.stat().st_size / 1024:.1f} KB]"

        # –°–ø—Ä–æ–±–∞ –ø—Ä–æ—á–∏—Ç–∞—Ç–∏ —è–∫ —Ç–µ–∫—Å—Ç
        with open(file_path, 'r', encoding='utf-8') as f:
            return f.read()
    except UnicodeDecodeError:
        # –Ø–∫—â–æ –Ω–µ –≤–¥–∞–ª–æ—Å—è –ø—Ä–æ—á–∏—Ç–∞—Ç–∏ —è–∫ UTF-8
        try:
            with open(file_path, 'r', encoding='cp1251') as f:
                return f.read()
        except:
            return "[–ù–µ –≤–¥–∞–ª–æ—Å—è –ø—Ä–æ—á–∏—Ç–∞—Ç–∏ —Ñ–∞–π–ª - –±—ñ–Ω–∞—Ä–Ω–∏–π –∞–±–æ –Ω–µ–≤—ñ–¥–æ–º–µ –∫–æ–¥—É–≤–∞–Ω–Ω—è]"
    except Exception as e:
        return f"[–ü–æ–º–∏–ª–∫–∞ —á–∏—Ç–∞–Ω–Ω—è: {str(e)}]"


def collect_files(root_path: Path) -> list:
    """–ó–±–∏—Ä–∞—î –≤—Å—ñ —Ç–µ–∫—Å—Ç–æ–≤—ñ —Ñ–∞–π–ª–∏ –ø—Ä–æ—î–∫—Ç—É"""
    files = []

    for item in root_path.rglob('*'):
        if item.is_file() and not should_ignore(item) and is_text_file(item):
            # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞, —â–æ –≤—Å—ñ –±–∞—Ç—å–∫—ñ–≤—Å—å–∫—ñ –ø–∞–ø–∫–∏ –Ω–µ —ñ–≥–Ω–æ—Ä—É—é—Ç—å—Å—è
            if not any(should_ignore(parent) for parent in item.parents):
                files.append(item)

    return sorted(files)


def generate_project_export(project_path: str, output_file: str = None):
    """–ì–µ–Ω–µ—Ä—É—î –ø–æ–≤–Ω–∏–π –µ–∫—Å–ø–æ—Ä—Ç –ø—Ä–æ—î–∫—Ç—É"""
    root = Path(project_path).resolve()

    if not root.exists():
        print(f"‚ùå –ü–æ–º–∏–ª–∫–∞: –®–ª—è—Ö '{project_path}' –Ω–µ —ñ—Å–Ω—É—î!")
        return

    if output_file is None:
        timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
        output_file = f"project_export_{timestamp}.txt"

    print(f"üìÅ –ê–Ω–∞–ª—ñ–∑ –ø—Ä–æ—î–∫—Ç—É: {root.name}")
    print(f"üìù –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –µ–∫—Å–ø–æ—Ä—Ç—É...")

    with open(output_file, 'w', encoding='utf-8') as f:
        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        f.write("=" * 80 + "\n")
        f.write(f"–ï–ö–°–ü–û–†–¢ –ü–†–û–Ñ–ö–¢–£: {root.name}\n")
        f.write(f"–î–∞—Ç–∞: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}\n")
        f.write(f"–®–ª—è—Ö: {root}\n")
        f.write("=" * 80 + "\n\n")

        # –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ—î–∫—Ç—É
        f.write("üìÇ –°–¢–†–£–ö–¢–£–†–ê –ü–†–û–Ñ–ö–¢–£\n")
        f.write("-" * 80 + "\n")
        f.write(f"{root.name}/\n")
        tree_lines = get_tree_structure(root)
        f.write("\n".join(tree_lines))
        f.write("\n\n")

        # –ó–±—ñ—Ä —Ñ–∞–π–ª—ñ–≤
        files = collect_files(root)

        f.write(f"üìÑ –í–ú–Ü–°–¢ –§–ê–ô–õ–Ü–í ({len(files)} —Ñ–∞–π–ª—ñ–≤)\n")
        f.write("=" * 80 + "\n\n")

        # –í–º—ñ—Å—Ç –∫–æ–∂–Ω–æ–≥–æ —Ñ–∞–π–ª—É
        for i, file_path in enumerate(files, 1):
            relative_path = file_path.relative_to(root)

            print(f"  [{i}/{len(files)}] {relative_path}")

            f.write("\n" + "=" * 80 + "\n")
            f.write(f"–§–∞–π–ª {i}/{len(files)}: {relative_path}\n")
            f.write("-" * 80 + "\n")

            content = read_file_content(file_path)
            f.write(content)
            f.write("\n")

        # –ü—ñ–¥—Å—É–º–æ–∫
        f.write("\n" + "=" * 80 + "\n")
        f.write("–ö–Ü–ù–ï–¶–¨ –ï–ö–°–ü–û–†–¢–£\n")
        f.write("=" * 80 + "\n")

    file_size = Path(output_file).stat().st_size
    print(f"\n‚úÖ –ï–∫—Å–ø–æ—Ä—Ç –∑–∞–≤–µ—Ä—à–µ–Ω–æ!")
    print(f"üìÑ –§–∞–π–ª: {output_file}")
    print(f"üìä –†–æ–∑–º—ñ—Ä: {file_size / 1024:.1f} KB")
    print(f"üìÅ –§–∞–π–ª—ñ–≤ –æ–±—Ä–æ–±–ª–µ–Ω–æ: {len(files)}")


if __name__ == "__main__":
    import sys

    # –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è: python export_project.py [—à–ª—è—Ö_–¥–æ_–ø—Ä–æ—î–∫—Ç—É] [–≤–∏—Ö—ñ–¥–Ω–∏–π_—Ñ–∞–π–ª]
    project_path = sys.argv[1] if len(sys.argv) > 1 else "."
    output_file = sys.argv[2] if len(sys.argv) > 2 else None

    generate_project_export(project_path, output_file)


================================================================================
–§–∞–π–ª 3/20: GitCommitTool.py
--------------------------------------------------------------------------------
import customtkinter as ctk
from tkinter import messagebox, scrolledtext
import subprocess
import os
import re
from pathlib import Path
from datetime import datetime
from packaging.version import parse as parse_version


class GitCommitTool(ctk.CTk):
    def __init__(self):
        super().__init__()

        self.title("Git Commit Tool")
        self.geometry("600x750")
        self.resizable(False, False)
        self.is_running = False  # –ü—Ä–∞–ø–æ—Ä–µ—Ü—å –¥–ª—è –±–ª–æ–∫—É–≤–∞–Ω–Ω—è UI

        # –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç–µ–º–∏
        ctk.set_appearance_mode("dark")  # –ó–º—ñ–Ω–µ–Ω–æ –Ω–∞ —Ç–µ–º–Ω—É
        ctk.set_default_color_theme("blue")

        # –û—Ç—Ä–∏–º–∞–Ω–Ω—è –ø–æ—Ç–æ—á–Ω–æ—ó –≤–µ—Ä—Å—ñ—ó
        self.current_version = self.get_current_version()

        # –°–ø–∏—Å–æ–∫ –µ–ª–µ–º–µ–Ω—Ç—ñ–≤ UI –¥–ª—è –±–ª–æ–∫—É–≤–∞–Ω–Ω—è
        self.interactive_widgets = []

        self.setup_ui()
        self.toggle_version_fields()  # –ü–æ—á–∞—Ç–∫–æ–≤–µ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —Å—Ç–∞–Ω—É UI

    def setup_ui(self):
        """(–û–ù–û–í–õ–ï–ù–û) –°—Ç–≤–æ—Ä–µ–Ω–Ω—è UI"""

        main_frame = ctk.CTkFrame(self, fg_color="transparent")
        main_frame.pack(fill="both", expand=True, padx=20, pady=15)

        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        title_label = ctk.CTkLabel(
            main_frame,
            text="Git Commit Tool",
            font=ctk.CTkFont(size=24, weight="bold")
        )
        title_label.pack(pady=10)

        # –ü–æ—Ç–æ—á–Ω–∞ –≤–µ—Ä—Å—ñ—è
        version_frame = ctk.CTkFrame(main_frame)
        version_frame.pack(pady=10, fill="x")

        ctk.CTkLabel(
            version_frame,
            text="–ü–æ—Ç–æ—á–Ω–∞ –≤–µ—Ä—Å—ñ—è:",
            font=ctk.CTkFont(size=12, weight="bold")
        ).pack(side="left", padx=(10, 0))

        self.current_version_label = ctk.CTkLabel(
            version_frame,
            text=f"v{self.current_version}",
            font=ctk.CTkFont(size=12),
            text_color="gray"
        )
        self.current_version_label.pack(side="left", padx=10)

        # –ö–æ–º–µ–Ω—Ç–∞—Ä
        ctk.CTkLabel(
            main_frame,
            text="–ö–æ–º–µ–Ω—Ç–∞—Ä (commit message):",
            font=ctk.CTkFont(size=12, weight="bold")
        ).pack(anchor="w", pady=(10, 5))

        self.comment_entry = ctk.CTkEntry(
            main_frame,
            placeholder_text="–û–ø–∏—à—ñ—Ç—å –≤–∞—à—ñ –∑–º—ñ–Ω–∏...",
            height=40,
            font=ctk.CTkFont(size=11)
        )
        self.comment_entry.pack(fill="x", pady=(0, 15))
        self.interactive_widgets.append(self.comment_entry)

        # --- –ë–ª–æ–∫ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –≤–µ—Ä—Å—ñ—ó ---

        # –ß–µ–∫–±–æ–∫—Å –¥–ª—è —Ç–∞–≥—É
        self.tag_checkbox = ctk.CTkCheckBox(
            main_frame,
            text="–°—Ç–≤–æ—Ä–∏—Ç–∏ –Ω–æ–≤–∏–π —Ç–µ–≥ –≤–µ—Ä—Å—ñ—ó",
            font=ctk.CTkFont(size=11),
            command=self.toggle_version_fields
        )
        self.tag_checkbox.pack(anchor="w", pady=(0, 10))
        self.tag_checkbox.select()
        self.interactive_widgets.append(self.tag_checkbox)

        # –ù–æ–≤–∞ –≤–µ—Ä—Å—ñ—è
        self.version_frame_new = ctk.CTkFrame(main_frame)
        self.version_frame_new.pack(fill="x", pady=(0, 15))

        ctk.CTkLabel(
            self.version_frame_new,
            text="–ù–æ–≤–∞ –≤–µ—Ä—Å—ñ—è (–¥–ª—è —Ç–∞–≥—É):",
            font=ctk.CTkFont(size=12, weight="bold")
        ).pack(anchor="w", pady=(0, 5), padx=10)

        version_entry_frame = ctk.CTkFrame(self.version_frame_new, fg_color="transparent")
        version_entry_frame.pack(fill="x", padx=10)

        ctk.CTkLabel(
            version_entry_frame,
            text="v",
            font=ctk.CTkFont(size=11)
        ).pack(side="left", padx=(0, 5))

        self.version_entry = ctk.CTkEntry(
            version_entry_frame,
            placeholder_text="1.1.0",
            height=35,
            font=ctk.CTkFont(size=11)
        )
        self.version_entry.pack(side="left", fill="x", expand=True)
        self.version_entry.insert(0, self.current_version)  # –ü–æ–ø–µ—Ä–µ–¥–Ω—å–æ –∑–∞–ø–æ–≤–Ω—é—î–º–æ
        self.interactive_widgets.append(self.version_entry)

        # (–ù–û–í–ï) –ö–Ω–æ–ø–∫–∏ –¥–ª—è "–±–∞–º–ø—É" –≤–µ—Ä—Å—ñ—ó
        self.bump_button_frame = ctk.CTkFrame(self.version_frame_new, fg_color="transparent")
        self.bump_button_frame.pack(fill="x", padx=10, pady=10)

        bump_patch_btn = ctk.CTkButton(
            self.bump_button_frame, text="Patch (+0.0.1)",
            command=lambda: self.bump_version('patch'),
            font=ctk.CTkFont(size=10, weight="bold"), height=25
        )
        bump_patch_btn.pack(side="left", fill="x", expand=True, padx=2)

        bump_minor_btn = ctk.CTkButton(
            self.bump_button_frame, text="Minor (+0.1.0)",
            command=lambda: self.bump_version('minor'),
            font=ctk.CTkFont(size=10, weight="bold"), height=25
        )
        bump_minor_btn.pack(side="left", fill="x", expand=True, padx=2)

        bump_major_btn = ctk.CTkButton(
            self.bump_button_frame, text="Major (+1.0.0)",
            command=lambda: self.bump_version('major'),
            font=ctk.CTkFont(size=10, weight="bold"), height=25
        )
        bump_major_btn.pack(side="left", fill="x", expand=True, padx=2)

        self.interactive_widgets.extend([bump_patch_btn, bump_minor_btn, bump_major_btn])

        # –ö–Ω–æ–ø–∫–∏
        button_frame = ctk.CTkFrame(main_frame, fg_color="transparent")
        button_frame.pack(fill="x", pady=(0, 15))

        self.commit_btn = ctk.CTkButton(
            button_frame,
            text="‚úÖ Commit & Push",
            command=self.commit_and_push_thread,
            font=ctk.CTkFont(size=12, weight="bold"),
            height=45,
            corner_radius=10
        )
        self.commit_btn.pack(side="left", fill="both", expand=True, padx=(0, 5))
        self.interactive_widgets.append(self.commit_btn)

        clear_btn = ctk.CTkButton(
            button_frame,
            text="üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç–∏",
            command=self.clear_fields,
            font=ctk.CTkFont(size=12),
            height=45,
            corner_radius=10,
            fg_color="gray30",
            hover_color="gray50"
        )
        clear_btn.pack(side="left", fill="both", expand=True, padx=(5, 0))
        self.interactive_widgets.append(clear_btn)

        # –õ–æ–≥–∏
        ctk.CTkLabel(
            main_frame,
            text="–õ–æ–≥–∏ –æ–ø–µ—Ä–∞—Ü—ñ–π:",
            font=ctk.CTkFont(size=11, weight="bold")
        ).pack(anchor="w", pady=(10, 5))

        log_frame = ctk.CTkFrame(main_frame, fg_color="transparent")
        log_frame.pack(fill="both", expand=True)

        self.log_text = scrolledtext.ScrolledText(
            log_frame,
            height=10,
            width=70,
            font=("Courier", 10),
            bg="#2B2B2B",  # –¢–µ–º–Ω–∏–π —Ñ–æ–Ω
            fg="#E0E0E0",  # –°–≤—ñ—Ç–ª–∏–π —Ç–µ–∫—Å—Ç
            relief="solid",
            borderwidth=1,
            bd=0
        )
        self.log_text.pack(fill="both", expand=True)
        # (–ù–û–í–ï) –¢–µ–≥–∏ –¥–ª—è –∫–æ–ª—å–æ—Ä—ñ–≤
        self.log_text.tag_config("info", foreground="#89CFF0")
        self.log_text.tag_config("success", foreground="#7FFF7F")
        self.log_text.tag_config("error", foreground="#FF6B6B")
        self.log_text.tag_config("warning", foreground="#FFA500")

        # –°—Ç–∞—Ç—É—Å
        self.status_label = ctk.CTkLabel(
            main_frame,
            text="–ì–æ—Ç–æ–≤–æ –¥–æ —Ä–æ–±–æ—Ç–∏",
            font=ctk.CTkFont(size=10),
            text_color="gray"
        )
        self.status_label.pack(pady=(10, 0))

    def get_current_version(self):
        """–û—Ç—Ä–∏–º–∞–Ω–Ω—è –ø–æ—Ç–æ—á–Ω–æ—ó –≤–µ—Ä—Å—ñ—ó –∑ version.txt"""
        try:
            with open("version.txt", "r") as f:
                version = f.read().strip()
                # (–ù–û–í–ï) –í–∞–ª—ñ–¥–∞—Ü—ñ—è –≤–µ—Ä—Å—ñ—ó
                if re.match(r"^\d+\.\d+\.\d+$", version):
                    return version
                else:
                    return "1.0.0"  # Fallback
        except:
            return "1.0.0"

    def toggle_version_fields(self):
        """(–ù–û–í–ï) –í–º–∏–∫–∞—î/–≤–∏–º–∏–∫–∞—î –±–ª–æ–∫ –≤–µ—Ä—Å—ñ—ó"""
        is_enabled = self.tag_checkbox.get()
        state = "normal" if is_enabled else "disabled"

        self.version_entry.configure(state=state)
        for btn in self.bump_button_frame.winfo_children():
            btn.configure(state=state)

        # (–ù–û–í–ï) –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –ø—Ä–æ–ø–æ–Ω—É—î–º–æ patch-bump
        if is_enabled:
            self.bump_version('patch', auto_fill=True)

    def bump_version(self, part="patch", auto_fill=False):
        """(–ù–û–í–ï) –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∑–±—ñ–ª—å—à—É—î –≤–µ—Ä—Å—ñ—é"""
        try:
            current_v = parse_version(self.get_current_version())
            parts = list(current_v.release)

            if part == 'major':
                parts[0] += 1
                parts[1] = 0
                parts[2] = 0
            elif part == 'minor':
                parts[1] += 1
                parts[2] = 0
            else:  # patch
                parts[2] += 1

            new_version = f"{parts[0]}.{parts[1]}.{parts[2]}"

            if not auto_fill or self.version_entry.get() != new_version:
                self.version_entry.delete(0, "end")
                self.version_entry.insert(0, new_version)

        except Exception as e:
            self.log_message(f"‚ùå –ü–æ–º–∏–ª–∫–∞ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –≤–µ—Ä—Å—ñ—ó: {str(e)}", "error")

    def log_message(self, message, tag="info"):
        """(–û–ù–û–í–õ–ï–ù–û) –î–æ–¥–∞–Ω–Ω—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –¥–æ –ª–æ–≥—ñ–≤ –∑ —Ç–µ–≥–æ–º"""
        timestamp = datetime.now().strftime("%H:%M:%S")
        self.log_text.configure(state="normal")
        self.log_text.insert("end", f"[{timestamp}] {message}\n", tag)
        self.log_text.configure(state="disabled")
        self.log_text.see("end")
        self.update_idletasks()

    def set_ui_state(self, is_enabled):
        """(–ù–û–í–ï) –í–º–∏–∫–∞—î/–≤–∏–º–∏–∫–∞—î –≤–µ—Å—å UI"""
        state = "normal" if is_enabled else "disabled"
        for widget in self.interactive_widgets:
            widget.configure(state=state)
        self.is_running = not is_enabled
        if is_enabled:
            self.toggle_version_fields()  # –ü–æ–≤–µ—Ä—Ç–∞—î–º–æ –∫–æ—Ä–µ–∫—Ç–Ω–∏–π —Å—Ç–∞–Ω –ø–æ–ª—ñ–≤ –≤–µ—Ä—Å—ñ—ó

    def run_git_command(self, command, log_output=True):
        """(–û–ù–û–í–õ–ï–ù–û) –í–∏–∫–æ–Ω–∞–Ω–Ω—è git –∫–æ–º–∞–Ω–¥–∏, –ø–æ–≤–µ—Ä—Ç–∞—î (success, output)"""
        self.log_message(f"$ {command}", "info")
        try:
            result = subprocess.run(
                command,
                shell=True,
                capture_output=True,
                text=True,
                encoding='utf-8',  # –í—Å—Ç–∞–Ω–æ–≤–ª—é—î–º–æ –∫–æ–¥—É–≤–∞–Ω–Ω—è
                cwd=os.getcwd()
            )

            if result.returncode == 0:
                if result.stdout and log_output:
                    self.log_message(f"{result.stdout.strip()}", "success")
                return True, result.stdout.strip()
            else:
                error_msg = result.stderr.strip() if result.stderr else "–ù–µ–≤—ñ–¥–æ–º–∞ –ø–æ–º–∏–ª–∫–∞"
                if log_output:
                    self.log_message(f"‚ùå –ü–æ–º–∏–ª–∫–∞: {error_msg}", "error")
                return False, error_msg
        except Exception as e:
            self.log_message(f"‚ùå –í–∏–Ω—è—Ç–æ–∫: {str(e)}", "error")
            return False, str(e)

    def get_current_branch(self):
        """(–ù–û–í–ï) –û—Ç—Ä–∏–º—É—î –ø–æ—Ç–æ—á–Ω—É –≥—ñ–ª–∫—É git"""
        success, output = self.run_git_command("git rev-parse --abbrev-ref HEAD", log_output=False)
        if success:
            return output
        return "main"  # Fallback

    def commit_and_push_thread(self):
        """(–ù–û–í–ï) –ó–∞–ø—É—Å–∫–∞—î –ø—Ä–æ—Ü–µ—Å –≤ –æ–∫—Ä–µ–º–æ–º—É –ø–æ—Ç–æ—Ü—ñ, —â–æ–± UI –Ω–µ "–∑–∞–≤–∏—Å–∞–≤" """
        if self.is_running:
            self.log_message("‚è≥ –û–ø–µ—Ä–∞—Ü—ñ—è –≤–∂–µ –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è...", "warning")
            return

        # –ó–∞–ø—É—Å–∫–∞—î–º–æ –≤ –æ–∫—Ä–µ–º–æ–º—É –ø–æ—Ç–æ—Ü—ñ
        import threading
        threading.Thread(target=self.commit_and_push, daemon=True).start()

    def commit_and_push(self):
        """(–û–ù–û–í–õ–ï–ù–û) –û—Å–Ω–æ–≤–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è - commit, tag —ñ push"""

        self.set_ui_state(False)
        self.status_label.configure(text="‚è≥ –û–±—Ä–æ–±–∫–∞...")

        try:
            comment = self.comment_entry.get().strip()
            new_version = self.version_entry.get().strip()
            create_tag = self.tag_checkbox.get()

            # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∏
            if not comment:
                messagebox.showwarning("–ü–æ–º–∏–ª–∫–∞", "–ù–∞–ø–∏—à—ñ—Ç—å –∫–æ–º–µ–Ω—Ç–∞—Ä –¥–æ –∫–æ–º—ñ—Ç—é!")
                self.log_message("‚ùå –ö–æ–º–µ–Ω—Ç–∞—Ä –Ω–µ –º–æ–∂–µ –±—É—Ç–∏ –ø–æ—Ä–æ–∂–Ω—ñ–º", "error")
                return

            if create_tag and not new_version:
                messagebox.showwarning("–ü–æ–º–∏–ª–∫–∞", "–ù–∞–ø–∏—à—ñ—Ç—å –Ω–æ–≤—É –≤–µ—Ä—Å—ñ—é –¥–ª—è —Ç–∞–≥—É!")
                self.log_message("‚ùå –ù–æ–º–µ—Ä –≤–µ—Ä—Å—ñ—ó –Ω–µ –º–æ–∂–µ –±—É—Ç–∏ –ø–æ—Ä–æ–∂–Ω—ñ–º", "error")
                return

            self.log_message("=" * 50, "info")
            self.log_message("üöÄ –†–æ–∑–ø–æ—á–∏–Ω–∞—î–º–æ commit & push –ø—Ä–æ—Ü–µ—Å...", "info")
            self.log_message("=" * 50, "info")

            # –ö—Ä–æ–∫ 1: –û—Ç—Ä–∏–º–∞–Ω–Ω—è –ø–æ—Ç–æ—á–Ω–æ—ó –≥—ñ–ª–∫–∏
            self.log_message("\nüìã –ö—Ä–æ–∫ 1: –í–∏–∑–Ω–∞—á–µ–Ω–Ω—è –ø–æ—Ç–æ—á–Ω–æ—ó –≥—ñ–ª–∫–∏...", "info")
            current_branch = self.get_current_branch()
            self.log_message(f"–ü–æ—Ç–æ—á–Ω–∞ –≥—ñ–ª–∫–∞: {current_branch}", "success")

            # –ö—Ä–æ–∫ 2: –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å—É
            self.log_message("\nüìã –ö—Ä–æ–∫ 2: –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å—É —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—é...", "info")
            success, status_output = self.run_git_command("git status --short")
            if not status_output:
                self.log_message("‚úÖ –ù–µ–º–∞—î –∑–º—ñ–Ω –¥–ª—è –∫–æ–º—ñ—Ç—É. –í—Å–µ —á–∏—Å—Ç–æ!", "success")
                self.status_label.configure(text="‚úÖ –ù–µ–º–∞—î –∑–º—ñ–Ω")
                return

            # –ö—Ä–æ–∫ 3: –î–æ–¥–∞–≤–∞–Ω–Ω—è –≤—Å—ñ—Ö —Ñ–∞–π–ª—ñ–≤
            self.log_message("\nüì¶ –ö—Ä–æ–∫ 3: –î–æ–¥–∞–≤–∞–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤ (git add .)...", "info")
            if not self.run_git_command("git add .")[0]:
                self.status_label.configure(text="‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ 'git add'")
                messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–ù–µ –≤–¥–∞–ª–æ—Å—è –¥–æ–¥–∞—Ç–∏ —Ñ–∞–π–ª–∏!")
                return

            # –ö—Ä–æ–∫ 4: –ö–æ–º—ñ—Ç
            self.log_message("\nüíæ –ö—Ä–æ–∫ 4: –ö–æ–º—ñ—Ç—É–≤–∞–Ω–Ω—è –∑–º—ñ–Ω...", "info")
            if not self.run_git_command(f'git commit -m "{comment}"')[0]:
                self.status_label.configure(text="‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –∫–æ–º—ñ—Ç—É–≤–∞–Ω–Ω—ñ")
                # (–º–æ–∂–ª–∏–≤–æ, –Ω–µ –±—É–ª–æ –∑–º—ñ–Ω)
                return

            # –ö—Ä–æ–∫ 5: Push
            self.log_message(f"\n‚¨ÜÔ∏è  –ö—Ä–æ–∫ 5: –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –Ω–∞ GitHub (git push origin {current_branch})...", "info")
            if not self.run_git_command(f"git push origin {current_branch}")[0]:
                self.status_label.configure(text="‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ 'git push'")
                messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–ù–µ –≤–¥–∞–ª–æ—Å—è –≤—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ –Ω–∞ GitHub!")
                return

            # –ö—Ä–æ–∫ 6: –¢–µ–≥ (—è–∫—â–æ –ø–æ—Ç—Ä—ñ–±–µ–Ω)
            if create_tag:
                self.log_message(f"\nüè∑Ô∏è  –ö—Ä–æ–∫ 6: –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–∞–≥—É v{new_version}...", "info")
                if not self.run_git_command(f"git tag v{new_version}")[0]:
                    self.status_label.configure(text="‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—ñ —Ç–∞–≥—É")
                    messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–ù–µ –≤–¥–∞–ª–æ—Å—è —Å—Ç–≤–æ—Ä–∏—Ç–∏ —Ç–µ–≥! –ú–æ–∂–ª–∏–≤–æ, –≤—ñ–Ω –≤–∂–µ —ñ—Å–Ω—É—î.")
                    return

                self.log_message(f"\n‚¨ÜÔ∏è  –ö—Ä–æ–∫ 7: –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ç–∞–≥—É –Ω–∞ GitHub...", "info")
                if not self.run_git_command(f"git push origin v{new_version}")[0]:
                    self.status_label.configure(text="‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ 'git push' —Ç–∞–≥—É")
                    messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–ù–µ –≤–¥–∞–ª–æ—Å—è –≤—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ —Ç–µ–≥!")
                    return

                # –û–Ω–æ–≤–ª–µ–Ω–Ω—è version.txt
                self.log_message("\nüìù –ö—Ä–æ–∫ 8: –û–Ω–æ–≤–ª–µ–Ω–Ω—è version.txt...", "info")
                try:
                    with open("version.txt", "w") as f:
                        f.write(new_version)
                    self.log_message("‚úÖ version.txt –æ–Ω–æ–≤–ª–µ–Ω–æ", "success")
                    self.current_version = new_version
                    self.current_version_label.configure(text=f"v{self.current_version}")
                except Exception as e:
                    self.log_message(f"‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –æ–Ω–æ–≤–ª–µ–Ω–Ω—ñ version.txt: {str(e)}", "error")

            self.log_message("\n" + "=" * 50, "success")
            self.log_message("‚úÖ –í–°–ï –£–°–ü–Ü–®–ù–û! GitHub Actions –ø–æ—á–Ω–µ –∫–æ–º–ø—ñ–ª—é–≤–∞—Ç–∏...", "success")
            self.log_message("=" * 50, "success")

            self.status_label.configure(text="‚úÖ –£—Å–ø—ñ—à–Ω–æ! GitHub Actions –∑–∞–ø—É—â–µ–Ω–æ")
            messagebox.showinfo(
                "–£—Å–ø—ñ—Ö",
                f"‚úÖ –ö–æ–º—ñ—Ç —É—Å–ø—ñ—à–Ω–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ!\n\n"
                f"–ö–æ–º–µ–Ω—Ç–∞—Ä: {comment}\n"
                + (f"–í–µ—Ä—Å—ñ—è: v{new_version}\n\nGitHub Actions –ø–æ—á–Ω–µ –∫–æ–º–ø—ñ–ª—é–≤–∞—Ç–∏ EXE..." if create_tag else "")
            )

            self.clear_fields()

        finally:
            # (–ù–û–í–ï) –ó–∞–≤–∂–¥–∏ –≤–º–∏–∫–∞—î–º–æ UI –Ω–∞–∑–∞–¥, –Ω–∞–≤—ñ—Ç—å —è–∫—â–æ –±—É–ª–∞ –ø–æ–º–∏–ª–∫–∞
            self.set_ui_state(True)
            if '–ü–æ–º–∏–ª–∫–∞' not in self.status_label.cget("text"):
                self.status_label.configure(text="–ì–æ—Ç–æ–≤–æ –¥–æ —Ä–æ–±–æ—Ç–∏")

    def clear_fields(self):
        """–û—á–∏—Å—Ç–∫–∞ –ø–æ–ª—ñ–≤"""
        self.comment_entry.delete(0, "end")
        self.version_entry.delete(0, "end")
        self.tag_checkbox.select()
        self.toggle_version_fields()  # –û–Ω–æ–≤–ª—é—î–º–æ —Å—Ç–∞–Ω –ø–æ–ª—ñ–≤ –≤–µ—Ä—Å—ñ—ó
        self.status_label.configure(text="–ì–æ—Ç–æ–≤–æ –¥–æ —Ä–æ–±–æ—Ç–∏")


def main():
    app = GitCommitTool()
    app.mainloop()


if __name__ == "__main__":
    main()

================================================================================
–§–∞–π–ª 4/20: project_export_20251110_104446.txt
--------------------------------------------------------------------------------
================================================================================
–ï–ö–°–ü–û–†–¢ –ü–†–û–Ñ–ö–¢–£: RemoteHand
–î–∞—Ç–∞: 2025-11-10 10:44:46
–®–ª—è—Ö: D:\Python Projects\Prego\RemoteHand
================================================================================

üìÇ –°–¢–†–£–ö–¢–£–†–ê –ü–†–û–Ñ–ö–¢–£
--------------------------------------------------------------------------------
RemoteHand/
‚îú‚îÄ‚îÄ assets/
‚îÇ   ‚îî‚îÄ‚îÄ icon.ico
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ anydesk_manager.py
‚îÇ   ‚îú‚îÄ‚îÄ config.py
‚îÇ   ‚îú‚îÄ‚îÄ config_manager.py
‚îÇ   ‚îú‚îÄ‚îÄ main.py
‚îÇ   ‚îú‚îÄ‚îÄ network_test.py
‚îÇ   ‚îú‚îÄ‚îÄ rdp_manager.py
‚îÇ   ‚îú‚îÄ‚îÄ set_anydesk_password.py
‚îÇ   ‚îú‚îÄ‚îÄ setup_wizard.py
‚îÇ   ‚îú‚îÄ‚îÄ telegram_api.py
‚îÇ   ‚îú‚îÄ‚îÄ telegram_helper.py
‚îÇ   ‚îú‚îÄ‚îÄ update.bat
‚îÇ   ‚îú‚îÄ‚îÄ updater.py
‚îÇ   ‚îî‚îÄ‚îÄ utils.py
‚îú‚îÄ‚îÄ .env.example
‚îú‚îÄ‚îÄ 23.88.7.196_admin_session.rdp
‚îú‚îÄ‚îÄ dev_run.py
‚îú‚îÄ‚îÄ export.py
‚îú‚îÄ‚îÄ GitCommitTool.py
‚îú‚îÄ‚îÄ project_export_20251110_104446.txt
‚îú‚îÄ‚îÄ README.md
‚îú‚îÄ‚îÄ RemoteHand.spec
‚îú‚îÄ‚îÄ requirements.txt
‚îú‚îÄ‚îÄ version.txt
‚îú‚îÄ‚îÄ version_info.txt
‚îî‚îÄ‚îÄ –ê–∫—Ç–∏–≤–∞—Ü—ñ—è —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞.txt

üìÑ –í–ú–Ü–°–¢ –§–ê–ô–õ–Ü–í (21 —Ñ–∞–π–ª—ñ–≤)
================================================================================


================================================================================
–§–∞–π–ª 1/21: dev_run.py
--------------------------------------------------------------------------------
"""
DEV_RUN.PY - –õ–æ–∫–∞–ª—å–Ω–µ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è
"""

import sys
import os

# –í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ DEV —Ä–µ–∂–∏–º
os.environ['REMOTEHAND_DEV_MODE'] = '1'

# –î–æ–¥–∞—Ç–∏ src –≤ path
sys.path.insert(0, os.path.join(os.path.dirname(__file__), 'src'))

print("–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π...")
import subprocess
subprocess.run([sys.executable, "-m", "pip", "install", "-r", "requirements.txt", "-q"],
               capture_output=True)

print("üîß –ó–∞–ø—É—Å–∫ —É DEV —Ä–µ–∂–∏–º—ñ...")

# –ü—Ä—è–º–æ –∑–∞–ø—É—Å—Ç–∏—Ç–∏ main
if __name__ == "__main__":
    import main
    main.main()


================================================================================
–§–∞–π–ª 2/21: export.py
--------------------------------------------------------------------------------
#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Project Structure Exporter
–°—Ç–≤–æ—Ä—é—î –¥–µ—Ç–∞–ª—å–Ω–∏–π –æ–ø–∏—Å —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ –ø—Ä–æ—î–∫—Ç—É —Ç–∞ –≤–º—ñ—Å—Ç —Ñ–∞–π–ª—ñ–≤ —É –æ–¥–∏–Ω —Ñ–∞–π–ª
"""

import os
from pathlib import Path
from datetime import datetime

# –§–∞–π–ª–∏ —Ç–∞ –ø–∞–ø–∫–∏, —è–∫—ñ —Ç—Ä–µ–±–∞ —ñ–≥–Ω–æ—Ä—É–≤–∞—Ç–∏
IGNORE_PATTERNS = {
    # –ü–∞–ø–∫–∏
    '__pycache__', '.git', '.idea', '.vscode', 'node_modules',
    'venv', 'env', '.env', 'dist', 'build', '.pytest_cache',
    '.mypy_cache', 'htmlcov', '.coverage', 'logs', 'tmp',
    # –§–∞–π–ª–∏
    '.pyc', '.pyo', '.pyd', '.so', '.dll', '.dylib', '.exe',
    '.log', '.sqlite', '.db', '.pkl', '.pickle', '.DS_Store',
    'Thumbs.db', '.env', '.env.local', '.gitignore'
}

# –†–æ–∑—à–∏—Ä–µ–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤ –¥–ª—è —á–∏—Ç–∞–Ω–Ω—è (—Ç–µ–∫—Å—Ç–æ–≤—ñ —Ñ–∞–π–ª–∏)
TEXT_EXTENSIONS = {
    '.py', '.js', '.ts', '.jsx', '.tsx', '.html', '.css', '.scss',
    '.json', '.yaml', '.yml', '.toml', '.ini', '.cfg', '.conf',
    '.txt', '.md', '.rst', '.xml', '.sql', '.sh', '.bash',
    '.env.example', '.gitignore', 'Dockerfile', 'Makefile',
    '.java', '.c', '.cpp', '.h', '.go', '.rs', '.php', '.rb'
}

# –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∏–π —Ä–æ–∑–º—ñ—Ä —Ñ–∞–π–ª—É (1 MB)
MAX_FILE_SIZE = 1024 * 1024


def should_ignore(path: Path) -> bool:
    """–ü–µ—Ä–µ–≤—ñ—Ä—è—î, —á–∏ —Ç—Ä–µ–±–∞ —ñ–≥–Ω–æ—Ä—É–≤–∞—Ç–∏ —Ñ–∞–π–ª/–ø–∞–ø–∫—É"""
    name = path.name

    # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ç–æ—á–Ω–æ–≥–æ –∑–±—ñ–≥—É
    if name in IGNORE_PATTERNS:
        return True

    # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è
    if path.suffix in IGNORE_PATTERNS:
        return True

    # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø—Ä–∏—Ö–æ–≤–∞–Ω–∏—Ö —Ñ–∞–π–ª—ñ–≤ (–∫—Ä—ñ–º .env.example)
    if name.startswith('.') and name != '.env.example':
        return True

    return False


def is_text_file(path: Path) -> bool:
    """–ü–µ—Ä–µ–≤—ñ—Ä—è—î, —á–∏ —î —Ñ–∞–π–ª —Ç–µ–∫—Å—Ç–æ–≤–∏–º"""
    # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è
    if path.suffix.lower() in TEXT_EXTENSIONS:
        return True

    # –§–∞–π–ª–∏ –±–µ–∑ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è, —è–∫—ñ –∑–∞–∑–≤–∏—á–∞–π —Ç–µ–∫—Å—Ç–æ–≤—ñ
    if path.suffix == '' and path.name in {'Dockerfile', 'Makefile', 'README', 'LICENSE'}:
        return True

    return False


def get_tree_structure(root_path: Path, prefix: str = "", is_last: bool = True) -> list:
    """–ì–µ–Ω–µ—Ä—É—î –¥–µ—Ä–µ–≤–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ –ø—Ä–æ—î–∫—Ç—É"""
    lines = []

    try:
        items = sorted(root_path.iterdir(), key=lambda x: (not x.is_dir(), x.name.lower()))
        items = [item for item in items if not should_ignore(item)]

        for i, item in enumerate(items):
            is_last_item = i == len(items) - 1
            current_prefix = "‚îî‚îÄ‚îÄ " if is_last_item else "‚îú‚îÄ‚îÄ "
            lines.append(f"{prefix}{current_prefix}{item.name}{'/' if item.is_dir() else ''}")

            if item.is_dir():
                extension = "    " if is_last_item else "‚îÇ   "
                lines.extend(get_tree_structure(item, prefix + extension, is_last_item))

    except PermissionError:
        pass

    return lines


def read_file_content(file_path: Path) -> str:
    """–ß–∏—Ç–∞—î –≤–º—ñ—Å—Ç —Ñ–∞–π–ª—É"""
    try:
        # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ä–æ–∑–º—ñ—Ä—É
        if file_path.stat().st_size > MAX_FILE_SIZE:
            return f"[–§–∞–π–ª –∑–∞–Ω–∞–¥—Ç–æ –≤–µ–ª–∏–∫–∏–π: {file_path.stat().st_size / 1024:.1f} KB]"

        # –°–ø—Ä–æ–±–∞ –ø—Ä–æ—á–∏—Ç–∞—Ç–∏ —è–∫ —Ç–µ–∫—Å—Ç
        with open(file_path, 'r', encoding='utf-8') as f:
            return f.read()
    except UnicodeDecodeError:
        # –Ø–∫—â–æ –Ω–µ –≤–¥–∞–ª–æ—Å—è –ø—Ä–æ—á–∏—Ç–∞—Ç–∏ —è–∫ UTF-8
        try:
            with open(file_path, 'r', encoding='cp1251') as f:
                return f.read()
        except:
            return "[–ù–µ –≤–¥–∞–ª–æ—Å—è –ø—Ä–æ—á–∏—Ç–∞—Ç–∏ —Ñ–∞–π–ª - –±—ñ–Ω–∞—Ä–Ω–∏–π –∞–±–æ –Ω–µ–≤—ñ–¥–æ–º–µ –∫–æ–¥—É–≤–∞–Ω–Ω—è]"
    except Exception as e:
        return f"[–ü–æ–º–∏–ª–∫–∞ —á–∏—Ç–∞–Ω–Ω—è: {str(e)}]"


def collect_files(root_path: Path) -> list:
    """–ó–±–∏—Ä–∞—î –≤—Å—ñ —Ç–µ–∫—Å—Ç–æ–≤—ñ —Ñ–∞–π–ª–∏ –ø—Ä–æ—î–∫—Ç—É"""
    files = []

    for item in root_path.rglob('*'):
        if item.is_file() and not should_ignore(item) and is_text_file(item):
            # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞, —â–æ –≤—Å—ñ –±–∞—Ç—å–∫—ñ–≤—Å—å–∫—ñ –ø–∞–ø–∫–∏ –Ω–µ —ñ–≥–Ω–æ—Ä—É—é—Ç—å—Å—è
            if not any(should_ignore(parent) for parent in item.parents):
                files.append(item)

    return sorted(files)


def generate_project_export(project_path: str, output_file: str = None):
    """–ì–µ–Ω–µ—Ä—É—î –ø–æ–≤–Ω–∏–π –µ–∫—Å–ø–æ—Ä—Ç –ø—Ä–æ—î–∫—Ç—É"""
    root = Path(project_path).resolve()

    if not root.exists():
        print(f"‚ùå –ü–æ–º–∏–ª–∫–∞: –®–ª—è—Ö '{project_path}' –Ω–µ —ñ—Å–Ω—É—î!")
        return

    if output_file is None:
        timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
        output_file = f"project_export_{timestamp}.txt"

    print(f"üìÅ –ê–Ω–∞–ª—ñ–∑ –ø—Ä–æ—î–∫—Ç—É: {root.name}")
    print(f"üìù –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –µ–∫—Å–ø–æ—Ä—Ç—É...")

    with open(output_file, 'w', encoding='utf-8') as f:
        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        f.write("=" * 80 + "\n")
        f.write(f"–ï–ö–°–ü–û–†–¢ –ü–†–û–Ñ–ö–¢–£: {root.name}\n")
        f.write(f"–î–∞—Ç–∞: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}\n")
        f.write(f"–®–ª—è—Ö: {root}\n")
        f.write("=" * 80 + "\n\n")

        # –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ—î–∫—Ç—É
        f.write("üìÇ –°–¢–†–£–ö–¢–£–†–ê –ü–†–û–Ñ–ö–¢–£\n")
        f.write("-" * 80 + "\n")
        f.write(f"{root.name}/\n")
        tree_lines = get_tree_structure(root)
        f.write("\n".join(tree_lines))
        f.write("\n\n")

        # –ó–±—ñ—Ä —Ñ–∞–π–ª—ñ–≤
        files = collect_files(root)

        f.write(f"üìÑ –í–ú–Ü–°–¢ –§–ê–ô–õ–Ü–í ({len(files)} —Ñ–∞–π–ª—ñ–≤)\n")
        f.write("=" * 80 + "\n\n")

        # –í–º—ñ—Å—Ç –∫–æ–∂–Ω–æ–≥–æ —Ñ–∞–π–ª—É
        for i, file_path in enumerate(files, 1):
            relative_path = file_path.relative_to(root)

            print(f"  [{i}/{len(files)}] {relative_path}")

            f.write("\n" + "=" * 80 + "\n")
            f.write(f"–§–∞–π–ª {i}/{len(files)}: {relative_path}\n")
            f.write("-" * 80 + "\n")

            content = read_file_content(file_path)
            f.write(content)
            f.write("\n")

        # –ü—ñ–¥—Å—É–º–æ–∫
        f.write("\n" + "=" * 80 + "\n")
        f.write("–ö–Ü–ù–ï–¶–¨ –ï–ö–°–ü–û–†–¢–£\n")
        f.write("=" * 80 + "\n")

    file_size = Path(output_file).stat().st_size
    print(f"\n‚úÖ –ï–∫—Å–ø–æ—Ä—Ç –∑–∞–≤–µ—Ä—à–µ–Ω–æ!")
    print(f"üìÑ –§–∞–π–ª: {output_file}")
    print(f"üìä –†–æ–∑–º—ñ—Ä: {file_size / 1024:.1f} KB")
    print(f"üìÅ –§–∞–π–ª—ñ–≤ –æ–±—Ä–æ–±–ª–µ–Ω–æ: {len(files)}")


if __name__ == "__main__":
    import sys

    # –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è: python export_project.py [—à–ª—è—Ö_–¥–æ_–ø—Ä–æ—î–∫—Ç—É] [–≤–∏—Ö—ñ–¥–Ω–∏–π_—Ñ–∞–π–ª]
    project_path = sys.argv[1] if len(sys.argv) > 1 else "."
    output_file = sys.argv[2] if len(sys.argv) > 2 else None

    generate_project_export(project_path, output_file)


================================================================================
–§–∞–π–ª 3/21: GitCommitTool.py
--------------------------------------------------------------------------------
import customtkinter as ctk
from tkinter import messagebox, scrolledtext
import subprocess
import os
from pathlib import Path
from datetime import datetime


class GitCommitTool(ctk.CTk):
    def __init__(self):
        super().__init__()

        self.title("Git Commit Tool")
        self.geometry("600x700")
        self.resizable(False, False)

        # –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç–µ–º–∏
        ctk.set_appearance_mode("light")
        ctk.set_default_color_theme("blue")

        # –û—Ç—Ä–∏–º–∞–Ω–Ω—è –ø–æ—Ç–æ—á–Ω–æ—ó –≤–µ—Ä—Å—ñ—ó
        self.current_version = self.get_current_version()

        self.setup_ui()

    def setup_ui(self):
        """–°—Ç–≤–æ—Ä–µ–Ω–Ω—è UI"""

        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        title_label = ctk.CTkLabel(
            self,
            text="Git Commit Tool",
            font=ctk.CTkFont(size=24, weight="bold")
        )
        title_label.pack(pady=15)

        # –ü–æ—Ç–æ—á–Ω–∞ –≤–µ—Ä—Å—ñ—è
        version_frame = ctk.CTkFrame(self)
        version_frame.pack(pady=10, padx=20, fill="x")

        ctk.CTkLabel(
            version_frame,
            text="–ü–æ—Ç–æ—á–Ω–∞ –≤–µ—Ä—Å—ñ—è:",
            font=ctk.CTkFont(size=12, weight="bold")
        ).pack(side="left")

        ctk.CTkLabel(
            version_frame,
            text=f"v{self.current_version}",
            font=ctk.CTkFont(size=12),
            text_color="gray"
        ).pack(side="left", padx=10)

        # –ö–æ–º–µ–Ω—Ç–∞—Ä
        ctk.CTkLabel(
            self,
            text="–ö–æ–º–µ–Ω—Ç–∞—Ä (commit message):",
            font=ctk.CTkFont(size=12, weight="bold")
        ).pack(anchor="w", padx=20, pady=(10, 5))

        self.comment_entry = ctk.CTkEntry(
            self,
            placeholder_text="–û–ø–∏—à—ñ—Ç—å –≤–∞—à—ñ –∑–º—ñ–Ω–∏...",
            height=40,
            font=ctk.CTkFont(size=11)
        )
        self.comment_entry.pack(padx=20, fill="x", pady=(0, 15))

        # –ù–æ–≤–∞ –≤–µ—Ä—Å—ñ—è
        ctk.CTkLabel(
            self,
            text="–ù–æ–≤–∞ –≤–µ—Ä—Å—ñ—è (–¥–ª—è —Ç–∞–≥—É):",
            font=ctk.CTkFont(size=12, weight="bold")
        ).pack(anchor="w", padx=20, pady=(10, 5))

        version_frame2 = ctk.CTkFrame(self)
        version_frame2.pack(padx=20, fill="x", pady=(0, 15))

        ctk.CTkLabel(
            version_frame2,
            text="v",
            font=ctk.CTkFont(size=11)
        ).pack(side="left", padx=(0, 5))

        self.version_entry = ctk.CTkEntry(
            version_frame2,
            placeholder_text="1.1.0",
            height=35,
            font=ctk.CTkFont(size=11)
        )
        self.version_entry.pack(side="left", fill="x", expand=True)

        # –ß–µ–∫–±–æ–∫—Å –¥–ª—è —Ç–∞–≥—É
        self.tag_checkbox = ctk.CTkCheckBox(
            self,
            text="–°—Ç–≤–æ—Ä–∏—Ç–∏ —Ç–µ–≥ –≤–µ—Ä—Å—ñ—ó",
            font=ctk.CTkFont(size=11)
        )
        self.tag_checkbox.pack(anchor="w", padx=20, pady=(0, 20))
        self.tag_checkbox.select()

        # –ö–Ω–æ–ø–∫–∏
        button_frame = ctk.CTkFrame(self)
        button_frame.pack(padx=20, fill="x", pady=(0, 15))

        commit_btn = ctk.CTkButton(
            button_frame,
            text="‚úÖ Commit & Push",
            command=self.commit_and_push,
            font=ctk.CTkFont(size=12, weight="bold"),
            height=45,
            corner_radius=10
        )
        commit_btn.pack(side="left", fill="both", expand=True, padx=(0, 5))

        clear_btn = ctk.CTkButton(
            button_frame,
            text="üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç–∏",
            command=self.clear_fields,
            font=ctk.CTkFont(size=12),
            height=45,
            corner_radius=10,
            fg_color="gray30",
            hover_color="gray50"
        )
        clear_btn.pack(side="left", fill="both", expand=True, padx=(5, 0))

        # –õ–æ–≥–∏
        ctk.CTkLabel(
            self,
            text="–õ–æ–≥–∏ –æ–ø–µ—Ä–∞—Ü—ñ–π:",
            font=ctk.CTkFont(size=11, weight="bold")
        ).pack(anchor="w", padx=20, pady=(10, 5))

        self.log_text = scrolledtext.ScrolledText(
            self,
            height=10,
            width=70,
            font=("Courier", 9),
            bg="#f0f0f0",
            fg="#333333",
            relief="solid",
            borderwidth=1
        )
        self.log_text.pack(padx=20, pady=(0, 15), fill="both", expand=True)

        # –°—Ç–∞—Ç—É—Å
        self.status_label = ctk.CTkLabel(
            self,
            text="–ì–æ—Ç–æ–≤–æ –¥–æ —Ä–æ–±–æ—Ç–∏",
            font=ctk.CTkFont(size=10),
            text_color="gray"
        )
        self.status_label.pack(pady=(0, 10))

    def get_current_version(self):
        """–û—Ç—Ä–∏–º–∞–Ω–Ω—è –ø–æ—Ç–æ—á–Ω–æ—ó –≤–µ—Ä—Å—ñ—ó –∑ version.txt"""
        try:
            with open("version.txt", "r") as f:
                return f.read().strip()
        except:
            return "1.0.0"

    def log_message(self, message):
        """–î–æ–¥–∞–Ω–Ω—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –¥–æ –ª–æ–≥—ñ–≤"""
        timestamp = datetime.now().strftime("%H:%M:%S")
        self.log_text.insert("end", f"[{timestamp}] {message}\n")
        self.log_text.see("end")
        self.update()

    def run_git_command(self, command):
        """–í–∏–∫–æ–Ω–∞–Ω–Ω—è git –∫–æ–º–∞–Ω–¥–∏"""
        try:
            result = subprocess.run(
                command,
                shell=True,
                capture_output=True,
                text=True,
                cwd=os.getcwd()
            )

            if result.returncode == 0:
                if result.stdout:
                    self.log_message(f"‚úÖ {result.stdout.strip()}")
                return True
            else:
                error_msg = result.stderr.strip() if result.stderr else "–ù–µ–≤—ñ–¥–æ–º–∞ –ø–æ–º–∏–ª–∫–∞"
                self.log_message(f"‚ùå –ü–æ–º–∏–ª–∫–∞: {error_msg}")
                return False
        except Exception as e:
            self.log_message(f"‚ùå –ò—Å–∫–ª—é—á–µ–Ω–∏–µ: {str(e)}")
            return False

    def commit_and_push(self):
        """–û—Å–Ω–æ–≤–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è - commit, tag —ñ push"""

        comment = self.comment_entry.get().strip()
        new_version = self.version_entry.get().strip()
        create_tag = self.tag_checkbox.get()

        # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∏
        if not comment:
            messagebox.showwarning("–ü–æ–º–∏–ª–∫–∞", "–ù–∞–ø–∏—à—ñ—Ç—å –∫–æ–º–µ–Ω—Ç–∞—Ä –¥–æ –∫–æ–º—ñ—Ç—é!")
            return

        if create_tag and not new_version:
            messagebox.showwarning("–ü–æ–º–∏–ª–∫–∞", "–ù–∞–ø–∏—à—ñ—Ç—å –Ω–æ–≤—É –≤–µ—Ä—Å—ñ—é –¥–ª—è —Ç–∞–≥—É!")
            return

        self.status_label.configure(text="‚è≥ –û–±—Ä–æ–±–∫–∞...")
        self.update()

        self.log_message("=" * 50)
        self.log_message("üöÄ –†–æ–∑–ø–æ—á–∏–Ω–∞—î–º–æ commit & push –ø—Ä–æ—Ü–µ—Å...")
        self.log_message("=" * 50)

        # –ö—Ä–æ–∫ 1: –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å—É
        self.log_message("\nüìã –ö—Ä–æ–∫ 1: –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å—É —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—é...")
        self.run_git_command("git status --short")

        # –ö—Ä–æ–∫ 2: –î–æ–±–∞–≤–ª–µ–Ω–Ω—è –≤—Å—ñ—Ö —Ñ–∞–π–ª—ñ–≤
        self.log_message("\nüì¶ –ö—Ä–æ–∫ 2: –î–æ–¥–∞–≤–∞–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤...")
        if not self.run_git_command("git add ."):
            self.status_label.configure(text="‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –¥–æ–¥–∞–≤–∞–Ω–Ω—ñ —Ñ–∞–π–ª—ñ–≤")
            messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–ù–µ –≤–¥–∞–ª–æ—Å—è –¥–æ–¥–∞—Ç–∏ —Ñ–∞–π–ª–∏!")
            return

        # –ö—Ä–æ–∫ 3: –ö–æ–º—ñ—Ç
        self.log_message("\nüíæ –ö—Ä–æ–∫ 3: –ö–æ–º—ñ—Ç—É–≤–∞–Ω–Ω—è –∑–º—ñ–Ω...")
        if not self.run_git_command(f'git commit -m "{comment}"'):
            self.status_label.configure(text="‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –∫–æ–º—ñ—Ç—É–≤–∞–Ω–Ω—ñ")
            messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–ù–µ –≤–¥–∞–ª–æ—Å—è –∑–∞–∫–æ–º—ñ—Ç–∏—Ç–∏!")
            return

        # –ö—Ä–æ–∫ 4: Push
        self.log_message("\n‚¨ÜÔ∏è  –ö—Ä–æ–∫ 4: –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –Ω–∞ GitHub...")
        if not self.run_git_command("git push origin main"):
            self.status_label.configure(text="‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ push")
            messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–ù–µ –≤–¥–∞–ª–æ—Å—è –≤—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ –Ω–∞ GitHub!")
            return

        # –ö—Ä–æ–∫ 5: –¢–µ–≥ (—è–∫—â–æ –ø–æ—Ç—Ä—ñ–±–µ–Ω)
        if create_tag:
            self.log_message("\nüè∑Ô∏è  –ö—Ä–æ–∫ 5: –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–∞–≥—É...")
            if not self.run_git_command(f"git tag v{new_version}"):
                self.status_label.configure(text="‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—ñ —Ç–∞–≥—É")
                messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–ù–µ –≤–¥–∞–ª–æ—Å—è —Å—Ç–≤–æ—Ä–∏—Ç–∏ —Ç–µ–≥!")
                return

            self.log_message("\n‚¨ÜÔ∏è  –ö—Ä–æ–∫ 6: –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ç–∞–≥—É –Ω–∞ GitHub...")
            if not self.run_git_command(f"git push origin v{new_version}"):
                self.status_label.configure(text="‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ push —Ç–∞–≥—É")
                messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–ù–µ –≤–¥–∞–ª–æ—Å—è –≤—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ —Ç–µ–≥!")
                return

            # –û–Ω–æ–≤–ª–µ–Ω–Ω—è version.txt
            self.log_message("\nüìù –ö—Ä–æ–∫ 7: –û–Ω–æ–≤–ª–µ–Ω–Ω—è version.txt...")
            try:
                with open("version.txt", "w") as f:
                    f.write(new_version)
                self.log_message("‚úÖ version.txt –æ–Ω–æ–≤–ª–µ–Ω–æ")
                self.current_version = new_version
            except Exception as e:
                self.log_message(f"‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –æ–Ω–æ–≤–ª–µ–Ω–Ω—ñ version.txt: {str(e)}")

        self.log_message("\n" + "=" * 50)
        self.log_message("‚úÖ –í–°–ï –£–°–ü–Ü–®–ù–û! GitHub Actions –ø–æ—á–Ω–µ –∫–æ–º–ø—ñ–ª—é–≤–∞—Ç–∏...")
        self.log_message("=" * 50)

        self.status_label.configure(text="‚úÖ –£—Å–ø—ñ—à–Ω–æ! GitHub Actions –∑–∞–ø—É—â–µ–Ω–æ")
        messagebox.showinfo(
            "–£—Å–ø—ñ—Ö",
            f"‚úÖ –ö–æ–º—ñ—Ç —É—Å–ø—ñ—à–Ω–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ!\n\n"
            f"–ö–æ–º–µ–Ω—Ç–∞—Ä: {comment}\n"
            + (f"–í–µ—Ä—Å—ñ—è: v{new_version}\n\nGitHub Actions –ø–æ—á–Ω–µ –∫–æ–º–ø—ñ–ª—é–≤–∞—Ç–∏ EXE..." if create_tag else "")
        )

        self.clear_fields()

    def clear_fields(self):
        """–û—á–∏—Å—Ç–∫–∞ –ø–æ–ª—ñ–≤"""
        self.comment_entry.delete(0, "end")
        self.version_entry.delete(0, "end")
        self.tag_checkbox.select()
        self.status_label.configure(text="–ì–æ—Ç–æ–≤–æ –¥–æ —Ä–æ–±–æ—Ç–∏")


def main():
    app = GitCommitTool()
    app.mainloop()


if __name__ == "__main__":
    main()


================================================================================
–§–∞–π–ª 4/21: project_export_20251110_104446.txt
--------------------------------------------------------------------------------
================================================================================
–ï–ö–°–ü–û–†–¢ –ü–†–û–Ñ–ö–¢–£: RemoteHand
–î–∞—Ç–∞: 2025-11-10 10:44:46
–®–ª—è—Ö: D:\Python Projects\Prego\RemoteHand
================================================================================

üìÇ –°–¢–†–£–ö–¢–£–†–ê –ü–†–û–Ñ–ö–¢–£
--------------------------------------------------------------------------------
RemoteHand/
‚îú‚îÄ‚îÄ assets/
‚îÇ   ‚îî‚îÄ‚îÄ icon.ico
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ anydesk_manager.py
‚îÇ   ‚îú‚îÄ‚îÄ config.py
‚îÇ   ‚îú‚îÄ‚îÄ config_manager.py
‚îÇ   ‚îú‚îÄ‚îÄ main.py
‚îÇ   ‚îú‚îÄ‚îÄ network_test.py
‚îÇ   ‚îú‚îÄ‚îÄ rdp_manager.py
‚îÇ   ‚îú‚îÄ‚îÄ set_anydesk_password.py
‚îÇ   ‚îú‚îÄ‚îÄ setup_wizard.py
‚îÇ   ‚îú‚îÄ‚îÄ telegram_api.py
‚îÇ   ‚îú‚îÄ‚îÄ telegram_helper.py
‚îÇ   ‚îú‚îÄ‚îÄ update.bat
‚îÇ   ‚îú‚îÄ‚îÄ updater.py
‚îÇ   ‚îî‚îÄ‚îÄ utils.py
‚îú‚îÄ‚îÄ .env.example
‚îú‚îÄ‚îÄ 23.88.7.196_admin_session.rdp
‚îú‚îÄ‚îÄ dev_run.py
‚îú‚îÄ‚îÄ export.py
‚îú‚îÄ‚îÄ GitCommitTool.py
‚îú‚îÄ‚îÄ project_export_20251110_104446.txt
‚îú‚îÄ‚îÄ README.md
‚îú‚îÄ‚îÄ RemoteHand.spec
‚îú‚îÄ‚îÄ requirements.txt
‚îú‚îÄ‚îÄ version.txt
‚îú‚îÄ‚îÄ version_info.txt
‚îî‚îÄ‚îÄ –ê–∫—Ç–∏–≤–∞—Ü—ñ—è —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞.txt

üìÑ –í–ú–Ü–°–¢ –§–ê–ô–õ–Ü–í (21 —Ñ–∞–π–ª—ñ–≤)
================================================================================


================================================================================
–§–∞–π–ª 1/21: dev_run.py
--------------------------------------------------------------------------------
"""
DEV_RUN.PY - –õ–æ–∫–∞–ª—å–Ω–µ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è
"""

import sys
import os

# –í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ DEV —Ä–µ–∂–∏–º
os.environ['REMOTEHAND_DEV_MODE'] = '1'

# –î–æ–¥–∞—Ç–∏ src –≤ path
sys.path.insert(0, os.path.join(os.path.dirname(__file__), 'src'))

print("–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π...")
import subprocess
subprocess.run([sys.executable, "-m", "pip", "install", "-r", "requirements.txt", "-q"],
               capture_output=True)

print("üîß –ó–∞–ø—É—Å–∫ —É DEV —Ä–µ–∂–∏–º—ñ...")

# –ü—Ä—è–º–æ –∑–∞–ø—É—Å—Ç–∏—Ç–∏ main
if __name__ == "__main__":
    import main
    main.main()


================================================================================
–§–∞–π–ª 2/21: export.py
--------------------------------------------------------------------------------
#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Project Structure Exporter
–°—Ç–≤–æ—Ä—é—î –¥–µ—Ç–∞–ª—å–Ω–∏–π –æ–ø–∏—Å —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ –ø—Ä–æ—î–∫—Ç—É —Ç–∞ –≤–º—ñ—Å—Ç —Ñ–∞–π–ª—ñ–≤ —É –æ–¥–∏–Ω —Ñ–∞–π–ª
"""

import os
from pathlib import Path
from datetime import datetime

# –§–∞–π–ª–∏ —Ç–∞ –ø–∞–ø–∫–∏, —è–∫—ñ —Ç—Ä–µ–±–∞ —ñ–≥–Ω–æ—Ä—É–≤–∞—Ç–∏
IGNORE_PATTERNS = {
    # –ü–∞–ø–∫–∏
    '__pycache__', '.git', '.idea', '.vscode', 'node_modules',
    'venv', 'env', '.env', 'dist', 'build', '.pytest_cache',
    '.mypy_cache', 'htmlcov', '.coverage', 'logs', 'tmp',
    # –§–∞–π–ª–∏
    '.pyc', '.pyo', '.pyd', '.so', '.dll', '.dylib', '.exe',
    '.log', '.sqlite', '.db', '.pkl', '.pickle', '.DS_Store',
    'Thumbs.db', '.env', '.env.local', '.gitignore'
}

# –†–æ–∑—à–∏—Ä–µ–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤ –¥–ª—è —á–∏—Ç–∞–Ω–Ω—è (—Ç–µ–∫—Å—Ç–æ–≤—ñ —Ñ–∞–π–ª–∏)
TEXT_EXTENSIONS = {
    '.py', '.js', '.ts', '.jsx', '.tsx', '.html', '.css', '.scss',
    '.json', '.yaml', '.yml', '.toml', '.ini', '.cfg', '.conf',
    '.txt', '.md', '.rst', '.xml', '.sql', '.sh', '.bash',
    '.env.example', '.gitignore', 'Dockerfile', 'Makefile',
    '.java', '.c', '.cpp', '.h', '.go', '.rs', '.php', '.rb'
}

# –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∏–π —Ä–æ–∑–º—ñ—Ä —Ñ–∞–π–ª—É (1 MB)
MAX_FILE_SIZE = 1024 * 1024


def should_ignore(path: Path) -> bool:
    """–ü–µ—Ä–µ–≤—ñ—Ä—è—î, —á–∏ —Ç—Ä–µ–±–∞ —ñ–≥–Ω–æ—Ä—É–≤–∞—Ç–∏ —Ñ–∞–π–ª/–ø–∞–ø–∫—É"""
    name = path.name

    # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ç–æ—á–Ω–æ–≥–æ –∑–±—ñ–≥—É
    if name in IGNORE_PATTERNS:
        return True

    # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è
    if path.suffix in IGNORE_PATTERNS:
        return True

    # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø—Ä–∏—Ö–æ–≤–∞–Ω–∏—Ö —Ñ–∞–π–ª—ñ–≤ (–∫—Ä—ñ–º .env.example)
    if name.startswith('.') and name != '.env.example':
        return True

    return False


def is_text_file(path: Path) -> bool:
    """–ü–µ—Ä–µ–≤—ñ—Ä—è—î, —á–∏ —î —Ñ–∞–π–ª —Ç–µ–∫—Å—Ç–æ–≤–∏–º"""
    # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è
    if path.suffix.lower() in TEXT_EXTENSIONS:
        return True

    # –§–∞–π–ª–∏ –±–µ–∑ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è, —è–∫—ñ –∑–∞–∑–≤–∏—á–∞–π —Ç–µ–∫—Å—Ç–æ–≤—ñ
    if path.suffix == '' and path.name in {'Dockerfile', 'Makefile', 'README', 'LICENSE'}:
        return True

    return False


def get_tree_structure(root_path: Path, prefix: str = "", is_last: bool = True) -> list:
    """–ì–µ–Ω–µ—Ä—É—î –¥–µ—Ä–µ–≤–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ –ø—Ä–æ—î–∫—Ç—É"""
    lines = []

    try:
        items = sorted(root_path.iterdir(), key=lambda x: (not x.is_dir(), x.name.lower()))
        items = [item for item in items if not should_ignore(item)]

        for i, item in enumerate(items):
            is_last_item = i == len(items) - 1
            current_prefix = "‚îî‚îÄ‚îÄ " if is_last_item else "‚îú‚îÄ‚îÄ "
            lines.append(f"{prefix}{current_prefix}{item.name}{'/' if item.is_dir() else ''}")

            if item.is_dir():
                extension = "    " if is_last_item else "‚îÇ   "
                lines.extend(get_tree_structure(item, prefix + extension, is_last_item))

    except PermissionError:
        pass

    return lines


def read_file_content(file_path: Path) -> str:
    """–ß–∏—Ç–∞—î –≤–º—ñ—Å—Ç —Ñ–∞–π–ª—É"""
    try:
        # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ä–æ–∑–º—ñ—Ä—É
        if file_path.stat().st_size > MAX_FILE_SIZE:
            return f"[–§–∞–π–ª –∑–∞–Ω–∞–¥—Ç–æ –≤–µ–ª–∏–∫–∏–π: {file_path.stat().st_size / 1024:.1f} KB]"

        # –°–ø—Ä–æ–±–∞ –ø—Ä–æ—á–∏—Ç–∞—Ç–∏ —è–∫ —Ç–µ–∫—Å—Ç
        with open(file_path, 'r', encoding='utf-8') as f:
            return f.read()
    except UnicodeDecodeError:
        # –Ø–∫—â–æ –Ω–µ –≤–¥–∞–ª–æ—Å—è –ø—Ä–æ—á–∏—Ç–∞—Ç–∏ —è–∫ UTF-8
        try:
            with open(file_path, 'r', encoding='cp1251') as f:
                return f.read()
        except:
            return "[–ù–µ –≤–¥–∞–ª–æ—Å—è –ø—Ä–æ—á–∏—Ç–∞—Ç–∏ —Ñ–∞–π–ª - –±—ñ–Ω–∞—Ä–Ω–∏–π –∞–±–æ –Ω–µ–≤—ñ–¥–æ–º–µ –∫–æ–¥—É–≤–∞–Ω–Ω—è]"
    except Exception as e:
        return f"[–ü–æ–º–∏–ª–∫–∞ —á–∏—Ç–∞–Ω–Ω—è: {str(e)}]"


def collect_files(root_path: Path) -> list:
    """–ó–±–∏—Ä–∞—î –≤—Å—ñ —Ç–µ–∫—Å—Ç–æ–≤—ñ —Ñ–∞–π–ª–∏ –ø—Ä–æ—î–∫—Ç—É"""
    files = []

    for item in root_path.rglob('*'):
        if item.is_file() and not should_ignore(item) and is_text_file(item):
            # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞, —â–æ –≤—Å—ñ –±–∞—Ç—å–∫—ñ–≤—Å—å–∫—ñ –ø–∞–ø–∫–∏ –Ω–µ —ñ–≥–Ω–æ—Ä—É—é—Ç—å—Å—è
            if not any(should_ignore(parent) for parent in item.parents):
                files.append(item)

    return sorted(files)


def generate_project_export(project_path: str, output_file: str = None):
    """–ì–µ–Ω–µ—Ä—É—î –ø–æ–≤–Ω–∏–π –µ–∫—Å–ø–æ—Ä—Ç –ø—Ä–æ—î–∫—Ç—É"""
    root = Path(project_path).resolve()

    if not root.exists():
        print(f"‚ùå –ü–æ–º–∏–ª–∫–∞: –®–ª—è—Ö '{project_path}' –Ω–µ —ñ—Å–Ω—É—î!")
        return

    if output_file is None:
        timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
        output_file = f"project_export_{timestamp}.txt"

    print(f"üìÅ –ê–Ω–∞–ª—ñ–∑ –ø—Ä–æ—î–∫—Ç—É: {root.name}")
    print(f"üìù –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –µ–∫—Å–ø–æ—Ä—Ç—É...")

    with open(output_file, 'w', encoding='utf-8') as f:
        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        f.write("=" * 80 + "\n")
        f.write(f"–ï–ö–°–ü–û–†–¢ –ü–†–û–Ñ–ö–¢–£: {root.name}\n")
        f.write(f"–î–∞—Ç–∞: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}\n")
        f.write(f"–®–ª—è—Ö: {root}\n")
        f.write("=" * 80 + "\n\n")

        # –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ—î–∫—Ç—É
        f.write("üìÇ –°–¢–†–£–ö–¢–£–†–ê –ü–†–û–Ñ–ö–¢–£\n")
        f.write("-" * 80 + "\n")
        f.write(f"{root.name}/\n")
        tree_lines = get_tree_structure(root)
        f.write("\n".join(tree_lines))
        f.write("\n\n")

        # –ó–±—ñ—Ä —Ñ–∞–π–ª—ñ–≤
        files = collect_files(root)

        f.write(f"üìÑ –í–ú–Ü–°–¢ –§–ê–ô–õ–Ü–í ({len(files)} —Ñ–∞–π–ª—ñ–≤)\n")
        f.write("=" * 80 + "\n\n")

        # –í–º—ñ—Å—Ç –∫–æ–∂–Ω–æ–≥–æ —Ñ–∞–π–ª—É
        for i, file_path in enumerate(files, 1):
            relative_path = file_path.relative_to(root)

            print(f"  [{i}/{len(files)}] {relative_path}")

            f.write("\n" + "=" * 80 + "\n")
            f.write(f"–§–∞–π–ª {i}/{len(files)}: {relative_path}\n")
            f.write("-" * 80 + "\n")

            content = read_file_content(file_path)
            f.write(content)
            f.write("\n")

        # –ü—ñ–¥—Å—É–º–æ–∫
        f.write("\n" + "=" * 80 + "\n")
        f.write("–ö–Ü–ù–ï–¶–¨ –ï–ö–°–ü–û–†–¢–£\n")
        f.write("=" * 80 + "\n")

    file_size = Path(output_file).stat().st_size
    print(f"\n‚úÖ –ï–∫—Å–ø–æ—Ä—Ç –∑–∞–≤–µ—Ä—à–µ–Ω–æ!")
    print(f"üìÑ –§–∞–π–ª: {output_file}")
    print(f"üìä –†–æ–∑–º—ñ—Ä: {file_size / 1024:.1f} KB")
    print(f"üìÅ –§–∞–π–ª—ñ–≤ –æ–±—Ä–æ–±–ª–µ–Ω–æ: {len(files)}")


if __name__ == "__main__":
    import sys

    # –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è: python export_project.py [—à–ª—è—Ö_–¥–æ_–ø—Ä–æ—î–∫—Ç—É] [–≤–∏—Ö—ñ–¥–Ω–∏–π_—Ñ–∞–π–ª]
    project_path = sys.argv[1] if len(sys.argv) > 1 else "."
    output_file = sys.argv[2] if len(sys.argv) > 2 else None

    generate_project_export(project_path, output_file)


================================================================================
–§–∞–π–ª 3/21: GitCommitTool.py
--------------------------------------------------------------------------------
import customtkinter as ctk
from tkinter import messagebox, scrolledtext
import subprocess
import os
from pathlib import Path
from datetime import datetime


class GitCommitTool(ctk.CTk):
    def __init__(self):
        super().__init__()

        self.title("Git Commit Tool")
        self.geometry("600x700")
        self.resizable(False, False)

        # –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç–µ–º–∏
        ctk.set_appearance_mode("light")
        ctk.set_default_color_theme("blue")

        # –û—Ç—Ä–∏–º–∞–Ω–Ω—è –ø–æ—Ç–æ—á–Ω–æ—ó –≤–µ—Ä—Å—ñ—ó
        self.current_version = self.get_current_version()

        self.setup_ui()

    def setup_ui(self):
        """–°—Ç–≤–æ—Ä–µ–Ω–Ω—è UI"""

        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        title_label = ctk.CTkLabel(
            self,
            text="Git Commit Tool",
            font=ctk.CTkFont(size=24, weight="bold")
        )
        title_label.pack(pady=15)

        # –ü–æ—Ç–æ—á–Ω–∞ –≤–µ—Ä—Å—ñ—è
        version_frame = ctk.CTkFrame(self)
        version_frame.pack(pady=10, padx=20, fill="x")

        ctk.CTkLabel(
            version_frame,
            text="–ü–æ—Ç–æ—á–Ω–∞ –≤–µ—Ä—Å—ñ—è:",
            font=ctk.CTkFont(size=12, weight="bold")
        ).pack(side="left")

        ctk.CTkLabel(
            version_frame,
            text=f"v{self.current_version}",
            font=ctk.CTkFont(size=12),
            text_color="gray"
        ).pack(side="left", padx=10)

        # –ö–æ–º–µ–Ω—Ç–∞—Ä
        ctk.CTkLabel(
            self,
            text="–ö–æ–º–µ–Ω—Ç–∞—Ä (commit message):",
            font=ctk.CTkFont(size=12, weight="bold")
        ).pack(anchor="w", padx=20, pady=(10, 5))

        self.comment_entry = ctk.CTkEntry(
            self,
            placeholder_text="–û–ø–∏—à—ñ—Ç—å –≤–∞—à—ñ –∑–º—ñ–Ω–∏...",
            height=40,
            font=ctk.CTkFont(size=11)
        )
        self.comment_entry.pack(padx=20, fill="x", pady=(0, 15))

        # –ù–æ–≤–∞ –≤–µ—Ä—Å—ñ—è
        ctk.CTkLabel(
            self,
            text="–ù–æ–≤–∞ –≤–µ—Ä—Å—ñ—è (–¥–ª—è —Ç–∞–≥—É):",
            font=ctk.CTkFont(size=12, weight="bold")
        ).pack(anchor="w", padx=20, pady=(10, 5))

        version_frame2 = ctk.CTkFrame(self)
        version_frame2.pack(padx=20, fill="x", pady=(0, 15))

        ctk.CTkLabel(
            version_frame2,
            text="v",
            font=ctk.CTkFont(size=11)
        ).pack(side="left", padx=(0, 5))

        self.version_entry = ctk.CTkEntry(
            version_frame2,
            placeholder_text="1.1.0",
            height=35,
            font=ctk.CTkFont(size=11)
        )
        self.version_entry.pack(side="left", fill="x", expand=True)

        # –ß–µ–∫–±–æ–∫—Å –¥–ª—è —Ç–∞–≥—É
        self.tag_checkbox = ctk.CTkCheckBox(
            self,
            text="–°—Ç–≤–æ—Ä–∏—Ç–∏ —Ç–µ–≥ –≤–µ—Ä—Å—ñ—ó",
            font=ctk.CTkFont(size=11)
        )
        self.tag_checkbox.pack(anchor="w", padx=20, pady=(0, 20))
        self.tag_checkbox.select()

        # –ö–Ω–æ–ø–∫–∏
        button_frame = ctk.CTkFrame(self)
        button_frame.pack(padx=20, fill="x", pady=(0, 15))

        commit_btn = ctk.CTkButton(
            button_frame,
            text="‚úÖ Commit & Push",
            command=self.commit_and_push,
            font=ctk.CTkFont(size=12, weight="bold"),
            height=45,
            corner_radius=10
        )
        commit_btn.pack(side="left", fill="both", expand=True, padx=(0, 5))

        clear_btn = ctk.CTkButton(
            button_frame,
            text="üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç–∏",
            command=self.clear_fields,
            font=ctk.CTkFont(size=12),
            height=45,
            corner_radius=10,
            fg_color="gray30",
            hover_color="gray50"
        )
        clear_btn.pack(side="left", fill="both", expand=True, padx=(5, 0))

        # –õ–æ–≥–∏
        ctk.CTkLabel(
            self,
            text="–õ–æ–≥–∏ –æ–ø–µ—Ä–∞—Ü—ñ–π:",
            font=ctk.CTkFont(size=11, weight="bold")
        ).pack(anchor="w", padx=20, pady=(10, 5))

        self.log_text = scrolledtext.ScrolledText(
            self,
            height=10,
            width=70,
            font=("Courier", 9),
            bg="#f0f0f0",
            fg="#333333",
            relief="solid",
            borderwidth=1
        )
        self.log_text.pack(padx=20, pady=(0, 15), fill="both", expand=True)

        # –°—Ç–∞—Ç—É—Å
        self.status_label = ctk.CTkLabel(
            self,
            text="–ì–æ—Ç–æ–≤–æ –¥–æ —Ä–æ–±–æ—Ç–∏",
            font=ctk.CTkFont(size=10),
            text_color="gray"
        )
        self.status_label.pack(pady=(0, 10))

    def get_current_version(self):
        """–û—Ç—Ä–∏–º–∞–Ω–Ω—è –ø–æ—Ç–æ—á–Ω–æ—ó –≤–µ—Ä—Å—ñ—ó –∑ version.txt"""
        try:
            with open("version.txt", "r") as f:
                return f.read().strip()
        except:
            return "1.0.0"

    def log_message(self, message):
        """–î–æ–¥–∞–Ω–Ω—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –¥–æ –ª–æ–≥—ñ–≤"""
        timestamp = datetime.now().strftime("%H:%M:%S")
        self.log_text.insert("end", f"[{timestamp}] {message}\n")
        self.log_text.see("end")
        self.update()

    def run_git_command(self, command):
        """–í–∏–∫–æ–Ω–∞–Ω–Ω—è git –∫–æ–º–∞–Ω–¥–∏"""
        try:
            result = subprocess.run(
                command,
                shell=True,
                capture_output=True,
                text=True,
                cwd=os.getcwd()
            )

            if result.returncode == 0:
                if result.stdout:
                    self.log_message(f"‚úÖ {result.stdout.strip()}")
                return True
            else:
                error_msg = result.stderr.strip() if result.stderr else "–ù–µ–≤—ñ–¥–æ–º–∞ –ø–æ–º–∏–ª–∫–∞"
                self.log_message(f"‚ùå –ü–æ–º–∏–ª–∫–∞: {error_msg}")
                return False
        except Exception as e:
            self.log_message(f"‚ùå –ò—Å–∫–ª—é—á–µ–Ω–∏–µ: {str(e)}")
            return False

    def commit_and_push(self):
        """–û—Å–Ω–æ–≤–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è - commit, tag —ñ push"""

        comment = self.comment_entry.get().strip()
        new_version = self.version_entry.get().strip()
        create_tag = self.tag_checkbox.get()

        # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∏
        if not comment:
            messagebox.showwarning("–ü–æ–º–∏–ª–∫–∞", "–ù–∞–ø–∏—à—ñ—Ç—å –∫–æ–º–µ–Ω—Ç–∞—Ä –¥–æ –∫–æ–º—ñ—Ç—é!")
            return

        if create_tag and not new_version:
            messagebox.showwarning("–ü–æ–º–∏–ª–∫–∞", "–ù–∞–ø–∏—à—ñ—Ç—å –Ω–æ–≤—É –≤–µ—Ä—Å—ñ—é –¥–ª—è —Ç–∞–≥—É!")
            return

        self.status_label.configure(text="‚è≥ –û–±—Ä–æ–±–∫–∞...")
        self.update()

        self.log_message("=" * 50)
        self.log_message("üöÄ –†–æ–∑–ø–æ—á–∏–Ω–∞—î–º–æ commit & push –ø—Ä–æ—Ü–µ—Å...")
        self.log_message("=" * 50)

        # –ö—Ä–æ–∫ 1: –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å—É
        self.log_message("\nüìã –ö—Ä–æ–∫ 1: –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å—É —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—é...")
        self.run_git_command("git status --short")

        # –ö—Ä–æ–∫ 2: –î–æ–±–∞–≤–ª–µ–Ω–Ω—è –≤—Å—ñ—Ö —Ñ–∞–π–ª—ñ–≤
        self.log_message("\nüì¶ –ö—Ä–æ–∫ 2: –î–æ–¥–∞–≤–∞–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤...")
        if not self.run_git_command("git add ."):
            self.status_label.configure(text="‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –¥–æ–¥–∞–≤–∞–Ω–Ω—ñ —Ñ–∞–π–ª—ñ–≤")
            messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–ù–µ –≤–¥–∞–ª–æ—Å—è –¥–æ–¥–∞—Ç–∏ —Ñ–∞–π–ª–∏!")
            return

        # –ö—Ä–æ–∫ 3: –ö–æ–º—ñ—Ç
        self.log_message("\nüíæ –ö—Ä–æ–∫ 3: –ö–æ–º—ñ—Ç—É–≤–∞–Ω–Ω—è –∑–º—ñ–Ω...")
        if not self.run_git_command(f'git commit -m "{comment}"'):
            self.status_label.configure(text="‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –∫–æ–º—ñ—Ç—É–≤–∞–Ω–Ω—ñ")
            messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–ù–µ –≤–¥–∞–ª–æ—Å—è –∑–∞–∫–æ–º—ñ—Ç–∏—Ç–∏!")
            return

        # –ö—Ä–æ–∫ 4: Push
        self.log_message("\n‚¨ÜÔ∏è  –ö—Ä–æ–∫ 4: –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –Ω–∞ GitHub...")
        if not self.run_git_command("git push origin main"):
            self.status_label.configure(text="‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ push")
            messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–ù–µ –≤–¥–∞–ª–æ—Å—è –≤—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ –Ω–∞ GitHub!")
            return

        # –ö—Ä–æ–∫ 5: –¢–µ–≥ (—è–∫—â–æ –ø–æ—Ç—Ä—ñ–±–µ–Ω)
        if create_tag:
            self.log_message("\nüè∑Ô∏è  –ö—Ä–æ–∫ 5: –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–∞–≥—É...")
            if not self.run_git_command(f"git tag v{new_version}"):
                self.status_label.configure(text="‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—ñ —Ç–∞–≥—É")
                messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–ù–µ –≤–¥–∞–ª–æ—Å—è —Å—Ç–≤–æ—Ä–∏—Ç–∏ —Ç–µ–≥!")
                return

            self.log_message("\n‚¨ÜÔ∏è  –ö—Ä–æ–∫ 6: –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ç–∞–≥—É –Ω–∞ GitHub...")
            if not self.run_git_command(f"git push origin v{new_version}"):
                self.status_label.configure(text="‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ push —Ç–∞–≥—É")
                messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–ù–µ –≤–¥–∞–ª–æ—Å—è –≤—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ —Ç–µ–≥!")
                return

            # –û–Ω–æ–≤–ª–µ–Ω–Ω—è version.txt
            self.log_message("\nüìù –ö—Ä–æ–∫ 7: –û–Ω–æ–≤–ª–µ–Ω–Ω—è version.txt...")
            try:
                with open("version.txt", "w") as f:
                    f.write(new_version)
                self.log_message("‚úÖ version.txt –æ–Ω–æ–≤–ª–µ–Ω–æ")
                self.current_version = new_version
            except Exception as e:
                self.log_message(f"‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –æ–Ω–æ–≤–ª–µ–Ω–Ω—ñ version.txt: {str(e)}")

        self.log_message("\n" + "=" * 50)
        self.log_message("‚úÖ –í–°–ï –£–°–ü–Ü–®–ù–û! GitHub Actions –ø–æ—á–Ω–µ –∫–æ–º–ø—ñ–ª—é–≤–∞—Ç–∏...")
        self.log_message("=" * 50)

        self.status_label.configure(text="‚úÖ –£—Å–ø—ñ—à–Ω–æ! GitHub Actions –∑–∞–ø—É—â–µ–Ω–æ")
        messagebox.showinfo(
            "–£—Å–ø—ñ—Ö",
            f"‚úÖ –ö–æ–º—ñ—Ç —É—Å–ø—ñ—à–Ω–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ!\n\n"
            f"–ö–æ–º–µ–Ω—Ç–∞—Ä: {comment}\n"
            + (f"–í–µ—Ä—Å—ñ—è: v{new_version}\n\nGitHub Actions –ø–æ—á–Ω–µ –∫–æ–º–ø—ñ–ª—é–≤–∞—Ç–∏ EXE..." if create_tag else "")
        )

        self.clear_fields()

    def clear_fields(self):
        """–û—á–∏—Å—Ç–∫–∞ –ø–æ–ª—ñ–≤"""
        self.comment_entry.delete(0, "end")
        self.version_entry.delete(0, "end")
        self.tag_checkbox.select()
        self.status_label.configure(text="–ì–æ—Ç–æ–≤–æ –¥–æ —Ä–æ–±–æ—Ç–∏")


def main():
    app = GitCommitTool()
    app.mainloop()


if __name__ == "__main__":
    main()


================================================================================
–§–∞–π–ª 5/21: README.md
--------------------------------------------------------------------------------


================================================================================
–§–∞–π–ª 6/21: requirements.txt
--------------------------------------------------------------------------------
customtkinter==5.2.1
requests==2.31.0
psutil==5.9.6
keyring==24.1.0
python-telegram-bot==20.3
packaging>=24.0
pywin32>=300
python-dotenv

================================================================================
–§–∞–π–ª 7/21: src\anydesk_manager.py
--------------------------------------------------------------------------------
import os
import sys
import subprocess
import time
import logging
import psutil
import platform
import ctypes
import socket
from pathlib import Path
from typing import Optional, Tuple

logger = logging.getLogger(__name__)

UNATTENDED_PASSWORD = "r3moteh4nd"


class AnyDeskManager:
    """–ú–µ–Ω–µ–¥–∂–µ—Ä –¥–ª—è AnyDesk"""

    def __init__(self, config_manager, telegram_api):
        self.config = config_manager
        self.telegram = telegram_api
        self.anydesk_path = self.find_anydesk()
        self._is_running = False
        self.connection_id = None

    def find_anydesk(self) -> Optional[str]:
        """–ó–Ω–∞–π—Ç–∏ AnyDesk"""
        possible_paths = [
            r"C:\Program Files\AnyDesk\AnyDesk.exe",
            r"C:\Program Files (x86)\AnyDesk\AnyDesk.exe",
            os.path.expanduser("~\\AppData\\Local\\AnyDesk\\AnyDesk.exe"),
            os.path.expanduser("~\\AppData\\Roaming\\AnyDesk\\AnyDesk.exe"),
            os.path.expanduser("~\\Downloads\\AnyDesk.exe"),
            r"C:\ProgramData\AnyDesk\AnyDesk.exe",
        ]

        for path in possible_paths:
            if os.path.exists(path):
                logger.info(f"‚úÖ AnyDesk –∑–Ω–∞–π–¥–µ–Ω–æ: {path}")
                return path

        logger.warning("‚ö†Ô∏è AnyDesk –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ")
        return None

    def download_anydesk(self) -> bool:
        """–ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ AnyDesk"""
        if self.anydesk_path:
            return True

        logger.info("üì• –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è AnyDesk...")
        try:
            import urllib.request
            downloads_dir = os.path.expanduser("~\\Downloads")
            save_path = os.path.join(downloads_dir, "AnyDesk.exe")
            download_url = "https://download.anydesk.com/AnyDesk.exe"

            if not os.path.exists(save_path):
                logger.info(f"–ó–∞–≤–∞–Ω—Ç–∞–∂—É...")
                urllib.request.urlretrieve(download_url, save_path)

            logger.info("–ó–∞–ø—É—Å–∫ –≤—Å—Ç–∞–Ω–æ–≤–ª—é–≤–∞—á–∞...")
            subprocess.Popen([save_path])

            logger.info("–ß–µ–∫–∞—é –Ω–∞ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è (90 —Å–µ–∫)...")
            for i in range(90):
                time.sleep(1)
                self.anydesk_path = self.find_anydesk()
                if self.anydesk_path:
                    logger.info(f"‚úÖ AnyDesk –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ")
                    time.sleep(3)
                    return True

            return False
        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞: {e}")
            return False

    def check_if_running(self) -> bool:
        """–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —á–∏ AnyDesk –∑–∞–ø—É—â–µ–Ω–æ"""
        try:
            for proc in psutil.process_iter(['pid', 'name']):
                if 'anydesk' in proc.info['name'].lower():
                    logger.info(f"‚ÑπÔ∏è AnyDesk –∑–∞–ø—É—â–µ–Ω–æ (PID: {proc.info['pid']})")
                    self._is_running = True
                    return True
        except:
            pass
        self._is_running = False
        return False

    def launch_anydesk(self) -> bool:
        """–ó–∞–ø—É—Å—Ç–∏—Ç–∏ AnyDesk"""
        if self.check_if_running():
            return True

        if not self.anydesk_path or not Path(self.anydesk_path).exists():
            logger.error("–®–ª—è—Ö –Ω–µ–≤—ñ–¥–æ–º–∏–π")
            return False

        try:
            logger.info(f"üöÄ –ó–∞–ø—É—Å–∫–∞—é AnyDesk...")
            subprocess.Popen(self.anydesk_path)
            time.sleep(5)

            if self.check_if_running():
                logger.info("‚úÖ AnyDesk –∑–∞–ø—É—â–µ–Ω–æ")
                return True
            else:
                self._is_running = True
                return True
        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞: {e}")
            return False

    def set_password_with_admin(self) -> bool:
        """–í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –ø–∞—Ä–æ–ª—å —á–µ—Ä–µ–∑ –æ–∫—Ä–µ–º–∏–π —Å–∫—Ä–∏–ø—Ç –∑ –∞–¥–º—ñ–Ω –ø—Ä–∞–≤–∞–º–∏"""
        if not self.anydesk_path:
            logger.error("–®–ª—è—Ö –Ω–µ–≤—ñ–¥–æ–º–∏–π")
            return False

        try:
            logger.info(f"üîê –ó–∞–ø—É—Å–∫–∞—é –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –ø–∞—Ä–æ–ª—è –∑ –∞–¥–º—ñ–Ω –ø—Ä–∞–≤–∞–º–∏...")

            # –í–∏–∑–Ω–∞—á–∏—Ç–∏ —à–ª—è—Ö –¥–æ —Å–∫—Ä–∏–ø—Ç—É
            if getattr(sys, 'frozen', False):
                # –Ø–∫—â–æ EXE - —Å–∫—Ä–∏–ø—Ç –ø–æ—Ä—É—á
                script_path = os.path.join(os.path.dirname(sys.executable), "src", "set_anydesk_password.py")
            else:
                # –Ø–∫—â–æ DEV
                script_path = os.path.join(os.path.dirname(__file__), "set_anydesk_password.py")

            if not os.path.exists(script_path):
                logger.error(f"–°–∫—Ä–∏–ø—Ç –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ: {script_path}")
                return False

            # –ü–µ—Ä–µ–¥–∞—Ç–∏ –ø–∞—Ä–æ–ª—å —è–∫ –∑–º—ñ–Ω–Ω—É —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞
            env = os.environ.copy()
            env["ANYDESK_PASSWORD"] = UNATTENDED_PASSWORD

            # –ó–∞–ø—É—Å—Ç–∏—Ç–∏ —Å–∫—Ä–∏–ø—Ç –∑ –∞–¥–º—ñ–Ω –ø—Ä–∞–≤–∞–º–∏
            ctypes.windll.shell32.ShellExecuteW(
                None,
                "runas",
                sys.executable,
                f'"{script_path}" "{self.anydesk_path}"',
                None,
                1  # SW_SHOW - –ø–æ–∫–∞–∑–∞—Ç–∏ –≤—ñ–∫–Ω–æ
            )

            logger.info(f"‚úÖ –ó–∞–ø—Ä–æ—Å –∞–¥–º—ñ–Ω –ø—Ä–∞–≤ –Ω–∞–¥—ñ—Å–ª–∞–Ω–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—É")
            time.sleep(3)
            return True

        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞: {e}")
            import traceback
            traceback.print_exc()
            return False

    def get_connection_id(self) -> Optional[str]:
        """–û—Ç—Ä–∏–º–∞—Ç–∏ ID"""
        if not self.anydesk_path:
            return None

        try:
            logger.info("üìå –û—Ç—Ä–∏–º—É—é ID...")

            result = subprocess.run(
                [self.anydesk_path, '--get-id'],
                capture_output=True,
                text=True,
                timeout=10,
                creationflags=subprocess.CREATE_NO_WINDOW if platform.system() == "Windows" else 0
            )

            if result.returncode == 0:
                connection_id = result.stdout.strip()
                if connection_id and connection_id.isdigit():
                    logger.info(f"‚úÖ ID: {connection_id}")
                    self.connection_id = connection_id
                    return connection_id

        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞: {e}")

        return None

    def start(self, password: str = None) -> Tuple[Optional[str], Optional[str]]:
        """–ó–∞–ø—É—Å—Ç–∏—Ç–∏ AnyDesk"""
        password = UNATTENDED_PASSWORD

        # –ö—Ä–æ–∫ 1: –Ø–∫—â–æ –≤–∂–µ –∑–∞–ø—É—â–µ–Ω–æ
        if self.check_if_running():
            logger.info("AnyDesk –≤–∂–µ –∑–∞–ø—É—â–µ–Ω–æ")
            connection_id = self.get_connection_id()
            if connection_id:
                try:
                    # ‚ö†Ô∏è –î–û–î–ê–¢–ò –ü–Ü–ë
                    user_name = self.config.get("user_name", "")

                    self.telegram.send_anydesk_info(
                        self.config.store_location_text,
                        user_name,  # ‚¨ÖÔ∏è –ü–Ü–ë
                        socket.gethostname(),  # –ü–ö
                        connection_id,
                        password
                    )
                except Exception as e:
                    logger.error(f"‚ùå Telegram: {e}")
            return connection_id, password

        # –ö—Ä–æ–∫ 2: –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —è–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ
        if not self.anydesk_path:
            if not self.download_anydesk():
                return None, None

        # –ö—Ä–æ–∫ 3: –ó–∞–ø—É—Å—Ç–∏—Ç–∏
        if not self.launch_anydesk():
            return None, None

        # –ö—Ä–æ–∫ 4: –í–°–¢–ê–ù–û–í–ò–¢–ò –ü–ê–†–û–õ–¨ –ó –ê–î–ú–Ü–ù –ü–†–ê–í–ê–ú–ò
        logger.info("üîê –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –ø–∞—Ä–æ–ª—è...")
        time.sleep(2)
        self.set_password_with_admin()

        # –ö—Ä–æ–∫ 5: –û—Ç—Ä–∏–º–∞—Ç–∏ ID
        logger.info("üìå –û—Ç—Ä–∏–º–∞–Ω–Ω—è ID...")
        time.sleep(2)
        connection_id = self.get_connection_id()

        if not connection_id:
            time.sleep(3)
            connection_id = self.get_connection_id()

        # –ö—Ä–æ–∫ 6: –ù–∞–¥—ñ—Å–ª–∞—Ç–∏ –≤ Telegram –∑ –ü–Ü–ë
        try:
            # ‚ö†Ô∏è –î–û–î–ê–¢–ò –ü–Ü–ë
            user_name = self.config.get("user_name", "")

            self.telegram.send_anydesk_info(
                self.config.store_location_text,
                user_name,  # ‚¨ÖÔ∏è –ü–Ü–ë
                socket.gethostname(),  # –ü–ö
                connection_id if connection_id else "–Ω–µ –æ—Ç—Ä–∏–º–∞–Ω–æ",
                password
            )
            logger.info("‚úÖ –¢–µ–ª–µ–≥—Ä–∞–º —Å–ø–æ–≤—ñ—â–µ–Ω–æ")
        except Exception as e:
            logger.error(f"‚ùå –¢–µ–ª–µ–≥—Ä–∞–º –ø–æ–º–∏–ª–∫–∞: {e}")

        logger.info(f"‚úÖ –ì–æ—Ç–æ–≤–æ (ID: {connection_id})")
        return connection_id, password


================================================================================
–§–∞–π–ª 8/21: src\config.py
--------------------------------------------------------------------------------
import os
from pathlib import Path
from dotenv import load_dotenv

# –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ .env
load_dotenv()

APP_NAME = "RemoteHand"
RDP_HOST = "23.88.7.196"
RDP_PORT = 4420
PING_HOST = "23.88.7.196"

# üîí –ó–Ü –ó–ú–Ü–ù–ù–ò–• –°–ï–†–ï–î–û–í–ò–©–ê, –ê –ù–ï –ó .env!
TELEGRAM_TOKEN = os.getenv("TELEGRAM_TOKEN", "")
TELEGRAM_CHAT_ID = os.getenv("TELEGRAM_CHAT_ID", "")

# –§–∞–π–ª–∏
LOCK_FILE = Path.home() / ".remotehand" / "lock"


================================================================================
–§–∞–π–ª 9/21: src\config_manager.py
--------------------------------------------------------------------------------
import json
import os
from pathlib import Path
import logging

logger = logging.getLogger(__name__)


class ConfigManager:
    """–ú–µ–Ω–µ–¥–∂–µ—Ä –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó"""

    def __init__(self):
        self.config_dir = Path.home() / ".remotehand"
        self.config_dir.mkdir(exist_ok=True)
        self.config_file = self.config_dir / "config.json"

        self.config = self.load()

    def load(self):
        """–ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –∫–æ–Ω—Ñ—ñ–≥"""
        if self.config_file.exists():
            try:
                with open(self.config_file, 'r', encoding='utf-8') as f:
                    return json.load(f)
            except:
                pass
        return {}

    def save(self):
        """–ó–±–µ—Ä–µ–≥—Ç–∏ –∫–æ–Ω—Ñ—ñ–≥ –≤ JSON —Ñ–∞–π–ª"""
        try:
            with open(self.config_file, 'w', encoding='utf-8') as f:
                json.dump(self.config, f, ensure_ascii=False, indent=2)
        except Exception as e:
            logger.error(f"–ü–æ–º–∏–ª–∫–∞ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –∫–æ–Ω—Ñ—ñ–≥—É: {e}")

    def set(self, key, value):
        """–í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –∑–Ω–∞—á–µ–Ω–Ω—è"""
        self.config[key] = value
        self.save()

    def get(self, key, default=""):
        """–û—Ç—Ä–∏–º–∞—Ç–∏ –∑–Ω–∞—á–µ–Ω–Ω—è"""
        return self.config.get(key, default)

    def is_first_run(self):
        """–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —á–∏ –ø–µ—Ä—à–∏–π –∑–∞–ø—É—Å–∫"""
        store = self.config.get('store', '')
        location = self.config.get('location', '')
        return not store or not location

    @property
    def store_location_text(self):
        """–û—Ç—Ä–∏–º–∞—Ç–∏ —Ç–µ–∫—Å—Ç –º–∞–≥–∞–∑–∏–Ω—É/–ª–æ–∫–∞—Ü—ñ—ó"""
        store = self.config.get('store', '–ù–µ–≤—ñ–¥–æ–º–æ')
        location = self.config.get('location', '–ù–µ–≤—ñ–¥–æ–º–æ')
        return f"{store} / {location}"


================================================================================
–§–∞–π–ª 10/21: src\main.py
--------------------------------------------------------------------------------
import customtkinter as ctk
from tkinter import messagebox
import sys
import os
import threading
import logging
from pathlib import Path

# –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ .env —Ñ–∞–π–ª
from dotenv import load_dotenv

load_dotenv()

# –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –ª–æ–≥—É–≤–∞–Ω–Ω—è
logging.basicConfig(
    level=logging.INFO,
    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s'
)
logger = logging.getLogger(__name__)

# ============ –ü–ï–†–ï–í–Ü–†–ö–ê DEV –†–ï–ñ–ò–ú–£ ============
DEV_MODE = os.getenv('REMOTEHAND_DEV_MODE') == '1'
logger.info(f"{'üîß DEV –†–ï–ñ–ò–ú' if DEV_MODE else '‚úÖ PRODUCTION –†–ï–ñ–ò–ú'}")

if not DEV_MODE:
    # –¢–Ü–õ–¨–ö–ò –í PRODUCTION
    try:
        from updater import check_and_update

        check_and_update()
    except Exception as e:
        logger.warning(f"–ü–æ–º–∏–ª–∫–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –æ–Ω–æ–≤–ª–µ–Ω—å: {e}")

# ============ –Ü–ú–ü–û–†–¢–ò ============
from utils import close_all_rdp_sessions, test_connection
from config import RDP_HOST, RDP_PORT, PING_HOST, APP_NAME

# –ù–æ–≤—ñ —ñ–º–ø–æ—Ä—Ç–∏
from config_manager import ConfigManager
from telegram_api import TelegramAPI
from setup_wizard import SetupWizard
from network_test import NetworkTest

try:
    from rdp_manager import RDPManager

    rdp_manager_available = True
except ImportError as e:
    rdp_manager_available = False
    logger.warning(f"rdp_manager –Ω–µ –¥–æ—Å—Ç—É–ø–Ω–∞: {e}")

try:
    from anydesk_manager import AnyDeskManager

    anydesk_available = True
except ImportError as e:
    anydesk_available = False
    logger.warning(f"anydesk_manager –Ω–µ –¥–æ—Å—Ç—É–ø–Ω–∞: {e}")


class RemoteHandApp(ctk.CTk):
    def __init__(self):
        super().__init__()

        # –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –≤—ñ–∫–Ω–∞
        self.title(APP_NAME)
        self.geometry("520x800")
        self.resizable(True, True)

        # –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç–µ–º–∏
        ctk.set_appearance_mode("light")
        ctk.set_default_color_theme("blue")

        # –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è –º–µ–Ω–µ–¥–∂–µ—Ä—ñ–≤
        self.config = ConfigManager()

        # ‚ö†Ô∏è –ó–ê–í–ê–ù–¢–ê–ñ–ò–¢–ò –¢–û–ö–ï–ù–ò –ó .env –õ–ò CONFIG
        telegram_token = os.getenv("TELEGRAM_TOKEN") or self.config.get("telegram_token")
        telegram_chat_id = os.getenv("TELEGRAM_CHAT_ID") or self.config.get("telegram_chat_id")

        logger.info(f"Telegram token: {'‚úÖ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ' if telegram_token else '‚ùå –ù–ï –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ'}")
        logger.info(f"Telegram chat_id: {'‚úÖ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ' if telegram_chat_id else '‚ùå –ù–ï –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ'}")

        self.telegram = TelegramAPI(telegram_token, telegram_chat_id)

        if rdp_manager_available:
            self.rdp_manager = RDPManager(self.config, self.telegram)
        else:
            self.rdp_manager = None

        if anydesk_available:
            self.anydesk_manager = AnyDeskManager(self.config, self.telegram)
        else:
            self.anydesk_manager = None

        self.network_test = NetworkTest(self.config, self.telegram)

        # ‚ö†Ô∏è –°–¢–í–û–†–ò–¢–ò UI –í–°–Ü –†–ê–ó–ò, –∞ –ø–æ—Ç—ñ–º –ø–æ–∫–∞–∑–∞—Ç–∏ SetupWizard —è–∫—â–æ –ø–µ—Ä—à–∏–π –∑–∞–ø—É—Å–∫
        self.setup_ui()

        if self.config.is_first_run():
            self.show_setup_wizard()

    def get_app_version(self):
        """–û—Ç—Ä–∏–º–∞—Ç–∏ –≤–µ—Ä—Å—ñ—é –ø—Ä–æ–≥—Ä–∞–º–∏"""
        try:
            if getattr(sys, 'frozen', False):
                # –Ø–∫—â–æ EXE - —à—É–∫–∞—î–º–æ –ø–æ—Ä—É—á –∑ EXE
                base_path = Path(sys.executable).parent
            else:
                # –Ø–∫—â–æ DEV - —à—É–∫–∞—î–º–æ –≤ –∫–æ—Ä–µ–Ω—ñ –ø—Ä–æ–µ–∫—Ç—É
                base_path = Path(__file__).parent.parent

            version_file = base_path / "version.txt"

            if version_file.exists():
                return version_file.read_text(encoding='utf-8').strip()
        except Exception as e:
            logger.error(f"–ü–æ–º–∏–ª–∫–∞ —á–∏—Ç–∞–Ω–Ω—è –≤–µ—Ä—Å—ñ—ó: {e}")

        return "1.0.0"

    def show_setup_wizard(self):
        """–ü–æ–∫–∞–∑–∞—Ç–∏ –≤—ñ–∫–Ω–æ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –ø—Ä–∏ –ø–µ—Ä—à–æ–º—É –∑–∞–ø—É—Å–∫—É"""

        def on_setup_complete(result):
            self.config.set("store", result["store"])
            self.config.set("location", result["location"])
            if result.get("user_name"):
                self.config.set("user_name", result["user_name"])
            # ‚úÖ –û–Ω–æ–≤–∏—Ç–∏ UI –ø—ñ—Å–ª—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è
            self.refresh_ui()

        wizard = SetupWizard(self, on_setup_complete)
        self.wait_window(wizard)

    def refresh_ui(self):
        """–û–Ω–æ–≤–∏—Ç–∏ UI –ø—ñ—Å–ª—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è"""
        # –û–Ω–æ–≤–∏—Ç–∏ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –º–∞–≥–∞–∑–∏–Ω
        user_info = self.config.store_location_text
        user_name = self.config.get("user_name", "")
        if user_name:
            user_info += f" | üë§ {user_name}"

        self.info_label.configure(text=f"üìç {user_info}")

    def setup_ui(self):
        """–°—Ç–≤–æ—Ä–µ–Ω–Ω—è UI"""

        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        title_label = ctk.CTkLabel(
            self,
            text="RemoteHand",
            font=ctk.CTkFont(size=28, weight="bold")
        )
        title_label.pack(pady=15)

        # –Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ –º–∞–≥–∞–∑–∏–Ω/–ª–æ–∫–∞—Ü—ñ—é + –ü–Ü–ë
        user_info = self.config.store_location_text
        user_name = self.config.get("user_name", "")
        if user_name:
            user_info += f" | üë§ {user_name}"

        self.info_label = ctk.CTkLabel(
            self,
            text=f"üìç {user_info}",
            font=ctk.CTkFont(size=11),
            text_color="gray"
        )
        self.info_label.pack(pady=(0, 20))

        # ==================== RDP –ë–õ–û–ö ====================
        rdp_frame = ctk.CTkFrame(self)
        rdp_frame.pack(pady=15, padx=20, fill="x")

        ctk.CTkLabel(
            rdp_frame,
            text="üìã –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ 1–°",
            font=ctk.CTkFont(size=13, weight="bold")
        ).pack(anchor="w", pady=(0, 10))

        # –û—Å–Ω–æ–≤–Ω–∞ –∫–Ω–æ–ø–∫–∞ RDP
        rdp_btn = ctk.CTkButton(
            rdp_frame,
            text="üñ•Ô∏è –í—ñ–¥–∫—Ä–∏—Ç–∏ 1–° (RDP)",
            command=self.open_rdp,
            height=50,
            font=ctk.CTkFont(size=12, weight="bold"),
            corner_radius=12,
            fg_color="#007AFF",
            hover_color="#0051D5"
        )
        rdp_btn.pack(fill="x", pady=(0, 10))

        # ==================== –ó–ê–ö–†–ò–¢–¢–Ø –°–ï–°–Ü–ô ====================
        close_sessions_btn = ctk.CTkButton(
            self,
            text="‚ùå –ó–∞–∫—Ä–∏—Ç–∏ –≤—Å—ñ RDP —Å–µ—Å—ñ—ó",
            command=self.close_sessions_confirm,
            height=45,
            font=ctk.CTkFont(size=12, weight="bold"),
            corner_radius=12,
            fg_color="#FF3B30",
            hover_color="#D70015"
        )
        close_sessions_btn.pack(pady=15, padx=20, fill="x")

        # ==================== ANYDESK –ë–õ–û–ö ====================
        if anydesk_available:
            anydesk_frame = ctk.CTkFrame(self)
            anydesk_frame.pack(pady=15, padx=20, fill="x")

            ctk.CTkLabel(
                anydesk_frame,
                text="üåê –í—ñ–¥–¥–∞–ª–µ–Ω–∏–π –¥–æ—Å—Ç—É–ø",
                font=ctk.CTkFont(size=13, weight="bold")
            ).pack(anchor="w", pady=(0, 10))

            anydesk_btn = ctk.CTkButton(
                anydesk_frame,
                text="üöÄ –ó–∞–ø—É—Å—Ç–∏—Ç–∏ AnyDesk",
                command=self.start_anydesk,
                height=50,
                font=ctk.CTkFont(size=12, weight="bold"),
                corner_radius=12,
                fg_color="#FF6B35",
                hover_color="#CC5529"
            )
            anydesk_btn.pack(fill="x", pady=(0, 10))

        # ==================== –¢–ï–°–¢ –ú–ï–†–ï–ñ–Ü ====================
        test_frame = ctk.CTkFrame(self)
        test_frame.pack(pady=15, padx=20, fill="x")

        ctk.CTkLabel(
            test_frame,
            text="üîß –î—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∞",
            font=ctk.CTkFont(size=13, weight="bold")
        ).pack(anchor="w", pady=(0, 10))

        test_btn = ctk.CTkButton(
            test_frame,
            text="üì° –¢–µ—Å—Ç –∑'—î–¥–Ω–∞–Ω–Ω—è",
            command=self.run_network_test,
            height=50,
            font=ctk.CTkFont(size=12, weight="bold"),
            corner_radius=12,
            fg_color="#34C759",
            hover_color="#248A3D"
        )
        test_btn.pack(fill="x", pady=(0, 10))

        # ==================== –°–¢–ê–¢–£–° ====================
        self.status_label = ctk.CTkLabel(
            self,
            text="‚úÖ –ì–æ—Ç–æ–≤–æ –¥–æ —Ä–æ–±–æ—Ç–∏",
            font=ctk.CTkFont(size=10),
            text_color="gray"
        )
        self.status_label.pack(pady=10)

        # ==================== –ö–ù–û–ü–ö–ê –†–ï–î–ê–ì–£–í–ê–ù–ù–Ø –ú–ê–ì–ê–ó–ò–ù–£ ====================
        settings_frame = ctk.CTkFrame(self)
        settings_frame.pack(pady=10, padx=20, fill="x")

        settings_btn = ctk.CTkButton(
            settings_frame,
            text="‚öôÔ∏è –ó–º—ñ–Ω–∏—Ç–∏ –º–∞–≥–∞–∑–∏–Ω/–ª–æ–∫–∞—Ü—ñ—é/–ü–Ü–ë",
            command=self.show_setup_wizard,
            height=35,
            font=ctk.CTkFont(size=10),
            corner_radius=8,
            fg_color="#999999",
            hover_color="#666666"
        )
        settings_btn.pack(fill="x")

        # ==================== –í–ï–†–°–Ü–Ø + –°–¢–ê–¢–£–° –û–ù–û–í–õ–ï–ù–ù–Ø ====================
        version_frame = ctk.CTkFrame(self)
        version_frame.pack(anchor="se", padx=10, pady=10)

        version_label = ctk.CTkLabel(
            version_frame,
            text=f"v{self.get_app_version()}",
            font=ctk.CTkFont(size=9, weight="bold"),
            text_color="#333333"
        )
        version_label.pack(side="left", padx=5)

        self.update_status_label = ctk.CTkLabel(
            version_frame,
            text="‚úÖ",
            font=ctk.CTkFont(size=10),
            text_color="green"
        )
        self.update_status_label.pack(side="left", padx=5)

    def open_rdp(self):
        """–í—ñ–¥–∫—Ä–∏—Ç–∏ RDP"""
        if not self.rdp_manager:
            messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "RDP –º–µ–Ω–µ–¥–∂–µ—Ä –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω")
            return

        # –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —á–∏ –ø–∞—Ä–æ–ª—å –≤–∂–µ –∑–±–µ—Ä–µ–∂–µ–Ω–æ
        saved_password = self.rdp_manager.get_credentials(RDP_HOST, "admin")

        if saved_password:
            # –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –∑–±–µ—Ä–µ–∂–µ–Ω–∏–π –ø–∞—Ä–æ–ª—å
            self.set_status("‚è≥ –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è...", "processing")

            def connect():
                try:
                    if self.rdp_manager.connect_rdp(RDP_HOST, RDP_PORT, "admin", saved_password):
                        self.set_status("‚úÖ –ü—ñ–¥–∫–ª—é—á–µ–Ω–æ", "success")
                    else:
                        self.set_status("‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è", "error")
                except Exception as e:
                    logger.error(f"–ü–æ–º–∏–ª–∫–∞: {e}")
                    self.set_status("‚ùå –ö—Ä–∏—Ç–∏—á–Ω–∞ –ø–æ–º–∏–ª–∫–∞", "error")

            thread = threading.Thread(target=connect, daemon=True)
            thread.start()
        else:
            # –ó–∞–ø—Ä–æ—Å–∏—Ç–∏ –Ω–æ–≤–∏–π –ø–∞—Ä–æ–ª—å
            dialog = ctk.CTkInputDialog(
                text="–í–≤–µ–¥—ñ—Ç—å –ø–∞—Ä–æ–ª—å –¥–ª—è RDP:",
                title="–ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ 1–°"
            )
            password = dialog.get_input()

            if password:
                self.set_status("üíæ –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è –ø–∞—Ä–æ–ª—è...", "processing")

                # –°–ø—Ä–æ–±—É–≤–∞—Ç–∏ –ø—ñ–¥–∫–ª—é—á–∏—Ç–∏—Å—è
                if self.rdp_manager.connect_rdp(RDP_HOST, RDP_PORT, "admin", password):
                    # –Ø–∫—â–æ —É—Å–ø—ñ—à–Ω–æ, —Ç–æ –∑–±–µ—Ä–µ–≥—Ç–∏ –ø–∞—Ä–æ–ª—å
                    self.rdp_manager.save_credentials(RDP_HOST, "admin", password)
                    self.set_status("‚úÖ –£—Å–ø—ñ—à–Ω–æ –ø—ñ–¥–∫–ª—é—á–µ–Ω–æ", "success")
                else:
                    self.set_status("‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è", "error")

    def close_sessions_confirm(self):
        """–ü—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è –∑–∞–∫—Ä–∏—Ç—Ç—è —Å–µ—Å—ñ–π"""
        result = messagebox.askyesno(
            "–ü—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è",
            "–í–∏ –≤–ø–µ–≤–Ω–µ–Ω—ñ, —â–æ —Ö–æ—á–µ—Ç–µ –∑–∞–∫—Ä–∏—Ç–∏ –≤—Å—ñ RDP —Å–µ—Å—ñ—ó?"
        )
        if result:
            self.set_status("‚è≥ –ó–∞–∫—Ä–∏—Ç—Ç—è —Å–µ—Å—ñ–π...", "processing")
            close_all_rdp_sessions()
            self.set_status("‚úÖ –í—Å—ñ —Å–µ—Å—ñ—ó –∑–∞–∫—Ä–∏—Ç–æ", "success")

    def start_anydesk(self):
        """–ó–∞–ø—É—Å—Ç–∏—Ç–∏ AnyDesk - –ë–ï–ó –ø–æ–∫–∞–∑—É –ø–∞—Ä–æ–ª—è!"""
        if not self.anydesk_manager:
            messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "AnyDesk –º–µ–Ω–µ–¥–∂–µ—Ä –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω")
            return

        self.set_status("‚è≥ –ó–∞–ø—É—Å–∫ AnyDesk...", "processing")

        def anydesk_task():
            try:
                # –ó–∞–ø—É—Å—Ç–∏—Ç–∏ AnyDesk - –ø–∞—Ä–æ–ª—å –ù–ï –ø–µ—Ä–µ–¥–∞—î–º–æ —Ç–∞ –ù–ï –ø–æ–∫–∞–∑—É—î–º–æ!
                anydesk_id, pwd = self.anydesk_manager.start(None)

                if anydesk_id:
                    self.set_status(f"‚úÖ AnyDesk –∑–∞–ø—É—â–µ–Ω–æ\nüÜî ID: {anydesk_id}", "success")
                    messagebox.showinfo(
                        "‚úÖ AnyDesk –∑–∞–ø—É—â–µ–Ω–æ",
                        f"ID –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è: {anydesk_id}\n\n"
                        f"–î–∞–Ω—ñ –Ω–∞–¥—ñ—Å–ª–∞–Ω—ñ –≤ Telegram\n"
                        f"–ü–∞—Ä–æ–ª—å –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ"
                    )
                else:
                    self.set_status("‚ùå AnyDesk –≤–∂–µ –∑–∞–ø—É—â–µ–Ω–æ", "error")
                    messagebox.showwarning(
                        "‚ö†Ô∏è –£–≤–∞–≥–∞",
                        "AnyDesk –≤–∂–µ –∑–∞–ø—É—â–µ–Ω–æ –∞–±–æ –Ω–µ –≤–¥–∞–ª–æ—Å—è –∑–∞–ø—É—Å—Ç–∏—Ç–∏"
                    )
            except Exception as e:
                logger.error(f"–ü–æ–º–∏–ª–∫–∞: {e}")
                self.set_status("‚ùå –ü–æ–º–∏–ª–∫–∞ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è", "error")

        thread = threading.Thread(target=anydesk_task, daemon=True)
        thread.start()

    def run_network_test(self):
        """–ó–∞–ø—É—Å—Ç–∏—Ç–∏ —Ç–µ—Å—Ç –º–µ—Ä–µ–∂—ñ"""
        self.set_status("‚è≥ –¢–µ—Å—Ç –º–µ—Ä–µ–∂—ñ...", "processing")

        def test_task():
            try:
                result = self.network_test.run_full_test()
                self.set_status(f"{result['status']}", result['color'])
            except Exception as e:
                logger.error(f"–ü–æ–º–∏–ª–∫–∞ —Ç–µ—Å—Ç—É: {e}")
                self.set_status("‚ùå –ü–æ–º–∏–ª–∫–∞ —Ç–µ—Å—Ç—É", "error")

        thread = threading.Thread(target=test_task, daemon=True)
        thread.start()

    def set_status(self, text, status_type="info"):
        """–í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ —Å—Ç–∞—Ç—É—Å –∑ –∫–æ–ª—å–æ—Ä–æ–º"""
        color_map = {
            "success": "green",
            "error": "red",
            "processing": "blue",
            "info": "gray"
        }
        self.status_label.configure(text=text, text_color=color_map.get(status_type, "gray"))


def main():
    """–ì–æ–ª–æ–≤–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è"""
    logger.info("–ó–∞–ø—É—Å–∫ RemoteHand...")
    app = RemoteHandApp()
    app.mainloop()


if __name__ == "__main__":
    main()


================================================================================
–§–∞–π–ª 11/21: src\network_test.py
--------------------------------------------------------------------------------
import subprocess
import re
import socket
import logging
from pathlib import Path
import tempfile

logger = logging.getLogger(__name__)


class NetworkTest:
    """–¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è –º–µ—Ä–µ–∂—ñ –∑ –∑–≤—ñ—Ç–æ–º"""

    def __init__(self, config_manager, telegram_api):
        self.config = config_manager
        self.telegram = telegram_api

    def run_ping_test(self, host, count=20):
        """–í–∏–∫–æ–Ω–∞—Ç–∏ ping —Ç–µ—Å—Ç –Ω–∞ —Ö–æ—Å—Ç—É"""
        try:
            result = subprocess.run(
                ['ping', host, '-n', str(count)],
                capture_output=True,
                text=True,
                encoding='cp1252',
                timeout=60,
                creationflags=subprocess.CREATE_NO_WINDOW
            )
            return result.stdout
        except Exception as e:
            logger.error(f"–ü–æ–º–∏–ª–∫–∞ ping: {e}")
            return f"–ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—ñ {host}: {str(e)}"

    def parse_ping_loss(self, ping_output):
        """–í–∏—Ç—è–≥—Ç–∏ –≤—ñ–¥—Å–æ—Ç–æ–∫ –≤—Ç—Ä–∞—Ç–∏ –ø–∞–∫–µ—Ç—ñ–≤"""
        try:
            match = re.search(r'(\d+)%\s+(–ø–æ—Ç–µ—Ä—å|loss)', ping_output, re.IGNORECASE)
            if match:
                return int(match.group(1))
            return 0
        except:
            return -1

    def run_full_test(self):
        """–ó–∞–ø—É—Å—Ç–∏—Ç–∏ –ø–æ–≤–Ω–∏–π —Ç–µ—Å—Ç –º–µ—Ä–µ–∂—ñ"""
        pc_name = socket.gethostname()
        store_location = self.config.store_location_text

        hosts = {
            "1–° –°–µ—Ä–≤–µ—Ä": "23.88.7.196",
            "Google DNS": "8.8.8.8"
        }

        report_parts = []
        total_loss = 0

        for name, ip in hosts.items():
            ping_output = self.run_ping_test(ip)
            loss = self.parse_ping_loss(ping_output)

            if loss >= 0:
                status = "‚úÖ" if loss == 0 else ("‚ö†Ô∏è" if loss <= 15 else "‚ùå")
                report_parts.append(f"{status} {name} ({ip}): {loss}% –≤—Ç—Ä–∞—Ç–∏")
                total_loss += loss
            else:
                report_parts.append(f"‚ùå {name} ({ip}): –ü–æ–º–∏–ª–∫–∞ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è")

        avg_loss = total_loss / len(hosts) if hosts else 0

        if avg_loss == 0:
            status_text = "‚úÖ –ú–µ—Ä–µ–∂–∞ –≤ –Ω–æ—Ä–º—ñ"
            color = "green"
        elif avg_loss <= 15:
            status_text = "‚ö†Ô∏è –Ñ –Ω–µ–≤–µ–ª–∏–∫—ñ –ø—Ä–æ–±–ª–µ–º–∏"
            color = "orange"
        else:
            status_text = "‚ùå –°–µ—Ä–π–æ–∑–Ω—ñ –ø—Ä–æ–±–ª–µ–º–∏"
            color = "red"

        # –í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ –≤ Telegram
        test_report = "\n".join(report_parts)
        self.telegram.send_network_report(store_location, pc_name, test_report)

        return {
            "status": status_text,
            "color": color,
            "details": test_report
        }


================================================================================
–§–∞–π–ª 12/21: src\rdp_manager.py
--------------------------------------------------------------------------------
import os
import subprocess
import time
import winreg
import logging
import keyring
from pathlib import Path

logger = logging.getLogger(__name__)


class RDPManager:
    """–ú–µ–Ω–µ–¥–∂–µ—Ä –¥–ª—è RDP –ø—ñ–¥–∫–ª—é—á–µ–Ω—å –∑ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–º –ª–æ–≥—ñ–Ω–æ–º"""

    def __init__(self, config_manager, telegram_api):
        self.config = config_manager
        self.telegram = telegram_api

    def save_credentials(self, host, username, password):
        """–ó–±–µ—Ä–µ–≥—Ç–∏ RDP –¥–∞–Ω—ñ –≤ Windows Credential Manager"""
        try:
            keyring.set_password(f"RDP_{host}", username, password)
            self.config.set("rdp_password", password)
            logger.info(f"‚úÖ –î–∞–Ω—ñ –∑–±–µ—Ä–µ–∂–µ–Ω—ñ –¥–ª—è {host}")
            return True
        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è: {e}")
            return False

    def get_credentials(self, host, username):
        """–û—Ç—Ä–∏–º–∞—Ç–∏ –ø–∞—Ä–æ–ª—å –∑ Credential Manager"""
        try:
            password = keyring.get_password(f"RDP_{host}", username)
            return password
        except:
            return None

    def connect_rdp(self, host, port, username, password=None):
        """–ü—ñ–¥–∫–ª—é—á–∏—Ç–∏—Å—è –¥–æ RDP"""
        try:
            # –ö–æ–¥—É–≤–∞–Ω–Ω—è –ø–∞—Ä–æ–ª—è –¥–ª—è .RDP —Ñ–∞–π–ª—É
            encrypted_password = self._encrypt_rdp_password(password) if password else ""

            rdp_content = f"""screen mode id:i:2
use multimon:i:0
desktopwidth:i:1920
desktopheight:i:1080
session bpp:i:32
connection type:i:7
disable wallpaper:i:0
allow font smoothing:i:1
allow desktop composition:i:1
disable full window drag:i:0
disable menu anims:i:0
disable themes:i:0
disable cursor setting:i:0
bitmapcachepersistenable:i:1
full address:s:{host}:{port}
audiomode:i:0
redirectprinters:i:0
redirectcomports:i:0
redirectsmartcards:i:0
redirectclipboard:i:1
redirectposdevices:i:0
autoreconnection enabled:i:1
authentication level:i:0
prompt for credentials on client:i:0
negotiate security layer:i:1
enablecredsspsupport:i:1
username:s:{username}
password 51:b:{encrypted_password}
"""

            rdp_file = f"{host}_{username}_session.rdp"
            with open(rdp_file, "w") as f:
                f.write(rdp_content)

            subprocess.Popen(f"mstsc {rdp_file}")
            logger.info(f"‚úÖ RDP –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –∑–∞–ø—É—â–µ–Ω–æ")

            # –í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ –≤ Telegram
#            self.telegram.send_rdp_info(
#                self.config.store_location_text,
#                os.environ.get('COMPUTERNAME', 'Unknown')
#            )

            return True
        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è: {e}")
            return False

    def _encrypt_rdp_password(self, password):
        """–ü—Ä–æ—Å—Ç–æ–µ —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è –ø–∞—Ä–æ–ª—è –¥–ª—è .RDP"""
        encrypted = ""
        for char in password:
            encrypted += format(ord(char) ^ 0xAA, '02x')
        return encrypted


================================================================================
–§–∞–π–ª 13/21: src\set_anydesk_password.py
--------------------------------------------------------------------------------
#!/usr/bin/env python3
"""–í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –ø–∞—Ä–æ–ª—è AnyDesk –∑ –∞–¥–º—ñ–Ω –ø—Ä–∞–≤–∞–º–∏"""

import subprocess
import sys
import os
import time
import ctypes

ANYDESK_PATH = sys.argv[1] if len(sys.argv) > 1 else None
PASSWORD = os.getenv("ANYDESK_PASSWORD", "r3moteh4nd")

if not ANYDESK_PATH or not os.path.exists(ANYDESK_PATH):
    print("[!] AnyDesk –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ")
    sys.exit(1)

# –ü–µ—Ä–µ–≤—ñ—Ä–∏–º–æ —á–∏ –∑–∞–ø—É—â–µ–Ω–æ –∑ –∞–¥–º—ñ–Ω –ø—Ä–∞–≤–∞–º–∏
try:
    is_admin = ctypes.windll.shell32.IsUserAnAdmin()
    if not is_admin:
        print("[!] –ü–æ—Ç—Ä—ñ–±–Ω—ñ –∞–¥–º—ñ–Ω –ø—Ä–∞–≤–∞")
        # –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–∏ –∑ –∞–¥–º—ñ–Ω –ø—Ä–∞–≤–∞–º–∏
        ctypes.windll.shell32.ShellExecuteW(
            None,
            "runas",
            sys.executable,
            f'"{__file__}" "{ANYDESK_PATH}"',
            None,
            1  # SW_SHOW
        )
        sys.exit(0)
except:
    pass

try:
    print(f"[*] –í—Å—Ç–∞–Ω–æ–≤–ª—é—é –ø–∞—Ä–æ–ª—å AnyDesk (—É –∞–¥–º—ñ–Ω—ñ)...")
    time.sleep(1)

    # –í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ —á–µ—Ä–µ–∑ stdin
    cmd = [ANYDESK_PATH, "--set-password", "_full_access"]

    result = subprocess.run(
        cmd,
        input=PASSWORD + "\n",
        capture_output=True,
        text=True,
        timeout=10
    )

    print(f"[CODE] {result.returncode}")
    if result.returncode in [0, 8000]:
        print("[‚úì] –ü–∞—Ä–æ–ª—å –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ!")
    else:
        print(f"[!] –ö–æ–¥: {result.returncode}")

    sys.exit(0)

except Exception as e:
    print(f"[!] –ü–æ–º–∏–ª–∫–∞: {e}")
    sys.exit(1)


================================================================================
–§–∞–π–ª 14/21: src\setup_wizard.py
--------------------------------------------------------------------------------
import customtkinter as ctk
import tkinter.messagebox as messagebox


class SetupWizard(ctk.CTkToplevel):
    def __init__(self, parent, on_complete):
        super().__init__(parent)

        self.title("RemoteHand - –ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞")
        self.geometry("450x500")
        self.resizable(False, False)

        # –¶–µ–Ω—Ç—Ä—É–≤–∞—Ç–∏ –Ω–∞ –µ–∫—Ä–∞–Ω—ñ
        self.transient(parent)
        self.grab_set()

        # ‚ö†Ô∏è –ó–ê–ë–û–†–û–ù–ò–¢–ò –ó–ê–ö–†–ò–¢–¢–Ø –ë–ï–ó –ó–ë–ï–†–ï–ñ–ï–ù–ù–Ø
        self.protocol("WM_DELETE_WINDOW", self.on_closing)

        self.on_complete = on_complete
        self.setup_complete = False

        # –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç–µ–º–∏
        ctk.set_appearance_mode("light")
        ctk.set_default_color_theme("blue")

        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        title = ctk.CTkLabel(
            self,
            text="–ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞",
            font=ctk.CTkFont(size=18, weight="bold")
        )
        title.pack(pady=20)

        # ===== –ú–ê–ì–ê–ó–ò–ù (–í–´–ë–Ü–†) =====
        ctk.CTkLabel(
            self,
            text="–í–∏–±–µ—Ä—ñ—Ç—å –º–∞–≥–∞–∑–∏–Ω:",
            font=ctk.CTkFont(size=12, weight="bold")
        ).pack(anchor="w", padx=20, pady=(10, 5))

        self.store_var = ctk.StringVar(value="")
        store_options = [
            "0 / –û—Ñ—ñ—Å",
            "1 / –î—ñ–∞–ª–æ–≥",
            "5 / –ü–æ–ª—Ç–∞–≤–∞",
            "7 / –û–∞–∑–∏—Å",
            "8 / –•–º–µ–ª—å–Ω–∏—Ü—å–∫–∏–π",
            "9 / –ß–µ—Ä–Ω—ñ–≤—Ü—ñ",
            "17 / –ö—Ä–µ–º–µ–Ω—á—É–∫",
            "18 / –ü_–ö–æ—Ç–ª—è—Ä–µ–≤—Å—å–∫–æ–≥–æ",
            "20 / –©–∞—Å–ª–∏–≤–∏–π",
            "21 / –°–æ—Ñ—ñ—è –º–æ–ª–ª"
        ]

        self.store_menu = ctk.CTkComboBox(
            self,
            values=store_options,
            variable=self.store_var,
            font=ctk.CTkFont(size=11),
            height=35
        )
        self.store_menu.pack(padx=20, fill="x", pady=(0, 20))

        # ===== –õ–û–ö–ê–¶–Ü–Ø (–í–´–ë–Ü–†) =====
        ctk.CTkLabel(
            self,
            text="–í–∏–±–µ—Ä—ñ—Ç—å –ª–æ–∫–∞—Ü—ñ—é:",
            font=ctk.CTkFont(size=12, weight="bold")
        ).pack(anchor="w", padx=20, pady=(10, 5))

        self.location_var = ctk.StringVar(value="")
        location_options = [
            "–∫–∞—Å–∞",
            "–∫–∞—Å–∞ 2",
            "–ø—ñ–¥—Å–æ–±–∫–∞",
            "–æ—Å–æ–±–∏—Å—Ç–∏–π"
        ]

        self.location_menu = ctk.CTkComboBox(
            self,
            values=location_options,
            variable=self.location_var,
            font=ctk.CTkFont(size=11),
            height=35
        )
        self.location_menu.pack(padx=20, fill="x", pady=(0, 20))

        # ===== –ü–Ü–ë (–û–ü–¶–Ü–ô–ù–û) =====
        ctk.CTkLabel(
            self,
            text="–ü–Ü–ë –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ (–æ–ø—Ü—ñ–π–Ω–æ):",
            font=ctk.CTkFont(size=12, weight="bold")
        ).pack(anchor="w", padx=20, pady=(10, 5))

        self.user_name_entry = ctk.CTkEntry(
            self,
            placeholder_text="–ù–∞–ø—Ä–∏–∫–ª–∞–¥: –Ü–≤–∞–Ω –ü–µ—Ç—Ä–µ–Ω–∫–æ",
            height=35,
            font=ctk.CTkFont(size=11)
        )
        self.user_name_entry.pack(padx=20, fill="x", pady=(0, 30))

        # –ö–Ω–æ–ø–∫–∞
        btn = ctk.CTkButton(
            self,
            text="‚úÖ –ó–±–µ—Ä–µ–≥—Ç–∏",
            command=self.save_settings,
            height=45,
            font=ctk.CTkFont(size=12, weight="bold"),
            corner_radius=10
        )
        btn.pack(padx=20, fill="x", pady=10)

    def on_closing(self):
        """–ó–∞–±–æ—Ä–æ–Ω–∏—Ç–∏ –∑–∞–∫—Ä–∏—Ç—Ç—è –±–µ–∑ –≤–≤–µ–¥–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö"""
        if not self.setup_complete:
            messagebox.showwarning(
                "–ü–æ–º–∏–ª–∫–∞",
                "–í–∏–±–µ—Ä—ñ—Ç—å –º–∞–≥–∞–∑–∏–Ω —ñ –ª–æ–∫–∞—Ü—ñ—é –ø–µ—Ä–µ–¥ –∑–∞–∫—Ä–∏—Ç—Ç—è–º!"
            )
            return
        self.destroy()

    def save_settings(self):
        """–ó–±–µ—Ä–µ–≥—Ç–∏ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è - –æ–±–æ–≤'—è–∑–∫–æ–≤–æ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏"""
        store = self.store_var.get().strip()
        location = self.location_var.get().strip()
        user_name = self.user_name_entry.get().strip()

        # ‚ö†Ô∏è –û–ë–û–í'–Ø–ó–ö–û–í–ê –ü–ï–†–ï–í–Ü–†–ö–ê
        if not store:
            messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–í–∏–±–µ—Ä—ñ—Ç—å –º–∞–≥–∞–∑–∏–Ω!")
            return

        if not location:
            messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–í–∏–±–µ—Ä—ñ—Ç—å –ª–æ–∫–∞—Ü—ñ—é!")
            return

        # –í—Å–µ –æ–∫ - –∑–±–µ—Ä–µ–∂–µ–º–æ
        self.setup_complete = True
        self.on_complete({
            "store": store,
            "location": location,
            "user_name": user_name
        })
        self.destroy()


================================================================================
–§–∞–π–ª 15/21: src\telegram_api.py
--------------------------------------------------------------------------------
import requests
import logging
import time
import os
from pathlib import Path

logger = logging.getLogger(__name__)


class TelegramAPI:
    """–†–æ–∑—à–∏—Ä–µ–Ω–∞ Telegram API –¥–ª—è –∑–≤—ñ—Ç—É–≤–∞–Ω–Ω—è"""

    def __init__(self, token, chat_id):
        self.token = token
        self.chat_id = chat_id

        # ‚ö†Ô∏è –ü–ï–†–ï–í–Ü–†–ê –¢–û–ö–ï–ù–Ü–í
        if not token:
            logger.error("‚ùå Telegram —Ç–æ–∫–µ–Ω –Ω–µ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ!")
            self.api_url = None
        elif not chat_id:
            logger.error("‚ùå Telegram chat_id –Ω–µ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ!")
            self.api_url = None
        else:
            self.api_url = f"https://api.telegram.org/bot{token}"
            logger.info(f"‚úÖ Telegram –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–æ (—Ç–æ–∫–µ–Ω: {token[:20]}...)")

    def send_message(self, text, parse_mode="HTML"):
        """–í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ —Ç–µ–∫—Å—Ç–æ–≤–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è"""
        if not self.api_url:
            logger.error("‚ùå Telegram –Ω–µ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–æ")
            return False

        try:
            payload = {
                "chat_id": self.chat_id,
                "text": text,
                "parse_mode": parse_mode
            }
            response = requests.post(
                f"{self.api_url}/sendMessage",
                json=payload,
                timeout=10
            )
            response.raise_for_status()
            logger.info("‚úÖ –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –Ω–∞–¥—ñ—Å–ª–∞–Ω–æ –≤ Telegram")
            return True
        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞ –≤—ñ–¥–ø—Ä–∞–≤–∫–∏ Telegram: {e}")
            return False

    def send_file(self, file_path, caption="", file_type="document"):
        """–í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ —Ñ–∞–π–ª (document –∞–±–æ photo)"""
        if not self.api_url:
            logger.error("‚ùå Telegram –Ω–µ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–æ")
            return False

        try:
            with open(file_path, 'rb') as f:
                files = {file_type: f}
                payload = {
                    "chat_id": self.chat_id,
                    "caption": caption,
                    "parse_mode": "HTML"
                }
                endpoint = "sendDocument" if file_type == "document" else "sendPhoto"
                response = requests.post(
                    f"{self.api_url}/{endpoint}",
                    files=files,
                    data=payload,
                    timeout=30
                )
                response.raise_for_status()
            logger.info(f"‚úÖ –§–∞–π–ª –Ω–∞–¥—ñ—Å–ª–∞–Ω–æ –≤ Telegram")
            return True
        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞ –≤—ñ–¥–ø—Ä–∞–≤–∫–∏ —Ñ–∞–π–ª—É: {e}")
            return False

    def send_network_report(self, store_location, pc_name, test_results):
        """–í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ –∑–≤—ñ—Ç –ø—Ä–æ —Å—Ç–∞–Ω –º–µ—Ä–µ–∂—ñ"""
        report = (
            f"<b>üìä –ó–≤—ñ—Ç –ø—Ä–æ —Å—Ç–∞–Ω –º–µ—Ä–µ–∂—ñ</b>\n\n"
            f"<b>–ú–∞–≥–∞–∑–∏–Ω/–õ–æ–∫–∞—Ü—ñ—è:</b> {store_location}\n"
            f"<b>–ü–ö:</b> <code>{pc_name}</code>\n"
            f"<b>–ß–∞—Å:</b> {time.strftime('%Y-%m-%d %H:%M:%S')}\n\n"
            f"<b>–†–µ–∑—É–ª—å—Ç–∞—Ç–∏:</b>\n"
            f"{test_results}"
        )
        return self.send_message(report)

    def send_anydesk_info(self, store_location, user_name, pc_name, anydesk_id, password):
        """–í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ AnyDesk —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é"""

        # –î–æ–¥–∞—Ç–∏ –ü–Ü–ë —è–∫—â–æ —î
        user_info = f"\n<b>üë§ –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á:</b> {user_name}" if user_name else ""

        message = (
            f"<b>üåê AnyDesk - –ó–∞–ø—Ä–æ—Å –Ω–∞ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è</b>\n\n"
            f"<b>üìç –ú–∞–≥–∞–∑–∏–Ω/–õ–æ–∫–∞—Ü—ñ—è:</b> {store_location}{user_info}\n"
            f"<b>üíª –ü–ö:</b> <code>{pc_name}</code>\n\n"
            f"<b>üÜî ID:</b> <code>{anydesk_id}</code>\n"
            f"<b>üîê –ü–∞—Ä–æ–ª—å:</b> <code>{password}</code>"
        )
        return self.send_message(message)

    def send_rdp_info(self, store_location, pc_name):
        """–í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è –ø—Ä–æ RDP –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è"""
        message = (
            f"<b>üñ•Ô∏è RDP –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è</b>\n\n"
            f"<b>–ú–∞–≥–∞–∑–∏–Ω/–õ–æ–∫–∞—Ü—ñ—è:</b> {store_location}\n"
            f"<b>–ü–ö:</b> <code>{pc_name}</code>\n"
            f"<b>–ß–∞—Å:</b> {time.strftime('%Y-%m-%d %H:%M:%S')}\n\n"
            f"‚úÖ –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –ø—ñ–¥–∫–ª—é—á–∏–≤—Å—è –¥–æ 1–°"
        )
        return self.send_message(message)

    def send_error_report(self, store_location, pc_name, error_text):
        """–í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ –∑–≤—ñ—Ç –ø—Ä–æ –ø–æ–º–∏–ª–∫—É"""
        message = (
            f"<b>‚ùå –ü–æ–º–∏–ª–∫–∞</b>\n\n"
            f"<b>–ú–∞–≥–∞–∑–∏–Ω/–õ–æ–∫–∞—Ü—ñ—è:</b> {store_location}\n"
            f"<b>–ü–ö:</b> <code>{pc_name}</code>\n"
            f"<b>–ß–∞—Å:</b> {time.strftime('%Y-%m-%d %H:%M:%S')}\n\n"
            f"<b>–î–µ—Ç–∞–ª—ñ:</b>\n<code>{error_text}</code>"
        )
        return self.send_message(message)


================================================================================
–§–∞–π–ª 16/21: src\telegram_helper.py
--------------------------------------------------------------------------------
import asyncio
import json
import logging
from telegram import Bot

logger = logging.getLogger(__name__)


class TelegramHelper:
    """–î–æ–ø–æ–º—ñ–∂–Ω–∏–∫ –¥–ª—è –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å –≤ Telegram"""

    def __init__(self, config_path="bot_config.json"):
        self.config_path = config_path
        self.config = self.load_config()

    def load_config(self):
        """–ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –∫–æ–Ω—Ñ—ñ–≥"""
        try:
            with open(self.config_path, "r", encoding="utf-8") as f:
                return json.load(f)
        except:
            return {}

    async def send_anydesk_code(self, anydesk_id, password):
        """–í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ AnyDesk –¥–∞–Ω—ñ –≤ Telegram"""
        try:
            token = self.config.get("TELEGRAM_TOKEN")
            chat_id = self.config.get("CHAT_ID")

            if not token or not chat_id:
                logger.error("‚ùå –ù–µ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ñ TELEGRAM_TOKEN –∞–±–æ CHAT_ID")
                return False

            bot = Bot(token=token)

            message = (
                f"üñ•Ô∏è **AnyDesk —Å–µ—Å—ñ—è –∞–∫—Ç–∏–≤–æ–≤–∞–Ω–∞**\n\n"
                f"üÜî ID: `{anydesk_id}`\n"
                f"üîê –ü–∞—Ä–æ–ª—å: `{password}`\n\n"
                f"–î–ª—è –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ —Ü—ñ –¥–∞–Ω—ñ."
            )

            await bot.send_message(
                chat_id=chat_id,
                text=message,
                parse_mode="Markdown"
            )

            logger.info("‚úÖ –î–∞–Ω—ñ –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω—ñ –≤ Telegram")
            return True

        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞ –≤—ñ–¥–ø—Ä–∞–≤–∫–∏: {e}")
            return False

    async def send_message(self, text):
        """–í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ –¥–æ–≤—ñ–ª—å–Ω–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è"""
        try:
            token = self.config.get("TELEGRAM_TOKEN")
            chat_id = self.config.get("CHAT_ID")

            if not token or not chat_id:
                return False

            bot = Bot(token=token)
            await bot.send_message(chat_id=chat_id, text=text)

            return True

        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞: {e}")
            return False

    def send_anydesk_code_sync(self, anydesk_id, password):
        """–°–∏–Ω—Ö—Ä–æ–Ω–Ω–∞ –≤–µ—Ä—Å—ñ—è (–¥–ª—è GUI)"""
        try:
            loop = asyncio.new_event_loop()
            asyncio.set_event_loop(loop)
            result = loop.run_until_complete(
                self.send_anydesk_code(anydesk_id, password)
            )
            loop.close()
            return result
        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞: {e}")
            return False


================================================================================
–§–∞–π–ª 17/21: src\updater.py
--------------------------------------------------------------------------------
import os
import sys
import requests
import subprocess
import time
import logging
from pathlib import Path

logger = logging.getLogger(__name__)


class UpdaterManager:
    """–ú–µ–Ω–µ–¥–∂–µ—Ä –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ —Ç–∞ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –æ–Ω–æ–≤–ª–µ–Ω—å"""

    GITHUB_REPO = "ShevchukVI/RemoteHand"
    GITHUB_API_URL = f"https://api.github.com/repos/{GITHUB_REPO}/releases/latest"

    def __init__(self):
        self.app_dir = Path(__file__).parent.parent
        self.version_file = self.app_dir / "version.txt"
        self.current_version = self.get_current_version()

    def get_current_version(self):
        """–û—Ç—Ä–∏–º–∞—Ç–∏ –ø–æ—Ç–æ—á–Ω—É –≤–µ—Ä—Å—ñ—é"""
        if self.version_file.exists():
            try:
                with open(self.version_file, 'r', encoding='utf-8') as f:
                    return f.read().strip()
            except:
                pass
        return "1.0.0"

    def get_latest_version(self):
        """–û—Ç—Ä–∏–º–∞—Ç–∏ –Ω–∞–π–Ω–æ–≤—ñ—à—É –≤–µ—Ä—Å—ñ—é –∑ GitHub"""
        try:
            response = requests.get(self.GITHUB_API_URL, timeout=10)
            response.raise_for_status()
            data = response.json()
            tag = data.get('tag_name', 'v1.0.0')
            return tag.lstrip('v')
        except Exception as e:
            logger.warning(f"–ù–µ –≤–¥–∞–ª–æ—Å—è –æ—Ç—Ä–∏–º–∞—Ç–∏ –≤–µ—Ä—Å—ñ—é –∑ GitHub: {e}")
            return None

    def compare_versions(self, current, latest):
        """–ü–æ—Ä—ñ–≤–Ω—è—Ç–∏ –≤–µ—Ä—Å—ñ—ó"""
        try:
            current_parts = [int(x) for x in current.split('.')]
            latest_parts = [int(x) for x in latest.split('.')]
            return latest_parts > current_parts
        except:
            return False

    def download_and_update(self, latest_version):
        """–ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —Ç–∞ –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –Ω–æ–≤—É –≤–µ—Ä—Å—ñ—é"""
        try:
            logger.info(f"üì• –ó–∞–≤–∞–Ω—Ç–∞–∂—É—é RemoteHand v{latest_version}...")

            download_url = f"https://github.com/{self.GITHUB_REPO}/releases/download/v{latest_version}/RemoteHand.exe"

            # –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –Ω–æ–≤—É –≤–µ—Ä—Å—ñ—é
            response = requests.get(download_url, timeout=30)
            response.raise_for_status()

            # –í–∏–∑–Ω–∞—á–∏—Ç–∏ —à–ª—è—Ö –¥–ª—è –Ω–æ–≤–æ—ó –≤–µ—Ä—Å—ñ—ó
            if getattr(sys, 'frozen', False):
                # –Ø–∫—â–æ –∑–∞–ø—É—â–µ–Ω–æ —è–∫ EXE
                current_exe = Path(sys.executable)
                new_exe = current_exe.parent / "RemoteHand_new.exe"
            else:
                # –Ø–∫—â–æ –∑–∞–ø—É—â–µ–Ω–æ —è–∫ Python —Å–∫—Ä–∏–ø—Ç (DEV)
                new_exe = Path.cwd() / "RemoteHand_new.exe"

            # –ó–±–µ—Ä–µ–≥—Ç–∏ –Ω–æ–≤—É –≤–µ—Ä—Å—ñ—é
            with open(new_exe, 'wb') as f:
                f.write(response.content)

            logger.info(f"‚úÖ RemoteHand v{latest_version} –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ")
            return str(new_exe)

        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è: {e}")
            return None

    def check_and_update(self):
        """–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —Ç–∞ –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è"""
        # –ù–ï –æ–Ω–æ–≤–ª—é–≤–∞—Ç–∏ –≤ DEV —Ä–µ–∂–∏–º—ñ!
        if os.getenv('REMOTEHAND_DEV_MODE') == '1':
            logger.info("üîß DEV —Ä–µ–∂–∏–º - –ø—Ä–æ–ø—É—Å–∫–∞—î–º–æ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è")
            return False

        logger.info("üîç –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –æ–Ω–æ–≤–ª–µ–Ω—å...")

        latest_version = self.get_latest_version()
        if not latest_version:
            logger.info("‚ö†Ô∏è –ù–µ –≤–¥–∞–ª–æ—Å—è –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è")
            return False

        if self.compare_versions(self.current_version, latest_version):
            logger.info(f"üì¶ –î–æ—Å—Ç—É–ø–Ω–µ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è: {latest_version}")
            logger.info(f"üìå –ü–æ—Ç–æ—á–Ω–∞ –≤–µ—Ä—Å—ñ—è: {self.current_version}")

            # –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –Ω–æ–≤—É –≤–µ—Ä—Å—ñ—é
            new_exe = self.download_and_update(latest_version)

            if new_exe and os.path.exists(new_exe):
                logger.info(f"‚úÖ –ù–æ–≤–∞ –≤–µ—Ä—Å—ñ—è –≥–æ—Ç–æ–≤–∞!")
                logger.info(f"üîÑ –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫...")

                # ‚ö†Ô∏è –ê–í–¢–û–ú–ê–¢–ò–ß–ù–ò–ô –ü–ï–†–ï–ó–ê–ü–£–°–ö
                try:
                    # –ó–∞–ø—É—Å—Ç–∏—Ç–∏ –Ω–æ–≤—É –≤–µ—Ä—Å—ñ—é
                    subprocess.Popen([new_exe], shell=False)

                    # –ß–µ–∫–∞—Ç–∏ 1 —Å–µ–∫—É–Ω–¥—É
                    time.sleep(1)

                    # –ó–∞–∫—Ä–∏—Ç–∏ –ø–æ—Ç–æ—á–Ω—É –≤–µ—Ä—Å—ñ—é
                    logger.info("üëã –ó–∞–≤–µ—Ä—à–µ–Ω–Ω—è —Ä–æ–±–æ—Ç–∏ —Å—Ç–∞—Ä–æ—ó –≤–µ—Ä—Å—ñ—ó")
                    sys.exit(0)

                except Exception as e:
                    logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫—É: {e}")
                    logger.info(f"–ó–∞–ø—É—Å—Ç—ñ—Ç—å –≤—Ä—É—á–Ω—É: {new_exe}")
                    return False

                return True

        logger.info(f"‚úÖ –í–µ—Ä—Å—ñ—è –∞–∫—Ç—É–∞–ª—å–Ω–∞: {self.current_version}")
        return False


def check_and_update():
    """–§—É–Ω–∫—Ü—ñ—è –¥–ª—è —ñ–º–ø–æ—Ä—Ç—É –≤ main.py"""
    updater = UpdaterManager()
    return updater.check_and_update()


================================================================================
–§–∞–π–ª 18/21: src\utils.py
--------------------------------------------------------------------------------
import os
import sys
import subprocess
import psutil
from pathlib import Path
from config import LOCK_FILE, APP_NAME


class SingleInstance:
    """–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –Ω–∞ —î–¥–∏–Ω–∏–π –µ–∫–∑–µ–º–ø–ª—è—Ä –ø—Ä–æ–≥—Ä–∞–º–∏"""

    def __init__(self):
        self.lock_file = LOCK_FILE
        self.fp = None

    def is_running(self):
        """–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —á–∏ –ø—Ä–æ–≥—Ä–∞–º–∞ –≤–∂–µ –∑–∞–ø—É—â–µ–Ω–∞"""
        if sys.platform == 'win32':
            import win32event
            import win32api
            import winerror

            self.mutex = win32event.CreateMutex(None, False, APP_NAME)
            if win32api.GetLastError() == winerror.ERROR_ALREADY_EXISTS:
                return True
        else:
            try:
                self.fp = open(self.lock_file, 'w')
                import fcntl
                fcntl.flock(self.fp, fcntl.LOCK_EX | fcntl.LOCK_NB)
            except IOError:
                return True
        return False


def open_rdp_connection(host, port):
    """–í—ñ–¥–∫—Ä–∏—Ç—Ç—è RDP –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è"""
    rdp_command = f'mstsc /v:{host}:{port}'
    subprocess.Popen(rdp_command, shell=True)


def close_all_rdp_sessions():
    """–ó–∞–∫—Ä–∏—Ç—Ç—è –≤—Å—ñ—Ö RDP —Å–µ—Å—ñ–π"""
    for proc in psutil.process_iter(['name']):
        try:
            if proc.info['name'].lower() == 'mstsc.exe':
                proc.kill()
        except (psutil.NoSuchProcess, psutil.AccessDenied):
            pass


def test_connection(host):
    """–¢–µ—Å—Ç –∑'—î–¥–Ω–∞–Ω–Ω—è —á–µ—Ä–µ–∑ ping"""
    param = '-n' if sys.platform == 'win32' else '-c'
    command = ['ping', param, '1', host]
    result = subprocess.run(command, capture_output=True, text=True)
    return result.returncode == 0

================================================================================
–§–∞–π–ª 19/21: version.txt
--------------------------------------------------------------------------------
—è—é1 . 0 . 4 
 
 

================================================================================
–§–∞–π–ª 20/21: version_info.txt
--------------------------------------------------------------------------------
VSVersionInfo(
  ffi=FixedFileInfo(mask=0x3f,
    mask_values=[(0, 63), (0, 63), (0, 63), (0, 63)],
    CV_VSVersionInfo=[(0, '0'), (0, '3'), (0, '0'), (0, '0')]),
  StringFileInfo([(u'040904B0',
    StringTable(u'040904B0',
      [StringEntry(u'CompanyName', u'RemoteHand'),
       StringEntry(u'FileDescription', u'RemoteHand - RDP & AnyDesk Manager'),
       StringEntry(u'FileVersion', u'1.0.3.0'),
       StringEntry(u'ProductName', u'RemoteHand'),
       StringEntry(u'ProductVersion', u'1.0.3')]))]),
  VarFileInfo([VarEntry(u'Translation', [1033, 1200])])
)


================================================================================
–§–∞–π–ª 21/21: –ê–∫—Ç–∏–≤–∞—Ü—ñ—è —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞.txt
--------------------------------------------------------------------------------
.venvScriptsActivate.ps1

================================================================================
–ö–Ü–ù–ï–¶–¨ –ï–ö–°–ü–û–†–¢–£
================================================================================


================================================================================
–§–∞–π–ª 5/20: project_export_20251110_151306.txt
--------------------------------------------------------------------------------
================================================================================
–ï–ö–°–ü–û–†–¢ –ü–†–û–Ñ–ö–¢–£: RemoteHand
–î–∞—Ç–∞: 2025-11-10 15:13:06
–®–ª—è—Ö: D:\Python Projects\Prego\RemoteHand
================================================================================

üìÇ –°–¢–†–£–ö–¢–£–†–ê –ü–†–û–Ñ–ö–¢–£
--------------------------------------------------------------------------------
RemoteHand/
‚îú‚îÄ‚îÄ assets/
‚îÇ   ‚îî‚îÄ‚îÄ icon.ico
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ anydesk_manager.py
‚îÇ   ‚îú‚îÄ‚îÄ config.py
‚îÇ   ‚îú‚îÄ‚îÄ config_manager.py
‚îÇ   ‚îú‚îÄ‚îÄ main.py
‚îÇ   ‚îú‚îÄ‚îÄ network_test.py
‚îÇ   ‚îú‚îÄ‚îÄ rdp_manager.py
‚îÇ   ‚îú‚îÄ‚îÄ setup_wizard.py
‚îÇ   ‚îú‚îÄ‚îÄ telegram_api.py
‚îÇ   ‚îú‚îÄ‚îÄ updater.py
‚îÇ   ‚îî‚îÄ‚îÄ utils.py
‚îú‚îÄ‚îÄ .env.example
‚îú‚îÄ‚îÄ 23.88.7.196_admin_session.rdp
‚îú‚îÄ‚îÄ dev_run.py
‚îú‚îÄ‚îÄ export.py
‚îú‚îÄ‚îÄ GitCommitTool.py
‚îú‚îÄ‚îÄ project_export_20251110_104446.txt
‚îú‚îÄ‚îÄ project_export_20251110_151306.txt
‚îú‚îÄ‚îÄ README.md
‚îú‚îÄ‚îÄ RemoteHand.spec
‚îú‚îÄ‚îÄ requirements.txt
‚îú‚îÄ‚îÄ version.txt
‚îú‚îÄ‚îÄ version_info.txt
‚îî‚îÄ‚îÄ –ê–∫—Ç–∏–≤–∞—Ü—ñ—è —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞.txt

üìÑ –í–ú–Ü–°–¢ –§–ê–ô–õ–Ü–í (20 —Ñ–∞–π–ª—ñ–≤)
================================================================================


================================================================================
–§–∞–π–ª 1/20: dev_run.py
--------------------------------------------------------------------------------
"""
DEV_RUN.PY - –õ–æ–∫–∞–ª—å–Ω–µ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è
"""

import sys
import os

# –í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ DEV —Ä–µ–∂–∏–º
os.environ['REMOTEHAND_DEV_MODE'] = '1'

# –î–æ–¥–∞—Ç–∏ src –≤ path
sys.path.insert(0, os.path.join(os.path.dirname(__file__), 'src'))

print("–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π...")
import subprocess
subprocess.run([sys.executable, "-m", "pip", "install", "-r", "requirements.txt", "-q"],
               capture_output=True)

print("üîß –ó–∞–ø—É—Å–∫ —É DEV —Ä–µ–∂–∏–º—ñ...")

# –ü—Ä—è–º–æ –∑–∞–ø—É—Å—Ç–∏—Ç–∏ main
if __name__ == "__main__":
    import main
    main.main()


================================================================================
–§–∞–π–ª 2/20: export.py
--------------------------------------------------------------------------------
#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Project Structure Exporter
–°—Ç–≤–æ—Ä—é—î –¥–µ—Ç–∞–ª—å–Ω–∏–π –æ–ø–∏—Å —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ –ø—Ä–æ—î–∫—Ç—É —Ç–∞ –≤–º—ñ—Å—Ç —Ñ–∞–π–ª—ñ–≤ —É –æ–¥–∏–Ω —Ñ–∞–π–ª
"""

import os
from pathlib import Path
from datetime import datetime

# –§–∞–π–ª–∏ —Ç–∞ –ø–∞–ø–∫–∏, —è–∫—ñ —Ç—Ä–µ–±–∞ —ñ–≥–Ω–æ—Ä—É–≤–∞—Ç–∏
IGNORE_PATTERNS = {
    # –ü–∞–ø–∫–∏
    '__pycache__', '.git', '.idea', '.vscode', 'node_modules',
    'venv', 'env', '.env', 'dist', 'build', '.pytest_cache',
    '.mypy_cache', 'htmlcov', '.coverage', 'logs', 'tmp',
    # –§–∞–π–ª–∏
    '.pyc', '.pyo', '.pyd', '.so', '.dll', '.dylib', '.exe',
    '.log', '.sqlite', '.db', '.pkl', '.pickle', '.DS_Store',
    'Thumbs.db', '.env', '.env.local', '.gitignore'
}

# –†–æ–∑—à–∏—Ä–µ–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤ –¥–ª—è —á–∏—Ç–∞–Ω–Ω—è (—Ç–µ–∫—Å—Ç–æ–≤—ñ —Ñ–∞–π–ª–∏)
TEXT_EXTENSIONS = {
    '.py', '.js', '.ts', '.jsx', '.tsx', '.html', '.css', '.scss',
    '.json', '.yaml', '.yml', '.toml', '.ini', '.cfg', '.conf',
    '.txt', '.md', '.rst', '.xml', '.sql', '.sh', '.bash',
    '.env.example', '.gitignore', 'Dockerfile', 'Makefile',
    '.java', '.c', '.cpp', '.h', '.go', '.rs', '.php', '.rb'
}

# –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∏–π —Ä–æ–∑–º—ñ—Ä —Ñ–∞–π–ª—É (1 MB)
MAX_FILE_SIZE = 1024 * 1024


def should_ignore(path: Path) -> bool:
    """–ü–µ—Ä–µ–≤—ñ—Ä—è—î, —á–∏ —Ç—Ä–µ–±–∞ —ñ–≥–Ω–æ—Ä—É–≤–∞—Ç–∏ —Ñ–∞–π–ª/–ø–∞–ø–∫—É"""
    name = path.name

    # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ç–æ—á–Ω–æ–≥–æ –∑–±—ñ–≥—É
    if name in IGNORE_PATTERNS:
        return True

    # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è
    if path.suffix in IGNORE_PATTERNS:
        return True

    # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø—Ä–∏—Ö–æ–≤–∞–Ω–∏—Ö —Ñ–∞–π–ª—ñ–≤ (–∫—Ä—ñ–º .env.example)
    if name.startswith('.') and name != '.env.example':
        return True

    return False


def is_text_file(path: Path) -> bool:
    """–ü–µ—Ä–µ–≤—ñ—Ä—è—î, —á–∏ —î —Ñ–∞–π–ª —Ç–µ–∫—Å—Ç–æ–≤–∏–º"""
    # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è
    if path.suffix.lower() in TEXT_EXTENSIONS:
        return True

    # –§–∞–π–ª–∏ –±–µ–∑ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è, —è–∫—ñ –∑–∞–∑–≤–∏—á–∞–π —Ç–µ–∫—Å—Ç–æ–≤—ñ
    if path.suffix == '' and path.name in {'Dockerfile', 'Makefile', 'README', 'LICENSE'}:
        return True

    return False


def get_tree_structure(root_path: Path, prefix: str = "", is_last: bool = True) -> list:
    """–ì–µ–Ω–µ—Ä—É—î –¥–µ—Ä–µ–≤–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ –ø—Ä–æ—î–∫—Ç—É"""
    lines = []

    try:
        items = sorted(root_path.iterdir(), key=lambda x: (not x.is_dir(), x.name.lower()))
        items = [item for item in items if not should_ignore(item)]

        for i, item in enumerate(items):
            is_last_item = i == len(items) - 1
            current_prefix = "‚îî‚îÄ‚îÄ " if is_last_item else "‚îú‚îÄ‚îÄ "
            lines.append(f"{prefix}{current_prefix}{item.name}{'/' if item.is_dir() else ''}")

            if item.is_dir():
                extension = "    " if is_last_item else "‚îÇ   "
                lines.extend(get_tree_structure(item, prefix + extension, is_last_item))

    except PermissionError:
        pass

    return lines


def read_file_content(file_path: Path) -> str:
    """–ß–∏—Ç–∞—î –≤–º—ñ—Å—Ç —Ñ–∞–π–ª—É"""
    try:
        # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ä–æ–∑–º—ñ—Ä—É
        if file_path.stat().st_size > MAX_FILE_SIZE:
            return f"[–§–∞–π–ª –∑–∞–Ω–∞–¥—Ç–æ –≤–µ–ª–∏–∫–∏–π: {file_path.stat().st_size / 1024:.1f} KB]"

        # –°–ø—Ä–æ–±–∞ –ø—Ä–æ—á–∏—Ç–∞—Ç–∏ —è–∫ —Ç–µ–∫—Å—Ç
        with open(file_path, 'r', encoding='utf-8') as f:
            return f.read()
    except UnicodeDecodeError:
        # –Ø–∫—â–æ –Ω–µ –≤–¥–∞–ª–æ—Å—è –ø—Ä–æ—á–∏—Ç–∞—Ç–∏ —è–∫ UTF-8
        try:
            with open(file_path, 'r', encoding='cp1251') as f:
                return f.read()
        except:
            return "[–ù–µ –≤–¥–∞–ª–æ—Å—è –ø—Ä–æ—á–∏—Ç–∞—Ç–∏ —Ñ–∞–π–ª - –±—ñ–Ω–∞—Ä–Ω–∏–π –∞–±–æ –Ω–µ–≤—ñ–¥–æ–º–µ –∫–æ–¥—É–≤–∞–Ω–Ω—è]"
    except Exception as e:
        return f"[–ü–æ–º–∏–ª–∫–∞ —á–∏—Ç–∞–Ω–Ω—è: {str(e)}]"


def collect_files(root_path: Path) -> list:
    """–ó–±–∏—Ä–∞—î –≤—Å—ñ —Ç–µ–∫—Å—Ç–æ–≤—ñ —Ñ–∞–π–ª–∏ –ø—Ä–æ—î–∫—Ç—É"""
    files = []

    for item in root_path.rglob('*'):
        if item.is_file() and not should_ignore(item) and is_text_file(item):
            # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞, —â–æ –≤—Å—ñ –±–∞—Ç—å–∫—ñ–≤—Å—å–∫—ñ –ø–∞–ø–∫–∏ –Ω–µ —ñ–≥–Ω–æ—Ä—É—é—Ç—å—Å—è
            if not any(should_ignore(parent) for parent in item.parents):
                files.append(item)

    return sorted(files)


def generate_project_export(project_path: str, output_file: str = None):
    """–ì–µ–Ω–µ—Ä—É—î –ø–æ–≤–Ω–∏–π –µ–∫—Å–ø–æ—Ä—Ç –ø—Ä–æ—î–∫—Ç—É"""
    root = Path(project_path).resolve()

    if not root.exists():
        print(f"‚ùå –ü–æ–º–∏–ª–∫–∞: –®–ª—è—Ö '{project_path}' –Ω–µ —ñ—Å–Ω—É—î!")
        return

    if output_file is None:
        timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
        output_file = f"project_export_{timestamp}.txt"

    print(f"üìÅ –ê–Ω–∞–ª—ñ–∑ –ø—Ä–æ—î–∫—Ç—É: {root.name}")
    print(f"üìù –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –µ–∫—Å–ø–æ—Ä—Ç—É...")

    with open(output_file, 'w', encoding='utf-8') as f:
        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        f.write("=" * 80 + "\n")
        f.write(f"–ï–ö–°–ü–û–†–¢ –ü–†–û–Ñ–ö–¢–£: {root.name}\n")
        f.write(f"–î–∞—Ç–∞: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}\n")
        f.write(f"–®–ª—è—Ö: {root}\n")
        f.write("=" * 80 + "\n\n")

        # –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ—î–∫—Ç—É
        f.write("üìÇ –°–¢–†–£–ö–¢–£–†–ê –ü–†–û–Ñ–ö–¢–£\n")
        f.write("-" * 80 + "\n")
        f.write(f"{root.name}/\n")
        tree_lines = get_tree_structure(root)
        f.write("\n".join(tree_lines))
        f.write("\n\n")

        # –ó–±—ñ—Ä —Ñ–∞–π–ª—ñ–≤
        files = collect_files(root)

        f.write(f"üìÑ –í–ú–Ü–°–¢ –§–ê–ô–õ–Ü–í ({len(files)} —Ñ–∞–π–ª—ñ–≤)\n")
        f.write("=" * 80 + "\n\n")

        # –í–º—ñ—Å—Ç –∫–æ–∂–Ω–æ–≥–æ —Ñ–∞–π–ª—É
        for i, file_path in enumerate(files, 1):
            relative_path = file_path.relative_to(root)

            print(f"  [{i}/{len(files)}] {relative_path}")

            f.write("\n" + "=" * 80 + "\n")
            f.write(f"–§–∞–π–ª {i}/{len(files)}: {relative_path}\n")
            f.write("-" * 80 + "\n")

            content = read_file_content(file_path)
            f.write(content)
            f.write("\n")

        # –ü—ñ–¥—Å—É–º–æ–∫
        f.write("\n" + "=" * 80 + "\n")
        f.write("–ö–Ü–ù–ï–¶–¨ –ï–ö–°–ü–û–†–¢–£\n")
        f.write("=" * 80 + "\n")

    file_size = Path(output_file).stat().st_size
    print(f"\n‚úÖ –ï–∫—Å–ø–æ—Ä—Ç –∑–∞–≤–µ—Ä—à–µ–Ω–æ!")
    print(f"üìÑ –§–∞–π–ª: {output_file}")
    print(f"üìä –†–æ–∑–º—ñ—Ä: {file_size / 1024:.1f} KB")
    print(f"üìÅ –§–∞–π–ª—ñ–≤ –æ–±—Ä–æ–±–ª–µ–Ω–æ: {len(files)}")


if __name__ == "__main__":
    import sys

    # –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è: python export_project.py [—à–ª—è—Ö_–¥–æ_–ø—Ä–æ—î–∫—Ç—É] [–≤–∏—Ö—ñ–¥–Ω–∏–π_—Ñ–∞–π–ª]
    project_path = sys.argv[1] if len(sys.argv) > 1 else "."
    output_file = sys.argv[2] if len(sys.argv) > 2 else None

    generate_project_export(project_path, output_file)


================================================================================
–§–∞–π–ª 3/20: GitCommitTool.py
--------------------------------------------------------------------------------
import customtkinter as ctk
from tkinter import messagebox, scrolledtext
import subprocess
import os
import re
from pathlib import Path
from datetime import datetime
from packaging.version import parse as parse_version


class GitCommitTool(ctk.CTk):
    def __init__(self):
        super().__init__()

        self.title("Git Commit Tool")
        self.geometry("600x750")
        self.resizable(False, False)
        self.is_running = False  # –ü—Ä–∞–ø–æ—Ä–µ—Ü—å –¥–ª—è –±–ª–æ–∫—É–≤–∞–Ω–Ω—è UI

        # –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç–µ–º–∏
        ctk.set_appearance_mode("dark")  # –ó–º—ñ–Ω–µ–Ω–æ –Ω–∞ —Ç–µ–º–Ω—É
        ctk.set_default_color_theme("blue")

        # –û—Ç—Ä–∏–º–∞–Ω–Ω—è –ø–æ—Ç–æ—á–Ω–æ—ó –≤–µ—Ä—Å—ñ—ó
        self.current_version = self.get_current_version()

        # –°–ø–∏—Å–æ–∫ –µ–ª–µ–º–µ–Ω—Ç—ñ–≤ UI –¥–ª—è –±–ª–æ–∫—É–≤–∞–Ω–Ω—è
        self.interactive_widgets = []

        self.setup_ui()
        self.toggle_version_fields()  # –ü–æ—á–∞—Ç–∫–æ–≤–µ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —Å—Ç–∞–Ω—É UI

    def setup_ui(self):
        """(–û–ù–û–í–õ–ï–ù–û) –°—Ç–≤–æ—Ä–µ–Ω–Ω—è UI"""

        main_frame = ctk.CTkFrame(self, fg_color="transparent")
        main_frame.pack(fill="both", expand=True, padx=20, pady=15)

        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        title_label = ctk.CTkLabel(
            main_frame,
            text="Git Commit Tool",
            font=ctk.CTkFont(size=24, weight="bold")
        )
        title_label.pack(pady=10)

        # –ü–æ—Ç–æ—á–Ω–∞ –≤–µ—Ä—Å—ñ—è
        version_frame = ctk.CTkFrame(main_frame)
        version_frame.pack(pady=10, fill="x")

        ctk.CTkLabel(
            version_frame,
            text="–ü–æ—Ç–æ—á–Ω–∞ –≤–µ—Ä—Å—ñ—è:",
            font=ctk.CTkFont(size=12, weight="bold")
        ).pack(side="left", padx=(10, 0))

        self.current_version_label = ctk.CTkLabel(
            version_frame,
            text=f"v{self.current_version}",
            font=ctk.CTkFont(size=12),
            text_color="gray"
        )
        self.current_version_label.pack(side="left", padx=10)

        # –ö–æ–º–µ–Ω—Ç–∞—Ä
        ctk.CTkLabel(
            main_frame,
            text="–ö–æ–º–µ–Ω—Ç–∞—Ä (commit message):",
            font=ctk.CTkFont(size=12, weight="bold")
        ).pack(anchor="w", pady=(10, 5))

        self.comment_entry = ctk.CTkEntry(
            main_frame,
            placeholder_text="–û–ø–∏—à—ñ—Ç—å –≤–∞—à—ñ –∑–º—ñ–Ω–∏...",
            height=40,
            font=ctk.CTkFont(size=11)
        )
        self.comment_entry.pack(fill="x", pady=(0, 15))
        self.interactive_widgets.append(self.comment_entry)

        # --- –ë–ª–æ–∫ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –≤–µ—Ä—Å—ñ—ó ---

        # –ß–µ–∫–±–æ–∫—Å –¥–ª—è —Ç–∞–≥—É
        self.tag_checkbox = ctk.CTkCheckBox(
            main_frame,
            text="–°—Ç–≤–æ—Ä–∏—Ç–∏ –Ω–æ–≤–∏–π —Ç–µ–≥ –≤–µ—Ä—Å—ñ—ó",
            font=ctk.CTkFont(size=11),
            command=self.toggle_version_fields
        )
        self.tag_checkbox.pack(anchor="w", pady=(0, 10))
        self.tag_checkbox.select()
        self.interactive_widgets.append(self.tag_checkbox)

        # –ù–æ–≤–∞ –≤–µ—Ä—Å—ñ—è
        self.version_frame_new = ctk.CTkFrame(main_frame)
        self.version_frame_new.pack(fill="x", pady=(0, 15))

        ctk.CTkLabel(
            self.version_frame_new,
            text="–ù–æ–≤–∞ –≤–µ—Ä—Å—ñ—è (–¥–ª—è —Ç–∞–≥—É):",
            font=ctk.CTkFont(size=12, weight="bold")
        ).pack(anchor="w", pady=(0, 5), padx=10)

        version_entry_frame = ctk.CTkFrame(self.version_frame_new, fg_color="transparent")
        version_entry_frame.pack(fill="x", padx=10)

        ctk.CTkLabel(
            version_entry_frame,
            text="v",
            font=ctk.CTkFont(size=11)
        ).pack(side="left", padx=(0, 5))

        self.version_entry = ctk.CTkEntry(
            version_entry_frame,
            placeholder_text="1.1.0",
            height=35,
            font=ctk.CTkFont(size=11)
        )
        self.version_entry.pack(side="left", fill="x", expand=True)
        self.version_entry.insert(0, self.current_version)  # –ü–æ–ø–µ—Ä–µ–¥–Ω—å–æ –∑–∞–ø–æ–≤–Ω—é—î–º–æ
        self.interactive_widgets.append(self.version_entry)

        # (–ù–û–í–ï) –ö–Ω–æ–ø–∫–∏ –¥–ª—è "–±–∞–º–ø—É" –≤–µ—Ä—Å—ñ—ó
        self.bump_button_frame = ctk.CTkFrame(self.version_frame_new, fg_color="transparent")
        self.bump_button_frame.pack(fill="x", padx=10, pady=10)

        bump_patch_btn = ctk.CTkButton(
            self.bump_button_frame, text="Patch (+0.0.1)",
            command=lambda: self.bump_version('patch'),
            font=ctk.CTkFont(size=10, weight="bold"), height=25
        )
        bump_patch_btn.pack(side="left", fill="x", expand=True, padx=2)

        bump_minor_btn = ctk.CTkButton(
            self.bump_button_frame, text="Minor (+0.1.0)",
            command=lambda: self.bump_version('minor'),
            font=ctk.CTkFont(size=10, weight="bold"), height=25
        )
        bump_minor_btn.pack(side="left", fill="x", expand=True, padx=2)

        bump_major_btn = ctk.CTkButton(
            self.bump_button_frame, text="Major (+1.0.0)",
            command=lambda: self.bump_version('major'),
            font=ctk.CTkFont(size=10, weight="bold"), height=25
        )
        bump_major_btn.pack(side="left", fill="x", expand=True, padx=2)

        self.interactive_widgets.extend([bump_patch_btn, bump_minor_btn, bump_major_btn])

        # –ö–Ω–æ–ø–∫–∏
        button_frame = ctk.CTkFrame(main_frame, fg_color="transparent")
        button_frame.pack(fill="x", pady=(0, 15))

        self.commit_btn = ctk.CTkButton(
            button_frame,
            text="‚úÖ Commit & Push",
            command=self.commit_and_push_thread,
            font=ctk.CTkFont(size=12, weight="bold"),
            height=45,
            corner_radius=10
        )
        self.commit_btn.pack(side="left", fill="both", expand=True, padx=(0, 5))
        self.interactive_widgets.append(self.commit_btn)

        clear_btn = ctk.CTkButton(
            button_frame,
            text="üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç–∏",
            command=self.clear_fields,
            font=ctk.CTkFont(size=12),
            height=45,
            corner_radius=10,
            fg_color="gray30",
            hover_color="gray50"
        )
        clear_btn.pack(side="left", fill="both", expand=True, padx=(5, 0))
        self.interactive_widgets.append(clear_btn)

        # –õ–æ–≥–∏
        ctk.CTkLabel(
            main_frame,
            text="–õ–æ–≥–∏ –æ–ø–µ—Ä–∞—Ü—ñ–π:",
            font=ctk.CTkFont(size=11, weight="bold")
        ).pack(anchor="w", pady=(10, 5))

        log_frame = ctk.CTkFrame(main_frame, fg_color="transparent")
        log_frame.pack(fill="both", expand=True)

        self.log_text = scrolledtext.ScrolledText(
            log_frame,
            height=10,
            width=70,
            font=("Courier", 10),
            bg="#2B2B2B",  # –¢–µ–º–Ω–∏–π —Ñ–æ–Ω
            fg="#E0E0E0",  # –°–≤—ñ—Ç–ª–∏–π —Ç–µ–∫—Å—Ç
            relief="solid",
            borderwidth=1,
            bd=0
        )
        self.log_text.pack(fill="both", expand=True)
        # (–ù–û–í–ï) –¢–µ–≥–∏ –¥–ª—è –∫–æ–ª—å–æ—Ä—ñ–≤
        self.log_text.tag_config("info", foreground="#89CFF0")
        self.log_text.tag_config("success", foreground="#7FFF7F")
        self.log_text.tag_config("error", foreground="#FF6B6B")
        self.log_text.tag_config("warning", foreground="#FFA500")

        # –°—Ç–∞—Ç—É—Å
        self.status_label = ctk.CTkLabel(
            main_frame,
            text="–ì–æ—Ç–æ–≤–æ –¥–æ —Ä–æ–±–æ—Ç–∏",
            font=ctk.CTkFont(size=10),
            text_color="gray"
        )
        self.status_label.pack(pady=(10, 0))

    def get_current_version(self):
        """–û—Ç—Ä–∏–º–∞–Ω–Ω—è –ø–æ—Ç–æ—á–Ω–æ—ó –≤–µ—Ä—Å—ñ—ó –∑ version.txt"""
        try:
            with open("version.txt", "r") as f:
                version = f.read().strip()
                # (–ù–û–í–ï) –í–∞–ª—ñ–¥–∞—Ü—ñ—è –≤–µ—Ä—Å—ñ—ó
                if re.match(r"^\d+\.\d+\.\d+$", version):
                    return version
                else:
                    return "1.0.0"  # Fallback
        except:
            return "1.0.0"

    def toggle_version_fields(self):
        """(–ù–û–í–ï) –í–º–∏–∫–∞—î/–≤–∏–º–∏–∫–∞—î –±–ª–æ–∫ –≤–µ—Ä—Å—ñ—ó"""
        is_enabled = self.tag_checkbox.get()
        state = "normal" if is_enabled else "disabled"

        self.version_entry.configure(state=state)
        for btn in self.bump_button_frame.winfo_children():
            btn.configure(state=state)

        # (–ù–û–í–ï) –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –ø—Ä–æ–ø–æ–Ω—É—î–º–æ patch-bump
        if is_enabled:
            self.bump_version('patch', auto_fill=True)

    def bump_version(self, part="patch", auto_fill=False):
        """(–ù–û–í–ï) –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∑–±—ñ–ª—å—à—É—î –≤–µ—Ä—Å—ñ—é"""
        try:
            current_v = parse_version(self.get_current_version())
            parts = list(current_v.release)

            if part == 'major':
                parts[0] += 1
                parts[1] = 0
                parts[2] = 0
            elif part == 'minor':
                parts[1] += 1
                parts[2] = 0
            else:  # patch
                parts[2] += 1

            new_version = f"{parts[0]}.{parts[1]}.{parts[2]}"

            if not auto_fill or self.version_entry.get() != new_version:
                self.version_entry.delete(0, "end")
                self.version_entry.insert(0, new_version)

        except Exception as e:
            self.log_message(f"‚ùå –ü–æ–º–∏–ª–∫–∞ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –≤–µ—Ä—Å—ñ—ó: {str(e)}", "error")

    def log_message(self, message, tag="info"):
        """(–û–ù–û–í–õ–ï–ù–û) –î–æ–¥–∞–Ω–Ω—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –¥–æ –ª–æ–≥—ñ–≤ –∑ —Ç–µ–≥–æ–º"""
        timestamp = datetime.now().strftime("%H:%M:%S")
        self.log_text.configure(state="normal")
        self.log_text.insert("end", f"[{timestamp}] {message}\n", tag)
        self.log_text.configure(state="disabled")
        self.log_text.see("end")
        self.update_idletasks()

    def set_ui_state(self, is_enabled):
        """(–ù–û–í–ï) –í–º–∏–∫–∞—î/–≤–∏–º–∏–∫–∞—î –≤–µ—Å—å UI"""
        state = "normal" if is_enabled else "disabled"
        for widget in self.interactive_widgets:
            widget.configure(state=state)
        self.is_running = not is_enabled
        if is_enabled:
            self.toggle_version_fields()  # –ü–æ–≤–µ—Ä—Ç–∞—î–º–æ –∫–æ—Ä–µ–∫—Ç–Ω–∏–π —Å—Ç–∞–Ω –ø–æ–ª—ñ–≤ –≤–µ—Ä—Å—ñ—ó

    def run_git_command(self, command, log_output=True):
        """(–û–ù–û–í–õ–ï–ù–û) –í–∏–∫–æ–Ω–∞–Ω–Ω—è git –∫–æ–º–∞–Ω–¥–∏, –ø–æ–≤–µ—Ä—Ç–∞—î (success, output)"""
        self.log_message(f"$ {command}", "info")
        try:
            result = subprocess.run(
                command,
                shell=True,
                capture_output=True,
                text=True,
                encoding='utf-8',  # –í—Å—Ç–∞–Ω–æ–≤–ª—é—î–º–æ –∫–æ–¥—É–≤–∞–Ω–Ω—è
                cwd=os.getcwd()
            )

            if result.returncode == 0:
                if result.stdout and log_output:
                    self.log_message(f"{result.stdout.strip()}", "success")
                return True, result.stdout.strip()
            else:
                error_msg = result.stderr.strip() if result.stderr else "–ù–µ–≤—ñ–¥–æ–º–∞ –ø–æ–º–∏–ª–∫–∞"
                if log_output:
                    self.log_message(f"‚ùå –ü–æ–º–∏–ª–∫–∞: {error_msg}", "error")
                return False, error_msg
        except Exception as e:
            self.log_message(f"‚ùå –í–∏–Ω—è—Ç–æ–∫: {str(e)}", "error")
            return False, str(e)

    def get_current_branch(self):
        """(–ù–û–í–ï) –û—Ç—Ä–∏–º—É—î –ø–æ—Ç–æ—á–Ω—É –≥—ñ–ª–∫—É git"""
        success, output = self.run_git_command("git rev-parse --abbrev-ref HEAD", log_output=False)
        if success:
            return output
        return "main"  # Fallback

    def commit_and_push_thread(self):
        """(–ù–û–í–ï) –ó–∞–ø—É—Å–∫–∞—î –ø—Ä–æ—Ü–µ—Å –≤ –æ–∫—Ä–µ–º–æ–º—É –ø–æ—Ç–æ—Ü—ñ, —â–æ–± UI –Ω–µ "–∑–∞–≤–∏—Å–∞–≤" """
        if self.is_running:
            self.log_message("‚è≥ –û–ø–µ—Ä–∞—Ü—ñ—è –≤–∂–µ –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è...", "warning")
            return

        # –ó–∞–ø—É—Å–∫–∞—î–º–æ –≤ –æ–∫—Ä–µ–º–æ–º—É –ø–æ—Ç–æ—Ü—ñ
        import threading
        threading.Thread(target=self.commit_and_push, daemon=True).start()

    def commit_and_push(self):
        """(–û–ù–û–í–õ–ï–ù–û) –û—Å–Ω–æ–≤–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è - commit, tag —ñ push"""

        self.set_ui_state(False)
        self.status_label.configure(text="‚è≥ –û–±—Ä–æ–±–∫–∞...")

        try:
            comment = self.comment_entry.get().strip()
            new_version = self.version_entry.get().strip()
            create_tag = self.tag_checkbox.get()

            # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∏
            if not comment:
                messagebox.showwarning("–ü–æ–º–∏–ª–∫–∞", "–ù–∞–ø–∏—à—ñ—Ç—å –∫–æ–º–µ–Ω—Ç–∞—Ä –¥–æ –∫–æ–º—ñ—Ç—é!")
                self.log_message("‚ùå –ö–æ–º–µ–Ω—Ç–∞—Ä –Ω–µ –º–æ–∂–µ –±—É—Ç–∏ –ø–æ—Ä–æ–∂–Ω—ñ–º", "error")
                return

            if create_tag and not new_version:
                messagebox.showwarning("–ü–æ–º–∏–ª–∫–∞", "–ù–∞–ø–∏—à—ñ—Ç—å –Ω–æ–≤—É –≤–µ—Ä—Å—ñ—é –¥–ª—è —Ç–∞–≥—É!")
                self.log_message("‚ùå –ù–æ–º–µ—Ä –≤–µ—Ä—Å—ñ—ó –Ω–µ –º–æ–∂–µ –±—É—Ç–∏ –ø–æ—Ä–æ–∂–Ω—ñ–º", "error")
                return

            self.log_message("=" * 50, "info")
            self.log_message("üöÄ –†–æ–∑–ø–æ—á–∏–Ω–∞—î–º–æ commit & push –ø—Ä–æ—Ü–µ—Å...", "info")
            self.log_message("=" * 50, "info")

            # –ö—Ä–æ–∫ 1: –û—Ç—Ä–∏–º–∞–Ω–Ω—è –ø–æ—Ç–æ—á–Ω–æ—ó –≥—ñ–ª–∫–∏
            self.log_message("\nüìã –ö—Ä–æ–∫ 1: –í–∏–∑–Ω–∞—á–µ–Ω–Ω—è –ø–æ—Ç–æ—á–Ω–æ—ó –≥—ñ–ª–∫–∏...", "info")
            current_branch = self.get_current_branch()
            self.log_message(f"–ü–æ—Ç–æ—á–Ω–∞ –≥—ñ–ª–∫–∞: {current_branch}", "success")

            # –ö—Ä–æ–∫ 2: –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å—É
            self.log_message("\nüìã –ö—Ä–æ–∫ 2: –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å—É —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—é...", "info")
            success, status_output = self.run_git_command("git status --short")
            if not status_output:
                self.log_message("‚úÖ –ù–µ–º–∞—î –∑–º—ñ–Ω –¥–ª—è –∫–æ–º—ñ—Ç—É. –í—Å–µ —á–∏—Å—Ç–æ!", "success")
                self.status_label.configure(text="‚úÖ –ù–µ–º–∞—î –∑–º—ñ–Ω")
                return

            # –ö—Ä–æ–∫ 3: –î–æ–¥–∞–≤–∞–Ω–Ω—è –≤—Å—ñ—Ö —Ñ–∞–π–ª—ñ–≤
            self.log_message("\nüì¶ –ö—Ä–æ–∫ 3: –î–æ–¥–∞–≤–∞–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤ (git add .)...", "info")
            if not self.run_git_command("git add .")[0]:
                self.status_label.configure(text="‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ 'git add'")
                messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–ù–µ –≤–¥–∞–ª–æ—Å—è –¥–æ–¥–∞—Ç–∏ —Ñ–∞–π–ª–∏!")
                return

            # –ö—Ä–æ–∫ 4: –ö–æ–º—ñ—Ç
            self.log_message("\nüíæ –ö—Ä–æ–∫ 4: –ö–æ–º—ñ—Ç—É–≤–∞–Ω–Ω—è –∑–º—ñ–Ω...", "info")
            if not self.run_git_command(f'git commit -m "{comment}"')[0]:
                self.status_label.configure(text="‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –∫–æ–º—ñ—Ç—É–≤–∞–Ω–Ω—ñ")
                # (–º–æ–∂–ª–∏–≤–æ, –Ω–µ –±—É–ª–æ –∑–º—ñ–Ω)
                return

            # –ö—Ä–æ–∫ 5: Push
            self.log_message(f"\n‚¨ÜÔ∏è  –ö—Ä–æ–∫ 5: –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –Ω–∞ GitHub (git push origin {current_branch})...", "info")
            if not self.run_git_command(f"git push origin {current_branch}")[0]:
                self.status_label.configure(text="‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ 'git push'")
                messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–ù–µ –≤–¥–∞–ª–æ—Å—è –≤—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ –Ω–∞ GitHub!")
                return

            # –ö—Ä–æ–∫ 6: –¢–µ–≥ (—è–∫—â–æ –ø–æ—Ç—Ä—ñ–±–µ–Ω)
            if create_tag:
                self.log_message(f"\nüè∑Ô∏è  –ö—Ä–æ–∫ 6: –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–∞–≥—É v{new_version}...", "info")
                if not self.run_git_command(f"git tag v{new_version}")[0]:
                    self.status_label.configure(text="‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—ñ —Ç–∞–≥—É")
                    messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–ù–µ –≤–¥–∞–ª–æ—Å—è —Å—Ç–≤–æ—Ä–∏—Ç–∏ —Ç–µ–≥! –ú–æ–∂–ª–∏–≤–æ, –≤—ñ–Ω –≤–∂–µ —ñ—Å–Ω—É—î.")
                    return

                self.log_message(f"\n‚¨ÜÔ∏è  –ö—Ä–æ–∫ 7: –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ç–∞–≥—É –Ω–∞ GitHub...", "info")
                if not self.run_git_command(f"git push origin v{new_version}")[0]:
                    self.status_label.configure(text="‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ 'git push' —Ç–∞–≥—É")
                    messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–ù–µ –≤–¥–∞–ª–æ—Å—è –≤—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ —Ç–µ–≥!")
                    return

                # –û–Ω–æ–≤–ª–µ–Ω–Ω—è version.txt
                self.log_message("\nüìù –ö—Ä–æ–∫ 8: –û–Ω–æ–≤–ª–µ–Ω–Ω—è version.txt...", "info")
                try:
                    with open("version.txt", "w") as f:
                        f.write(new_version)
                    self.log_message("‚úÖ version.txt –æ–Ω–æ–≤–ª–µ–Ω–æ", "success")
                    self.current_version = new_version
                    self.current_version_label.configure(text=f"v{self.current_version}")
                except Exception as e:
                    self.log_message(f"‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –æ–Ω–æ–≤–ª–µ–Ω–Ω—ñ version.txt: {str(e)}", "error")

            self.log_message("\n" + "=" * 50, "success")
            self.log_message("‚úÖ –í–°–ï –£–°–ü–Ü–®–ù–û! GitHub Actions –ø–æ—á–Ω–µ –∫–æ–º–ø—ñ–ª—é–≤–∞—Ç–∏...", "success")
            self.log_message("=" * 50, "success")

            self.status_label.configure(text="‚úÖ –£—Å–ø—ñ—à–Ω–æ! GitHub Actions –∑–∞–ø—É—â–µ–Ω–æ")
            messagebox.showinfo(
                "–£—Å–ø—ñ—Ö",
                f"‚úÖ –ö–æ–º—ñ—Ç —É—Å–ø—ñ—à–Ω–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ!\n\n"
                f"–ö–æ–º–µ–Ω—Ç–∞—Ä: {comment}\n"
                + (f"–í–µ—Ä—Å—ñ—è: v{new_version}\n\nGitHub Actions –ø–æ—á–Ω–µ –∫–æ–º–ø—ñ–ª—é–≤–∞—Ç–∏ EXE..." if create_tag else "")
            )

            self.clear_fields()

        finally:
            # (–ù–û–í–ï) –ó–∞–≤–∂–¥–∏ –≤–º–∏–∫–∞—î–º–æ UI –Ω–∞–∑–∞–¥, –Ω–∞–≤—ñ—Ç—å —è–∫—â–æ –±—É–ª–∞ –ø–æ–º–∏–ª–∫–∞
            self.set_ui_state(True)
            if '–ü–æ–º–∏–ª–∫–∞' not in self.status_label.cget("text"):
                self.status_label.configure(text="–ì–æ—Ç–æ–≤–æ –¥–æ —Ä–æ–±–æ—Ç–∏")

    def clear_fields(self):
        """–û—á–∏—Å—Ç–∫–∞ –ø–æ–ª—ñ–≤"""
        self.comment_entry.delete(0, "end")
        self.version_entry.delete(0, "end")
        self.tag_checkbox.select()
        self.toggle_version_fields()  # –û–Ω–æ–≤–ª—é—î–º–æ —Å—Ç–∞–Ω –ø–æ–ª—ñ–≤ –≤–µ—Ä—Å—ñ—ó
        self.status_label.configure(text="–ì–æ—Ç–æ–≤–æ –¥–æ —Ä–æ–±–æ—Ç–∏")


def main():
    app = GitCommitTool()
    app.mainloop()


if __name__ == "__main__":
    main()

================================================================================
–§–∞–π–ª 4/20: project_export_20251110_104446.txt
--------------------------------------------------------------------------------
================================================================================
–ï–ö–°–ü–û–†–¢ –ü–†–û–Ñ–ö–¢–£: RemoteHand
–î–∞—Ç–∞: 2025-11-10 10:44:46
–®–ª—è—Ö: D:\Python Projects\Prego\RemoteHand
================================================================================

üìÇ –°–¢–†–£–ö–¢–£–†–ê –ü–†–û–Ñ–ö–¢–£
--------------------------------------------------------------------------------
RemoteHand/
‚îú‚îÄ‚îÄ assets/
‚îÇ   ‚îî‚îÄ‚îÄ icon.ico
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ anydesk_manager.py
‚îÇ   ‚îú‚îÄ‚îÄ config.py
‚îÇ   ‚îú‚îÄ‚îÄ config_manager.py
‚îÇ   ‚îú‚îÄ‚îÄ main.py
‚îÇ   ‚îú‚îÄ‚îÄ network_test.py
‚îÇ   ‚îú‚îÄ‚îÄ rdp_manager.py
‚îÇ   ‚îú‚îÄ‚îÄ set_anydesk_password.py
‚îÇ   ‚îú‚îÄ‚îÄ setup_wizard.py
‚îÇ   ‚îú‚îÄ‚îÄ telegram_api.py
‚îÇ   ‚îú‚îÄ‚îÄ telegram_helper.py
‚îÇ   ‚îú‚îÄ‚îÄ update.bat
‚îÇ   ‚îú‚îÄ‚îÄ updater.py
‚îÇ   ‚îî‚îÄ‚îÄ utils.py
‚îú‚îÄ‚îÄ .env.example
‚îú‚îÄ‚îÄ 23.88.7.196_admin_session.rdp
‚îú‚îÄ‚îÄ dev_run.py
‚îú‚îÄ‚îÄ export.py
‚îú‚îÄ‚îÄ GitCommitTool.py
‚îú‚îÄ‚îÄ project_export_20251110_104446.txt
‚îú‚îÄ‚îÄ README.md
‚îú‚îÄ‚îÄ RemoteHand.spec
‚îú‚îÄ‚îÄ requirements.txt
‚îú‚îÄ‚îÄ version.txt
‚îú‚îÄ‚îÄ version_info.txt
‚îî‚îÄ‚îÄ –ê–∫—Ç–∏–≤–∞—Ü—ñ—è —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞.txt

üìÑ –í–ú–Ü–°–¢ –§–ê–ô–õ–Ü–í (21 —Ñ–∞–π–ª—ñ–≤)
================================================================================


================================================================================
–§–∞–π–ª 1/21: dev_run.py
--------------------------------------------------------------------------------
"""
DEV_RUN.PY - –õ–æ–∫–∞–ª—å–Ω–µ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è
"""

import sys
import os

# –í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ DEV —Ä–µ–∂–∏–º
os.environ['REMOTEHAND_DEV_MODE'] = '1'

# –î–æ–¥–∞—Ç–∏ src –≤ path
sys.path.insert(0, os.path.join(os.path.dirname(__file__), 'src'))

print("–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π...")
import subprocess
subprocess.run([sys.executable, "-m", "pip", "install", "-r", "requirements.txt", "-q"],
               capture_output=True)

print("üîß –ó–∞–ø—É—Å–∫ —É DEV —Ä–µ–∂–∏–º—ñ...")

# –ü—Ä—è–º–æ –∑–∞–ø—É—Å—Ç–∏—Ç–∏ main
if __name__ == "__main__":
    import main
    main.main()


================================================================================
–§–∞–π–ª 2/21: export.py
--------------------------------------------------------------------------------
#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Project Structure Exporter
–°—Ç–≤–æ—Ä—é—î –¥–µ—Ç–∞–ª—å–Ω–∏–π –æ–ø–∏—Å —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ –ø—Ä–æ—î–∫—Ç—É —Ç–∞ –≤–º—ñ—Å—Ç —Ñ–∞–π–ª—ñ–≤ —É –æ–¥–∏–Ω —Ñ–∞–π–ª
"""

import os
from pathlib import Path
from datetime import datetime

# –§–∞–π–ª–∏ —Ç–∞ –ø–∞–ø–∫–∏, —è–∫—ñ —Ç—Ä–µ–±–∞ —ñ–≥–Ω–æ—Ä—É–≤–∞—Ç–∏
IGNORE_PATTERNS = {
    # –ü–∞–ø–∫–∏
    '__pycache__', '.git', '.idea', '.vscode', 'node_modules',
    'venv', 'env', '.env', 'dist', 'build', '.pytest_cache',
    '.mypy_cache', 'htmlcov', '.coverage', 'logs', 'tmp',
    # –§–∞–π–ª–∏
    '.pyc', '.pyo', '.pyd', '.so', '.dll', '.dylib', '.exe',
    '.log', '.sqlite', '.db', '.pkl', '.pickle', '.DS_Store',
    'Thumbs.db', '.env', '.env.local', '.gitignore'
}

# –†–æ–∑—à–∏—Ä–µ–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤ –¥–ª—è —á–∏—Ç–∞–Ω–Ω—è (—Ç–µ–∫—Å—Ç–æ–≤—ñ —Ñ–∞–π–ª–∏)
TEXT_EXTENSIONS = {
    '.py', '.js', '.ts', '.jsx', '.tsx', '.html', '.css', '.scss',
    '.json', '.yaml', '.yml', '.toml', '.ini', '.cfg', '.conf',
    '.txt', '.md', '.rst', '.xml', '.sql', '.sh', '.bash',
    '.env.example', '.gitignore', 'Dockerfile', 'Makefile',
    '.java', '.c', '.cpp', '.h', '.go', '.rs', '.php', '.rb'
}

# –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∏–π —Ä–æ–∑–º—ñ—Ä —Ñ–∞–π–ª—É (1 MB)
MAX_FILE_SIZE = 1024 * 1024


def should_ignore(path: Path) -> bool:
    """–ü–µ—Ä–µ–≤—ñ—Ä—è—î, —á–∏ —Ç—Ä–µ–±–∞ —ñ–≥–Ω–æ—Ä—É–≤–∞—Ç–∏ —Ñ–∞–π–ª/–ø–∞–ø–∫—É"""
    name = path.name

    # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ç–æ—á–Ω–æ–≥–æ –∑–±—ñ–≥—É
    if name in IGNORE_PATTERNS:
        return True

    # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è
    if path.suffix in IGNORE_PATTERNS:
        return True

    # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø—Ä–∏—Ö–æ–≤–∞–Ω–∏—Ö —Ñ–∞–π–ª—ñ–≤ (–∫—Ä—ñ–º .env.example)
    if name.startswith('.') and name != '.env.example':
        return True

    return False


def is_text_file(path: Path) -> bool:
    """–ü–µ—Ä–µ–≤—ñ—Ä—è—î, —á–∏ —î —Ñ–∞–π–ª —Ç–µ–∫—Å—Ç–æ–≤–∏–º"""
    # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è
    if path.suffix.lower() in TEXT_EXTENSIONS:
        return True

    # –§–∞–π–ª–∏ –±–µ–∑ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è, —è–∫—ñ –∑–∞–∑–≤–∏—á–∞–π —Ç–µ–∫—Å—Ç–æ–≤—ñ
    if path.suffix == '' and path.name in {'Dockerfile', 'Makefile', 'README', 'LICENSE'}:
        return True

    return False


def get_tree_structure(root_path: Path, prefix: str = "", is_last: bool = True) -> list:
    """–ì–µ–Ω–µ—Ä—É—î –¥–µ—Ä–µ–≤–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ –ø—Ä–æ—î–∫—Ç—É"""
    lines = []

    try:
        items = sorted(root_path.iterdir(), key=lambda x: (not x.is_dir(), x.name.lower()))
        items = [item for item in items if not should_ignore(item)]

        for i, item in enumerate(items):
            is_last_item = i == len(items) - 1
            current_prefix = "‚îî‚îÄ‚îÄ " if is_last_item else "‚îú‚îÄ‚îÄ "
            lines.append(f"{prefix}{current_prefix}{item.name}{'/' if item.is_dir() else ''}")

            if item.is_dir():
                extension = "    " if is_last_item else "‚îÇ   "
                lines.extend(get_tree_structure(item, prefix + extension, is_last_item))

    except PermissionError:
        pass

    return lines


def read_file_content(file_path: Path) -> str:
    """–ß–∏—Ç–∞—î –≤–º—ñ—Å—Ç —Ñ–∞–π–ª—É"""
    try:
        # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ä–æ–∑–º—ñ—Ä—É
        if file_path.stat().st_size > MAX_FILE_SIZE:
            return f"[–§–∞–π–ª –∑–∞–Ω–∞–¥—Ç–æ –≤–µ–ª–∏–∫–∏–π: {file_path.stat().st_size / 1024:.1f} KB]"

        # –°–ø—Ä–æ–±–∞ –ø—Ä–æ—á–∏—Ç–∞—Ç–∏ —è–∫ —Ç–µ–∫—Å—Ç
        with open(file_path, 'r', encoding='utf-8') as f:
            return f.read()
    except UnicodeDecodeError:
        # –Ø–∫—â–æ –Ω–µ –≤–¥–∞–ª–æ—Å—è –ø—Ä–æ—á–∏—Ç–∞—Ç–∏ —è–∫ UTF-8
        try:
            with open(file_path, 'r', encoding='cp1251') as f:
                return f.read()
        except:
            return "[–ù–µ –≤–¥–∞–ª–æ—Å—è –ø—Ä–æ—á–∏—Ç–∞—Ç–∏ —Ñ–∞–π–ª - –±—ñ–Ω–∞—Ä–Ω–∏–π –∞–±–æ –Ω–µ–≤—ñ–¥–æ–º–µ –∫–æ–¥—É–≤–∞–Ω–Ω—è]"
    except Exception as e:
        return f"[–ü–æ–º–∏–ª–∫–∞ —á–∏—Ç–∞–Ω–Ω—è: {str(e)}]"


def collect_files(root_path: Path) -> list:
    """–ó–±–∏—Ä–∞—î –≤—Å—ñ —Ç–µ–∫—Å—Ç–æ–≤—ñ —Ñ–∞–π–ª–∏ –ø—Ä–æ—î–∫—Ç—É"""
    files = []

    for item in root_path.rglob('*'):
        if item.is_file() and not should_ignore(item) and is_text_file(item):
            # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞, —â–æ –≤—Å—ñ –±–∞—Ç—å–∫—ñ–≤—Å—å–∫—ñ –ø–∞–ø–∫–∏ –Ω–µ —ñ–≥–Ω–æ—Ä—É—é—Ç—å—Å—è
            if not any(should_ignore(parent) for parent in item.parents):
                files.append(item)

    return sorted(files)


def generate_project_export(project_path: str, output_file: str = None):
    """–ì–µ–Ω–µ—Ä—É—î –ø–æ–≤–Ω–∏–π –µ–∫—Å–ø–æ—Ä—Ç –ø—Ä–æ—î–∫—Ç—É"""
    root = Path(project_path).resolve()

    if not root.exists():
        print(f"‚ùå –ü–æ–º–∏–ª–∫–∞: –®–ª—è—Ö '{project_path}' –Ω–µ —ñ—Å–Ω—É—î!")
        return

    if output_file is None:
        timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
        output_file = f"project_export_{timestamp}.txt"

    print(f"üìÅ –ê–Ω–∞–ª—ñ–∑ –ø—Ä–æ—î–∫—Ç—É: {root.name}")
    print(f"üìù –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –µ–∫—Å–ø–æ—Ä—Ç—É...")

    with open(output_file, 'w', encoding='utf-8') as f:
        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        f.write("=" * 80 + "\n")
        f.write(f"–ï–ö–°–ü–û–†–¢ –ü–†–û–Ñ–ö–¢–£: {root.name}\n")
        f.write(f"–î–∞—Ç–∞: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}\n")
        f.write(f"–®–ª—è—Ö: {root}\n")
        f.write("=" * 80 + "\n\n")

        # –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ—î–∫—Ç—É
        f.write("üìÇ –°–¢–†–£–ö–¢–£–†–ê –ü–†–û–Ñ–ö–¢–£\n")
        f.write("-" * 80 + "\n")
        f.write(f"{root.name}/\n")
        tree_lines = get_tree_structure(root)
        f.write("\n".join(tree_lines))
        f.write("\n\n")

        # –ó–±—ñ—Ä —Ñ–∞–π–ª—ñ–≤
        files = collect_files(root)

        f.write(f"üìÑ –í–ú–Ü–°–¢ –§–ê–ô–õ–Ü–í ({len(files)} —Ñ–∞–π–ª—ñ–≤)\n")
        f.write("=" * 80 + "\n\n")

        # –í–º—ñ—Å—Ç –∫–æ–∂–Ω–æ–≥–æ —Ñ–∞–π–ª—É
        for i, file_path in enumerate(files, 1):
            relative_path = file_path.relative_to(root)

            print(f"  [{i}/{len(files)}] {relative_path}")

            f.write("\n" + "=" * 80 + "\n")
            f.write(f"–§–∞–π–ª {i}/{len(files)}: {relative_path}\n")
            f.write("-" * 80 + "\n")

            content = read_file_content(file_path)
            f.write(content)
            f.write("\n")

        # –ü—ñ–¥—Å—É–º–æ–∫
        f.write("\n" + "=" * 80 + "\n")
        f.write("–ö–Ü–ù–ï–¶–¨ –ï–ö–°–ü–û–†–¢–£\n")
        f.write("=" * 80 + "\n")

    file_size = Path(output_file).stat().st_size
    print(f"\n‚úÖ –ï–∫—Å–ø–æ—Ä—Ç –∑–∞–≤–µ—Ä—à–µ–Ω–æ!")
    print(f"üìÑ –§–∞–π–ª: {output_file}")
    print(f"üìä –†–æ–∑–º—ñ—Ä: {file_size / 1024:.1f} KB")
    print(f"üìÅ –§–∞–π–ª—ñ–≤ –æ–±—Ä–æ–±–ª–µ–Ω–æ: {len(files)}")


if __name__ == "__main__":
    import sys

    # –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è: python export_project.py [—à–ª—è—Ö_–¥–æ_–ø—Ä–æ—î–∫—Ç—É] [–≤–∏—Ö—ñ–¥–Ω–∏–π_—Ñ–∞–π–ª]
    project_path = sys.argv[1] if len(sys.argv) > 1 else "."
    output_file = sys.argv[2] if len(sys.argv) > 2 else None

    generate_project_export(project_path, output_file)


================================================================================
–§–∞–π–ª 3/21: GitCommitTool.py
--------------------------------------------------------------------------------
import customtkinter as ctk
from tkinter import messagebox, scrolledtext
import subprocess
import os
from pathlib import Path
from datetime import datetime


class GitCommitTool(ctk.CTk):
    def __init__(self):
        super().__init__()

        self.title("Git Commit Tool")
        self.geometry("600x700")
        self.resizable(False, False)

        # –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç–µ–º–∏
        ctk.set_appearance_mode("light")
        ctk.set_default_color_theme("blue")

        # –û—Ç—Ä–∏–º–∞–Ω–Ω—è –ø–æ—Ç–æ—á–Ω–æ—ó –≤–µ—Ä—Å—ñ—ó
        self.current_version = self.get_current_version()

        self.setup_ui()

    def setup_ui(self):
        """–°—Ç–≤–æ—Ä–µ–Ω–Ω—è UI"""

        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        title_label = ctk.CTkLabel(
            self,
            text="Git Commit Tool",
            font=ctk.CTkFont(size=24, weight="bold")
        )
        title_label.pack(pady=15)

        # –ü–æ—Ç–æ—á–Ω–∞ –≤–µ—Ä—Å—ñ—è
        version_frame = ctk.CTkFrame(self)
        version_frame.pack(pady=10, padx=20, fill="x")

        ctk.CTkLabel(
            version_frame,
            text="–ü–æ—Ç–æ—á–Ω–∞ –≤–µ—Ä—Å—ñ—è:",
            font=ctk.CTkFont(size=12, weight="bold")
        ).pack(side="left")

        ctk.CTkLabel(
            version_frame,
            text=f"v{self.current_version}",
            font=ctk.CTkFont(size=12),
            text_color="gray"
        ).pack(side="left", padx=10)

        # –ö–æ–º–µ–Ω—Ç–∞—Ä
        ctk.CTkLabel(
            self,
            text="–ö–æ–º–µ–Ω—Ç–∞—Ä (commit message):",
            font=ctk.CTkFont(size=12, weight="bold")
        ).pack(anchor="w", padx=20, pady=(10, 5))

        self.comment_entry = ctk.CTkEntry(
            self,
            placeholder_text="–û–ø–∏—à—ñ—Ç—å –≤–∞—à—ñ –∑–º—ñ–Ω–∏...",
            height=40,
            font=ctk.CTkFont(size=11)
        )
        self.comment_entry.pack(padx=20, fill="x", pady=(0, 15))

        # –ù–æ–≤–∞ –≤–µ—Ä—Å—ñ—è
        ctk.CTkLabel(
            self,
            text="–ù–æ–≤–∞ –≤–µ—Ä—Å—ñ—è (–¥–ª—è —Ç–∞–≥—É):",
            font=ctk.CTkFont(size=12, weight="bold")
        ).pack(anchor="w", padx=20, pady=(10, 5))

        version_frame2 = ctk.CTkFrame(self)
        version_frame2.pack(padx=20, fill="x", pady=(0, 15))

        ctk.CTkLabel(
            version_frame2,
            text="v",
            font=ctk.CTkFont(size=11)
        ).pack(side="left", padx=(0, 5))

        self.version_entry = ctk.CTkEntry(
            version_frame2,
            placeholder_text="1.1.0",
            height=35,
            font=ctk.CTkFont(size=11)
        )
        self.version_entry.pack(side="left", fill="x", expand=True)

        # –ß–µ–∫–±–æ–∫—Å –¥–ª—è —Ç–∞–≥—É
        self.tag_checkbox = ctk.CTkCheckBox(
            self,
            text="–°—Ç–≤–æ—Ä–∏—Ç–∏ —Ç–µ–≥ –≤–µ—Ä—Å—ñ—ó",
            font=ctk.CTkFont(size=11)
        )
        self.tag_checkbox.pack(anchor="w", padx=20, pady=(0, 20))
        self.tag_checkbox.select()

        # –ö–Ω–æ–ø–∫–∏
        button_frame = ctk.CTkFrame(self)
        button_frame.pack(padx=20, fill="x", pady=(0, 15))

        commit_btn = ctk.CTkButton(
            button_frame,
            text="‚úÖ Commit & Push",
            command=self.commit_and_push,
            font=ctk.CTkFont(size=12, weight="bold"),
            height=45,
            corner_radius=10
        )
        commit_btn.pack(side="left", fill="both", expand=True, padx=(0, 5))

        clear_btn = ctk.CTkButton(
            button_frame,
            text="üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç–∏",
            command=self.clear_fields,
            font=ctk.CTkFont(size=12),
            height=45,
            corner_radius=10,
            fg_color="gray30",
            hover_color="gray50"
        )
        clear_btn.pack(side="left", fill="both", expand=True, padx=(5, 0))

        # –õ–æ–≥–∏
        ctk.CTkLabel(
            self,
            text="–õ–æ–≥–∏ –æ–ø–µ—Ä–∞—Ü—ñ–π:",
            font=ctk.CTkFont(size=11, weight="bold")
        ).pack(anchor="w", padx=20, pady=(10, 5))

        self.log_text = scrolledtext.ScrolledText(
            self,
            height=10,
            width=70,
            font=("Courier", 9),
            bg="#f0f0f0",
            fg="#333333",
            relief="solid",
            borderwidth=1
        )
        self.log_text.pack(padx=20, pady=(0, 15), fill="both", expand=True)

        # –°—Ç–∞—Ç—É—Å
        self.status_label = ctk.CTkLabel(
            self,
            text="–ì–æ—Ç–æ–≤–æ –¥–æ —Ä–æ–±–æ—Ç–∏",
            font=ctk.CTkFont(size=10),
            text_color="gray"
        )
        self.status_label.pack(pady=(0, 10))

    def get_current_version(self):
        """–û—Ç—Ä–∏–º–∞–Ω–Ω—è –ø–æ—Ç–æ—á–Ω–æ—ó –≤–µ—Ä—Å—ñ—ó –∑ version.txt"""
        try:
            with open("version.txt", "r") as f:
                return f.read().strip()
        except:
            return "1.0.0"

    def log_message(self, message):
        """–î–æ–¥–∞–Ω–Ω—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –¥–æ –ª–æ–≥—ñ–≤"""
        timestamp = datetime.now().strftime("%H:%M:%S")
        self.log_text.insert("end", f"[{timestamp}] {message}\n")
        self.log_text.see("end")
        self.update()

    def run_git_command(self, command):
        """–í–∏–∫–æ–Ω–∞–Ω–Ω—è git –∫–æ–º–∞–Ω–¥–∏"""
        try:
            result = subprocess.run(
                command,
                shell=True,
                capture_output=True,
                text=True,
                cwd=os.getcwd()
            )

            if result.returncode == 0:
                if result.stdout:
                    self.log_message(f"‚úÖ {result.stdout.strip()}")
                return True
            else:
                error_msg = result.stderr.strip() if result.stderr else "–ù–µ–≤—ñ–¥–æ–º–∞ –ø–æ–º–∏–ª–∫–∞"
                self.log_message(f"‚ùå –ü–æ–º–∏–ª–∫–∞: {error_msg}")
                return False
        except Exception as e:
            self.log_message(f"‚ùå –ò—Å–∫–ª—é—á–µ–Ω–∏–µ: {str(e)}")
            return False

    def commit_and_push(self):
        """–û—Å–Ω–æ–≤–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è - commit, tag —ñ push"""

        comment = self.comment_entry.get().strip()
        new_version = self.version_entry.get().strip()
        create_tag = self.tag_checkbox.get()

        # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∏
        if not comment:
            messagebox.showwarning("–ü–æ–º–∏–ª–∫–∞", "–ù–∞–ø–∏—à—ñ—Ç—å –∫–æ–º–µ–Ω—Ç–∞—Ä –¥–æ –∫–æ–º—ñ—Ç—é!")
            return

        if create_tag and not new_version:
            messagebox.showwarning("–ü–æ–º–∏–ª–∫–∞", "–ù–∞–ø–∏—à—ñ—Ç—å –Ω–æ–≤—É –≤–µ—Ä—Å—ñ—é –¥–ª—è —Ç–∞–≥—É!")
            return

        self.status_label.configure(text="‚è≥ –û–±—Ä–æ–±–∫–∞...")
        self.update()

        self.log_message("=" * 50)
        self.log_message("üöÄ –†–æ–∑–ø–æ—á–∏–Ω–∞—î–º–æ commit & push –ø—Ä–æ—Ü–µ—Å...")
        self.log_message("=" * 50)

        # –ö—Ä–æ–∫ 1: –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å—É
        self.log_message("\nüìã –ö—Ä–æ–∫ 1: –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å—É —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—é...")
        self.run_git_command("git status --short")

        # –ö—Ä–æ–∫ 2: –î–æ–±–∞–≤–ª–µ–Ω–Ω—è –≤—Å—ñ—Ö —Ñ–∞–π–ª—ñ–≤
        self.log_message("\nüì¶ –ö—Ä–æ–∫ 2: –î–æ–¥–∞–≤–∞–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤...")
        if not self.run_git_command("git add ."):
            self.status_label.configure(text="‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –¥–æ–¥–∞–≤–∞–Ω–Ω—ñ —Ñ–∞–π–ª—ñ–≤")
            messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–ù–µ –≤–¥–∞–ª–æ—Å—è –¥–æ–¥–∞—Ç–∏ —Ñ–∞–π–ª–∏!")
            return

        # –ö—Ä–æ–∫ 3: –ö–æ–º—ñ—Ç
        self.log_message("\nüíæ –ö—Ä–æ–∫ 3: –ö–æ–º—ñ—Ç—É–≤–∞–Ω–Ω—è –∑–º—ñ–Ω...")
        if not self.run_git_command(f'git commit -m "{comment}"'):
            self.status_label.configure(text="‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –∫–æ–º—ñ—Ç—É–≤–∞–Ω–Ω—ñ")
            messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–ù–µ –≤–¥–∞–ª–æ—Å—è –∑–∞–∫–æ–º—ñ—Ç–∏—Ç–∏!")
            return

        # –ö—Ä–æ–∫ 4: Push
        self.log_message("\n‚¨ÜÔ∏è  –ö—Ä–æ–∫ 4: –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –Ω–∞ GitHub...")
        if not self.run_git_command("git push origin main"):
            self.status_label.configure(text="‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ push")
            messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–ù–µ –≤–¥–∞–ª–æ—Å—è –≤—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ –Ω–∞ GitHub!")
            return

        # –ö—Ä–æ–∫ 5: –¢–µ–≥ (—è–∫—â–æ –ø–æ—Ç—Ä—ñ–±–µ–Ω)
        if create_tag:
            self.log_message("\nüè∑Ô∏è  –ö—Ä–æ–∫ 5: –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–∞–≥—É...")
            if not self.run_git_command(f"git tag v{new_version}"):
                self.status_label.configure(text="‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—ñ —Ç–∞–≥—É")
                messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–ù–µ –≤–¥–∞–ª–æ—Å—è —Å—Ç–≤–æ—Ä–∏—Ç–∏ —Ç–µ–≥!")
                return

            self.log_message("\n‚¨ÜÔ∏è  –ö—Ä–æ–∫ 6: –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ç–∞–≥—É –Ω–∞ GitHub...")
            if not self.run_git_command(f"git push origin v{new_version}"):
                self.status_label.configure(text="‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ push —Ç–∞–≥—É")
                messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–ù–µ –≤–¥–∞–ª–æ—Å—è –≤—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ —Ç–µ–≥!")
                return

            # –û–Ω–æ–≤–ª–µ–Ω–Ω—è version.txt
            self.log_message("\nüìù –ö—Ä–æ–∫ 7: –û–Ω–æ–≤–ª–µ–Ω–Ω—è version.txt...")
            try:
                with open("version.txt", "w") as f:
                    f.write(new_version)
                self.log_message("‚úÖ version.txt –æ–Ω–æ–≤–ª–µ–Ω–æ")
                self.current_version = new_version
            except Exception as e:
                self.log_message(f"‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –æ–Ω–æ–≤–ª–µ–Ω–Ω—ñ version.txt: {str(e)}")

        self.log_message("\n" + "=" * 50)
        self.log_message("‚úÖ –í–°–ï –£–°–ü–Ü–®–ù–û! GitHub Actions –ø–æ—á–Ω–µ –∫–æ–º–ø—ñ–ª—é–≤–∞—Ç–∏...")
        self.log_message("=" * 50)

        self.status_label.configure(text="‚úÖ –£—Å–ø—ñ—à–Ω–æ! GitHub Actions –∑–∞–ø—É—â–µ–Ω–æ")
        messagebox.showinfo(
            "–£—Å–ø—ñ—Ö",
            f"‚úÖ –ö–æ–º—ñ—Ç —É—Å–ø—ñ—à–Ω–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ!\n\n"
            f"–ö–æ–º–µ–Ω—Ç–∞—Ä: {comment}\n"
            + (f"–í–µ—Ä—Å—ñ—è: v{new_version}\n\nGitHub Actions –ø–æ—á–Ω–µ –∫–æ–º–ø—ñ–ª—é–≤–∞—Ç–∏ EXE..." if create_tag else "")
        )

        self.clear_fields()

    def clear_fields(self):
        """–û—á–∏—Å—Ç–∫–∞ –ø–æ–ª—ñ–≤"""
        self.comment_entry.delete(0, "end")
        self.version_entry.delete(0, "end")
        self.tag_checkbox.select()
        self.status_label.configure(text="–ì–æ—Ç–æ–≤–æ –¥–æ —Ä–æ–±–æ—Ç–∏")


def main():
    app = GitCommitTool()
    app.mainloop()


if __name__ == "__main__":
    main()


================================================================================
–§–∞–π–ª 4/21: project_export_20251110_104446.txt
--------------------------------------------------------------------------------
================================================================================
–ï–ö–°–ü–û–†–¢ –ü–†–û–Ñ–ö–¢–£: RemoteHand
–î–∞—Ç–∞: 2025-11-10 10:44:46
–®–ª—è—Ö: D:\Python Projects\Prego\RemoteHand
================================================================================

üìÇ –°–¢–†–£–ö–¢–£–†–ê –ü–†–û–Ñ–ö–¢–£
--------------------------------------------------------------------------------
RemoteHand/
‚îú‚îÄ‚îÄ assets/
‚îÇ   ‚îî‚îÄ‚îÄ icon.ico
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ anydesk_manager.py
‚îÇ   ‚îú‚îÄ‚îÄ config.py
‚îÇ   ‚îú‚îÄ‚îÄ config_manager.py
‚îÇ   ‚îú‚îÄ‚îÄ main.py
‚îÇ   ‚îú‚îÄ‚îÄ network_test.py
‚îÇ   ‚îú‚îÄ‚îÄ rdp_manager.py
‚îÇ   ‚îú‚îÄ‚îÄ set_anydesk_password.py
‚îÇ   ‚îú‚îÄ‚îÄ setup_wizard.py
‚îÇ   ‚îú‚îÄ‚îÄ telegram_api.py
‚îÇ   ‚îú‚îÄ‚îÄ telegram_helper.py
‚îÇ   ‚îú‚îÄ‚îÄ update.bat
‚îÇ   ‚îú‚îÄ‚îÄ updater.py
‚îÇ   ‚îî‚îÄ‚îÄ utils.py
‚îú‚îÄ‚îÄ .env.example
‚îú‚îÄ‚îÄ 23.88.7.196_admin_session.rdp
‚îú‚îÄ‚îÄ dev_run.py
‚îú‚îÄ‚îÄ export.py
‚îú‚îÄ‚îÄ GitCommitTool.py
‚îú‚îÄ‚îÄ project_export_20251110_104446.txt
‚îú‚îÄ‚îÄ README.md
‚îú‚îÄ‚îÄ RemoteHand.spec
‚îú‚îÄ‚îÄ requirements.txt
‚îú‚îÄ‚îÄ version.txt
‚îú‚îÄ‚îÄ version_info.txt
‚îî‚îÄ‚îÄ –ê–∫—Ç–∏–≤–∞—Ü—ñ—è —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞.txt

üìÑ –í–ú–Ü–°–¢ –§–ê–ô–õ–Ü–í (21 —Ñ–∞–π–ª—ñ–≤)
================================================================================


================================================================================
–§–∞–π–ª 1/21: dev_run.py
--------------------------------------------------------------------------------
"""
DEV_RUN.PY - –õ–æ–∫–∞–ª—å–Ω–µ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è
"""

import sys
import os

# –í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ DEV —Ä–µ–∂–∏–º
os.environ['REMOTEHAND_DEV_MODE'] = '1'

# –î–æ–¥–∞—Ç–∏ src –≤ path
sys.path.insert(0, os.path.join(os.path.dirname(__file__), 'src'))

print("–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π...")
import subprocess
subprocess.run([sys.executable, "-m", "pip", "install", "-r", "requirements.txt", "-q"],
               capture_output=True)

print("üîß –ó–∞–ø—É—Å–∫ —É DEV —Ä–µ–∂–∏–º—ñ...")

# –ü—Ä—è–º–æ –∑–∞–ø—É—Å—Ç–∏—Ç–∏ main
if __name__ == "__main__":
    import main
    main.main()


================================================================================
–§–∞–π–ª 2/21: export.py
--------------------------------------------------------------------------------
#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Project Structure Exporter
–°—Ç–≤–æ—Ä—é—î –¥–µ—Ç–∞–ª—å–Ω–∏–π –æ–ø–∏—Å —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ –ø—Ä–æ—î–∫—Ç—É —Ç–∞ –≤–º—ñ—Å—Ç —Ñ–∞–π–ª—ñ–≤ —É –æ–¥–∏–Ω —Ñ–∞–π–ª
"""

import os
from pathlib import Path
from datetime import datetime

# –§–∞–π–ª–∏ —Ç–∞ –ø–∞–ø–∫–∏, —è–∫—ñ —Ç—Ä–µ–±–∞ —ñ–≥–Ω–æ—Ä—É–≤–∞—Ç–∏
IGNORE_PATTERNS = {
    # –ü–∞–ø–∫–∏
    '__pycache__', '.git', '.idea', '.vscode', 'node_modules',
    'venv', 'env', '.env', 'dist', 'build', '.pytest_cache',
    '.mypy_cache', 'htmlcov', '.coverage', 'logs', 'tmp',
    # –§–∞–π–ª–∏
    '.pyc', '.pyo', '.pyd', '.so', '.dll', '.dylib', '.exe',
    '.log', '.sqlite', '.db', '.pkl', '.pickle', '.DS_Store',
    'Thumbs.db', '.env', '.env.local', '.gitignore'
}

# –†–æ–∑—à–∏—Ä–µ–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤ –¥–ª—è —á–∏—Ç–∞–Ω–Ω—è (—Ç–µ–∫—Å—Ç–æ–≤—ñ —Ñ–∞–π–ª–∏)
TEXT_EXTENSIONS = {
    '.py', '.js', '.ts', '.jsx', '.tsx', '.html', '.css', '.scss',
    '.json', '.yaml', '.yml', '.toml', '.ini', '.cfg', '.conf',
    '.txt', '.md', '.rst', '.xml', '.sql', '.sh', '.bash',
    '.env.example', '.gitignore', 'Dockerfile', 'Makefile',
    '.java', '.c', '.cpp', '.h', '.go', '.rs', '.php', '.rb'
}

# –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∏–π —Ä–æ–∑–º—ñ—Ä —Ñ–∞–π–ª—É (1 MB)
MAX_FILE_SIZE = 1024 * 1024


def should_ignore(path: Path) -> bool:
    """–ü–µ—Ä–µ–≤—ñ—Ä—è—î, —á–∏ —Ç—Ä–µ–±–∞ —ñ–≥–Ω–æ—Ä—É–≤–∞—Ç–∏ —Ñ–∞–π–ª/–ø–∞–ø–∫—É"""
    name = path.name

    # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ç–æ—á–Ω–æ–≥–æ –∑–±—ñ–≥—É
    if name in IGNORE_PATTERNS:
        return True

    # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è
    if path.suffix in IGNORE_PATTERNS:
        return True

    # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø—Ä–∏—Ö–æ–≤–∞–Ω–∏—Ö —Ñ–∞–π–ª—ñ–≤ (–∫—Ä—ñ–º .env.example)
    if name.startswith('.') and name != '.env.example':
        return True

    return False


def is_text_file(path: Path) -> bool:
    """–ü–µ—Ä–µ–≤—ñ—Ä—è—î, —á–∏ —î —Ñ–∞–π–ª —Ç–µ–∫—Å—Ç–æ–≤–∏–º"""
    # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è
    if path.suffix.lower() in TEXT_EXTENSIONS:
        return True

    # –§–∞–π–ª–∏ –±–µ–∑ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è, —è–∫—ñ –∑–∞–∑–≤–∏—á–∞–π —Ç–µ–∫—Å—Ç–æ–≤—ñ
    if path.suffix == '' and path.name in {'Dockerfile', 'Makefile', 'README', 'LICENSE'}:
        return True

    return False


def get_tree_structure(root_path: Path, prefix: str = "", is_last: bool = True) -> list:
    """–ì–µ–Ω–µ—Ä—É—î –¥–µ—Ä–µ–≤–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ –ø—Ä–æ—î–∫—Ç—É"""
    lines = []

    try:
        items = sorted(root_path.iterdir(), key=lambda x: (not x.is_dir(), x.name.lower()))
        items = [item for item in items if not should_ignore(item)]

        for i, item in enumerate(items):
            is_last_item = i == len(items) - 1
            current_prefix = "‚îî‚îÄ‚îÄ " if is_last_item else "‚îú‚îÄ‚îÄ "
            lines.append(f"{prefix}{current_prefix}{item.name}{'/' if item.is_dir() else ''}")

            if item.is_dir():
                extension = "    " if is_last_item else "‚îÇ   "
                lines.extend(get_tree_structure(item, prefix + extension, is_last_item))

    except PermissionError:
        pass

    return lines


def read_file_content(file_path: Path) -> str:
    """–ß–∏—Ç–∞—î –≤–º—ñ—Å—Ç —Ñ–∞–π–ª—É"""
    try:
        # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ä–æ–∑–º—ñ—Ä—É
        if file_path.stat().st_size > MAX_FILE_SIZE:
            return f"[–§–∞–π–ª –∑–∞–Ω–∞–¥—Ç–æ –≤–µ–ª–∏–∫–∏–π: {file_path.stat().st_size / 1024:.1f} KB]"

        # –°–ø—Ä–æ–±–∞ –ø—Ä–æ—á–∏—Ç–∞—Ç–∏ —è–∫ —Ç–µ–∫—Å—Ç
        with open(file_path, 'r', encoding='utf-8') as f:
            return f.read()
    except UnicodeDecodeError:
        # –Ø–∫—â–æ –Ω–µ –≤–¥–∞–ª–æ—Å—è –ø—Ä–æ—á–∏—Ç–∞—Ç–∏ —è–∫ UTF-8
        try:
            with open(file_path, 'r', encoding='cp1251') as f:
                return f.read()
        except:
            return "[–ù–µ –≤–¥–∞–ª–æ—Å—è –ø—Ä–æ—á–∏—Ç–∞—Ç–∏ —Ñ–∞–π–ª - –±—ñ–Ω–∞—Ä–Ω–∏–π –∞–±–æ –Ω–µ–≤—ñ–¥–æ–º–µ –∫–æ–¥—É–≤–∞–Ω–Ω—è]"
    except Exception as e:
        return f"[–ü–æ–º–∏–ª–∫–∞ —á–∏—Ç–∞–Ω–Ω—è: {str(e)}]"


def collect_files(root_path: Path) -> list:
    """–ó–±–∏—Ä–∞—î –≤—Å—ñ —Ç–µ–∫—Å—Ç–æ–≤—ñ —Ñ–∞–π–ª–∏ –ø—Ä–æ—î–∫—Ç—É"""
    files = []

    for item in root_path.rglob('*'):
        if item.is_file() and not should_ignore(item) and is_text_file(item):
            # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞, —â–æ –≤—Å—ñ –±–∞—Ç—å–∫—ñ–≤—Å—å–∫—ñ –ø–∞–ø–∫–∏ –Ω–µ —ñ–≥–Ω–æ—Ä—É—é—Ç—å—Å—è
            if not any(should_ignore(parent) for parent in item.parents):
                files.append(item)

    return sorted(files)


def generate_project_export(project_path: str, output_file: str = None):
    """–ì–µ–Ω–µ—Ä—É—î –ø–æ–≤–Ω–∏–π –µ–∫—Å–ø–æ—Ä—Ç –ø—Ä–æ—î–∫—Ç—É"""
    root = Path(project_path).resolve()

    if not root.exists():
        print(f"‚ùå –ü–æ–º–∏–ª–∫–∞: –®–ª—è—Ö '{project_path}' –Ω–µ —ñ—Å–Ω—É—î!")
        return

    if output_file is None:
        timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
        output_file = f"project_export_{timestamp}.txt"

    print(f"üìÅ –ê–Ω–∞–ª—ñ–∑ –ø—Ä–æ—î–∫—Ç—É: {root.name}")
    print(f"üìù –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –µ–∫—Å–ø–æ—Ä—Ç—É...")

    with open(output_file, 'w', encoding='utf-8') as f:
        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        f.write("=" * 80 + "\n")
        f.write(f"–ï–ö–°–ü–û–†–¢ –ü–†–û–Ñ–ö–¢–£: {root.name}\n")
        f.write(f"–î–∞—Ç–∞: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}\n")
        f.write(f"–®–ª—è—Ö: {root}\n")
        f.write("=" * 80 + "\n\n")

        # –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ—î–∫—Ç—É
        f.write("üìÇ –°–¢–†–£–ö–¢–£–†–ê –ü–†–û–Ñ–ö–¢–£\n")
        f.write("-" * 80 + "\n")
        f.write(f"{root.name}/\n")
        tree_lines = get_tree_structure(root)
        f.write("\n".join(tree_lines))
        f.write("\n\n")

        # –ó–±—ñ—Ä —Ñ–∞–π–ª—ñ–≤
        files = collect_files(root)

        f.write(f"üìÑ –í–ú–Ü–°–¢ –§–ê–ô–õ–Ü–í ({len(files)} —Ñ–∞–π–ª—ñ–≤)\n")
        f.write("=" * 80 + "\n\n")

        # –í–º—ñ—Å—Ç –∫–æ–∂–Ω–æ–≥–æ —Ñ–∞–π–ª—É
        for i, file_path in enumerate(files, 1):
            relative_path = file_path.relative_to(root)

            print(f"  [{i}/{len(files)}] {relative_path}")

            f.write("\n" + "=" * 80 + "\n")
            f.write(f"–§–∞–π–ª {i}/{len(files)}: {relative_path}\n")
            f.write("-" * 80 + "\n")

            content = read_file_content(file_path)
            f.write(content)
            f.write("\n")

        # –ü—ñ–¥—Å—É–º–æ–∫
        f.write("\n" + "=" * 80 + "\n")
        f.write("–ö–Ü–ù–ï–¶–¨ –ï–ö–°–ü–û–†–¢–£\n")
        f.write("=" * 80 + "\n")

    file_size = Path(output_file).stat().st_size
    print(f"\n‚úÖ –ï–∫—Å–ø–æ—Ä—Ç –∑–∞–≤–µ—Ä—à–µ–Ω–æ!")
    print(f"üìÑ –§–∞–π–ª: {output_file}")
    print(f"üìä –†–æ–∑–º—ñ—Ä: {file_size / 1024:.1f} KB")
    print(f"üìÅ –§–∞–π–ª—ñ–≤ –æ–±—Ä–æ–±–ª–µ–Ω–æ: {len(files)}")


if __name__ == "__main__":
    import sys

    # –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è: python export_project.py [—à–ª—è—Ö_–¥–æ_–ø—Ä–æ—î–∫—Ç—É] [–≤–∏—Ö—ñ–¥–Ω–∏–π_—Ñ–∞–π–ª]
    project_path = sys.argv[1] if len(sys.argv) > 1 else "."
    output_file = sys.argv[2] if len(sys.argv) > 2 else None

    generate_project_export(project_path, output_file)


================================================================================
–§–∞–π–ª 3/21: GitCommitTool.py
--------------------------------------------------------------------------------
import customtkinter as ctk
from tkinter import messagebox, scrolledtext
import subprocess
import os
from pathlib import Path
from datetime import datetime


class GitCommitTool(ctk.CTk):
    def __init__(self):
        super().__init__()

        self.title("Git Commit Tool")
        self.geometry("600x700")
        self.resizable(False, False)

        # –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç–µ–º–∏
        ctk.set_appearance_mode("light")
        ctk.set_default_color_theme("blue")

        # –û—Ç—Ä–∏–º–∞–Ω–Ω—è –ø–æ—Ç–æ—á–Ω–æ—ó –≤–µ—Ä—Å—ñ—ó
        self.current_version = self.get_current_version()

        self.setup_ui()

    def setup_ui(self):
        """–°—Ç–≤–æ—Ä–µ–Ω–Ω—è UI"""

        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        title_label = ctk.CTkLabel(
            self,
            text="Git Commit Tool",
            font=ctk.CTkFont(size=24, weight="bold")
        )
        title_label.pack(pady=15)

        # –ü–æ—Ç–æ—á–Ω–∞ –≤–µ—Ä—Å—ñ—è
        version_frame = ctk.CTkFrame(self)
        version_frame.pack(pady=10, padx=20, fill="x")

        ctk.CTkLabel(
            version_frame,
            text="–ü–æ—Ç–æ—á–Ω–∞ –≤–µ—Ä—Å—ñ—è:",
            font=ctk.CTkFont(size=12, weight="bold")
        ).pack(side="left")

        ctk.CTkLabel(
            version_frame,
            text=f"v{self.current_version}",
            font=ctk.CTkFont(size=12),
            text_color="gray"
        ).pack(side="left", padx=10)

        # –ö–æ–º–µ–Ω—Ç–∞—Ä
        ctk.CTkLabel(
            self,
            text="–ö–æ–º–µ–Ω—Ç–∞—Ä (commit message):",
            font=ctk.CTkFont(size=12, weight="bold")
        ).pack(anchor="w", padx=20, pady=(10, 5))

        self.comment_entry = ctk.CTkEntry(
            self,
            placeholder_text="–û–ø–∏—à—ñ—Ç—å –≤–∞—à—ñ –∑–º—ñ–Ω–∏...",
            height=40,
            font=ctk.CTkFont(size=11)
        )
        self.comment_entry.pack(padx=20, fill="x", pady=(0, 15))

        # –ù–æ–≤–∞ –≤–µ—Ä—Å—ñ—è
        ctk.CTkLabel(
            self,
            text="–ù–æ–≤–∞ –≤–µ—Ä—Å—ñ—è (–¥–ª—è —Ç–∞–≥—É):",
            font=ctk.CTkFont(size=12, weight="bold")
        ).pack(anchor="w", padx=20, pady=(10, 5))

        version_frame2 = ctk.CTkFrame(self)
        version_frame2.pack(padx=20, fill="x", pady=(0, 15))

        ctk.CTkLabel(
            version_frame2,
            text="v",
            font=ctk.CTkFont(size=11)
        ).pack(side="left", padx=(0, 5))

        self.version_entry = ctk.CTkEntry(
            version_frame2,
            placeholder_text="1.1.0",
            height=35,
            font=ctk.CTkFont(size=11)
        )
        self.version_entry.pack(side="left", fill="x", expand=True)

        # –ß–µ–∫–±–æ–∫—Å –¥–ª—è —Ç–∞–≥—É
        self.tag_checkbox = ctk.CTkCheckBox(
            self,
            text="–°—Ç–≤–æ—Ä–∏—Ç–∏ —Ç–µ–≥ –≤–µ—Ä—Å—ñ—ó",
            font=ctk.CTkFont(size=11)
        )
        self.tag_checkbox.pack(anchor="w", padx=20, pady=(0, 20))
        self.tag_checkbox.select()

        # –ö–Ω–æ–ø–∫–∏
        button_frame = ctk.CTkFrame(self)
        button_frame.pack(padx=20, fill="x", pady=(0, 15))

        commit_btn = ctk.CTkButton(
            button_frame,
            text="‚úÖ Commit & Push",
            command=self.commit_and_push,
            font=ctk.CTkFont(size=12, weight="bold"),
            height=45,
            corner_radius=10
        )
        commit_btn.pack(side="left", fill="both", expand=True, padx=(0, 5))

        clear_btn = ctk.CTkButton(
            button_frame,
            text="üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç–∏",
            command=self.clear_fields,
            font=ctk.CTkFont(size=12),
            height=45,
            corner_radius=10,
            fg_color="gray30",
            hover_color="gray50"
        )
        clear_btn.pack(side="left", fill="both", expand=True, padx=(5, 0))

        # –õ–æ–≥–∏
        ctk.CTkLabel(
            self,
            text="–õ–æ–≥–∏ –æ–ø–µ—Ä–∞—Ü—ñ–π:",
            font=ctk.CTkFont(size=11, weight="bold")
        ).pack(anchor="w", padx=20, pady=(10, 5))

        self.log_text = scrolledtext.ScrolledText(
            self,
            height=10,
            width=70,
            font=("Courier", 9),
            bg="#f0f0f0",
            fg="#333333",
            relief="solid",
            borderwidth=1
        )
        self.log_text.pack(padx=20, pady=(0, 15), fill="both", expand=True)

        # –°—Ç–∞—Ç—É—Å
        self.status_label = ctk.CTkLabel(
            self,
            text="–ì–æ—Ç–æ–≤–æ –¥–æ —Ä–æ–±–æ—Ç–∏",
            font=ctk.CTkFont(size=10),
            text_color="gray"
        )
        self.status_label.pack(pady=(0, 10))

    def get_current_version(self):
        """–û—Ç—Ä–∏–º–∞–Ω–Ω—è –ø–æ—Ç–æ—á–Ω–æ—ó –≤–µ—Ä—Å—ñ—ó –∑ version.txt"""
        try:
            with open("version.txt", "r") as f:
                return f.read().strip()
        except:
            return "1.0.0"

    def log_message(self, message):
        """–î–æ–¥–∞–Ω–Ω—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –¥–æ –ª–æ–≥—ñ–≤"""
        timestamp = datetime.now().strftime("%H:%M:%S")
        self.log_text.insert("end", f"[{timestamp}] {message}\n")
        self.log_text.see("end")
        self.update()

    def run_git_command(self, command):
        """–í–∏–∫–æ–Ω–∞–Ω–Ω—è git –∫–æ–º–∞–Ω–¥–∏"""
        try:
            result = subprocess.run(
                command,
                shell=True,
                capture_output=True,
                text=True,
                cwd=os.getcwd()
            )

            if result.returncode == 0:
                if result.stdout:
                    self.log_message(f"‚úÖ {result.stdout.strip()}")
                return True
            else:
                error_msg = result.stderr.strip() if result.stderr else "–ù–µ–≤—ñ–¥–æ–º–∞ –ø–æ–º–∏–ª–∫–∞"
                self.log_message(f"‚ùå –ü–æ–º–∏–ª–∫–∞: {error_msg}")
                return False
        except Exception as e:
            self.log_message(f"‚ùå –ò—Å–∫–ª—é—á–µ–Ω–∏–µ: {str(e)}")
            return False

    def commit_and_push(self):
        """–û—Å–Ω–æ–≤–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è - commit, tag —ñ push"""

        comment = self.comment_entry.get().strip()
        new_version = self.version_entry.get().strip()
        create_tag = self.tag_checkbox.get()

        # –ü–µ—Ä–µ–≤—ñ—Ä–∫–∏
        if not comment:
            messagebox.showwarning("–ü–æ–º–∏–ª–∫–∞", "–ù–∞–ø–∏—à—ñ—Ç—å –∫–æ–º–µ–Ω—Ç–∞—Ä –¥–æ –∫–æ–º—ñ—Ç—é!")
            return

        if create_tag and not new_version:
            messagebox.showwarning("–ü–æ–º–∏–ª–∫–∞", "–ù–∞–ø–∏—à—ñ—Ç—å –Ω–æ–≤—É –≤–µ—Ä—Å—ñ—é –¥–ª—è —Ç–∞–≥—É!")
            return

        self.status_label.configure(text="‚è≥ –û–±—Ä–æ–±–∫–∞...")
        self.update()

        self.log_message("=" * 50)
        self.log_message("üöÄ –†–æ–∑–ø–æ—á–∏–Ω–∞—î–º–æ commit & push –ø—Ä–æ—Ü–µ—Å...")
        self.log_message("=" * 50)

        # –ö—Ä–æ–∫ 1: –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å—É
        self.log_message("\nüìã –ö—Ä–æ–∫ 1: –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å—É —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—é...")
        self.run_git_command("git status --short")

        # –ö—Ä–æ–∫ 2: –î–æ–±–∞–≤–ª–µ–Ω–Ω—è –≤—Å—ñ—Ö —Ñ–∞–π–ª—ñ–≤
        self.log_message("\nüì¶ –ö—Ä–æ–∫ 2: –î–æ–¥–∞–≤–∞–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤...")
        if not self.run_git_command("git add ."):
            self.status_label.configure(text="‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –¥–æ–¥–∞–≤–∞–Ω–Ω—ñ —Ñ–∞–π–ª—ñ–≤")
            messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–ù–µ –≤–¥–∞–ª–æ—Å—è –¥–æ–¥–∞—Ç–∏ —Ñ–∞–π–ª–∏!")
            return

        # –ö—Ä–æ–∫ 3: –ö–æ–º—ñ—Ç
        self.log_message("\nüíæ –ö—Ä–æ–∫ 3: –ö–æ–º—ñ—Ç—É–≤–∞–Ω–Ω—è –∑–º—ñ–Ω...")
        if not self.run_git_command(f'git commit -m "{comment}"'):
            self.status_label.configure(text="‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –∫–æ–º—ñ—Ç—É–≤–∞–Ω–Ω—ñ")
            messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–ù–µ –≤–¥–∞–ª–æ—Å—è –∑–∞–∫–æ–º—ñ—Ç–∏—Ç–∏!")
            return

        # –ö—Ä–æ–∫ 4: Push
        self.log_message("\n‚¨ÜÔ∏è  –ö—Ä–æ–∫ 4: –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –Ω–∞ GitHub...")
        if not self.run_git_command("git push origin main"):
            self.status_label.configure(text="‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ push")
            messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–ù–µ –≤–¥–∞–ª–æ—Å—è –≤—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ –Ω–∞ GitHub!")
            return

        # –ö—Ä–æ–∫ 5: –¢–µ–≥ (—è–∫—â–æ –ø–æ—Ç—Ä—ñ–±–µ–Ω)
        if create_tag:
            self.log_message("\nüè∑Ô∏è  –ö—Ä–æ–∫ 5: –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–∞–≥—É...")
            if not self.run_git_command(f"git tag v{new_version}"):
                self.status_label.configure(text="‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—ñ —Ç–∞–≥—É")
                messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–ù–µ –≤–¥–∞–ª–æ—Å—è —Å—Ç–≤–æ—Ä–∏—Ç–∏ —Ç–µ–≥!")
                return

            self.log_message("\n‚¨ÜÔ∏è  –ö—Ä–æ–∫ 6: –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ç–∞–≥—É –Ω–∞ GitHub...")
            if not self.run_git_command(f"git push origin v{new_version}"):
                self.status_label.configure(text="‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ push —Ç–∞–≥—É")
                messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–ù–µ –≤–¥–∞–ª–æ—Å—è –≤—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ —Ç–µ–≥!")
                return

            # –û–Ω–æ–≤–ª–µ–Ω–Ω—è version.txt
            self.log_message("\nüìù –ö—Ä–æ–∫ 7: –û–Ω–æ–≤–ª–µ–Ω–Ω—è version.txt...")
            try:
                with open("version.txt", "w") as f:
                    f.write(new_version)
                self.log_message("‚úÖ version.txt –æ–Ω–æ–≤–ª–µ–Ω–æ")
                self.current_version = new_version
            except Exception as e:
                self.log_message(f"‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –æ–Ω–æ–≤–ª–µ–Ω–Ω—ñ version.txt: {str(e)}")

        self.log_message("\n" + "=" * 50)
        self.log_message("‚úÖ –í–°–ï –£–°–ü–Ü–®–ù–û! GitHub Actions –ø–æ—á–Ω–µ –∫–æ–º–ø—ñ–ª—é–≤–∞—Ç–∏...")
        self.log_message("=" * 50)

        self.status_label.configure(text="‚úÖ –£—Å–ø—ñ—à–Ω–æ! GitHub Actions –∑–∞–ø—É—â–µ–Ω–æ")
        messagebox.showinfo(
            "–£—Å–ø—ñ—Ö",
            f"‚úÖ –ö–æ–º—ñ—Ç —É—Å–ø—ñ—à–Ω–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ!\n\n"
            f"–ö–æ–º–µ–Ω—Ç–∞—Ä: {comment}\n"
            + (f"–í–µ—Ä—Å—ñ—è: v{new_version}\n\nGitHub Actions –ø–æ—á–Ω–µ –∫–æ–º–ø—ñ–ª—é–≤–∞—Ç–∏ EXE..." if create_tag else "")
        )

        self.clear_fields()

    def clear_fields(self):
        """–û—á–∏—Å—Ç–∫–∞ –ø–æ–ª—ñ–≤"""
        self.comment_entry.delete(0, "end")
        self.version_entry.delete(0, "end")
        self.tag_checkbox.select()
        self.status_label.configure(text="–ì–æ—Ç–æ–≤–æ –¥–æ —Ä–æ–±–æ—Ç–∏")


def main():
    app = GitCommitTool()
    app.mainloop()


if __name__ == "__main__":
    main()


================================================================================
–§–∞–π–ª 5/21: README.md
--------------------------------------------------------------------------------


================================================================================
–§–∞–π–ª 6/21: requirements.txt
--------------------------------------------------------------------------------
customtkinter==5.2.1
requests==2.31.0
psutil==5.9.6
keyring==24.1.0
python-telegram-bot==20.3
packaging>=24.0
pywin32>=300
python-dotenv

================================================================================
–§–∞–π–ª 7/21: src\anydesk_manager.py
--------------------------------------------------------------------------------
import os
import sys
import subprocess
import time
import logging
import psutil
import platform
import ctypes
import socket
from pathlib import Path
from typing import Optional, Tuple

logger = logging.getLogger(__name__)

UNATTENDED_PASSWORD = "r3moteh4nd"


class AnyDeskManager:
    """–ú–µ–Ω–µ–¥–∂–µ—Ä –¥–ª—è AnyDesk"""

    def __init__(self, config_manager, telegram_api):
        self.config = config_manager
        self.telegram = telegram_api
        self.anydesk_path = self.find_anydesk()
        self._is_running = False
        self.connection_id = None

    def find_anydesk(self) -> Optional[str]:
        """–ó–Ω–∞–π—Ç–∏ AnyDesk"""
        possible_paths = [
            r"C:\Program Files\AnyDesk\AnyDesk.exe",
            r"C:\Program Files (x86)\AnyDesk\AnyDesk.exe",
            os.path.expanduser("~\\AppData\\Local\\AnyDesk\\AnyDesk.exe"),
            os.path.expanduser("~\\AppData\\Roaming\\AnyDesk\\AnyDesk.exe"),
            os.path.expanduser("~\\Downloads\\AnyDesk.exe"),
            r"C:\ProgramData\AnyDesk\AnyDesk.exe",
        ]

        for path in possible_paths:
            if os.path.exists(path):
                logger.info(f"‚úÖ AnyDesk –∑–Ω–∞–π–¥–µ–Ω–æ: {path}")
                return path

        logger.warning("‚ö†Ô∏è AnyDesk –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ")
        return None

    def download_anydesk(self) -> bool:
        """–ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ AnyDesk"""
        if self.anydesk_path:
            return True

        logger.info("üì• –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è AnyDesk...")
        try:
            import urllib.request
            downloads_dir = os.path.expanduser("~\\Downloads")
            save_path = os.path.join(downloads_dir, "AnyDesk.exe")
            download_url = "https://download.anydesk.com/AnyDesk.exe"

            if not os.path.exists(save_path):
                logger.info(f"–ó–∞–≤–∞–Ω—Ç–∞–∂—É...")
                urllib.request.urlretrieve(download_url, save_path)

            logger.info("–ó–∞–ø—É—Å–∫ –≤—Å—Ç–∞–Ω–æ–≤–ª—é–≤–∞—á–∞...")
            subprocess.Popen([save_path])

            logger.info("–ß–µ–∫–∞—é –Ω–∞ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è (90 —Å–µ–∫)...")
            for i in range(90):
                time.sleep(1)
                self.anydesk_path = self.find_anydesk()
                if self.anydesk_path:
                    logger.info(f"‚úÖ AnyDesk –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ")
                    time.sleep(3)
                    return True

            return False
        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞: {e}")
            return False

    def check_if_running(self) -> bool:
        """–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —á–∏ AnyDesk –∑–∞–ø—É—â–µ–Ω–æ"""
        try:
            for proc in psutil.process_iter(['pid', 'name']):
                if 'anydesk' in proc.info['name'].lower():
                    logger.info(f"‚ÑπÔ∏è AnyDesk –∑–∞–ø—É—â–µ–Ω–æ (PID: {proc.info['pid']})")
                    self._is_running = True
                    return True
        except:
            pass
        self._is_running = False
        return False

    def launch_anydesk(self) -> bool:
        """–ó–∞–ø—É—Å—Ç–∏—Ç–∏ AnyDesk"""
        if self.check_if_running():
            return True

        if not self.anydesk_path or not Path(self.anydesk_path).exists():
            logger.error("–®–ª—è—Ö –Ω–µ–≤—ñ–¥–æ–º–∏–π")
            return False

        try:
            logger.info(f"üöÄ –ó–∞–ø—É—Å–∫–∞—é AnyDesk...")
            subprocess.Popen(self.anydesk_path)
            time.sleep(5)

            if self.check_if_running():
                logger.info("‚úÖ AnyDesk –∑–∞–ø—É—â–µ–Ω–æ")
                return True
            else:
                self._is_running = True
                return True
        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞: {e}")
            return False

    def set_password_with_admin(self) -> bool:
        """–í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –ø–∞—Ä–æ–ª—å —á–µ—Ä–µ–∑ –æ–∫—Ä–µ–º–∏–π —Å–∫—Ä–∏–ø—Ç –∑ –∞–¥–º—ñ–Ω –ø—Ä–∞–≤–∞–º–∏"""
        if not self.anydesk_path:
            logger.error("–®–ª—è—Ö –Ω–µ–≤—ñ–¥–æ–º–∏–π")
            return False

        try:
            logger.info(f"üîê –ó–∞–ø—É—Å–∫–∞—é –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –ø–∞—Ä–æ–ª—è –∑ –∞–¥–º—ñ–Ω –ø—Ä–∞–≤–∞–º–∏...")

            # –í–∏–∑–Ω–∞—á–∏—Ç–∏ —à–ª—è—Ö –¥–æ —Å–∫—Ä–∏–ø—Ç—É
            if getattr(sys, 'frozen', False):
                # –Ø–∫—â–æ EXE - —Å–∫—Ä–∏–ø—Ç –ø–æ—Ä—É—á
                script_path = os.path.join(os.path.dirname(sys.executable), "src", "set_anydesk_password.py")
            else:
                # –Ø–∫—â–æ DEV
                script_path = os.path.join(os.path.dirname(__file__), "set_anydesk_password.py")

            if not os.path.exists(script_path):
                logger.error(f"–°–∫—Ä–∏–ø—Ç –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ: {script_path}")
                return False

            # –ü–µ—Ä–µ–¥–∞—Ç–∏ –ø–∞—Ä–æ–ª—å —è–∫ –∑–º—ñ–Ω–Ω—É —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞
            env = os.environ.copy()
            env["ANYDESK_PASSWORD"] = UNATTENDED_PASSWORD

            # –ó–∞–ø—É—Å—Ç–∏—Ç–∏ —Å–∫—Ä–∏–ø—Ç –∑ –∞–¥–º—ñ–Ω –ø—Ä–∞–≤–∞–º–∏
            ctypes.windll.shell32.ShellExecuteW(
                None,
                "runas",
                sys.executable,
                f'"{script_path}" "{self.anydesk_path}"',
                None,
                1  # SW_SHOW - –ø–æ–∫–∞–∑–∞—Ç–∏ –≤—ñ–∫–Ω–æ
            )

            logger.info(f"‚úÖ –ó–∞–ø—Ä–æ—Å –∞–¥–º—ñ–Ω –ø—Ä–∞–≤ –Ω–∞–¥—ñ—Å–ª–∞–Ω–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—É")
            time.sleep(3)
            return True

        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞: {e}")
            import traceback
            traceback.print_exc()
            return False

    def get_connection_id(self) -> Optional[str]:
        """–û—Ç—Ä–∏–º–∞—Ç–∏ ID"""
        if not self.anydesk_path:
            return None

        try:
            logger.info("üìå –û—Ç—Ä–∏–º—É—é ID...")

            result = subprocess.run(
                [self.anydesk_path, '--get-id'],
                capture_output=True,
                text=True,
                timeout=10,
                creationflags=subprocess.CREATE_NO_WINDOW if platform.system() == "Windows" else 0
            )

            if result.returncode == 0:
                connection_id = result.stdout.strip()
                if connection_id and connection_id.isdigit():
                    logger.info(f"‚úÖ ID: {connection_id}")
                    self.connection_id = connection_id
                    return connection_id

        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞: {e}")

        return None

    def start(self, password: str = None) -> Tuple[Optional[str], Optional[str]]:
        """–ó–∞–ø—É—Å—Ç–∏—Ç–∏ AnyDesk"""
        password = UNATTENDED_PASSWORD

        # –ö—Ä–æ–∫ 1: –Ø–∫—â–æ –≤–∂–µ –∑–∞–ø—É—â–µ–Ω–æ
        if self.check_if_running():
            logger.info("AnyDesk –≤–∂–µ –∑–∞–ø—É—â–µ–Ω–æ")
            connection_id = self.get_connection_id()
            if connection_id:
                try:
                    # ‚ö†Ô∏è –î–û–î–ê–¢–ò –ü–Ü–ë
                    user_name = self.config.get("user_name", "")

                    self.telegram.send_anydesk_info(
                        self.config.store_location_text,
                        user_name,  # ‚¨ÖÔ∏è –ü–Ü–ë
                        socket.gethostname(),  # –ü–ö
                        connection_id,
                        password
                    )
                except Exception as e:
                    logger.error(f"‚ùå Telegram: {e}")
            return connection_id, password

        # –ö—Ä–æ–∫ 2: –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —è–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ
        if not self.anydesk_path:
            if not self.download_anydesk():
                return None, None

        # –ö—Ä–æ–∫ 3: –ó–∞–ø—É—Å—Ç–∏—Ç–∏
        if not self.launch_anydesk():
            return None, None

        # –ö—Ä–æ–∫ 4: –í–°–¢–ê–ù–û–í–ò–¢–ò –ü–ê–†–û–õ–¨ –ó –ê–î–ú–Ü–ù –ü–†–ê–í–ê–ú–ò
        logger.info("üîê –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –ø–∞—Ä–æ–ª—è...")
        time.sleep(2)
        self.set_password_with_admin()

        # –ö—Ä–æ–∫ 5: –û—Ç—Ä–∏–º–∞—Ç–∏ ID
        logger.info("üìå –û—Ç—Ä–∏–º–∞–Ω–Ω—è ID...")
        time.sleep(2)
        connection_id = self.get_connection_id()

        if not connection_id:
            time.sleep(3)
            connection_id = self.get_connection_id()

        # –ö—Ä–æ–∫ 6: –ù–∞–¥—ñ—Å–ª–∞—Ç–∏ –≤ Telegram –∑ –ü–Ü–ë
        try:
            # ‚ö†Ô∏è –î–û–î–ê–¢–ò –ü–Ü–ë
            user_name = self.config.get("user_name", "")

            self.telegram.send_anydesk_info(
                self.config.store_location_text,
                user_name,  # ‚¨ÖÔ∏è –ü–Ü–ë
                socket.gethostname(),  # –ü–ö
                connection_id if connection_id else "–Ω–µ –æ—Ç—Ä–∏–º–∞–Ω–æ",
                password
            )
            logger.info("‚úÖ –¢–µ–ª–µ–≥—Ä–∞–º —Å–ø–æ–≤—ñ—â–µ–Ω–æ")
        except Exception as e:
            logger.error(f"‚ùå –¢–µ–ª–µ–≥—Ä–∞–º –ø–æ–º–∏–ª–∫–∞: {e}")

        logger.info(f"‚úÖ –ì–æ—Ç–æ–≤–æ (ID: {connection_id})")
        return connection_id, password


================================================================================
–§–∞–π–ª 8/21: src\config.py
--------------------------------------------------------------------------------
import os
from pathlib import Path
from dotenv import load_dotenv

# –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ .env
load_dotenv()

APP_NAME = "RemoteHand"
RDP_HOST = "23.88.7.196"
RDP_PORT = 4420
PING_HOST = "23.88.7.196"

# üîí –ó–Ü –ó–ú–Ü–ù–ù–ò–• –°–ï–†–ï–î–û–í–ò–©–ê, –ê –ù–ï –ó .env!
TELEGRAM_TOKEN = os.getenv("TELEGRAM_TOKEN", "")
TELEGRAM_CHAT_ID = os.getenv("TELEGRAM_CHAT_ID", "")

# –§–∞–π–ª–∏
LOCK_FILE = Path.home() / ".remotehand" / "lock"


================================================================================
–§–∞–π–ª 9/21: src\config_manager.py
--------------------------------------------------------------------------------
import json
import os
from pathlib import Path
import logging

logger = logging.getLogger(__name__)


class ConfigManager:
    """–ú–µ–Ω–µ–¥–∂–µ—Ä –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó"""

    def __init__(self):
        self.config_dir = Path.home() / ".remotehand"
        self.config_dir.mkdir(exist_ok=True)
        self.config_file = self.config_dir / "config.json"

        self.config = self.load()

    def load(self):
        """–ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –∫–æ–Ω—Ñ—ñ–≥"""
        if self.config_file.exists():
            try:
                with open(self.config_file, 'r', encoding='utf-8') as f:
                    return json.load(f)
            except:
                pass
        return {}

    def save(self):
        """–ó–±–µ—Ä–µ–≥—Ç–∏ –∫–æ–Ω—Ñ—ñ–≥ –≤ JSON —Ñ–∞–π–ª"""
        try:
            with open(self.config_file, 'w', encoding='utf-8') as f:
                json.dump(self.config, f, ensure_ascii=False, indent=2)
        except Exception as e:
            logger.error(f"–ü–æ–º–∏–ª–∫–∞ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –∫–æ–Ω—Ñ—ñ–≥—É: {e}")

    def set(self, key, value):
        """–í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –∑–Ω–∞—á–µ–Ω–Ω—è"""
        self.config[key] = value
        self.save()

    def get(self, key, default=""):
        """–û—Ç—Ä–∏–º–∞—Ç–∏ –∑–Ω–∞—á–µ–Ω–Ω—è"""
        return self.config.get(key, default)

    def is_first_run(self):
        """–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —á–∏ –ø–µ—Ä—à–∏–π –∑–∞–ø—É—Å–∫"""
        store = self.config.get('store', '')
        location = self.config.get('location', '')
        return not store or not location

    @property
    def store_location_text(self):
        """–û—Ç—Ä–∏–º–∞—Ç–∏ —Ç–µ–∫—Å—Ç –º–∞–≥–∞–∑–∏–Ω—É/–ª–æ–∫–∞—Ü—ñ—ó"""
        store = self.config.get('store', '–ù–µ–≤—ñ–¥–æ–º–æ')
        location = self.config.get('location', '–ù–µ–≤—ñ–¥–æ–º–æ')
        return f"{store} / {location}"


================================================================================
–§–∞–π–ª 10/21: src\main.py
--------------------------------------------------------------------------------
import customtkinter as ctk
from tkinter import messagebox
import sys
import os
import threading
import logging
from pathlib import Path

# –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ .env —Ñ–∞–π–ª
from dotenv import load_dotenv

load_dotenv()

# –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –ª–æ–≥—É–≤–∞–Ω–Ω—è
logging.basicConfig(
    level=logging.INFO,
    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s'
)
logger = logging.getLogger(__name__)

# ============ –ü–ï–†–ï–í–Ü–†–ö–ê DEV –†–ï–ñ–ò–ú–£ ============
DEV_MODE = os.getenv('REMOTEHAND_DEV_MODE') == '1'
logger.info(f"{'üîß DEV –†–ï–ñ–ò–ú' if DEV_MODE else '‚úÖ PRODUCTION –†–ï–ñ–ò–ú'}")

if not DEV_MODE:
    # –¢–Ü–õ–¨–ö–ò –í PRODUCTION
    try:
        from updater import check_and_update

        check_and_update()
    except Exception as e:
        logger.warning(f"–ü–æ–º–∏–ª–∫–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –æ–Ω–æ–≤–ª–µ–Ω—å: {e}")

# ============ –Ü–ú–ü–û–†–¢–ò ============
from utils import close_all_rdp_sessions, test_connection
from config import RDP_HOST, RDP_PORT, PING_HOST, APP_NAME

# –ù–æ–≤—ñ —ñ–º–ø–æ—Ä—Ç–∏
from config_manager import ConfigManager
from telegram_api import TelegramAPI
from setup_wizard import SetupWizard
from network_test import NetworkTest

try:
    from rdp_manager import RDPManager

    rdp_manager_available = True
except ImportError as e:
    rdp_manager_available = False
    logger.warning(f"rdp_manager –Ω–µ –¥–æ—Å—Ç—É–ø–Ω–∞: {e}")

try:
    from anydesk_manager import AnyDeskManager

    anydesk_available = True
except ImportError as e:
    anydesk_available = False
    logger.warning(f"anydesk_manager –Ω–µ –¥–æ—Å—Ç—É–ø–Ω–∞: {e}")


class RemoteHandApp(ctk.CTk):
    def __init__(self):
        super().__init__()

        # –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –≤—ñ–∫–Ω–∞
        self.title(APP_NAME)
        self.geometry("520x800")
        self.resizable(True, True)

        # –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç–µ–º–∏
        ctk.set_appearance_mode("light")
        ctk.set_default_color_theme("blue")

        # –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è –º–µ–Ω–µ–¥–∂–µ—Ä—ñ–≤
        self.config = ConfigManager()

        # ‚ö†Ô∏è –ó–ê–í–ê–ù–¢–ê–ñ–ò–¢–ò –¢–û–ö–ï–ù–ò –ó .env –õ–ò CONFIG
        telegram_token = os.getenv("TELEGRAM_TOKEN") or self.config.get("telegram_token")
        telegram_chat_id = os.getenv("TELEGRAM_CHAT_ID") or self.config.get("telegram_chat_id")

        logger.info(f"Telegram token: {'‚úÖ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ' if telegram_token else '‚ùå –ù–ï –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ'}")
        logger.info(f"Telegram chat_id: {'‚úÖ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ' if telegram_chat_id else '‚ùå –ù–ï –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ'}")

        self.telegram = TelegramAPI(telegram_token, telegram_chat_id)

        if rdp_manager_available:
            self.rdp_manager = RDPManager(self.config, self.telegram)
        else:
            self.rdp_manager = None

        if anydesk_available:
            self.anydesk_manager = AnyDeskManager(self.config, self.telegram)
        else:
            self.anydesk_manager = None

        self.network_test = NetworkTest(self.config, self.telegram)

        # ‚ö†Ô∏è –°–¢–í–û–†–ò–¢–ò UI –í–°–Ü –†–ê–ó–ò, –∞ –ø–æ—Ç—ñ–º –ø–æ–∫–∞–∑–∞—Ç–∏ SetupWizard —è–∫—â–æ –ø–µ—Ä—à–∏–π –∑–∞–ø—É—Å–∫
        self.setup_ui()

        if self.config.is_first_run():
            self.show_setup_wizard()

    def get_app_version(self):
        """–û—Ç—Ä–∏–º–∞—Ç–∏ –≤–µ—Ä—Å—ñ—é –ø—Ä–æ–≥—Ä–∞–º–∏"""
        try:
            if getattr(sys, 'frozen', False):
                # –Ø–∫—â–æ EXE - —à—É–∫–∞—î–º–æ –ø–æ—Ä—É—á –∑ EXE
                base_path = Path(sys.executable).parent
            else:
                # –Ø–∫—â–æ DEV - —à—É–∫–∞—î–º–æ –≤ –∫–æ—Ä–µ–Ω—ñ –ø—Ä–æ–µ–∫—Ç—É
                base_path = Path(__file__).parent.parent

            version_file = base_path / "version.txt"

            if version_file.exists():
                return version_file.read_text(encoding='utf-8').strip()
        except Exception as e:
            logger.error(f"–ü–æ–º–∏–ª–∫–∞ —á–∏—Ç–∞–Ω–Ω—è –≤–µ—Ä—Å—ñ—ó: {e}")

        return "1.0.0"

    def show_setup_wizard(self):
        """–ü–æ–∫–∞–∑–∞—Ç–∏ –≤—ñ–∫–Ω–æ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –ø—Ä–∏ –ø–µ—Ä—à–æ–º—É –∑–∞–ø—É—Å–∫—É"""

        def on_setup_complete(result):
            self.config.set("store", result["store"])
            self.config.set("location", result["location"])
            if result.get("user_name"):
                self.config.set("user_name", result["user_name"])
            # ‚úÖ –û–Ω–æ–≤–∏—Ç–∏ UI –ø—ñ—Å–ª—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è
            self.refresh_ui()

        wizard = SetupWizard(self, on_setup_complete)
        self.wait_window(wizard)

    def refresh_ui(self):
        """–û–Ω–æ–≤–∏—Ç–∏ UI –ø—ñ—Å–ª—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è"""
        # –û–Ω–æ–≤–∏—Ç–∏ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –º–∞–≥–∞–∑–∏–Ω
        user_info = self.config.store_location_text
        user_name = self.config.get("user_name", "")
        if user_name:
            user_info += f" | üë§ {user_name}"

        self.info_label.configure(text=f"üìç {user_info}")

    def setup_ui(self):
        """–°—Ç–≤–æ—Ä–µ–Ω–Ω—è UI"""

        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        title_label = ctk.CTkLabel(
            self,
            text="RemoteHand",
            font=ctk.CTkFont(size=28, weight="bold")
        )
        title_label.pack(pady=15)

        # –Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ –º–∞–≥–∞–∑–∏–Ω/–ª–æ–∫–∞—Ü—ñ—é + –ü–Ü–ë
        user_info = self.config.store_location_text
        user_name = self.config.get("user_name", "")
        if user_name:
            user_info += f" | üë§ {user_name}"

        self.info_label = ctk.CTkLabel(
            self,
            text=f"üìç {user_info}",
            font=ctk.CTkFont(size=11),
            text_color="gray"
        )
        self.info_label.pack(pady=(0, 20))

        # ==================== RDP –ë–õ–û–ö ====================
        rdp_frame = ctk.CTkFrame(self)
        rdp_frame.pack(pady=15, padx=20, fill="x")

        ctk.CTkLabel(
            rdp_frame,
            text="üìã –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ 1–°",
            font=ctk.CTkFont(size=13, weight="bold")
        ).pack(anchor="w", pady=(0, 10))

        # –û—Å–Ω–æ–≤–Ω–∞ –∫–Ω–æ–ø–∫–∞ RDP
        rdp_btn = ctk.CTkButton(
            rdp_frame,
            text="üñ•Ô∏è –í—ñ–¥–∫—Ä–∏—Ç–∏ 1–° (RDP)",
            command=self.open_rdp,
            height=50,
            font=ctk.CTkFont(size=12, weight="bold"),
            corner_radius=12,
            fg_color="#007AFF",
            hover_color="#0051D5"
        )
        rdp_btn.pack(fill="x", pady=(0, 10))

        # ==================== –ó–ê–ö–†–ò–¢–¢–Ø –°–ï–°–Ü–ô ====================
        close_sessions_btn = ctk.CTkButton(
            self,
            text="‚ùå –ó–∞–∫—Ä–∏—Ç–∏ –≤—Å—ñ RDP —Å–µ—Å—ñ—ó",
            command=self.close_sessions_confirm,
            height=45,
            font=ctk.CTkFont(size=12, weight="bold"),
            corner_radius=12,
            fg_color="#FF3B30",
            hover_color="#D70015"
        )
        close_sessions_btn.pack(pady=15, padx=20, fill="x")

        # ==================== ANYDESK –ë–õ–û–ö ====================
        if anydesk_available:
            anydesk_frame = ctk.CTkFrame(self)
            anydesk_frame.pack(pady=15, padx=20, fill="x")

            ctk.CTkLabel(
                anydesk_frame,
                text="üåê –í—ñ–¥–¥–∞–ª–µ–Ω–∏–π –¥–æ—Å—Ç—É–ø",
                font=ctk.CTkFont(size=13, weight="bold")
            ).pack(anchor="w", pady=(0, 10))

            anydesk_btn = ctk.CTkButton(
                anydesk_frame,
                text="üöÄ –ó–∞–ø—É—Å—Ç–∏—Ç–∏ AnyDesk",
                command=self.start_anydesk,
                height=50,
                font=ctk.CTkFont(size=12, weight="bold"),
                corner_radius=12,
                fg_color="#FF6B35",
                hover_color="#CC5529"
            )
            anydesk_btn.pack(fill="x", pady=(0, 10))

        # ==================== –¢–ï–°–¢ –ú–ï–†–ï–ñ–Ü ====================
        test_frame = ctk.CTkFrame(self)
        test_frame.pack(pady=15, padx=20, fill="x")

        ctk.CTkLabel(
            test_frame,
            text="üîß –î—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∞",
            font=ctk.CTkFont(size=13, weight="bold")
        ).pack(anchor="w", pady=(0, 10))

        test_btn = ctk.CTkButton(
            test_frame,
            text="üì° –¢–µ—Å—Ç –∑'—î–¥–Ω–∞–Ω–Ω—è",
            command=self.run_network_test,
            height=50,
            font=ctk.CTkFont(size=12, weight="bold"),
            corner_radius=12,
            fg_color="#34C759",
            hover_color="#248A3D"
        )
        test_btn.pack(fill="x", pady=(0, 10))

        # ==================== –°–¢–ê–¢–£–° ====================
        self.status_label = ctk.CTkLabel(
            self,
            text="‚úÖ –ì–æ—Ç–æ–≤–æ –¥–æ —Ä–æ–±–æ—Ç–∏",
            font=ctk.CTkFont(size=10),
            text_color="gray"
        )
        self.status_label.pack(pady=10)

        # ==================== –ö–ù–û–ü–ö–ê –†–ï–î–ê–ì–£–í–ê–ù–ù–Ø –ú–ê–ì–ê–ó–ò–ù–£ ====================
        settings_frame = ctk.CTkFrame(self)
        settings_frame.pack(pady=10, padx=20, fill="x")

        settings_btn = ctk.CTkButton(
            settings_frame,
            text="‚öôÔ∏è –ó–º—ñ–Ω–∏—Ç–∏ –º–∞–≥–∞–∑–∏–Ω/–ª–æ–∫–∞—Ü—ñ—é/–ü–Ü–ë",
            command=self.show_setup_wizard,
            height=35,
            font=ctk.CTkFont(size=10),
            corner_radius=8,
            fg_color="#999999",
            hover_color="#666666"
        )
        settings_btn.pack(fill="x")

        # ==================== –í–ï–†–°–Ü–Ø + –°–¢–ê–¢–£–° –û–ù–û–í–õ–ï–ù–ù–Ø ====================
        version_frame = ctk.CTkFrame(self)
        version_frame.pack(anchor="se", padx=10, pady=10)

        version_label = ctk.CTkLabel(
            version_frame,
            text=f"v{self.get_app_version()}",
            font=ctk.CTkFont(size=9, weight="bold"),
            text_color="#333333"
        )
        version_label.pack(side="left", padx=5)

        self.update_status_label = ctk.CTkLabel(
            version_frame,
            text="‚úÖ",
            font=ctk.CTkFont(size=10),
            text_color="green"
        )
        self.update_status_label.pack(side="left", padx=5)

    def open_rdp(self):
        """–í—ñ–¥–∫—Ä–∏—Ç–∏ RDP"""
        if not self.rdp_manager:
            messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "RDP –º–µ–Ω–µ–¥–∂–µ—Ä –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω")
            return

        # –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —á–∏ –ø–∞—Ä–æ–ª—å –≤–∂–µ –∑–±–µ—Ä–µ–∂–µ–Ω–æ
        saved_password = self.rdp_manager.get_credentials(RDP_HOST, "admin")

        if saved_password:
            # –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –∑–±–µ—Ä–µ–∂–µ–Ω–∏–π –ø–∞—Ä–æ–ª—å
            self.set_status("‚è≥ –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è...", "processing")

            def connect():
                try:
                    if self.rdp_manager.connect_rdp(RDP_HOST, RDP_PORT, "admin", saved_password):
                        self.set_status("‚úÖ –ü—ñ–¥–∫–ª—é—á–µ–Ω–æ", "success")
                    else:
                        self.set_status("‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è", "error")
                except Exception as e:
                    logger.error(f"–ü–æ–º–∏–ª–∫–∞: {e}")
                    self.set_status("‚ùå –ö—Ä–∏—Ç–∏—á–Ω–∞ –ø–æ–º–∏–ª–∫–∞", "error")

            thread = threading.Thread(target=connect, daemon=True)
            thread.start()
        else:
            # –ó–∞–ø—Ä–æ—Å–∏—Ç–∏ –Ω–æ–≤–∏–π –ø–∞—Ä–æ–ª—å
            dialog = ctk.CTkInputDialog(
                text="–í–≤–µ–¥—ñ—Ç—å –ø–∞—Ä–æ–ª—å –¥–ª—è RDP:",
                title="–ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ 1–°"
            )
            password = dialog.get_input()

            if password:
                self.set_status("üíæ –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è –ø–∞—Ä–æ–ª—è...", "processing")

                # –°–ø—Ä–æ–±—É–≤–∞—Ç–∏ –ø—ñ–¥–∫–ª—é—á–∏—Ç–∏—Å—è
                if self.rdp_manager.connect_rdp(RDP_HOST, RDP_PORT, "admin", password):
                    # –Ø–∫—â–æ —É—Å–ø—ñ—à–Ω–æ, —Ç–æ –∑–±–µ—Ä–µ–≥—Ç–∏ –ø–∞—Ä–æ–ª—å
                    self.rdp_manager.save_credentials(RDP_HOST, "admin", password)
                    self.set_status("‚úÖ –£—Å–ø—ñ—à–Ω–æ –ø—ñ–¥–∫–ª—é—á–µ–Ω–æ", "success")
                else:
                    self.set_status("‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è", "error")

    def close_sessions_confirm(self):
        """–ü—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è –∑–∞–∫—Ä–∏—Ç—Ç—è —Å–µ—Å—ñ–π"""
        result = messagebox.askyesno(
            "–ü—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è",
            "–í–∏ –≤–ø–µ–≤–Ω–µ–Ω—ñ, —â–æ —Ö–æ—á–µ—Ç–µ –∑–∞–∫—Ä–∏—Ç–∏ –≤—Å—ñ RDP —Å–µ—Å—ñ—ó?"
        )
        if result:
            self.set_status("‚è≥ –ó–∞–∫—Ä–∏—Ç—Ç—è —Å–µ—Å—ñ–π...", "processing")
            close_all_rdp_sessions()
            self.set_status("‚úÖ –í—Å—ñ —Å–µ—Å—ñ—ó –∑–∞–∫—Ä–∏—Ç–æ", "success")

    def start_anydesk(self):
        """–ó–∞–ø—É—Å—Ç–∏—Ç–∏ AnyDesk - –ë–ï–ó –ø–æ–∫–∞–∑—É –ø–∞—Ä–æ–ª—è!"""
        if not self.anydesk_manager:
            messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "AnyDesk –º–µ–Ω–µ–¥–∂–µ—Ä –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω")
            return

        self.set_status("‚è≥ –ó–∞–ø—É—Å–∫ AnyDesk...", "processing")

        def anydesk_task():
            try:
                # –ó–∞–ø—É—Å—Ç–∏—Ç–∏ AnyDesk - –ø–∞—Ä–æ–ª—å –ù–ï –ø–µ—Ä–µ–¥–∞—î–º–æ —Ç–∞ –ù–ï –ø–æ–∫–∞–∑—É—î–º–æ!
                anydesk_id, pwd = self.anydesk_manager.start(None)

                if anydesk_id:
                    self.set_status(f"‚úÖ AnyDesk –∑–∞–ø—É—â–µ–Ω–æ\nüÜî ID: {anydesk_id}", "success")
                    messagebox.showinfo(
                        "‚úÖ AnyDesk –∑–∞–ø—É—â–µ–Ω–æ",
                        f"ID –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è: {anydesk_id}\n\n"
                        f"–î–∞–Ω—ñ –Ω–∞–¥—ñ—Å–ª–∞–Ω—ñ –≤ Telegram\n"
                        f"–ü–∞—Ä–æ–ª—å –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ"
                    )
                else:
                    self.set_status("‚ùå AnyDesk –≤–∂–µ –∑–∞–ø—É—â–µ–Ω–æ", "error")
                    messagebox.showwarning(
                        "‚ö†Ô∏è –£–≤–∞–≥–∞",
                        "AnyDesk –≤–∂–µ –∑–∞–ø—É—â–µ–Ω–æ –∞–±–æ –Ω–µ –≤–¥–∞–ª–æ—Å—è –∑–∞–ø—É—Å—Ç–∏—Ç–∏"
                    )
            except Exception as e:
                logger.error(f"–ü–æ–º–∏–ª–∫–∞: {e}")
                self.set_status("‚ùå –ü–æ–º–∏–ª–∫–∞ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è", "error")

        thread = threading.Thread(target=anydesk_task, daemon=True)
        thread.start()

    def run_network_test(self):
        """–ó–∞–ø—É—Å—Ç–∏—Ç–∏ —Ç–µ—Å—Ç –º–µ—Ä–µ–∂—ñ"""
        self.set_status("‚è≥ –¢–µ—Å—Ç –º–µ—Ä–µ–∂—ñ...", "processing")

        def test_task():
            try:
                result = self.network_test.run_full_test()
                self.set_status(f"{result['status']}", result['color'])
            except Exception as e:
                logger.error(f"–ü–æ–º–∏–ª–∫–∞ —Ç–µ—Å—Ç—É: {e}")
                self.set_status("‚ùå –ü–æ–º–∏–ª–∫–∞ —Ç–µ—Å—Ç—É", "error")

        thread = threading.Thread(target=test_task, daemon=True)
        thread.start()

    def set_status(self, text, status_type="info"):
        """–í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ —Å—Ç–∞—Ç—É—Å –∑ –∫–æ–ª—å–æ—Ä–æ–º"""
        color_map = {
            "success": "green",
            "error": "red",
            "processing": "blue",
            "info": "gray"
        }
        self.status_label.configure(text=text, text_color=color_map.get(status_type, "gray"))


def main():
    """–ì–æ–ª–æ–≤–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è"""
    logger.info("–ó–∞–ø—É—Å–∫ RemoteHand...")
    app = RemoteHandApp()
    app.mainloop()


if __name__ == "__main__":
    main()


================================================================================
–§–∞–π–ª 11/21: src\network_test.py
--------------------------------------------------------------------------------
import subprocess
import re
import socket
import logging
from pathlib import Path
import tempfile

logger = logging.getLogger(__name__)


class NetworkTest:
    """–¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è –º–µ—Ä–µ–∂—ñ –∑ –∑–≤—ñ—Ç–æ–º"""

    def __init__(self, config_manager, telegram_api):
        self.config = config_manager
        self.telegram = telegram_api

    def run_ping_test(self, host, count=20):
        """–í–∏–∫–æ–Ω–∞—Ç–∏ ping —Ç–µ—Å—Ç –Ω–∞ —Ö–æ—Å—Ç—É"""
        try:
            result = subprocess.run(
                ['ping', host, '-n', str(count)],
                capture_output=True,
                text=True,
                encoding='cp1252',
                timeout=60,
                creationflags=subprocess.CREATE_NO_WINDOW
            )
            return result.stdout
        except Exception as e:
            logger.error(f"–ü–æ–º–∏–ª–∫–∞ ping: {e}")
            return f"–ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—ñ {host}: {str(e)}"

    def parse_ping_loss(self, ping_output):
        """–í–∏—Ç—è–≥—Ç–∏ –≤—ñ–¥—Å–æ—Ç–æ–∫ –≤—Ç—Ä–∞—Ç–∏ –ø–∞–∫–µ—Ç—ñ–≤"""
        try:
            match = re.search(r'(\d+)%\s+(–ø–æ—Ç–µ—Ä—å|loss)', ping_output, re.IGNORECASE)
            if match:
                return int(match.group(1))
            return 0
        except:
            return -1

    def run_full_test(self):
        """–ó–∞–ø—É—Å—Ç–∏—Ç–∏ –ø–æ–≤–Ω–∏–π —Ç–µ—Å—Ç –º–µ—Ä–µ–∂—ñ"""
        pc_name = socket.gethostname()
        store_location = self.config.store_location_text

        hosts = {
            "1–° –°–µ—Ä–≤–µ—Ä": "23.88.7.196",
            "Google DNS": "8.8.8.8"
        }

        report_parts = []
        total_loss = 0

        for name, ip in hosts.items():
            ping_output = self.run_ping_test(ip)
            loss = self.parse_ping_loss(ping_output)

            if loss >= 0:
                status = "‚úÖ" if loss == 0 else ("‚ö†Ô∏è" if loss <= 15 else "‚ùå")
                report_parts.append(f"{status} {name} ({ip}): {loss}% –≤—Ç—Ä–∞—Ç–∏")
                total_loss += loss
            else:
                report_parts.append(f"‚ùå {name} ({ip}): –ü–æ–º–∏–ª–∫–∞ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è")

        avg_loss = total_loss / len(hosts) if hosts else 0

        if avg_loss == 0:
            status_text = "‚úÖ –ú–µ—Ä–µ–∂–∞ –≤ –Ω–æ—Ä–º—ñ"
            color = "green"
        elif avg_loss <= 15:
            status_text = "‚ö†Ô∏è –Ñ –Ω–µ–≤–µ–ª–∏–∫—ñ –ø—Ä–æ–±–ª–µ–º–∏"
            color = "orange"
        else:
            status_text = "‚ùå –°–µ—Ä–π–æ–∑–Ω—ñ –ø—Ä–æ–±–ª–µ–º–∏"
            color = "red"

        # –í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ –≤ Telegram
        test_report = "\n".join(report_parts)
        self.telegram.send_network_report(store_location, pc_name, test_report)

        return {
            "status": status_text,
            "color": color,
            "details": test_report
        }


================================================================================
–§–∞–π–ª 12/21: src\rdp_manager.py
--------------------------------------------------------------------------------
import os
import subprocess
import time
import winreg
import logging
import keyring
from pathlib import Path

logger = logging.getLogger(__name__)


class RDPManager:
    """–ú–µ–Ω–µ–¥–∂–µ—Ä –¥–ª—è RDP –ø—ñ–¥–∫–ª—é—á–µ–Ω—å –∑ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–º –ª–æ–≥—ñ–Ω–æ–º"""

    def __init__(self, config_manager, telegram_api):
        self.config = config_manager
        self.telegram = telegram_api

    def save_credentials(self, host, username, password):
        """–ó–±–µ—Ä–µ–≥—Ç–∏ RDP –¥–∞–Ω—ñ –≤ Windows Credential Manager"""
        try:
            keyring.set_password(f"RDP_{host}", username, password)
            self.config.set("rdp_password", password)
            logger.info(f"‚úÖ –î–∞–Ω—ñ –∑–±–µ—Ä–µ–∂–µ–Ω—ñ –¥–ª—è {host}")
            return True
        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è: {e}")
            return False

    def get_credentials(self, host, username):
        """–û—Ç—Ä–∏–º–∞—Ç–∏ –ø–∞—Ä–æ–ª—å –∑ Credential Manager"""
        try:
            password = keyring.get_password(f"RDP_{host}", username)
            return password
        except:
            return None

    def connect_rdp(self, host, port, username, password=None):
        """–ü—ñ–¥–∫–ª—é—á–∏—Ç–∏—Å—è –¥–æ RDP"""
        try:
            # –ö–æ–¥—É–≤–∞–Ω–Ω—è –ø–∞—Ä–æ–ª—è –¥–ª—è .RDP —Ñ–∞–π–ª—É
            encrypted_password = self._encrypt_rdp_password(password) if password else ""

            rdp_content = f"""screen mode id:i:2
use multimon:i:0
desktopwidth:i:1920
desktopheight:i:1080
session bpp:i:32
connection type:i:7
disable wallpaper:i:0
allow font smoothing:i:1
allow desktop composition:i:1
disable full window drag:i:0
disable menu anims:i:0
disable themes:i:0
disable cursor setting:i:0
bitmapcachepersistenable:i:1
full address:s:{host}:{port}
audiomode:i:0
redirectprinters:i:0
redirectcomports:i:0
redirectsmartcards:i:0
redirectclipboard:i:1
redirectposdevices:i:0
autoreconnection enabled:i:1
authentication level:i:0
prompt for credentials on client:i:0
negotiate security layer:i:1
enablecredsspsupport:i:1
username:s:{username}
password 51:b:{encrypted_password}
"""

            rdp_file = f"{host}_{username}_session.rdp"
            with open(rdp_file, "w") as f:
                f.write(rdp_content)

            subprocess.Popen(f"mstsc {rdp_file}")
            logger.info(f"‚úÖ RDP –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –∑–∞–ø—É—â–µ–Ω–æ")

            # –í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ –≤ Telegram
#            self.telegram.send_rdp_info(
#                self.config.store_location_text,
#                os.environ.get('COMPUTERNAME', 'Unknown')
#            )

            return True
        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è: {e}")
            return False

    def _encrypt_rdp_password(self, password):
        """–ü—Ä–æ—Å—Ç–æ–µ —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è –ø–∞—Ä–æ–ª—è –¥–ª—è .RDP"""
        encrypted = ""
        for char in password:
            encrypted += format(ord(char) ^ 0xAA, '02x')
        return encrypted


================================================================================
–§–∞–π–ª 13/21: src\set_anydesk_password.py
--------------------------------------------------------------------------------
#!/usr/bin/env python3
"""–í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –ø–∞—Ä–æ–ª—è AnyDesk –∑ –∞–¥–º—ñ–Ω –ø—Ä–∞–≤–∞–º–∏"""

import subprocess
import sys
import os
import time
import ctypes

ANYDESK_PATH = sys.argv[1] if len(sys.argv) > 1 else None
PASSWORD = os.getenv("ANYDESK_PASSWORD", "r3moteh4nd")

if not ANYDESK_PATH or not os.path.exists(ANYDESK_PATH):
    print("[!] AnyDesk –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ")
    sys.exit(1)

# –ü–µ—Ä–µ–≤—ñ—Ä–∏–º–æ —á–∏ –∑–∞–ø—É—â–µ–Ω–æ –∑ –∞–¥–º—ñ–Ω –ø—Ä–∞–≤–∞–º–∏
try:
    is_admin = ctypes.windll.shell32.IsUserAnAdmin()
    if not is_admin:
        print("[!] –ü–æ—Ç—Ä—ñ–±–Ω—ñ –∞–¥–º—ñ–Ω –ø—Ä–∞–≤–∞")
        # –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–∏ –∑ –∞–¥–º—ñ–Ω –ø—Ä–∞–≤–∞–º–∏
        ctypes.windll.shell32.ShellExecuteW(
            None,
            "runas",
            sys.executable,
            f'"{__file__}" "{ANYDESK_PATH}"',
            None,
            1  # SW_SHOW
        )
        sys.exit(0)
except:
    pass

try:
    print(f"[*] –í—Å—Ç–∞–Ω–æ–≤–ª—é—é –ø–∞—Ä–æ–ª—å AnyDesk (—É –∞–¥–º—ñ–Ω—ñ)...")
    time.sleep(1)

    # –í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ —á–µ—Ä–µ–∑ stdin
    cmd = [ANYDESK_PATH, "--set-password", "_full_access"]

    result = subprocess.run(
        cmd,
        input=PASSWORD + "\n",
        capture_output=True,
        text=True,
        timeout=10
    )

    print(f"[CODE] {result.returncode}")
    if result.returncode in [0, 8000]:
        print("[‚úì] –ü–∞—Ä–æ–ª—å –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ!")
    else:
        print(f"[!] –ö–æ–¥: {result.returncode}")

    sys.exit(0)

except Exception as e:
    print(f"[!] –ü–æ–º–∏–ª–∫–∞: {e}")
    sys.exit(1)


================================================================================
–§–∞–π–ª 14/21: src\setup_wizard.py
--------------------------------------------------------------------------------
import customtkinter as ctk
import tkinter.messagebox as messagebox


class SetupWizard(ctk.CTkToplevel):
    def __init__(self, parent, on_complete):
        super().__init__(parent)

        self.title("RemoteHand - –ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞")
        self.geometry("450x500")
        self.resizable(False, False)

        # –¶–µ–Ω—Ç—Ä—É–≤–∞—Ç–∏ –Ω–∞ –µ–∫—Ä–∞–Ω—ñ
        self.transient(parent)
        self.grab_set()

        # ‚ö†Ô∏è –ó–ê–ë–û–†–û–ù–ò–¢–ò –ó–ê–ö–†–ò–¢–¢–Ø –ë–ï–ó –ó–ë–ï–†–ï–ñ–ï–ù–ù–Ø
        self.protocol("WM_DELETE_WINDOW", self.on_closing)

        self.on_complete = on_complete
        self.setup_complete = False

        # –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç–µ–º–∏
        ctk.set_appearance_mode("light")
        ctk.set_default_color_theme("blue")

        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        title = ctk.CTkLabel(
            self,
            text="–ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞",
            font=ctk.CTkFont(size=18, weight="bold")
        )
        title.pack(pady=20)

        # ===== –ú–ê–ì–ê–ó–ò–ù (–í–´–ë–Ü–†) =====
        ctk.CTkLabel(
            self,
            text="–í–∏–±–µ—Ä—ñ—Ç—å –º–∞–≥–∞–∑–∏–Ω:",
            font=ctk.CTkFont(size=12, weight="bold")
        ).pack(anchor="w", padx=20, pady=(10, 5))

        self.store_var = ctk.StringVar(value="")
        store_options = [
            "0 / –û—Ñ—ñ—Å",
            "1 / –î—ñ–∞–ª–æ–≥",
            "5 / –ü–æ–ª—Ç–∞–≤–∞",
            "7 / –û–∞–∑–∏—Å",
            "8 / –•–º–µ–ª—å–Ω–∏—Ü—å–∫–∏–π",
            "9 / –ß–µ—Ä–Ω—ñ–≤—Ü—ñ",
            "17 / –ö—Ä–µ–º–µ–Ω—á—É–∫",
            "18 / –ü_–ö–æ—Ç–ª—è—Ä–µ–≤—Å—å–∫–æ–≥–æ",
            "20 / –©–∞—Å–ª–∏–≤–∏–π",
            "21 / –°–æ—Ñ—ñ—è –º–æ–ª–ª"
        ]

        self.store_menu = ctk.CTkComboBox(
            self,
            values=store_options,
            variable=self.store_var,
            font=ctk.CTkFont(size=11),
            height=35
        )
        self.store_menu.pack(padx=20, fill="x", pady=(0, 20))

        # ===== –õ–û–ö–ê–¶–Ü–Ø (–í–´–ë–Ü–†) =====
        ctk.CTkLabel(
            self,
            text="–í–∏–±–µ—Ä—ñ—Ç—å –ª–æ–∫–∞—Ü—ñ—é:",
            font=ctk.CTkFont(size=12, weight="bold")
        ).pack(anchor="w", padx=20, pady=(10, 5))

        self.location_var = ctk.StringVar(value="")
        location_options = [
            "–∫–∞—Å–∞",
            "–∫–∞—Å–∞ 2",
            "–ø—ñ–¥—Å–æ–±–∫–∞",
            "–æ—Å–æ–±–∏—Å—Ç–∏–π"
        ]

        self.location_menu = ctk.CTkComboBox(
            self,
            values=location_options,
            variable=self.location_var,
            font=ctk.CTkFont(size=11),
            height=35
        )
        self.location_menu.pack(padx=20, fill="x", pady=(0, 20))

        # ===== –ü–Ü–ë (–û–ü–¶–Ü–ô–ù–û) =====
        ctk.CTkLabel(
            self,
            text="–ü–Ü–ë –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ (–æ–ø—Ü—ñ–π–Ω–æ):",
            font=ctk.CTkFont(size=12, weight="bold")
        ).pack(anchor="w", padx=20, pady=(10, 5))

        self.user_name_entry = ctk.CTkEntry(
            self,
            placeholder_text="–ù–∞–ø—Ä–∏–∫–ª–∞–¥: –Ü–≤–∞–Ω –ü–µ—Ç—Ä–µ–Ω–∫–æ",
            height=35,
            font=ctk.CTkFont(size=11)
        )
        self.user_name_entry.pack(padx=20, fill="x", pady=(0, 30))

        # –ö–Ω–æ–ø–∫–∞
        btn = ctk.CTkButton(
            self,
            text="‚úÖ –ó–±–µ—Ä–µ–≥—Ç–∏",
            command=self.save_settings,
            height=45,
            font=ctk.CTkFont(size=12, weight="bold"),
            corner_radius=10
        )
        btn.pack(padx=20, fill="x", pady=10)

    def on_closing(self):
        """–ó–∞–±–æ—Ä–æ–Ω–∏—Ç–∏ –∑–∞–∫—Ä–∏—Ç—Ç—è –±–µ–∑ –≤–≤–µ–¥–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö"""
        if not self.setup_complete:
            messagebox.showwarning(
                "–ü–æ–º–∏–ª–∫–∞",
                "–í–∏–±–µ—Ä—ñ—Ç—å –º–∞–≥–∞–∑–∏–Ω —ñ –ª–æ–∫–∞—Ü—ñ—é –ø–µ—Ä–µ–¥ –∑–∞–∫—Ä–∏—Ç—Ç—è–º!"
            )
            return
        self.destroy()

    def save_settings(self):
        """–ó–±–µ—Ä–µ–≥—Ç–∏ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è - –æ–±–æ–≤'—è–∑–∫–æ–≤–æ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏"""
        store = self.store_var.get().strip()
        location = self.location_var.get().strip()
        user_name = self.user_name_entry.get().strip()

        # ‚ö†Ô∏è –û–ë–û–í'–Ø–ó–ö–û–í–ê –ü–ï–†–ï–í–Ü–†–ö–ê
        if not store:
            messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–í–∏–±–µ—Ä—ñ—Ç—å –º–∞–≥–∞–∑–∏–Ω!")
            return

        if not location:
            messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–í–∏–±–µ—Ä—ñ—Ç—å –ª–æ–∫–∞—Ü—ñ—é!")
            return

        # –í—Å–µ –æ–∫ - –∑–±–µ—Ä–µ–∂–µ–º–æ
        self.setup_complete = True
        self.on_complete({
            "store": store,
            "location": location,
            "user_name": user_name
        })
        self.destroy()


================================================================================
–§–∞–π–ª 15/21: src\telegram_api.py
--------------------------------------------------------------------------------
import requests
import logging
import time
import os
from pathlib import Path

logger = logging.getLogger(__name__)


class TelegramAPI:
    """–†–æ–∑—à–∏—Ä–µ–Ω–∞ Telegram API –¥–ª—è –∑–≤—ñ—Ç—É–≤–∞–Ω–Ω—è"""

    def __init__(self, token, chat_id):
        self.token = token
        self.chat_id = chat_id

        # ‚ö†Ô∏è –ü–ï–†–ï–í–Ü–†–ê –¢–û–ö–ï–ù–Ü–í
        if not token:
            logger.error("‚ùå Telegram —Ç–æ–∫–µ–Ω –Ω–µ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ!")
            self.api_url = None
        elif not chat_id:
            logger.error("‚ùå Telegram chat_id –Ω–µ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ!")
            self.api_url = None
        else:
            self.api_url = f"https://api.telegram.org/bot{token}"
            logger.info(f"‚úÖ Telegram –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–æ (—Ç–æ–∫–µ–Ω: {token[:20]}...)")

    def send_message(self, text, parse_mode="HTML"):
        """–í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ —Ç–µ–∫—Å—Ç–æ–≤–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è"""
        if not self.api_url:
            logger.error("‚ùå Telegram –Ω–µ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–æ")
            return False

        try:
            payload = {
                "chat_id": self.chat_id,
                "text": text,
                "parse_mode": parse_mode
            }
            response = requests.post(
                f"{self.api_url}/sendMessage",
                json=payload,
                timeout=10
            )
            response.raise_for_status()
            logger.info("‚úÖ –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –Ω–∞–¥—ñ—Å–ª–∞–Ω–æ –≤ Telegram")
            return True
        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞ –≤—ñ–¥–ø—Ä–∞–≤–∫–∏ Telegram: {e}")
            return False

    def send_file(self, file_path, caption="", file_type="document"):
        """–í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ —Ñ–∞–π–ª (document –∞–±–æ photo)"""
        if not self.api_url:
            logger.error("‚ùå Telegram –Ω–µ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–æ")
            return False

        try:
            with open(file_path, 'rb') as f:
                files = {file_type: f}
                payload = {
                    "chat_id": self.chat_id,
                    "caption": caption,
                    "parse_mode": "HTML"
                }
                endpoint = "sendDocument" if file_type == "document" else "sendPhoto"
                response = requests.post(
                    f"{self.api_url}/{endpoint}",
                    files=files,
                    data=payload,
                    timeout=30
                )
                response.raise_for_status()
            logger.info(f"‚úÖ –§–∞–π–ª –Ω–∞–¥—ñ—Å–ª–∞–Ω–æ –≤ Telegram")
            return True
        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞ –≤—ñ–¥–ø—Ä–∞–≤–∫–∏ —Ñ–∞–π–ª—É: {e}")
            return False

    def send_network_report(self, store_location, pc_name, test_results):
        """–í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ –∑–≤—ñ—Ç –ø—Ä–æ —Å—Ç–∞–Ω –º–µ—Ä–µ–∂—ñ"""
        report = (
            f"<b>üìä –ó–≤—ñ—Ç –ø—Ä–æ —Å—Ç–∞–Ω –º–µ—Ä–µ–∂—ñ</b>\n\n"
            f"<b>–ú–∞–≥–∞–∑–∏–Ω/–õ–æ–∫–∞—Ü—ñ—è:</b> {store_location}\n"
            f"<b>–ü–ö:</b> <code>{pc_name}</code>\n"
            f"<b>–ß–∞—Å:</b> {time.strftime('%Y-%m-%d %H:%M:%S')}\n\n"
            f"<b>–†–µ–∑—É–ª—å—Ç–∞—Ç–∏:</b>\n"
            f"{test_results}"
        )
        return self.send_message(report)

    def send_anydesk_info(self, store_location, user_name, pc_name, anydesk_id, password):
        """–í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ AnyDesk —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é"""

        # –î–æ–¥–∞—Ç–∏ –ü–Ü–ë —è–∫—â–æ —î
        user_info = f"\n<b>üë§ –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á:</b> {user_name}" if user_name else ""

        message = (
            f"<b>üåê AnyDesk - –ó–∞–ø—Ä–æ—Å –Ω–∞ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è</b>\n\n"
            f"<b>üìç –ú–∞–≥–∞–∑–∏–Ω/–õ–æ–∫–∞—Ü—ñ—è:</b> {store_location}{user_info}\n"
            f"<b>üíª –ü–ö:</b> <code>{pc_name}</code>\n\n"
            f"<b>üÜî ID:</b> <code>{anydesk_id}</code>\n"
            f"<b>üîê –ü–∞—Ä–æ–ª—å:</b> <code>{password}</code>"
        )
        return self.send_message(message)

    def send_rdp_info(self, store_location, pc_name):
        """–í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è –ø—Ä–æ RDP –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è"""
        message = (
            f"<b>üñ•Ô∏è RDP –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è</b>\n\n"
            f"<b>–ú–∞–≥–∞–∑–∏–Ω/–õ–æ–∫–∞—Ü—ñ—è:</b> {store_location}\n"
            f"<b>–ü–ö:</b> <code>{pc_name}</code>\n"
            f"<b>–ß–∞—Å:</b> {time.strftime('%Y-%m-%d %H:%M:%S')}\n\n"
            f"‚úÖ –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –ø—ñ–¥–∫–ª—é—á–∏–≤—Å—è –¥–æ 1–°"
        )
        return self.send_message(message)

    def send_error_report(self, store_location, pc_name, error_text):
        """–í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ –∑–≤—ñ—Ç –ø—Ä–æ –ø–æ–º–∏–ª–∫—É"""
        message = (
            f"<b>‚ùå –ü–æ–º–∏–ª–∫–∞</b>\n\n"
            f"<b>–ú–∞–≥–∞–∑–∏–Ω/–õ–æ–∫–∞—Ü—ñ—è:</b> {store_location}\n"
            f"<b>–ü–ö:</b> <code>{pc_name}</code>\n"
            f"<b>–ß–∞—Å:</b> {time.strftime('%Y-%m-%d %H:%M:%S')}\n\n"
            f"<b>–î–µ—Ç–∞–ª—ñ:</b>\n<code>{error_text}</code>"
        )
        return self.send_message(message)


================================================================================
–§–∞–π–ª 16/21: src\telegram_helper.py
--------------------------------------------------------------------------------
import asyncio
import json
import logging
from telegram import Bot

logger = logging.getLogger(__name__)


class TelegramHelper:
    """–î–æ–ø–æ–º—ñ–∂–Ω–∏–∫ –¥–ª—è –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å –≤ Telegram"""

    def __init__(self, config_path="bot_config.json"):
        self.config_path = config_path
        self.config = self.load_config()

    def load_config(self):
        """–ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –∫–æ–Ω—Ñ—ñ–≥"""
        try:
            with open(self.config_path, "r", encoding="utf-8") as f:
                return json.load(f)
        except:
            return {}

    async def send_anydesk_code(self, anydesk_id, password):
        """–í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ AnyDesk –¥–∞–Ω—ñ –≤ Telegram"""
        try:
            token = self.config.get("TELEGRAM_TOKEN")
            chat_id = self.config.get("CHAT_ID")

            if not token or not chat_id:
                logger.error("‚ùå –ù–µ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ñ TELEGRAM_TOKEN –∞–±–æ CHAT_ID")
                return False

            bot = Bot(token=token)

            message = (
                f"üñ•Ô∏è **AnyDesk —Å–µ—Å—ñ—è –∞–∫—Ç–∏–≤–æ–≤–∞–Ω–∞**\n\n"
                f"üÜî ID: `{anydesk_id}`\n"
                f"üîê –ü–∞—Ä–æ–ª—å: `{password}`\n\n"
                f"–î–ª—è –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ —Ü—ñ –¥–∞–Ω—ñ."
            )

            await bot.send_message(
                chat_id=chat_id,
                text=message,
                parse_mode="Markdown"
            )

            logger.info("‚úÖ –î–∞–Ω—ñ –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω—ñ –≤ Telegram")
            return True

        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞ –≤—ñ–¥–ø—Ä–∞–≤–∫–∏: {e}")
            return False

    async def send_message(self, text):
        """–í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ –¥–æ–≤—ñ–ª—å–Ω–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è"""
        try:
            token = self.config.get("TELEGRAM_TOKEN")
            chat_id = self.config.get("CHAT_ID")

            if not token or not chat_id:
                return False

            bot = Bot(token=token)
            await bot.send_message(chat_id=chat_id, text=text)

            return True

        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞: {e}")
            return False

    def send_anydesk_code_sync(self, anydesk_id, password):
        """–°–∏–Ω—Ö—Ä–æ–Ω–Ω–∞ –≤–µ—Ä—Å—ñ—è (–¥–ª—è GUI)"""
        try:
            loop = asyncio.new_event_loop()
            asyncio.set_event_loop(loop)
            result = loop.run_until_complete(
                self.send_anydesk_code(anydesk_id, password)
            )
            loop.close()
            return result
        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞: {e}")
            return False


================================================================================
–§–∞–π–ª 17/21: src\updater.py
--------------------------------------------------------------------------------
import os
import sys
import requests
import subprocess
import time
import logging
from pathlib import Path

logger = logging.getLogger(__name__)


class UpdaterManager:
    """–ú–µ–Ω–µ–¥–∂–µ—Ä –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ —Ç–∞ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –æ–Ω–æ–≤–ª–µ–Ω—å"""

    GITHUB_REPO = "ShevchukVI/RemoteHand"
    GITHUB_API_URL = f"https://api.github.com/repos/{GITHUB_REPO}/releases/latest"

    def __init__(self):
        self.app_dir = Path(__file__).parent.parent
        self.version_file = self.app_dir / "version.txt"
        self.current_version = self.get_current_version()

    def get_current_version(self):
        """–û—Ç—Ä–∏–º–∞—Ç–∏ –ø–æ—Ç–æ—á–Ω—É –≤–µ—Ä—Å—ñ—é"""
        if self.version_file.exists():
            try:
                with open(self.version_file, 'r', encoding='utf-8') as f:
                    return f.read().strip()
            except:
                pass
        return "1.0.0"

    def get_latest_version(self):
        """–û—Ç—Ä–∏–º–∞—Ç–∏ –Ω–∞–π–Ω–æ–≤—ñ—à—É –≤–µ—Ä—Å—ñ—é –∑ GitHub"""
        try:
            response = requests.get(self.GITHUB_API_URL, timeout=10)
            response.raise_for_status()
            data = response.json()
            tag = data.get('tag_name', 'v1.0.0')
            return tag.lstrip('v')
        except Exception as e:
            logger.warning(f"–ù–µ –≤–¥–∞–ª–æ—Å—è –æ—Ç—Ä–∏–º–∞—Ç–∏ –≤–µ—Ä—Å—ñ—é –∑ GitHub: {e}")
            return None

    def compare_versions(self, current, latest):
        """–ü–æ—Ä—ñ–≤–Ω—è—Ç–∏ –≤–µ—Ä—Å—ñ—ó"""
        try:
            current_parts = [int(x) for x in current.split('.')]
            latest_parts = [int(x) for x in latest.split('.')]
            return latest_parts > current_parts
        except:
            return False

    def download_and_update(self, latest_version):
        """–ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —Ç–∞ –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –Ω–æ–≤—É –≤–µ—Ä—Å—ñ—é"""
        try:
            logger.info(f"üì• –ó–∞–≤–∞–Ω—Ç–∞–∂—É—é RemoteHand v{latest_version}...")

            download_url = f"https://github.com/{self.GITHUB_REPO}/releases/download/v{latest_version}/RemoteHand.exe"

            # –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –Ω–æ–≤—É –≤–µ—Ä—Å—ñ—é
            response = requests.get(download_url, timeout=30)
            response.raise_for_status()

            # –í–∏–∑–Ω–∞—á–∏—Ç–∏ —à–ª—è—Ö –¥–ª—è –Ω–æ–≤–æ—ó –≤–µ—Ä—Å—ñ—ó
            if getattr(sys, 'frozen', False):
                # –Ø–∫—â–æ –∑–∞–ø—É—â–µ–Ω–æ —è–∫ EXE
                current_exe = Path(sys.executable)
                new_exe = current_exe.parent / "RemoteHand_new.exe"
            else:
                # –Ø–∫—â–æ –∑–∞–ø—É—â–µ–Ω–æ —è–∫ Python —Å–∫—Ä–∏–ø—Ç (DEV)
                new_exe = Path.cwd() / "RemoteHand_new.exe"

            # –ó–±–µ—Ä–µ–≥—Ç–∏ –Ω–æ–≤—É –≤–µ—Ä—Å—ñ—é
            with open(new_exe, 'wb') as f:
                f.write(response.content)

            logger.info(f"‚úÖ RemoteHand v{latest_version} –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ")
            return str(new_exe)

        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è: {e}")
            return None

    def check_and_update(self):
        """–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —Ç–∞ –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è"""
        # –ù–ï –æ–Ω–æ–≤–ª—é–≤–∞—Ç–∏ –≤ DEV —Ä–µ–∂–∏–º—ñ!
        if os.getenv('REMOTEHAND_DEV_MODE') == '1':
            logger.info("üîß DEV —Ä–µ–∂–∏–º - –ø—Ä–æ–ø—É—Å–∫–∞—î–º–æ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è")
            return False

        logger.info("üîç –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –æ–Ω–æ–≤–ª–µ–Ω—å...")

        latest_version = self.get_latest_version()
        if not latest_version:
            logger.info("‚ö†Ô∏è –ù–µ –≤–¥–∞–ª–æ—Å—è –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è")
            return False

        if self.compare_versions(self.current_version, latest_version):
            logger.info(f"üì¶ –î–æ—Å—Ç—É–ø–Ω–µ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è: {latest_version}")
            logger.info(f"üìå –ü–æ—Ç–æ—á–Ω–∞ –≤–µ—Ä—Å—ñ—è: {self.current_version}")

            # –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –Ω–æ–≤—É –≤–µ—Ä—Å—ñ—é
            new_exe = self.download_and_update(latest_version)

            if new_exe and os.path.exists(new_exe):
                logger.info(f"‚úÖ –ù–æ–≤–∞ –≤–µ—Ä—Å—ñ—è –≥–æ—Ç–æ–≤–∞!")
                logger.info(f"üîÑ –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫...")

                # ‚ö†Ô∏è –ê–í–¢–û–ú–ê–¢–ò–ß–ù–ò–ô –ü–ï–†–ï–ó–ê–ü–£–°–ö
                try:
                    # –ó–∞–ø—É—Å—Ç–∏—Ç–∏ –Ω–æ–≤—É –≤–µ—Ä—Å—ñ—é
                    subprocess.Popen([new_exe], shell=False)

                    # –ß–µ–∫–∞—Ç–∏ 1 —Å–µ–∫—É–Ω–¥—É
                    time.sleep(1)

                    # –ó–∞–∫—Ä–∏—Ç–∏ –ø–æ—Ç–æ—á–Ω—É –≤–µ—Ä—Å—ñ—é
                    logger.info("üëã –ó–∞–≤–µ—Ä—à–µ–Ω–Ω—è —Ä–æ–±–æ—Ç–∏ —Å—Ç–∞—Ä–æ—ó –≤–µ—Ä—Å—ñ—ó")
                    sys.exit(0)

                except Exception as e:
                    logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫—É: {e}")
                    logger.info(f"–ó–∞–ø—É—Å—Ç—ñ—Ç—å –≤—Ä—É—á–Ω—É: {new_exe}")
                    return False

                return True

        logger.info(f"‚úÖ –í–µ—Ä—Å—ñ—è –∞–∫—Ç—É–∞–ª—å–Ω–∞: {self.current_version}")
        return False


def check_and_update():
    """–§—É–Ω–∫—Ü—ñ—è –¥–ª—è —ñ–º–ø–æ—Ä—Ç—É –≤ main.py"""
    updater = UpdaterManager()
    return updater.check_and_update()


================================================================================
–§–∞–π–ª 18/21: src\utils.py
--------------------------------------------------------------------------------
import os
import sys
import subprocess
import psutil
from pathlib import Path
from config import LOCK_FILE, APP_NAME


class SingleInstance:
    """–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –Ω–∞ —î–¥–∏–Ω–∏–π –µ–∫–∑–µ–º–ø–ª—è—Ä –ø—Ä–æ–≥—Ä–∞–º–∏"""

    def __init__(self):
        self.lock_file = LOCK_FILE
        self.fp = None

    def is_running(self):
        """–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —á–∏ –ø—Ä–æ–≥—Ä–∞–º–∞ –≤–∂–µ –∑–∞–ø—É—â–µ–Ω–∞"""
        if sys.platform == 'win32':
            import win32event
            import win32api
            import winerror

            self.mutex = win32event.CreateMutex(None, False, APP_NAME)
            if win32api.GetLastError() == winerror.ERROR_ALREADY_EXISTS:
                return True
        else:
            try:
                self.fp = open(self.lock_file, 'w')
                import fcntl
                fcntl.flock(self.fp, fcntl.LOCK_EX | fcntl.LOCK_NB)
            except IOError:
                return True
        return False


def open_rdp_connection(host, port):
    """–í—ñ–¥–∫—Ä–∏—Ç—Ç—è RDP –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è"""
    rdp_command = f'mstsc /v:{host}:{port}'
    subprocess.Popen(rdp_command, shell=True)


def close_all_rdp_sessions():
    """–ó–∞–∫—Ä–∏—Ç—Ç—è –≤—Å—ñ—Ö RDP —Å–µ—Å—ñ–π"""
    for proc in psutil.process_iter(['name']):
        try:
            if proc.info['name'].lower() == 'mstsc.exe':
                proc.kill()
        except (psutil.NoSuchProcess, psutil.AccessDenied):
            pass


def test_connection(host):
    """–¢–µ—Å—Ç –∑'—î–¥–Ω–∞–Ω–Ω—è —á–µ—Ä–µ–∑ ping"""
    param = '-n' if sys.platform == 'win32' else '-c'
    command = ['ping', param, '1', host]
    result = subprocess.run(command, capture_output=True, text=True)
    return result.returncode == 0

================================================================================
–§–∞–π–ª 19/21: version.txt
--------------------------------------------------------------------------------
—è—é1 . 0 . 4 
 
 

================================================================================
–§–∞–π–ª 20/21: version_info.txt
--------------------------------------------------------------------------------
VSVersionInfo(
  ffi=FixedFileInfo(mask=0x3f,
    mask_values=[(0, 63), (0, 63), (0, 63), (0, 63)],
    CV_VSVersionInfo=[(0, '0'), (0, '3'), (0, '0'), (0, '0')]),
  StringFileInfo([(u'040904B0',
    StringTable(u'040904B0',
      [StringEntry(u'CompanyName', u'RemoteHand'),
       StringEntry(u'FileDescription', u'RemoteHand - RDP & AnyDesk Manager'),
       StringEntry(u'FileVersion', u'1.0.3.0'),
       StringEntry(u'ProductName', u'RemoteHand'),
       StringEntry(u'ProductVersion', u'1.0.3')]))]),
  VarFileInfo([VarEntry(u'Translation', [1033, 1200])])
)


================================================================================
–§–∞–π–ª 21/21: –ê–∫—Ç–∏–≤–∞—Ü—ñ—è —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞.txt
--------------------------------------------------------------------------------
.venvScriptsActivate.ps1

================================================================================
–ö–Ü–ù–ï–¶–¨ –ï–ö–°–ü–û–†–¢–£
================================================================================


================================================================================
–§–∞–π–ª 6/20: README.md
--------------------------------------------------------------------------------


================================================================================
–§–∞–π–ª 7/20: requirements.txt
--------------------------------------------------------------------------------
customtkinter==5.2.1
requests==2.31.0
psutil==5.9.6
keyring==24.1.0
python-telegram-bot==20.3
packaging>=24.0
pywin32>=300
python-dotenv

================================================================================
–§–∞–π–ª 8/20: src\anydesk_manager.py
--------------------------------------------------------------------------------
import os
import sys
import subprocess
import time
import logging
import psutil
import platform
import ctypes
import socket
from pathlib import Path
from typing import Optional, Tuple

logger = logging.getLogger(__name__)

UNATTENDED_PASSWORD = "r3moteh4nd"


class AnyDeskManager:
    """–ú–µ–Ω–µ–¥–∂–µ—Ä –¥–ª—è AnyDesk"""

    def __init__(self, config_manager, telegram_api):
        self.config = config_manager
        self.telegram = telegram_api
        self.anydesk_path = self.find_anydesk()
        self._is_running = False
        self.connection_id = None

    def find_anydesk(self) -> Optional[str]:
        """–ó–Ω–∞–π—Ç–∏ AnyDesk"""
        possible_paths = [
            r"C:\Program Files\AnyDesk\AnyDesk.exe",
            r"C:\Program Files (x86)\AnyDesk\AnyDesk.exe",
            os.path.expanduser("~\\AppData\\Local\\AnyDesk\\AnyDesk.exe"),
            os.path.expanduser("~\\AppData\\Roaming\\AnyDesk\\AnyDesk.exe"),
            os.path.expanduser("~\\Downloads\\AnyDesk.exe"),
            r"C:\ProgramData\AnyDesk\AnyDesk.exe",
        ]

        for path in possible_paths:
            if os.path.exists(path):
                logger.info(f"‚úÖ AnyDesk –∑–Ω–∞–π–¥–µ–Ω–æ: {path}")
                return path

        logger.warning("‚ö†Ô∏è AnyDesk –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ")
        return None

    def download_anydesk(self) -> bool:
        """–ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ AnyDesk"""
        if self.anydesk_path:
            return True

        logger.info("üì• –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è AnyDesk...")
        try:
            import urllib.request
            downloads_dir = os.path.expanduser("~\\Downloads")
            save_path = os.path.join(downloads_dir, "AnyDesk.exe")
            download_url = "https://download.anydesk.com/AnyDesk.exe"

            if not os.path.exists(save_path):
                logger.info(f"–ó–∞–≤–∞–Ω—Ç–∞–∂—É...")
                urllib.request.urlretrieve(download_url, save_path)

            logger.info("–ó–∞–ø—É—Å–∫ –≤—Å—Ç–∞–Ω–æ–≤–ª—é–≤–∞—á–∞...")
            subprocess.Popen([save_path])

            logger.info("–ß–µ–∫–∞—é –Ω–∞ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è (90 —Å–µ–∫)...")
            for i in range(90):
                time.sleep(1)
                self.anydesk_path = self.find_anydesk()
                if self.anydesk_path:
                    logger.info(f"‚úÖ AnyDesk –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ")
                    time.sleep(3)
                    return True

            return False
        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞: {e}")
            return False

    def check_if_running(self) -> bool:
        """–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —á–∏ AnyDesk –∑–∞–ø—É—â–µ–Ω–æ"""
        try:
            for proc in psutil.process_iter(['pid', 'name']):
                if 'anydesk' in proc.info['name'].lower():
                    logger.info(f"‚ÑπÔ∏è AnyDesk –∑–∞–ø—É—â–µ–Ω–æ (PID: {proc.info['pid']})")
                    self._is_running = True
                    return True
        except:
            pass
        self._is_running = False
        return False

    def launch_anydesk(self) -> bool:
        """–ó–∞–ø—É—Å—Ç–∏—Ç–∏ AnyDesk"""
        if self.check_if_running():
            return True

        if not self.anydesk_path or not Path(self.anydesk_path).exists():
            logger.error("–®–ª—è—Ö –Ω–µ–≤—ñ–¥–æ–º–∏–π")
            return False

        try:
            logger.info(f"üöÄ –ó–∞–ø—É—Å–∫–∞—é AnyDesk...")
            subprocess.Popen(self.anydesk_path)
            time.sleep(5)

            if self.check_if_running():
                logger.info("‚úÖ AnyDesk –∑–∞–ø—É—â–µ–Ω–æ")
                return True
            else:
                self._is_running = True
                return True
        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞: {e}")
            return False

    def set_password_with_admin(self) -> bool:
        """
        –ó–∞–ø—É—Å–∫–∞—î *—Å–∞–º—É —Å–µ–±–µ* –∑ –∞–¥–º—ñ–Ω –ø—Ä–∞–≤–∞–º–∏ –¥–ª—è –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –ø–∞—Ä–æ–ª—è.
        –ö–æ—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–æ–±–ª—è—î DEV-—Ä–µ–∂–∏–º.
        """
        if not self.anydesk_path:
            logger.error("–®–ª—è—Ö AnyDesk –Ω–µ–≤—ñ–¥–æ–º–∏–π, –Ω–µ –º–æ–∂—É –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –ø–∞—Ä–æ–ª—å")
            return False

        try:
            logger.info(f"üîê –ó–∞–ø—É—Å–∫–∞—é –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –ø–∞—Ä–æ–ª—è –∑ –∞–¥–º—ñ–Ω –ø—Ä–∞–≤–∞–º–∏...")

            # –ü–µ—Ä–µ–¥–∞—Ç–∏ –ø–∞—Ä–æ–ª—å —è–∫ –∑–º—ñ–Ω–Ω—É —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞
            env = os.environ.copy()
            env["ANYDESK_PASSWORD"] = UNATTENDED_PASSWORD

            if getattr(sys, 'frozen', False):
                # –†–µ–∂–∏–º EXE: –∑–∞–ø—É—Å–∫–∞—î–º–æ —Å–∞–º .exe
                executable = sys.executable
                arguments = f'--set-anydesk-password "{self.anydesk_path}"'
                logger.info(f"EXE Mode Admin Lauch: {executable} {arguments}")
            else:
                # –†–µ–∂–∏–º DEV: –∑–∞–ø—É—Å–∫–∞—î–º–æ python.exe + [—Å–∫—Ä–∏–ø—Ç] + [–∞—Ä–≥—É–º–µ–Ω—Ç–∏]
                executable = sys.executable  # python.exe
                script_path = os.path.abspath(sys.argv[0])
                arguments = f'"{script_path}" --set-anydesk-password "{self.anydesk_path}"'
                logger.info(f"DEV Mode Admin Lauch: {executable} {arguments}")

            # –ó–∞–ø—É—Å—Ç–∏—Ç–∏ —Å–∫—Ä–∏–ø—Ç –∑ –∞–¥–º—ñ–Ω –ø—Ä–∞–≤–∞–º–∏
            ctypes.windll.shell32.ShellExecuteW(
                None,
                "runas",  # –ó–∞–ø–∏—Ç –∞–¥–º—ñ–Ω –ø—Ä–∞–≤
                executable,  # RemoteHand.exe –∞–±–æ python.exe
                arguments,  # –ê—Ä–≥—É–º–µ–Ω—Ç–∏
                None,
                1  # SW_SHOW - –ø–æ–∫–∞–∑–∞—Ç–∏ –≤—ñ–∫–Ω–æ (UAC)
            )

            logger.info(f"‚úÖ –ó–∞–ø—Ä–æ—Å –∞–¥–º—ñ–Ω –ø—Ä–∞–≤ –Ω–∞–¥—ñ—Å–ª–∞–Ω–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—É")
            return True

        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞ –∑–∞–ø—É—Å–∫—É –∞–¥–º—ñ–Ω-–ø—Ä–æ—Ü–µ—Å—É: {e}")
            import traceback
            traceback.print_exc()
            return False

    def get_connection_id(self) -> Optional[str]:
        """–û—Ç—Ä–∏–º–∞—Ç–∏ ID"""
        if not self.anydesk_path:
            return None

        try:
            logger.info("üìå –û—Ç—Ä–∏–º—É—é ID...")

            result = subprocess.run(
                [self.anydesk_path, '--get-id'],
                capture_output=True,
                text=True,
                timeout=10,
                creationflags=subprocess.CREATE_NO_WINDOW if platform.system() == "Windows" else 0
            )

            if result.returncode == 0:
                connection_id = result.stdout.strip()
                if connection_id and connection_id.isdigit():
                    logger.info(f"‚úÖ ID: {connection_id}")
                    self.connection_id = connection_id
                    return connection_id

        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞: {e}")

        return None

    def start(self, password: str = None) -> Tuple[Optional[str], Optional[str]]:
        """(–û–ù–û–í–õ–ï–ù–û) –ó–∞–ø—É—Å—Ç–∏—Ç–∏ AnyDesk –∑ –æ—á—ñ–∫—É–≤–∞–Ω–Ω—è–º –∞–¥–º—ñ–Ω-–ø—Ä–æ—Ü–µ—Å—É"""
        password = UNATTENDED_PASSWORD

        # –ö—Ä–æ–∫ 1: –Ø–∫—â–æ –≤–∂–µ –∑–∞–ø—É—â–µ–Ω–æ (–Ω—ñ—á–æ–≥–æ –Ω–µ –∑–º—ñ–Ω–∏–ª–æ—Å—å)
        if self.check_if_running():
            logger.info("AnyDesk –≤–∂–µ –∑–∞–ø—É—â–µ–Ω–æ")
            connection_id = self.get_connection_id()
            if connection_id:
                try:
                    user_name = self.config.get("user_name", "")
                    self.telegram.send_anydesk_info(
                        self.config.store_location_text,
                        user_name, socket.gethostname(), connection_id, password
                    )
                except Exception as e:
                    logger.error(f"‚ùå Telegram: {e}")
            return connection_id, password

        # –ö—Ä–æ–∫ 2: –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —è–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ
        if not self.anydesk_path:
            if not self.download_anydesk():
                return None, None

        # –ö—Ä–æ–∫ 3: –ó–∞–ø—É—Å—Ç–∏—Ç–∏
        if not self.launch_anydesk():
            return None, None

        # –ö—Ä–æ–∫ 4: –í–°–¢–ê–ù–û–í–ò–¢–ò –ü–ê–†–û–õ–¨ (–ó –û–ß–Ü–ö–£–í–ê–ù–ù–Ø–ú)
        logger.info("üîê –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –ø–∞—Ä–æ–ª—è...")

        # (–ù–û–í–ï) –®–ª—è—Ö –¥–æ –ø—Ä–∞–ø–æ—Ä—Ü—è —Ç–∞ –æ—á–∏—â–µ–Ω–Ω—è —Å—Ç–∞—Ä–æ–≥–æ, —è–∫—â–æ —î
        flag_file = Path(os.environ.get("TEMP", Path.home())) / ".rh_pass_set_flag"
        if flag_file.exists():
            try:
                os.remove(flag_file)
            except Exception as e:
                logger.warning(f"–ù–µ –≤–¥–∞–ª–æ—Å—è –≤–∏–¥–∞–ª–∏—Ç–∏ —Å—Ç–∞—Ä–∏–π –ø—Ä–∞–ø–æ—Ä–µ—Ü—å: {e}")

        # –ó–∞–ø—É—Å–∫–∞—î–º–æ –∞–¥–º—ñ–Ω-–ø—Ä–æ—Ü–µ—Å
        if not self.set_password_with_admin():
            logger.error("–ù–µ –≤–¥–∞–ª–æ—Å—è –∑–∞–ø—É—Å—Ç–∏—Ç–∏ –∞–¥–º—ñ–Ω-–ø—Ä–æ—Ü–µ—Å.")
            # –ü—Ä–æ–±—É—î–º–æ –ø—Ä–æ–¥–æ–≤–∂–∏—Ç–∏ –±–µ–∑ –ø–∞—Ä–æ–ª—è (—Ö–æ—á–∞ –± ID)
            pass

        # (–ù–û–í–ï) –ß–µ–∫–∞—î–º–æ –Ω–∞ –∞–¥–º—ñ–Ω-–ø—Ä–æ—Ü–µ—Å (–¥–æ 30 —Å–µ–∫)
        logger.info("–ß–µ–∫–∞—é –Ω–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è —Ä–æ–±–æ—Ç–∏ –∞–¥–º—ñ–Ω-–ø—Ä–æ—Ü–µ—Å—É (–¥–æ 30 —Å–µ–∫)...")
        password_set = False
        for i in range(30):
            if flag_file.exists():
                logger.info("‚úÖ –ê–¥–º—ñ–Ω-–ø—Ä–æ—Ü–µ—Å –∑–∞–≤–µ—Ä—à–∏–≤ —Ä–æ–±–æ—Ç—É.")
                try:
                    os.remove(flag_file)
                except:
                    pass
                password_set = True
                break
            time.sleep(1)

        if not password_set:
            logger.warning("‚ö†Ô∏è –ê–¥–º—ñ–Ω-–ø—Ä–æ—Ü–µ—Å –Ω–µ –≤—ñ–¥–ø–æ–≤—ñ–≤ (timeout). –ü—Ä–æ–±—É—é –ø—Ä–æ–¥–æ–≤–∂–∏—Ç–∏...")

        # –ö—Ä–æ–∫ 5: –û—Ç—Ä–∏–º–∞—Ç–∏ ID
        logger.info("üìå –û—Ç—Ä–∏–º–∞–Ω–Ω—è ID...")
        time.sleep(1)  # –î–∞–º–æ AnyDesk —Å–µ–∫—É–Ω–¥—É
        connection_id = self.get_connection_id()

        if not connection_id:
            logger.info("–ü–æ–≤—Ç–æ—Ä–Ω–∞ —Å–ø—Ä–æ–±–∞ –æ—Ç—Ä–∏–º–∞—Ç–∏ ID...")
            time.sleep(3)
            connection_id = self.get_connection_id()

        # –ö—Ä–æ–∫ 6: –ù–∞–¥—ñ—Å–ª–∞—Ç–∏ –≤ Telegram
        try:
            user_name = self.config.get("user_name", "")
            self.telegram.send_anydesk_info(
                self.config.store_location_text,
                user_name,
                socket.gethostname(),
                connection_id if connection_id else "–ù–ï –û–¢–†–ò–ú–ê–ù–û",
                password if password_set else "(–ù–ï –í–°–¢–ê–ù–û–í–õ–ï–ù–û!)"
            )
            logger.info("‚úÖ –¢–µ–ª–µ–≥—Ä–∞–º —Å–ø–æ–≤—ñ—â–µ–Ω–æ")
        except Exception as e:
            logger.error(f"‚ùå –¢–µ–ª–µ–≥—Ä–∞–º –ø–æ–º–∏–ª–∫–∞: {e}")

        logger.info(f"‚úÖ –ì–æ—Ç–æ–≤–æ (ID: {connection_id})")
        return connection_id, password

================================================================================
–§–∞–π–ª 9/20: src\config.py
--------------------------------------------------------------------------------
import os
from pathlib import Path
from dotenv import load_dotenv

# –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ .env
load_dotenv()

APP_NAME = "RemoteHand"
RDP_HOST = "23.88.7.196"
RDP_PORT = 4420
PING_HOST = "23.88.7.196"

# üîí –ó–Ü –ó–ú–Ü–ù–ù–ò–• –°–ï–†–ï–î–û–í–ò–©–ê, –ê –ù–ï –ó .env!
TELEGRAM_TOKEN = os.getenv("TELEGRAM_TOKEN", "")
TELEGRAM_CHAT_ID = os.getenv("TELEGRAM_CHAT_ID", "")

# –§–∞–π–ª–∏
LOCK_FILE = Path.home() / ".remotehand" / "lock"


================================================================================
–§–∞–π–ª 10/20: src\config_manager.py
--------------------------------------------------------------------------------
import json
import os
from pathlib import Path
import logging

logger = logging.getLogger(__name__)


class ConfigManager:
    """–ú–µ–Ω–µ–¥–∂–µ—Ä –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó"""

    def __init__(self):
        self.config_dir = Path.home() / ".remotehand"
        self.config_dir.mkdir(exist_ok=True)
        self.config_file = self.config_dir / "config.json"

        self.config = self.load()

    def load(self):
        """–ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –∫–æ–Ω—Ñ—ñ–≥"""
        if self.config_file.exists():
            try:
                with open(self.config_file, 'r', encoding='utf-8') as f:
                    return json.load(f)
            except:
                pass
        return {}

    def save(self):
        """–ó–±–µ—Ä–µ–≥—Ç–∏ –∫–æ–Ω—Ñ—ñ–≥ –≤ JSON —Ñ–∞–π–ª"""
        try:
            with open(self.config_file, 'w', encoding='utf-8') as f:
                json.dump(self.config, f, ensure_ascii=False, indent=2)
        except Exception as e:
            logger.error(f"–ü–æ–º–∏–ª–∫–∞ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –∫–æ–Ω—Ñ—ñ–≥—É: {e}")

    def set(self, key, value):
        """–í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –∑–Ω–∞—á–µ–Ω–Ω—è"""
        self.config[key] = value
        self.save()

    def get(self, key, default=""):
        """–û—Ç—Ä–∏–º–∞—Ç–∏ –∑–Ω–∞—á–µ–Ω–Ω—è"""
        return self.config.get(key, default)

    def is_first_run(self):
        """–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —á–∏ –ø–µ—Ä—à–∏–π –∑–∞–ø—É—Å–∫"""
        store = self.config.get('store', '')
        location = self.config.get('location', '')
        return not store or not location

    @property
    def store_location_text(self):
        """–û—Ç—Ä–∏–º–∞—Ç–∏ —Ç–µ–∫—Å—Ç –º–∞–≥–∞–∑–∏–Ω—É/–ª–æ–∫–∞—Ü—ñ—ó"""
        store = self.config.get('store', '–ù–µ–≤—ñ–¥–æ–º–æ')
        location = self.config.get('location', '–ù–µ–≤—ñ–¥–æ–º–æ')
        return f"{store} / {location}"


================================================================================
–§–∞–π–ª 11/20: src\main.py
--------------------------------------------------------------------------------
import customtkinter as ctk
from tkinter import messagebox
import sys
import os
import threading
import logging
from pathlib import Path
import ctypes
import subprocess
import time

# –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ .env —Ñ–∞–π–ª
from dotenv import load_dotenv

load_dotenv()

# –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –ª–æ–≥—É–≤–∞–Ω–Ω—è
logging.basicConfig(
    level=logging.INFO,
    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s'
)
logger = logging.getLogger(__name__)

# ============ –ü–ï–†–ï–í–Ü–†–ö–ê DEV –†–ï–ñ–ò–ú–£ ============
DEV_MODE = os.getenv('REMOTEHAND_DEV_MODE') == '1'
logger.info(f"{'üîß DEV –†–ï–ñ–òM' if DEV_MODE else '‚úÖ PRODUCTION –†–ï–ñ–ò–ú'}")

if not DEV_MODE:
    # –¢–Ü–õ–¨–ö–ò –í PRODUCTION
    try:
        from updater import check_and_update

        check_and_update()
    except Exception as e:
        logger.warning(f"–ü–æ–º–∏–ª–∫–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –æ–Ω–æ–≤–ª–µ–Ω—å: {e}")

# ============ –Ü–ú–ü–û–†–¢–ò ============
from utils import close_all_rdp_sessions, test_connection
from config import RDP_HOST, RDP_PORT, PING_HOST, APP_NAME

# –ù–æ–≤—ñ —ñ–º–ø–æ—Ä—Ç–∏
from config_manager import ConfigManager
from telegram_api import TelegramAPI
from setup_wizard import SetupWizard
from network_test import NetworkTest

try:
    from rdp_manager import RDPManager

    rdp_manager_available = True
except ImportError as e:
    rdp_manager_available = False
    logger.warning(f"rdp_manager –Ω–µ –¥–æ—Å—Ç—É–ø–Ω–∞: {e}")

try:
    from anydesk_manager import AnyDeskManager

    anydesk_available = True
except ImportError as e:
    anydesk_available = False
    logger.warning(f"anydesk_manager –Ω–µ –¥–æ—Å—Ç—É–ø–Ω–∞: {e}")

# ============ –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —Å—Ç–∏–ª—é iOS ============
IOS_BG_COLOR = "#f2f2f7"  # –°–≤—ñ—Ç–ª–æ-—Å—ñ—Ä–∏–π —Ñ–æ–Ω
IOS_CARD_COLOR = "#ffffff"  # –ë—ñ–ª—ñ –∫–∞—Ä—Ç–∫–∏
IOS_TEXT_COLOR = "#000000"  # –ß–æ—Ä–Ω–∏–π —Ç–µ–∫—Å—Ç
IOS_SUBTEXT_COLOR = "#8A8A8E"  # –°—ñ—Ä–∏–π –ø—ñ–¥–ø–∏—Å
IOS_CARD_BORDER = "#E0E0E0"  # –õ–µ–¥—å –ø–æ–º—ñ—Ç–Ω–∞ —Ä–∞–º–∫–∞ –∫–∞—Ä—Ç–∫–∏
IOS_CARD_RADIUS = 15
IOS_BUTTON_RADIUS = 12


class RemoteHandApp(ctk.CTk):
    def __init__(self):
        super().__init__()

        # –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –≤—ñ–∫–Ω–∞
        self.title(APP_NAME)
        self.geometry("520x800")
        self.resizable(True, True)

        ctk.set_appearance_mode("light")
        ctk.set_default_color_theme("blue")
        self.configure(fg_color=IOS_BG_COLOR)

        # –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è –º–µ–Ω–µ–¥–∂–µ—Ä—ñ–≤
        self.config = ConfigManager()

        telegram_token = os.getenv("TELEGRAM_TOKEN") or self.config.get("telegram_token")
        telegram_chat_id = os.getenv("TELEGRAM_CHAT_ID") or self.config.get("telegram_chat_id")

        logger.info(f"Telegram token: {'‚úÖ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ' if telegram_token else '‚ùå –ù–ï –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ'}")
        logger.info(f"Telegram chat_id: {'‚úÖ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ' if telegram_chat_id else '‚ùå –ù–ï –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ'}")

        self.telegram = TelegramAPI(telegram_token, telegram_chat_id)

        if rdp_manager_available:
            self.rdp_manager = RDPManager(self.config, self.telegram)
        else:
            self.rdp_manager = None

        if anydesk_available:
            self.anydesk_manager = AnyDeskManager(self.config, self.telegram)
        else:
            self.anydesk_manager = None

        self.network_test = NetworkTest(self.config, self.telegram)

        self.setup_ui()

        if self.config.is_first_run():
            self.show_setup_wizard()

    def get_app_version(self):
        """–û—Ç—Ä–∏–º–∞—Ç–∏ –≤–µ—Ä—Å—ñ—é –ø—Ä–æ–≥—Ä–∞–º–∏ (–∑ –æ–±—Ä–æ–±–∫–æ—é –∫–æ–¥—É–≤–∞–Ω—å)"""
        try:
            if getattr(sys, 'frozen', False):
                # –Ø–∫—â–æ EXE (—Å–∫–æ–º–ø—ñ–ª—å–æ–≤–∞–Ω–æ)
                base_path = Path(sys._MEIPASS)
            else:
                # –Ø–∫—â–æ DEV (–∑–∞–ø—É—Å–∫ –∑ dev_run.py)
                base_path = Path.cwd()  # –ü–æ—Ç–æ—á–Ω–∞ —Ä–æ–±–æ—á–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—è (–∫–æ—Ä—ñ–Ω—å –ø—Ä–æ—î–∫—Ç—É)

            version_file = base_path / "version.txt"

            if not version_file.exists():
                logger.warning(f"–ù–µ –∑–Ω–∞–π–¥–µ–Ω–æ version.txt —É {base_path}")
                base_path = Path(sys.executable).parent
                version_file = base_path / "version.txt"
                if not version_file.exists():
                    logger.warning(f"–ù–µ –∑–Ω–∞–π–¥–µ–Ω–æ version.txt —ñ —É {base_path}")
                    return "1.0.0"  # Fallback

            try:
                # –°–ø—Ä–æ–±—É–≤–∞—Ç–∏ UTF-8-SIG (—Å—Ç–∞–Ω–¥–∞—Ä—Ç –∑ BOM)
                return version_file.read_text(encoding='utf-8-sig').strip()
            except UnicodeDecodeError:
                try:
                    # –Ø–∫—â–æ –Ω–µ –≤–∏–π—à–ª–æ (byte 0xff), —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ UTF-16
                    logger.warning("version.txt –Ω–µ –≤ UTF-8, –ø—Ä–æ–±—É—é UTF-16...")
                    return version_file.read_text(encoding='utf-16').strip()
                except Exception as e_inner:
                    logger.error(f"–ù–µ –≤–¥–∞–ª–æ—Å—è –ø—Ä–æ—á–∏—Ç–∞—Ç–∏ version.txt –Ω—ñ –≤ UTF-8, –Ω—ñ –≤ UTF-16: {e_inner}")
            except Exception as e_outer:
                logger.error(f"–ü–æ–º–∏–ª–∫–∞ —á–∏—Ç–∞–Ω–Ω—è –≤–µ—Ä—Å—ñ—ó: {e_outer}")

        except Exception as e:
            logger.error(f"–ö—Ä–∏—Ç–∏—á–Ω–∞ –ø–æ–º–∏–ª–∫–∞ get_app_version: {e}")

        return "1.0.0"  # –ó–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º

    def show_setup_wizard(self):
        """–ü–æ–∫–∞–∑–∞—Ç–∏ –≤—ñ–∫–Ω–æ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –ø—Ä–∏ –ø–µ—Ä—à–æ–º—É –∑–∞–ø—É—Å–∫—É"""

        def on_setup_complete(result):
            self.config.set("store", result["store"])
            self.config.set("location", result["location"])
            if result.get("user_name"):
                self.config.set("user_name", result["user_name"])
            self.refresh_ui()

        wizard = SetupWizard(self, on_setup_complete)
        self.wait_window(wizard)

    def refresh_ui(self):
        """–û–Ω–æ–≤–∏—Ç–∏ UI –ø—ñ—Å–ª—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è"""
        user_info = self.config.store_location_text
        user_name = self.config.get("user_name", "")
        if user_name:
            user_info += f" | üë§ {user_name}"

        self.info_label.configure(text=f"üìç {user_info}")

    def setup_ui(self):
        """–°—Ç–≤–æ—Ä–µ–Ω–Ω—è UI –≤ —Å—Ç–∏–ª—ñ iOS (–∫–æ–º–ø–∞–∫—Ç–Ω–æ)"""

        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        title_label = ctk.CTkLabel(
            self,
            text="RemoteHand",
            font=ctk.CTkFont(size=28, weight="bold"),
            text_color=IOS_TEXT_COLOR
        )
        title_label.pack(pady=(10, 0), padx=20, anchor="w")

        # –Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ –º–∞–≥–∞–∑–∏–Ω/–ª–æ–∫–∞—Ü—ñ—é + –ü–Ü–ë
        user_info = self.config.store_location_text
        user_name = self.config.get("user_name", "")
        if user_name:
            user_info += f" | üë§ {user_name}"

        self.info_label = ctk.CTkLabel(
            self,
            text=f"üìç {user_info}",
            font=ctk.CTkFont(size=12),
            text_color=IOS_SUBTEXT_COLOR
        )
        self.info_label.pack(pady=(0, 15), padx=20, anchor="w")

        # ==================== RDP –ë–õ–û–ö (–ö–ê–†–¢–ö–ê 1) ====================
        rdp_frame = ctk.CTkFrame(
            self,
            fg_color=IOS_CARD_COLOR,
            corner_radius=IOS_CARD_RADIUS,
            border_width=1,
            border_color=IOS_CARD_BORDER
        )
        rdp_frame.pack(pady=8, padx=20, fill="x")

        ctk.CTkLabel(
            rdp_frame,
            text="–ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ 1–°",
            font=ctk.CTkFont(size=13, weight="bold"),
            text_color=IOS_TEXT_COLOR
        ).pack(anchor="w", pady=(10, 10), padx=15)

        rdp_btn = ctk.CTkButton(
            rdp_frame,
            text="üñ•Ô∏è –í—ñ–¥–∫—Ä–∏—Ç–∏ 1–° (RDP)",
            command=self.open_rdp,
            height=50,
            font=ctk.CTkFont(size=12, weight="bold"),
            corner_radius=IOS_BUTTON_RADIUS,
            fg_color="#007AFF",
            hover_color="#0051D5"
        )
        rdp_btn.pack(fill="x", pady=(0, 15), padx=15)

        # ==================== ANYDESK –ë–õ–û–ö (–ö–ê–†–¢–ö–ê 2) ====================
        if anydesk_available:
            anydesk_frame = ctk.CTkFrame(
                self,
                fg_color=IOS_CARD_COLOR,
                corner_radius=IOS_CARD_RADIUS,
                border_width=1,
                border_color=IOS_CARD_BORDER
            )
            anydesk_frame.pack(pady=8, padx=20, fill="x")

            ctk.CTkLabel(
                anydesk_frame,
                text="–í—ñ–¥–¥–∞–ª–µ–Ω–∏–π –¥–æ—Å—Ç—É–ø",
                font=ctk.CTkFont(size=13, weight="bold"),
                text_color=IOS_TEXT_COLOR
            ).pack(anchor="w", pady=(10, 10), padx=15)

            anydesk_btn = ctk.CTkButton(
                anydesk_frame,
                text="üöÄ –ó–∞–ø—É—Å—Ç–∏—Ç–∏ AnyDesk",
                command=self.start_anydesk,
                height=50,
                font=ctk.CTkFont(size=12, weight="bold"),
                corner_radius=IOS_BUTTON_RADIUS,
                fg_color="#FF6B35",
                hover_color="#CC5529"
            )
            anydesk_btn.pack(fill="x", pady=(0, 15), padx=15)

        # ==================== –î–Ü–ê–ì–ù–û–°–¢–ò–ö–ê (–ö–ê–†–¢–ö–ê 3) ====================
        test_frame = ctk.CTkFrame(
            self,
            fg_color=IOS_CARD_COLOR,
            corner_radius=IOS_CARD_RADIUS,
            border_width=1,
            border_color=IOS_CARD_BORDER
        )
        test_frame.pack(pady=8, padx=20, fill="x")

        ctk.CTkLabel(
            test_frame,
            text="–î—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —Ç–∞ –£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è",
            font=ctk.CTkFont(size=13, weight="bold"),
            text_color=IOS_TEXT_COLOR
        ).pack(anchor="w", pady=(10, 10), padx=15)

        test_btn = ctk.CTkButton(
            test_frame,
            text="üì° –¢–µ—Å—Ç –∑'—î–¥–Ω–∞–Ω–Ω—è",
            command=self.run_network_test,
            height=50,
            font=ctk.CTkFont(size=12, weight="bold"),
            corner_radius=IOS_BUTTON_RADIUS,
            fg_color="#34C759",
            hover_color="#248A3D"
        )
        test_btn.pack(fill="x", pady=(0, 10), padx=15)

        # –†–æ–∑–¥—ñ–ª—é–≤–∞—á
        separator = ctk.CTkFrame(test_frame, height=1, fg_color=IOS_CARD_BORDER)
        separator.pack(fill="x", padx=15, pady=5)

        close_sessions_btn = ctk.CTkButton(
            test_frame,
            text="‚ùå –ó–∞–∫—Ä–∏—Ç–∏ –≤—Å—ñ RDP —Å–µ—Å—ñ—ó",
            command=self.close_sessions_confirm,
            height=45,
            font=ctk.CTkFont(size=12, weight="bold"),
            corner_radius=IOS_BUTTON_RADIUS,
            fg_color="#FF3B30",
            hover_color="#D70015"
        )
        close_sessions_btn.pack(fill="x", pady=(10, 15), padx=15)

        # ==================== –ù–ê–õ–ê–®–¢–£–í–ê–ù–ù–Ø (–ö–ê–†–¢–ö–ê 4) ====================
        settings_frame = ctk.CTkFrame(
            self,
            fg_color=IOS_CARD_COLOR,
            corner_radius=IOS_CARD_RADIUS,
            border_width=1,
            border_color=IOS_CARD_BORDER
        )
        settings_frame.pack(pady=8, padx=20, fill="x")

        settings_btn = ctk.CTkButton(
            settings_frame,
            text="‚öôÔ∏è –ó–º—ñ–Ω–∏—Ç–∏ –º–∞–≥–∞–∑–∏–Ω/–ª–æ–∫–∞—Ü—ñ—é/–ü–Ü–ë",
            command=self.show_setup_wizard,
            height=40,
            font=ctk.CTkFont(size=11),
            corner_radius=IOS_BUTTON_RADIUS,
            fg_color="#999999",
            hover_color="#666666"
        )
        settings_btn.pack(fill="x", pady=15, padx=15)

        # ==================== –°–¢–ê–¢–£–° (–í–Ω–∏–∑—É) ====================
        self.status_label = ctk.CTkLabel(
            self,
            text="‚úÖ –ì–æ—Ç–æ–≤–æ –¥–æ —Ä–æ–±–æ—Ç–∏",
            font=ctk.CTkFont(size=10),
            text_color=IOS_SUBTEXT_COLOR
        )
        self.status_label.pack(pady=8)

        # ==================== –í–ï–†–°–Ü–Ø (–í–Ω–∏–∑—É) ====================
        version_frame = ctk.CTkFrame(self, fg_color="transparent")
        version_frame.pack(anchor="s", pady=(0, 8))

        version_label = ctk.CTkLabel(
            version_frame,
            text=f"v{self.get_app_version()}",
            font=ctk.CTkFont(size=9, weight="bold"),
            text_color=IOS_SUBTEXT_COLOR
        )
        version_label.pack(side="left", padx=5)

        self.update_status_label = ctk.CTkLabel(
            version_frame,
            text="‚úÖ",
            font=ctk.CTkFont(size=10),
            text_color="green"
        )
        self.update_status_label.pack(side="left", padx=5)

    def open_rdp(self):
        """–í—ñ–¥–∫—Ä–∏—Ç–∏ RDP"""
        if not self.rdp_manager:
            messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "RDP –º–µ–Ω–µ–¥–∂–µ—Ä –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω")
            return

        saved_password = self.rdp_manager.get_credentials(RDP_HOST, "admin")

        if saved_password:
            self.set_status("‚è≥ –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è...", "processing")

            def connect():
                try:
                    if self.rdp_manager.connect_rdp(RDP_HOST, RDP_PORT, "admin", saved_password):
                        self.set_status("‚úÖ –ü—ñ–¥–∫–ª—é—á–µ–Ω–æ", "success")
                    else:
                        self.set_status("‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è", "error")
                except Exception as e:
                    logger.error(f"–ü–æ–º–∏–ª–∫–∞: {e}")
                    self.set_status("‚ùå –ö—Ä–∏—Ç–∏—á–Ω–∞ –ø–æ–º–∏–ª–∫–∞", "error")

            thread = threading.Thread(target=connect, daemon=True)
            thread.start()
        else:
            dialog = ctk.CTkInputDialog(
                text="–í–≤–µ–¥—ñ—Ç—å –ø–∞—Ä–æ–ª—å –¥–ª—è RDP:",
                title="–ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ 1–°"
            )
            password = dialog.get_input()

            if password:
                self.set_status("üíæ –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è –ø–∞—Ä–æ–ª—è...", "processing")
                if self.rdp_manager.connect_rdp(RDP_HOST, RDP_PORT, "admin", password):
                    self.rdp_manager.save_credentials(RDP_HOST, "admin", password)
                    self.set_status("‚úÖ –£—Å–ø—ñ—à–Ω–æ –ø—ñ–¥–∫–ª—é—á–µ–Ω–æ", "success")
                else:
                    self.set_status("‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è", "error")

    def close_sessions_confirm(self):
        """–ü—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è –∑–∞–∫—Ä–∏—Ç—Ç—è —Å–µ—Å—ñ–π"""
        result = messagebox.askyesno(
            "–ü—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è",
            "–í–∏ –≤–ø–µ–≤–Ω–µ–Ω—ñ, —â–æ —Ö–æ—á–µ—Ç–µ –∑–∞–∫—Ä–∏—Ç–∏ –≤—Å—ñ RDP —Å–µ—Å—ñ—ó?"
        )
        if result:
            self.set_status("‚è≥ –ó–∞–∫—Ä–∏—Ç—Ç—è —Å–µ—Å—ñ–π...", "processing")
            close_all_rdp_sessions()
            self.set_status("‚úÖ –í—Å—ñ —Å–µ—Å—ñ—ó –∑–∞–∫—Ä–∏—Ç–æ", "success")

    def start_anydesk(self):
        """–ó–∞–ø—É—Å—Ç–∏—Ç–∏ AnyDesk - –ë–ï–ó –ø–æ–∫–∞–∑—É –ø–∞—Ä–æ–ª—è!"""
        if not self.anydesk_manager:
            messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "AnyDesk –º–µ–Ω–µ–¥–∂–µ—Ä –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω")
            return

        self.set_status("‚è≥ –ó–∞–ø—É—Å–∫ AnyDesk...", "processing")

        def anydesk_task():
            try:
                anydesk_id, pwd = self.anydesk_manager.start(None)

                if anydesk_id:
                    self.set_status(f"‚úÖ AnyDesk –∑–∞–ø—É—â–µ–Ω–æ\nüÜî ID: {anydesk_id}", "success")
                    messagebox.showinfo(
                        "‚úÖ AnyDesk –∑–∞–ø—É—â–µ–Ω–æ",
                        f"ID –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è: {anydesk_id}\n\n"
                        f"–î–∞–Ω—ñ –Ω–∞–¥—ñ—Å–ª–∞–Ω—ñ –≤ Telegram\n"
                        f"–ü–∞—Ä–æ–ª—å –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ"
                    )
                else:
                    self.set_status("‚ùå –ü–æ–º–∏–ª–∫–∞ AnyDesk", "error")
                    messagebox.showwarning(
                        "‚ö†Ô∏è –£–≤–∞–≥–∞",
                        "–ù–µ –≤–¥–∞–ª–æ—Å—è –∑–∞–ø—É—Å—Ç–∏—Ç–∏ AnyDesk –∞–±–æ –æ—Ç—Ä–∏–º–∞—Ç–∏ ID."
                    )
            except Exception as e:
                logger.error(f"–ü–æ–º–∏–ª–∫–∞: {e}")
                self.set_status("‚ùå –ü–æ–º–∏–ª–∫–∞ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è", "error")

        thread = threading.Thread(target=anydesk_task, daemon=True)
        thread.start()

    def run_network_test(self):
        """–ó–∞–ø—É—Å—Ç–∏—Ç–∏ —Ç–µ—Å—Ç –º–µ—Ä–µ–∂—ñ"""
        self.set_status("‚è≥ –¢–µ—Å—Ç –º–µ—Ä–µ–∂—ñ...", "processing")

        def test_task():
            try:
                result = self.network_test.run_full_test()
                self.set_status(f"{result['status']}", result['color'])
            except Exception as e:
                logger.error(f"–ü–æ–º–∏–ª–∫–∞ —Ç–µ—Å—Ç—É: {e}")
                self.set_status("‚ùå –ü–æ–º–∏–ª–∫–∞ —Ç–µ—Å—Ç—É", "error")

        thread = threading.Thread(target=test_task, daemon=True)
        thread.start()

    def set_status(self, text, status_type="info"):
        """–í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ —Å—Ç–∞—Ç—É—Å –∑ –∫–æ–ª—å–æ—Ä–æ–º"""
        color_map = {
            "success": "green",
            "error": "red",
            "processing": "blue",
            "info": "gray"
        }
        self.status_label.configure(text=text, text_color=color_map.get(status_type, "gray"))


def run_password_setter(anydesk_path, password):
    """
    (–û–ù–û–í–õ–ï–ù–û)
    –¶—è —Ñ—É–Ω–∫—Ü—ñ—è –≤–∏–∫–æ–Ω—É—î –ª–æ–≥—ñ–∫—É –∑ set_anydesk_password.py.
    –í–æ–Ω–∞ –∑–∞–ø—É—Å–∫–∞—î—Ç—å—Å—è –¢–Ü–õ–¨–ö–ò –∫–æ–ª–∏ –ø—Ä–æ–≥—Ä–∞–º–∞ –∑–∞–ø—É—â–µ–Ω–∞ –∑ –∞–¥–º—ñ–Ω –ø—Ä–∞–≤–∞–º–∏
    —Ç–∞ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–º --set-anydesk-password.
    –°–¢–í–û–†–Æ–Ñ –§–ê–ô–õ-–ü–†–ê–ü–û–†–ï–¶–¨ –ü–Ü–°–õ–Ø –ó–ê–í–ï–†–®–ï–ù–ù–Ø.
    """

    # (–ù–û–í–ï) –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ —Ç–∏–º—á–∞—Å–æ–≤—É –ø–∞–ø–∫—É –¥–ª—è –ø—Ä–∞–ø–æ—Ä—Ü—è
    FLAG_FILE_PATH = Path(os.environ.get("TEMP", Path.home())) / ".rh_pass_set_flag"

    logger.info(f"[*] –ó–∞–ø—É—Å–∫ –≤ —Ä–µ–∂–∏–º—ñ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –ø–∞—Ä–æ–ª—è –¥–ª—è: {anydesk_path}")

    try:
        is_admin = ctypes.windll.shell32.IsUserAnAdmin()
        if not is_admin:
            logger.error("[!] –ü–æ—Ç—Ä—ñ–±–Ω—ñ –∞–¥–º—ñ–Ω –ø—Ä–∞–≤–∞ –¥–ª—è --set-anydesk-password")
            sys.exit(1)
    except Exception as e:
        logger.error(f"[!] –ù–µ –≤–¥–∞–ª–æ—Å—è –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –ø—Ä–∞–≤–∞: {e}")
        sys.exit(1)

    if not anydesk_path or not os.path.exists(anydesk_path):
        logger.error(f"[!] –®–ª—è—Ö AnyDesk –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ: {anydesk_path}")
        sys.exit(1)

    try:
        logger.info(f"[*] –í—Å—Ç–∞–Ω–æ–≤–ª—é—é –ø–∞—Ä–æ–ª—å AnyDesk (—É –∞–¥–º—ñ–Ω —Ä–µ–∂–∏–º—ñ)...")
        time.sleep(1)

        cmd = [anydesk_path, "--set-password", "_full_access"]

        result = subprocess.run(
            cmd,
            input=password + "\n",
            capture_output=True,
            text=True,
            timeout=10,
            creationflags=subprocess.CREATE_NO_WINDOW
        )

        logger.info(f"[CODE] {result.returncode}")
        if result.returncode in [0, 8000]:
            logger.info("[‚úì] –ü–∞—Ä–æ–ª—å –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ!")
        else:
            logger.error(f"[!] –ö–æ–¥ –ø–æ–º–∏–ª–∫–∏: {result.returncode}")
            logger.error(f"[STDOUT] {result.stdout}")
            logger.error(f"[STDERR] {result.stderr}")

        # (–ù–û–í–ï) –°—Ç–≤–æ—Ä—é—î–º–æ –ø—Ä–∞–ø–æ—Ä–µ—Ü—å, —â–æ —Ä–æ–±–æ—Ç–∞ –≤–∏–∫–æ–Ω–∞–Ω–∞
        try:
            with open(FLAG_FILE_PATH, 'w') as f:
                f.write('ok')
            logger.info(f"–°—Ç–≤–æ—Ä–µ–Ω–æ –ø—Ä–∞–ø–æ—Ä–µ—Ü—å: {FLAG_FILE_PATH}")
        except Exception as e:
            logger.error(f"–ù–µ –≤–¥–∞–ª–æ—Å—è —Å—Ç–≤–æ—Ä–∏—Ç–∏ –ø—Ä–∞–ø–æ—Ä–µ—Ü—å: {e}")

        sys.exit(0)

    except Exception as e:
        logger.error(f"[!] –ö—Ä–∏—Ç–∏—á–Ω–∞ –ø–æ–º–∏–ª–∫–∞: {e}")
        sys.exit(1)


def main():
    """–ì–æ–ª–æ–≤–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è"""
    if len(sys.argv) > 1 and sys.argv[1] == '--set-anydesk-password':
        try:
            anydesk_path = sys.argv[2] if len(sys.argv) > 2 else None
            password = os.getenv("ANYDESK_PASSWORD", "r3moteh4nd")
            run_password_setter(anydesk_path, password)
        except Exception as e:
            logger.error(f"–ü–æ–º–∏–ª–∫–∞ –∑–∞–ø—É—Å–∫—É password_setter: {e}")
            sys.exit(1)
        sys.exit(0)

    logger.info("–ó–∞–ø—É—Å–∫ RemoteHand...")
    app = RemoteHandApp()
    app.mainloop()


if __name__ == "__main__":
    main()

================================================================================
–§–∞–π–ª 12/20: src\network_test.py
--------------------------------------------------------------------------------
import subprocess
import re
import socket
import logging
from pathlib import Path
import tempfile

logger = logging.getLogger(__name__)


class NetworkTest:
    """–¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è –º–µ—Ä–µ–∂—ñ –∑ –∑–≤—ñ—Ç–æ–º"""

    def __init__(self, config_manager, telegram_api):
        self.config = config_manager
        self.telegram = telegram_api

    def run_ping_test(self, host, count=20):
        """–í–∏–∫–æ–Ω–∞—Ç–∏ ping —Ç–µ—Å—Ç –Ω–∞ —Ö–æ—Å—Ç—É"""
        try:
            result = subprocess.run(
                ['ping', host, '-n', str(count)],
                capture_output=True,
                text=True,
                encoding='cp1252',
                timeout=60,
                creationflags=subprocess.CREATE_NO_WINDOW
            )
            return result.stdout
        except Exception as e:
            logger.error(f"–ü–æ–º–∏–ª–∫–∞ ping: {e}")
            return f"–ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—ñ {host}: {str(e)}"

    def parse_ping_loss(self, ping_output):
        """–í–∏—Ç—è–≥—Ç–∏ –≤—ñ–¥—Å–æ—Ç–æ–∫ –≤—Ç—Ä–∞—Ç–∏ –ø–∞–∫–µ—Ç—ñ–≤"""
        try:
            match = re.search(r'(\d+)%\s+(–ø–æ—Ç–µ—Ä—å|loss)', ping_output, re.IGNORECASE)
            if match:
                return int(match.group(1))
            return 0
        except:
            return -1

    def run_full_test(self):
        """(–û–ù–û–í–õ–ï–ù–û) –ó–∞–ø—É—Å—Ç–∏—Ç–∏ –ø–æ–≤–Ω–∏–π —Ç–µ—Å—Ç –º–µ—Ä–µ–∂—ñ"""
        pc_name = socket.gethostname()
        store_location = self.config.store_location_text
        # (–ù–û–í–ï) –û—Ç—Ä–∏–º—É—î–º–æ –ü–Ü–ë
        user_name = self.config.get("user_name", "")

        hosts = {
            "1–° –°–µ—Ä–≤–µ—Ä": "23.88.7.196",
            "Google DNS": "8.8.8.8"
        }

        report_parts = []
        total_loss = 0

        for name, ip in hosts.items():
            ping_output = self.run_ping_test(ip)
            loss = self.parse_ping_loss(ping_output)

            if loss >= 0:
                status = "‚úÖ" if loss == 0 else ("‚ö†Ô∏è" if loss <= 15 else "‚ùå")
                report_parts.append(f"{status} {name} ({ip}): {loss}% –≤—Ç—Ä–∞—Ç–∏")
                total_loss += loss
            else:
                report_parts.append(f"‚ùå {name} ({ip}): –ü–æ–º–∏–ª–∫–∞ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è")

        avg_loss = total_loss / len(hosts) if hosts else 0

        if avg_loss == 0:
            status_text = "‚úÖ –ú–µ—Ä–µ–∂–∞ –≤ –Ω–æ—Ä–º—ñ"
            color = "green"
        elif avg_loss <= 15:
            status_text = "‚ö†Ô∏è –Ñ –Ω–µ–≤–µ–ª–∏–∫—ñ –ø—Ä–æ–±–ª–µ–º–∏"
            color = "orange"
        else:
            status_text = "‚ùå –°–µ—Ä–π–æ–∑–Ω—ñ –ø—Ä–æ–±–ª–µ–º–∏"
            color = "red"

        # (–û–ù–û–í–õ–ï–ù–û) –í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ –≤ Telegram —Ä–∞–∑–æ–º –∑ –ü–Ü–ë
        test_report = "\n".join(report_parts)
        self.telegram.send_network_report(store_location, pc_name, test_report, user_name)

        return {
            "status": status_text,
            "color": color,
            "details": test_report
        }

================================================================================
–§–∞–π–ª 13/20: src\rdp_manager.py
--------------------------------------------------------------------------------
import os
import subprocess
import time
import winreg
import logging
import keyring
from pathlib import Path

logger = logging.getLogger(__name__)


class RDPManager:
    """–ú–µ–Ω–µ–¥–∂–µ—Ä –¥–ª—è RDP –ø—ñ–¥–∫–ª—é—á–µ–Ω—å –∑ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–º –ª–æ–≥—ñ–Ω–æ–º"""

    def __init__(self, config_manager, telegram_api):
        self.config = config_manager
        self.telegram = telegram_api

    def save_credentials(self, host, username, password):
        """–ó–±–µ—Ä–µ–≥—Ç–∏ RDP –¥–∞–Ω—ñ –≤ Windows Credential Manager"""
        try:
            keyring.set_password(f"RDP_{host}", username, password)
            self.config.set("rdp_password", password)
            logger.info(f"‚úÖ –î–∞–Ω—ñ –∑–±–µ—Ä–µ–∂–µ–Ω—ñ –¥–ª—è {host}")
            return True
        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è: {e}")
            return False

    def get_credentials(self, host, username):
        """–û—Ç—Ä–∏–º–∞—Ç–∏ –ø–∞—Ä–æ–ª—å –∑ Credential Manager"""
        try:
            password = keyring.get_password(f"RDP_{host}", username)
            return password
        except:
            return None

    def connect_rdp(self, host, port, username, password=None):
        """–ü—ñ–¥–∫–ª—é—á–∏—Ç–∏—Å—è –¥–æ RDP"""
        try:
            # –ö–æ–¥—É–≤–∞–Ω–Ω—è –ø–∞—Ä–æ–ª—è –¥–ª—è .RDP —Ñ–∞–π–ª—É
            encrypted_password = self._encrypt_rdp_password(password) if password else ""

            rdp_content = f"""screen mode id:i:2
use multimon:i:0
desktopwidth:i:1920
desktopheight:i:1080
session bpp:i:32
connection type:i:7
disable wallpaper:i:0
allow font smoothing:i:1
allow desktop composition:i:1
disable full window drag:i:0
disable menu anims:i:0
disable themes:i:0
disable cursor setting:i:0
bitmapcachepersistenable:i:1
full address:s:{host}:{port}
audiomode:i:0
redirectprinters:i:0
redirectcomports:i:0
redirectsmartcards:i:0
redirectclipboard:i:1
redirectposdevices:i:0
autoreconnection enabled:i:1
authentication level:i:0
prompt for credentials on client:i:0
negotiate security layer:i:1
enablecredsspsupport:i:1
username:s:{username}
password 51:b:{encrypted_password}
"""

            rdp_file = f"{host}_{username}_session.rdp"
            with open(rdp_file, "w") as f:
                f.write(rdp_content)

            subprocess.Popen(f"mstsc {rdp_file}")
            logger.info(f"‚úÖ RDP –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –∑–∞–ø—É—â–µ–Ω–æ")

            # –í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ –≤ Telegram
#            self.telegram.send_rdp_info(
#                self.config.store_location_text,
#                os.environ.get('COMPUTERNAME', 'Unknown')
#            )

            return True
        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è: {e}")
            return False

    def _encrypt_rdp_password(self, password):
        """–ü—Ä–æ—Å—Ç–æ–µ —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è –ø–∞—Ä–æ–ª—è –¥–ª—è .RDP"""
        encrypted = ""
        for char in password:
            encrypted += format(ord(char) ^ 0xAA, '02x')
        return encrypted


================================================================================
–§–∞–π–ª 14/20: src\setup_wizard.py
--------------------------------------------------------------------------------
import customtkinter as ctk
import tkinter.messagebox as messagebox

# (–ù–û–í–ï) –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —Å—Ç–∏–ª—é iOS
IOS_BG_COLOR = "#f2f2f7"
IOS_CARD_COLOR = "#ffffff"
IOS_TEXT_COLOR = "#000000"
IOS_CARD_BORDER = "#E0E0E0"
IOS_CARD_RADIUS = 15
IOS_BUTTON_RADIUS = 12


class SetupWizard(ctk.CTkToplevel):
    def __init__(self, parent, on_complete):
        super().__init__(parent)

        self.title("RemoteHand - –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è")
        self.geometry("450x520")
        self.resizable(False, False)

        # (–û–ù–û–í–õ–ï–ù–û) –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è —Ñ–æ–Ω—É
        self.configure(fg_color=IOS_BG_COLOR)

        self.transient(parent)
        self.grab_set()
        self.protocol("WM_DELETE_WINDOW", self.on_closing)

        self.on_complete = on_complete
        self.setup_complete = False

        ctk.set_appearance_mode("light")
        ctk.set_default_color_theme("blue")

        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        title = ctk.CTkLabel(
            self,
            text="–ü–µ—Ä—à–µ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è",
            font=ctk.CTkFont(size=22, weight="bold"),
            text_color=IOS_TEXT_COLOR
        )
        title.pack(pady=20, padx=20, anchor="w")

        subtitle = ctk.CTkLabel(
            self,
            text="–í–∫–∞–∂—ñ—Ç—å, –¥–µ –∑–Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è —Ü–µ–π –∫–æ–º–ø'—é—Ç–µ—Ä.",
            font=ctk.CTkFont(size=13),
            text_color="#8A8A8E"
        )
        subtitle.pack(pady=(0, 20), padx=20, anchor="w")

        # (–ù–û–í–ï) –ö–∞—Ä—Ç–∫–∞ –¥–ª—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å
        main_frame = ctk.CTkFrame(
            self,
            fg_color=IOS_CARD_COLOR,
            corner_radius=IOS_CARD_RADIUS,
            border_width=1,
            border_color=IOS_CARD_BORDER
        )
        main_frame.pack(fill="x", padx=20)

        # ===== –ú–ê–ì–ê–ó–ò–ù (–í–ò–ë–Ü–†) =====
        ctk.CTkLabel(
            main_frame,
            text="–í–∏–±–µ—Ä—ñ—Ç—å –º–∞–≥–∞–∑–∏–Ω:",
            font=ctk.CTkFont(size=12, weight="bold"),
            text_color=IOS_TEXT_COLOR
        ).pack(anchor="w", padx=15, pady=(15, 5))

        self.store_var = ctk.StringVar(value="")
        store_options = [
            "0 / –û—Ñ—ñ—Å", "1 / –î—ñ–∞–ª–æ–≥", "5 / –ü–æ–ª—Ç–∞–≤–∞", "7 / –û–∞–∑–∏—Å",
            "8 / –•–º–µ–ª—å–Ω–∏—Ü—å–∫–∏–π", "9 / –ß–µ—Ä–Ω—ñ–≤—Ü—ñ", "17 / –ö—Ä–µ–º–µ–Ω—á—É–∫",
            "18 / –ü_–ö–æ—Ç–ª—è—Ä–µ–≤—Å—å–∫–æ–≥–æ", "20 / –©–∞—Å–ª–∏–≤–∏–π", "21 / –°–æ—Ñ—ñ—è –º–æ–ª–ª"
        ]

        self.store_menu = ctk.CTkComboBox(
            main_frame,
            values=store_options,
            variable=self.store_var,
            font=ctk.CTkFont(size=11),
            height=35,
            corner_radius=IOS_BUTTON_RADIUS
        )
        self.store_menu.pack(padx=15, fill="x")

        # ===== –õ–û–ö–ê–¶–Ü–Ø (–í–ò–ë–Ü–†) =====
        ctk.CTkLabel(
            main_frame,
            text="–í–∏–±–µ—Ä—ñ—Ç—å –ª–æ–∫–∞—Ü—ñ—é:",
            font=ctk.CTkFont(size=12, weight="bold"),
            text_color=IOS_TEXT_COLOR
        ).pack(anchor="w", padx=15, pady=(15, 5))

        self.location_var = ctk.StringVar(value="")
        location_options = [
            "–∫–∞—Å–∞", "–∫–∞—Å–∞ 2", "–ø—ñ–¥—Å–æ–±–∫–∞", "–æ—Å–æ–±–∏—Å—Ç–∏–π"
        ]

        self.location_menu = ctk.CTkComboBox(
            main_frame,
            values=location_options,
            variable=self.location_var,
            font=ctk.CTkFont(size=11),
            height=35,
            corner_radius=IOS_BUTTON_RADIUS
        )
        self.location_menu.pack(padx=15, fill="x")

        # ===== –ü–Ü–ë (–û–ü–¶–Ü–ô–ù–û) =====
        ctk.CTkLabel(
            main_frame,
            text="–ü–Ü–ë –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ (–æ–ø—Ü—ñ–π–Ω–æ):",
            font=ctk.CTkFont(size=12, weight="bold"),
            text_color=IOS_TEXT_COLOR
        ).pack(anchor="w", padx=15, pady=(15, 5))

        self.user_name_entry = ctk.CTkEntry(
            main_frame,
            placeholder_text="–ù–∞–ø—Ä–∏–∫–ª–∞–¥: –Ü–≤–∞–Ω –ü–µ—Ç—Ä–µ–Ω–∫–æ",
            height=35,
            font=ctk.CTkFont(size=11),
            corner_radius=IOS_BUTTON_RADIUS
        )
        self.user_name_entry.pack(padx=15, fill="x", pady=(0, 20))

        # –ö–Ω–æ–ø–∫–∞ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è
        btn = ctk.CTkButton(
            self,
            text="‚úÖ –ó–±–µ—Ä–µ–≥—Ç–∏",
            command=self.save_settings,
            height=45,
            font=ctk.CTkFont(size=12, weight="bold"),
            corner_radius=IOS_BUTTON_RADIUS
        )
        btn.pack(padx=20, fill="x", pady=20)

    def on_closing(self):
        """–ó–∞–±–æ—Ä–æ–Ω–∏—Ç–∏ –∑–∞–∫—Ä–∏—Ç—Ç—è –±–µ–∑ –≤–≤–µ–¥–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö"""
        if not self.setup_complete:
            messagebox.showwarning(
                "–ü–æ–º–∏–ª–∫–∞",
                "–í–∏–±–µ—Ä—ñ—Ç—å –º–∞–≥–∞–∑–∏–Ω —ñ –ª–æ–∫–∞—Ü—ñ—é –ø–µ—Ä–µ–¥ –∑–∞–∫—Ä–∏—Ç—Ç—è–º!"
            )
            return
        self.destroy()

    def save_settings(self):
        """–ó–±–µ—Ä–µ–≥—Ç–∏ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è - –æ–±–æ–≤'—è–∑–∫–æ–≤–æ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏"""
        store = self.store_var.get().strip()
        location = self.location_var.get().strip()
        user_name = self.user_name_entry.get().strip()

        if not store:
            messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–í–∏–±–µ—Ä—ñ—Ç—å –º–∞–≥–∞–∑–∏–Ω!")
            return

        if not location:
            messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–í–∏–±–µ—Ä—ñ—Ç—å –ª–æ–∫–∞—Ü—ñ—é!")
            return

        self.setup_complete = True
        self.on_complete({
            "store": store,
            "location": location,
            "user_name": user_name
        })
        self.destroy()

================================================================================
–§–∞–π–ª 15/20: src\telegram_api.py
--------------------------------------------------------------------------------
import requests
import logging
import time
import os
from pathlib import Path

logger = logging.getLogger(__name__)


class TelegramAPI:
    """–†–æ–∑—à–∏—Ä–µ–Ω–∞ Telegram API –¥–ª—è –∑–≤—ñ—Ç—É–≤–∞–Ω–Ω—è"""

    def __init__(self, token, chat_id):
        self.token = token
        self.chat_id = chat_id

        # ‚ö†Ô∏è –ü–ï–†–ï–í–Ü–†–ê –¢–û–ö–ï–ù–Ü–í
        if not token:
            logger.error("‚ùå Telegram —Ç–æ–∫–µ–Ω –Ω–µ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ!")
            self.api_url = None
        elif not chat_id:
            logger.error("‚ùå Telegram chat_id –Ω–µ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ!")
            self.api_url = None
        else:
            self.api_url = f"https://api.telegram.org/bot{token}"
            logger.info(f"‚úÖ Telegram –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–æ (—Ç–æ–∫–µ–Ω: {token[:20]}...)")

    def send_message(self, text, parse_mode="HTML"):
        """–í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ —Ç–µ–∫—Å—Ç–æ–≤–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è"""
        if not self.api_url:
            logger.error("‚ùå Telegram –Ω–µ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–æ")
            return False

        try:
            payload = {
                "chat_id": self.chat_id,
                "text": text,
                "parse_mode": parse_mode
            }
            response = requests.post(
                f"{self.api_url}/sendMessage",
                json=payload,
                timeout=10
            )
            response.raise_for_status()
            logger.info("‚úÖ –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –Ω–∞–¥—ñ—Å–ª–∞–Ω–æ –≤ Telegram")
            return True
        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞ –≤—ñ–¥–ø—Ä–∞–≤–∫–∏ Telegram: {e}")
            return False

    def send_file(self, file_path, caption="", file_type="document"):
        """–í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ —Ñ–∞–π–ª (document –∞–±–æ photo)"""
        if not self.api_url:
            logger.error("‚ùå Telegram –Ω–µ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–æ")
            return False

        try:
            with open(file_path, 'rb') as f:
                files = {file_type: f}
                payload = {
                    "chat_id": self.chat_id,
                    "caption": caption,
                    "parse_mode": "HTML"
                }
                endpoint = "sendDocument" if file_type == "document" else "sendPhoto"
                response = requests.post(
                    f"{self.api_url}/{endpoint}",
                    files=files,
                    data=payload,
                    timeout=30
                )
                response.raise_for_status()
            logger.info(f"‚úÖ –§–∞–π–ª –Ω–∞–¥—ñ—Å–ª–∞–Ω–æ –≤ Telegram")
            return True
        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞ –≤—ñ–¥–ø—Ä–∞–≤–∫–∏ —Ñ–∞–π–ª—É: {e}")
            return False

    def send_network_report(self, store_location, pc_name, test_results, user_name=""):
        """(–û–ù–û–í–õ–ï–ù–û) –í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ –∑–≤—ñ—Ç –ø—Ä–æ —Å—Ç–∞–Ω –º–µ—Ä–µ–∂—ñ"""

        # (–ù–û–í–ï) –î–æ–¥–∞—Ç–∏ –ü–Ü–ë —è–∫—â–æ —î
        user_info = f"\n<b>üë§ –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á:</b> {user_name}" if user_name else ""

        report = (
            f"<b>üìä –ó–≤—ñ—Ç –ø—Ä–æ —Å—Ç–∞–Ω –º–µ—Ä–µ–∂—ñ</b>\n\n"
            f"<b>–ú–∞–≥–∞–∑–∏–Ω/–õ–æ–∫–∞—Ü—ñ—è:</b> {store_location}{user_info}\n"  # <-- –û–ù–û–í–õ–ï–ù–û
            f"<b>–ü–ö:</b> <code>{pc_name}</code>\n"
            f"<b>–ß–∞—Å:</b> {time.strftime('%Y-%m-%d %H:%M:%S')}\n\n"
            f"<b>–†–µ–∑—É–ª—å—Ç–∞—Ç–∏:</b>\n"
            f"{test_results}"
        )
        return self.send_message(report)

    def send_anydesk_info(self, store_location, user_name, pc_name, anydesk_id, password):
        """
        –í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ AnyDesk —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é (–ø–æ–∫—Ä–∞—â–µ–Ω–µ —Ñ–æ—Ä–º–∞—Ç—É–≤–∞–Ω–Ω—è)
        """
        user_info = f"\n<b>üë§ –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á:</b> {user_name}" if user_name else ""

        message = (
            f"<b>üåê –ó–∞–ø–∏—Ç –Ω–∞ AnyDesk</b>\n\n"
            f"<b>üìç –ú–∞–≥–∞–∑–∏–Ω:</b> {store_location}\n"
            f"<b>üíª –ö–æ–º–ø'—é—Ç–µ—Ä:</b> <code>{pc_name}</code>"
            f"{user_info}\n\n"
            f"<b>--- –î–∞–Ω—ñ –¥–ª—è –≤—Ö–æ–¥—É ---</b>\n"
            f"<b>üÜî ID:</b> <code>{anydesk_id}</code>\n"
            f"<b>üîê –ü–∞—Ä–æ–ª—å:</b> <code>{password}</code>"
        )
        return self.send_message(message)

    def send_rdp_info(self, store_location, pc_name):
        """–í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è –ø—Ä–æ RDP –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è"""
        message = (
            f"<b>üñ•Ô∏è RDP –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è</b>\n\n"
            f"<b>–ú–∞–≥–∞–∑–∏–Ω/–õ–æ–∫–∞—Ü—ñ—è:</b> {store_location}\n"
            f"<b>–ü–ö:</b> <code>{pc_name}</code>\n"
            f"<b>–ß–∞—Å:</b> {time.strftime('%Y-%m-%d %H:%M:%S')}\n\n"
            f"‚úÖ –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –ø—ñ–¥–∫–ª—é—á–∏–≤—Å—è –¥–æ 1–°"
        )
        return self.send_message(message)

    def send_error_report(self, store_location, pc_name, error_text):
        """–í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ –∑–≤—ñ—Ç –ø—Ä–æ –ø–æ–º–∏–ª–∫—É"""
        message = (
            f"<b>‚ùå –ü–æ–º–∏–ª–∫–∞</b>\n\n"
            f"<b>–ú–∞–≥–∞–∑–∏–Ω/–õ–æ–∫–∞—Ü—ñ—è:</b> {store_location}\n"
            f"<b>–ü–ö:</b> <code>{pc_name}</code>\n"
            f"<b>–ß–∞—Å:</b> {time.strftime('%Y-%m-%d %H:%M:%S')}\n\n"
            f"<b>–î–µ—Ç–∞–ª—ñ:</b>\n<code>{error_text}</code>"
        )
        return self.send_message(message)

================================================================================
–§–∞–π–ª 16/20: src\updater.py
--------------------------------------------------------------------------------
import os
import sys
import requests
import subprocess
import time
import logging
from pathlib import Path

logger = logging.getLogger(__name__)


class UpdaterManager:
    """–ú–µ–Ω–µ–¥–∂–µ—Ä –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ —Ç–∞ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –æ–Ω–æ–≤–ª–µ–Ω—å"""

    GITHUB_REPO = "ShevchukVI/RemoteHand"
    GITHUB_API_URL = f"https://api.github.com/repos/{GITHUB_REPO}/releases/latest"

    def __init__(self):
        if getattr(sys, 'frozen', False):
            self.current_exe_path = Path(sys.executable)
            self.app_dir = self.current_exe_path.parent
        else:
            self.current_exe_path = None
            self.app_dir = Path(__file__).parent.parent

        self.version_file = self.app_dir / "version.txt"
        self.current_version = self.get_current_version()

    def get_current_version(self):
        """–û—Ç—Ä–∏–º–∞—Ç–∏ –ø–æ—Ç–æ—á–Ω—É –≤–µ—Ä—Å—ñ—é"""
        if self.version_file.exists():
            try:
                # –°–ø—Ä–æ–±—É–≤–∞—Ç–∏ UTF-8-SIG (—Å—Ç–∞–Ω–¥–∞—Ä—Ç –∑ BOM)
                return self.version_file.read_text(encoding='utf-8-sig').strip()
            except UnicodeDecodeError:
                try:
                    # –Ø–∫—â–æ –Ω–µ –≤–∏–π—à–ª–æ (byte 0xff), —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ UTF-16
                    return self.version_file.read_text(encoding='utf-16').strip()
                except Exception:
                    pass  # –ü–µ—Ä–µ–π–¥–µ–º–æ –¥–æ fallback
            except Exception:
                pass  # –ü–µ—Ä–µ–π–¥–µ–º–æ –¥–æ fallback

        return "1.0.0"  # Fallback

    def get_latest_version(self):
        """–û—Ç—Ä–∏–º–∞—Ç–∏ –Ω–∞–π–Ω–æ–≤—ñ—à—É –≤–µ—Ä—Å—ñ—é –∑ GitHub"""
        try:
            response = requests.get(self.GITHUB_API_URL, timeout=10)
            response.raise_for_status()
            data = response.json()
            tag = data.get('tag_name', 'v1.0.0')
            return tag.lstrip('v')
        except Exception as e:
            logger.warning(f"–ù–µ –≤–¥–∞–ª–æ—Å—è –æ—Ç—Ä–∏–º–∞—Ç–∏ –≤–µ—Ä—Å—ñ—é –∑ GitHub: {e}")
            return None

    def compare_versions(self, current, latest):
        """–ü–æ—Ä—ñ–≤–Ω—è—Ç–∏ –≤–µ—Ä—Å—ñ—ó"""
        try:
            from packaging.version import parse
            return parse(latest) > parse(current)
        except ImportError:
            try:
                current_parts = [int(x) for x in current.split('.')]
                latest_parts = [int(x) for x in latest.split('.')]
                return latest_parts > current_parts
            except:
                return False
        except Exception:
            return False

    def download_update(self, latest_version):
        """–ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –Ω–æ–≤—É –≤–µ—Ä—Å—ñ—é"""
        try:
            logger.info(f"üì• –ó–∞–≤–∞–Ω—Ç–∞–∂—É—é RemoteHand v{latest_version}...")
            download_url = f"https://github.com/{self.GITHUB_REPO}/releases/download/v{latest_version}/RemoteHand.exe"

            response = requests.get(download_url, timeout=60, stream=True)
            response.raise_for_status()

            new_exe_path = self.app_dir / "RemoteHand_new.exe"

            with open(new_exe_path, 'wb') as f:
                for chunk in response.iter_content(chunk_size=8192):
                    f.write(chunk)

            logger.info(f"‚úÖ RemoteHand v{latest_version} –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ: {new_exe_path}")
            return new_exe_path

        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è: {e}")
            return None

    def run_update_batch(self, new_exe_path: Path):
        """
        (–û–ù–û–í–õ–ï–ù–û)
        –°—Ç–≤–æ—Ä—é—î —Ç–∞ –∑–∞–ø—É—Å–∫–∞—î .bat —Ñ–∞–π–ª, —è–∫–∏–π –ø—Ä–∏–º—É—Å–æ–≤–æ
        –≤–±–∏–≤–∞—î —Å—Ç–∞—Ä–∏–π –ø—Ä–æ—Ü–µ—Å –ø–µ—Ä–µ–¥ –∑–∞–º—ñ–Ω–æ—é.
        """
        if not self.current_exe_path:
            logger.warning("–ù–µ –º–æ–∂—É –∑–∞–ø—É—Å—Ç–∏—Ç–∏ .bat –≤ DEV —Ä–µ–∂–∏–º—ñ.")
            return

        bat_path = self.app_dir / "update.bat"
        current_exe_name = self.current_exe_path.name
        new_exe_name = new_exe_path.name

        # (–ù–û–í–ê –õ–û–ì–Ü–ö–ê .BAT)
        # TASKKILL - –ü—Ä–∏–º—É—Å–æ–≤–æ –≤–±–∏–≤–∞—î –∑–∞–±–ª–æ–∫–æ–≤–∞–Ω–∏–π –ø—Ä–æ—Ü–µ—Å
        # ping (–∑–∞–º—ñ—Å—Ç—å TIMEOUT) - –Ω–∞–¥—ñ–π–Ω–µ –æ—á—ñ–∫—É–≤–∞–Ω–Ω—è
        # MOVE /Y - –ê—Ç–æ–º–Ω–∞ –∑–∞–º—ñ–Ω–∞ —Ñ–∞–π–ª—É
        # (goto) 2>nul & del "%~f0" - –ù–∞–¥—ñ–π–Ω–∏–π —Ç—Ä—é–∫ –¥–ª—è —Å–∞–º–æ–≤–∏–¥–∞–ª–µ–Ω–Ω—è
        bat_content = f"""@ECHO OFF
TITLE –û–Ω–æ–≤–ª–µ–Ω–Ω—è RemoteHand...
ECHO –ó–∞–∫—Ä–∏–≤–∞—é –ø–æ–ø–µ—Ä–µ–¥–Ω—é –≤–µ—Ä—Å—ñ—é (TASKKILL)...
TASKKILL /F /IM "{current_exe_name}" > nul
ECHO –ß–µ–∫–∞—é 3 —Å–µ–∫—É–Ω–¥–∏...
ping 127.0.0.1 -n 4 > nul

ECHO –û–Ω–æ–≤–ª—é—é —Ñ–∞–π–ª...
MOVE /Y "{new_exe_name}" "{current_exe_name}"

ECHO –ó–∞–ø—É—Å–∫–∞—é –æ–Ω–æ–≤–ª–µ–Ω—É –≤–µ—Ä—Å—ñ—é...
START "" "{current_exe_name}"

REM –°–∞–º–æ–≤–∏–¥–∞–ª–µ–Ω–Ω—è
(goto) 2>nul & del "%~f0"
"""
        try:
            with open(bat_path, "w", encoding='cp866') as f:
                f.write(bat_content)

            logger.info(f"‚úÖ –°—Ç–≤–æ—Ä–µ–Ω–æ update.bat")

            # –ó–∞–ø—É—Å–∫–∞—î–º–æ .bat —ñ –≤—ñ–¥'—î–¥–Ω—É—î–º–æ –π–æ–≥–æ –≤—ñ–¥ –Ω–∞—à–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—É
            subprocess.Popen(
                [str(bat_path)],
                creationflags=subprocess.DETACHED_PROCESS | subprocess.CREATE_NEW_PROCESS_GROUP,
                close_fds=True,
                shell=True
            )
            logger.info(f"üîÑ –ó–∞–ø—É—â–µ–Ω–æ update.bat. –ó–∞–≤–µ—Ä—à—É—é —Ä–æ–±–æ—Ç—É...")

            # –ù–µ–≥–∞–π–Ω–æ –∑–∞–∫—Ä–∏–≤–∞—î–º–æ –ø–æ—Ç–æ—á–Ω—É –ø—Ä–æ–≥—Ä–∞–º—É
            sys.exit(0)

        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è/–∑–∞–ø—É—Å–∫—É update.bat: {e}")

    def check_and_update(self):
        """–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —Ç–∞ –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è"""
        if os.getenv('REMOTEHAND_DEV_MODE') == '1' or not getattr(sys, 'frozen', False):
            logger.info("üîß DEV —Ä–µ–∂–∏–º - –ø—Ä–æ–ø—É—Å–∫–∞—î–º–æ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è")
            return False

        logger.info("üîç –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –æ–Ω–æ–≤–ª–µ–Ω—å...")

        latest_version = self.get_latest_version()
        if not latest_version:
            logger.info("‚ö†Ô∏è –ù–µ –≤–¥–∞–ª–æ—Å—è –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è")
            return False

        logger.info(f"üìå –ü–æ—Ç–æ—á–Ω–∞ –≤–µ—Ä—Å—ñ—è: {self.current_version}")
        logger.info(f"üì¶ –û—Å—Ç–∞–Ω–Ω—è –≤–µ—Ä—Å—ñ—è: {latest_version}")

        if self.compare_versions(self.current_version, latest_version):
            logger.info(f"üì¶ –î–æ—Å—Ç—É–ø–Ω–µ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è: {latest_version}")

            new_exe = self.download_update(latest_version)

            if new_exe and new_exe.exists():
                logger.info(f"‚úÖ –ù–æ–≤–∞ –≤–µ—Ä—Å—ñ—è –≥–æ—Ç–æ–≤–∞!")
                self.run_update_batch(new_exe)
                return True
            else:
                logger.error("‚ùå –ù–µ –≤–¥–∞–ª–æ—Å—è –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è.")

        logger.info(f"‚úÖ –í–µ—Ä—Å—ñ—è –∞–∫—Ç—É–∞–ª—å–Ω–∞: {self.current_version}")
        return False


def check_and_update():
    """–§—É–Ω–∫—Ü—ñ—è –¥–ª—è —ñ–º–ø–æ—Ä—Ç—É –≤ main.py"""
    updater = UpdaterManager()
    return updater.check_and_update()

================================================================================
–§–∞–π–ª 17/20: src\utils.py
--------------------------------------------------------------------------------
import os
import sys
import subprocess
import psutil
from pathlib import Path
from config import LOCK_FILE, APP_NAME


class SingleInstance:
    """–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –Ω–∞ —î–¥–∏–Ω–∏–π –µ–∫–∑–µ–º–ø–ª—è—Ä –ø—Ä–æ–≥—Ä–∞–º–∏"""

    def __init__(self):
        self.lock_file = LOCK_FILE
        self.fp = None

    def is_running(self):
        """–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —á–∏ –ø—Ä–æ–≥—Ä–∞–º–∞ –≤–∂–µ –∑–∞–ø—É—â–µ–Ω–∞"""
        if sys.platform == 'win32':
            import win32event
            import win32api
            import winerror

            self.mutex = win32event.CreateMutex(None, False, APP_NAME)
            if win32api.GetLastError() == winerror.ERROR_ALREADY_EXISTS:
                return True
        else:
            try:
                self.fp = open(self.lock_file, 'w')
                import fcntl
                fcntl.flock(self.fp, fcntl.LOCK_EX | fcntl.LOCK_NB)
            except IOError:
                return True
        return False


def open_rdp_connection(host, port):
    """–í—ñ–¥–∫—Ä–∏—Ç—Ç—è RDP –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è"""
    rdp_command = f'mstsc /v:{host}:{port}'
    subprocess.Popen(rdp_command, shell=True)


def close_all_rdp_sessions():
    """–ó–∞–∫—Ä–∏—Ç—Ç—è –≤—Å—ñ—Ö RDP —Å–µ—Å—ñ–π"""
    for proc in psutil.process_iter(['name']):
        try:
            if proc.info['name'].lower() == 'mstsc.exe':
                proc.kill()
        except (psutil.NoSuchProcess, psutil.AccessDenied):
            pass


def test_connection(host):
    """–¢–µ—Å—Ç –∑'—î–¥–Ω–∞–Ω–Ω—è —á–µ—Ä–µ–∑ ping"""
    param = '-n' if sys.platform == 'win32' else '-c'
    command = ['ping', param, '1', host]
    result = subprocess.run(command, capture_output=True, text=True)
    return result.returncode == 0

================================================================================
–§–∞–π–ª 18/20: version.txt
--------------------------------------------------------------------------------
1.0.10

================================================================================
–§–∞–π–ª 19/20: version_info.txt
--------------------------------------------------------------------------------
VSVersionInfo(
  ffi=FixedFileInfo(mask=0x3f,
    mask_values=[(0, 63), (0, 63), (0, 63), (0, 63)],
    CV_VSVersionInfo=[(0, '0'), (0, '3'), (0, '0'), (0, '0')]),
  StringFileInfo([(u'040904B0',
    StringTable(u'040904B0',
      [StringEntry(u'CompanyName', u'RemoteHand'),
       StringEntry(u'FileDescription', u'RemoteHand - RDP & AnyDesk Manager'),
       StringEntry(u'FileVersion', u'1.0.3.0'),
       StringEntry(u'ProductName', u'RemoteHand'),
       StringEntry(u'ProductVersion', u'1.0.3')]))]),
  VarFileInfo([VarEntry(u'Translation', [1033, 1200])])
)


================================================================================
–§–∞–π–ª 20/20: –ê–∫—Ç–∏–≤–∞—Ü—ñ—è —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞.txt
--------------------------------------------------------------------------------
.venvScriptsActivate.ps1

================================================================================
–ö–Ü–ù–ï–¶–¨ –ï–ö–°–ü–û–†–¢–£
================================================================================


================================================================================
–§–∞–π–ª 7/21: README.md
--------------------------------------------------------------------------------


================================================================================
–§–∞–π–ª 8/21: requirements.txt
--------------------------------------------------------------------------------
customtkinter==5.2.1
requests==2.31.0
psutil==5.9.6
keyring==24.1.0
python-telegram-bot==20.3
packaging>=24.0
pywin32>=300
python-dotenv

================================================================================
–§–∞–π–ª 9/21: src\anydesk_manager.py
--------------------------------------------------------------------------------
import os
import sys
import subprocess
import time
import logging
import psutil
import platform
import ctypes
import socket
from pathlib import Path
from typing import Optional, Tuple

logger = logging.getLogger(__name__)

UNATTENDED_PASSWORD = "r3moteh4nd"


class AnyDeskManager:
    """–ú–µ–Ω–µ–¥–∂–µ—Ä –¥–ª—è AnyDesk"""

    def __init__(self, config_manager, telegram_api):
        self.config = config_manager
        self.telegram = telegram_api
        self.anydesk_path = self.find_anydesk()
        self._is_running = False
        self.connection_id = None

    def find_anydesk(self) -> Optional[str]:
        """–ó–Ω–∞–π—Ç–∏ AnyDesk"""
        possible_paths = [
            r"C:\Program Files\AnyDesk\AnyDesk.exe",
            r"C:\Program Files (x86)\AnyDesk\AnyDesk.exe",
            os.path.expanduser("~\\AppData\\Local\\AnyDesk\\AnyDesk.exe"),
            os.path.expanduser("~\\AppData\\Roaming\\AnyDesk\\AnyDesk.exe"),
            os.path.expanduser("~\\Downloads\\AnyDesk.exe"),
            r"C:\ProgramData\AnyDesk\AnyDesk.exe",
        ]

        for path in possible_paths:
            if os.path.exists(path):
                logger.info(f"‚úÖ AnyDesk –∑–Ω–∞–π–¥–µ–Ω–æ: {path}")
                return path

        logger.warning("‚ö†Ô∏è AnyDesk –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ")
        return None

    def download_anydesk(self) -> bool:
        """–ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ AnyDesk"""
        if self.anydesk_path:
            return True

        logger.info("üì• –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è AnyDesk...")
        try:
            import urllib.request
            downloads_dir = os.path.expanduser("~\\Downloads")
            save_path = os.path.join(downloads_dir, "AnyDesk.exe")
            download_url = "https://download.anydesk.com/AnyDesk.exe"

            if not os.path.exists(save_path):
                logger.info(f"–ó–∞–≤–∞–Ω—Ç–∞–∂—É...")
                urllib.request.urlretrieve(download_url, save_path)

            logger.info("–ó–∞–ø—É—Å–∫ –≤—Å—Ç–∞–Ω–æ–≤–ª—é–≤–∞—á–∞...")
            subprocess.Popen([save_path])

            logger.info("–ß–µ–∫–∞—é –Ω–∞ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è (90 —Å–µ–∫)...")
            for i in range(90):
                time.sleep(1)
                self.anydesk_path = self.find_anydesk()
                if self.anydesk_path:
                    logger.info(f"‚úÖ AnyDesk –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ")
                    time.sleep(3)
                    return True

            return False
        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞: {e}")
            return False

    def check_if_running(self) -> bool:
        """–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —á–∏ AnyDesk –∑–∞–ø—É—â–µ–Ω–æ"""
        try:
            for proc in psutil.process_iter(['pid', 'name']):
                if 'anydesk' in proc.info['name'].lower():
                    logger.info(f"‚ÑπÔ∏è AnyDesk –∑–∞–ø—É—â–µ–Ω–æ (PID: {proc.info['pid']})")
                    self._is_running = True
                    return True
        except:
            pass
        self._is_running = False
        return False

    def launch_anydesk(self) -> bool:
        """–ó–∞–ø—É—Å—Ç–∏—Ç–∏ AnyDesk"""
        if self.check_if_running():
            return True

        if not self.anydesk_path or not Path(self.anydesk_path).exists():
            logger.error("–®–ª—è—Ö –Ω–µ–≤—ñ–¥–æ–º–∏–π")
            return False

        try:
            logger.info(f"üöÄ –ó–∞–ø—É—Å–∫–∞—é AnyDesk...")
            subprocess.Popen(self.anydesk_path)
            time.sleep(5)

            if self.check_if_running():
                logger.info("‚úÖ AnyDesk –∑–∞–ø—É—â–µ–Ω–æ")
                return True
            else:
                self._is_running = True
                return True
        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞: {e}")
            return False

    def set_password_with_admin(self) -> bool:
        """
        –ó–∞–ø—É—Å–∫–∞—î *—Å–∞–º—É —Å–µ–±–µ* –∑ –∞–¥–º—ñ–Ω –ø—Ä–∞–≤–∞–º–∏ –¥–ª—è –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –ø–∞—Ä–æ–ª—è.
        –ö–æ—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–æ–±–ª—è—î DEV-—Ä–µ–∂–∏–º.
        """
        if not self.anydesk_path:
            logger.error("–®–ª—è—Ö AnyDesk –Ω–µ–≤—ñ–¥–æ–º–∏–π, –Ω–µ –º–æ–∂—É –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –ø–∞—Ä–æ–ª—å")
            return False

        try:
            logger.info(f"üîê –ó–∞–ø—É—Å–∫–∞—é –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –ø–∞—Ä–æ–ª—è –∑ –∞–¥–º—ñ–Ω –ø—Ä–∞–≤–∞–º–∏...")

            # –ü–µ—Ä–µ–¥–∞—Ç–∏ –ø–∞—Ä–æ–ª—å —è–∫ –∑–º—ñ–Ω–Ω—É —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞
            env = os.environ.copy()
            env["ANYDESK_PASSWORD"] = UNATTENDED_PASSWORD

            if getattr(sys, 'frozen', False):
                # –†–µ–∂–∏–º EXE: –∑–∞–ø—É—Å–∫–∞—î–º–æ —Å–∞–º .exe
                executable = sys.executable
                arguments = f'--set-anydesk-password "{self.anydesk_path}"'
                logger.info(f"EXE Mode Admin Lauch: {executable} {arguments}")
            else:
                # –†–µ–∂–∏–º DEV: –∑–∞–ø—É—Å–∫–∞—î–º–æ python.exe + [—Å–∫—Ä–∏–ø—Ç] + [–∞—Ä–≥—É–º–µ–Ω—Ç–∏]
                executable = sys.executable  # python.exe
                # (–û–ù–û–í–õ–ï–ù–û) –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ Path.cwd() –¥–ª—è –∫–æ—Ä–µ–∫—Ç–Ω–æ–≥–æ —à–ª—è—Ö—É –≤ DEV
                script_path = str(Path.cwd() / "dev_run.py")
                arguments = f'"{script_path}" --set-anydesk-password "{self.anydesk_path}"'
                logger.info(f"DEV Mode Admin Lauch: {executable} {arguments}")

            # –ó–∞–ø—É—Å—Ç–∏—Ç–∏ —Å–∫—Ä–∏–ø—Ç –∑ –∞–¥–º—ñ–Ω –ø—Ä–∞–≤–∞–º–∏
            ctypes.windll.shell32.ShellExecuteW(
                None,
                "runas",  # –ó–∞–ø–∏—Ç –∞–¥–º—ñ–Ω –ø—Ä–∞–≤
                executable,  # RemoteHand.exe –∞–±–æ python.exe
                arguments,  # –ê—Ä–≥—É–º–µ–Ω—Ç–∏
                None,
                1  # SW_SHOW - –ø–æ–∫–∞–∑–∞—Ç–∏ –≤—ñ–∫–Ω–æ (UAC)
            )

            logger.info(f"‚úÖ –ó–∞–ø—Ä–æ—Å –∞–¥–º—ñ–Ω –ø—Ä–∞–≤ –Ω–∞–¥—ñ—Å–ª–∞–Ω–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—É")
            return True

        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞ –∑–∞–ø—É—Å–∫—É –∞–¥–º—ñ–Ω-–ø—Ä–æ—Ü–µ—Å—É: {e}")
            import traceback
            traceback.print_exc()
            return False

    def get_connection_id(self) -> Optional[str]:
        """–û—Ç—Ä–∏–º–∞—Ç–∏ ID"""
        if not self.anydesk_path:
            return None

        try:
            logger.info("üìå –û—Ç—Ä–∏–º—É—é ID...")

            result = subprocess.run(
                [self.anydesk_path, '--get-id'],
                capture_output=True,
                text=True,
                timeout=10,
                creationflags=subprocess.CREATE_NO_WINDOW if platform.system() == "Windows" else 0
            )

            if result.returncode == 0:
                connection_id = result.stdout.strip()
                if connection_id and connection_id.isdigit():
                    logger.info(f"‚úÖ ID: {connection_id}")
                    self.connection_id = connection_id
                    return connection_id

        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞: {e}")

        return None

    def start(self, password: str = None) -> Tuple[Optional[str], Optional[str]]:
        """(–û–ù–û–í–õ–ï–ù–û) –ó–∞–ø—É—Å—Ç–∏—Ç–∏ AnyDesk –∑ –æ—á—ñ–∫—É–≤–∞–Ω–Ω—è–º –∞–¥–º—ñ–Ω-–ø—Ä–æ—Ü–µ—Å—É"""
        password = UNATTENDED_PASSWORD

        # –ö—Ä–æ–∫ 1: –Ø–∫—â–æ –≤–∂–µ –∑–∞–ø—É—â–µ–Ω–æ (–Ω—ñ—á–æ–≥–æ –Ω–µ –∑–º—ñ–Ω–∏–ª–æ—Å—å)
        if self.check_if_running():
            logger.info("AnyDesk –≤–∂–µ –∑–∞–ø—É—â–µ–Ω–æ")
            connection_id = self.get_connection_id()
            if connection_id:
                try:
                    user_name = self.config.get("user_name", "")
                    self.telegram.send_anydesk_info(
                        self.config.store_location_text,
                        user_name, socket.gethostname(), connection_id, password
                    )
                except Exception as e:
                    logger.error(f"‚ùå Telegram: {e}")
            return connection_id, password

        # –ö—Ä–æ–∫ 2: –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —è–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ
        if not self.anydesk_path:
            if not self.download_anydesk():
                return None, None

        # –ö—Ä–æ–∫ 3: –ó–∞–ø—É—Å—Ç–∏—Ç–∏
        if not self.launch_anydesk():
            return None, None

        # –ö—Ä–æ–∫ 4: –í–°–¢–ê–ù–û–í–ò–¢–ò –ü–ê–†–û–õ–¨ (–ó –û–ß–Ü–ö–£–í–ê–ù–ù–Ø–ú)
        logger.info("üîê –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –ø–∞—Ä–æ–ª—è...")

        # (–û–ù–û–í–õ–ï–ù–û) –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ C:\ProgramData - —Å–ø—ñ–ª—å–Ω—É –ø–∞–ø–∫—É
        flag_file = Path(os.environ.get("PROGRAMDATA", "C:/")) / ".rh_pass_set_flag"
        logger.info(f"[*] –®–ª—è—Ö –¥–æ –ø—Ä–∞–ø–æ—Ä—Ü—è: {flag_file}")

        if flag_file.exists():
            try:
                os.remove(flag_file)
            except Exception as e:
                logger.warning(f"–ù–µ –≤–¥–∞–ª–æ—Å—è –≤–∏–¥–∞–ª–∏—Ç–∏ —Å—Ç–∞—Ä–∏–π –ø—Ä–∞–ø–æ—Ä–µ—Ü—å: {e}")

        # –ó–∞–ø—É—Å–∫–∞—î–º–æ –∞–¥–º—ñ–Ω-–ø—Ä–æ—Ü–µ—Å
        if not self.set_password_with_admin():
            logger.error("–ù–µ –≤–¥–∞–ª–æ—Å—è –∑–∞–ø—É—Å—Ç–∏—Ç–∏ –∞–¥–º—ñ–Ω-–ø—Ä–æ—Ü–µ—Å.")
            pass

        # (–û–ù–û–í–õ–ï–ù–û) –ß–µ–∫–∞—î–º–æ –Ω–∞ –∞–¥–º—ñ–Ω-–ø—Ä–æ—Ü–µ—Å (–¥–æ 3 —Ö–≤–∏–ª–∏–Ω)
        logger.info("–ß–µ–∫–∞—é –Ω–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è —Ä–æ–±–æ—Ç–∏ –∞–¥–º—ñ–Ω-–ø—Ä–æ—Ü–µ—Å—É (–¥–æ 180 —Å–µ–∫)...")
        password_set = False
        for i in range(180):  # 3 —Ö–≤–∏–ª–∏–Ω–∏
            if flag_file.exists():
                logger.info("‚úÖ –ê–¥–º—ñ–Ω-–ø—Ä–æ—Ü–µ—Å –∑–∞–≤–µ—Ä—à–∏–≤ —Ä–æ–±–æ—Ç—É.")
                try:
                    os.remove(flag_file)
                except:
                    pass
                password_set = True
                break
            time.sleep(1)

        if not password_set:
            logger.warning("‚ö†Ô∏è –ê–¥–º—ñ–Ω-–ø—Ä–æ—Ü–µ—Å –Ω–µ –≤—ñ–¥–ø–æ–≤—ñ–≤ (timeout). –ü—Ä–æ–±—É—é –ø—Ä–æ–¥–æ–≤–∂–∏—Ç–∏...")

        # –ö—Ä–æ–∫ 5: –û—Ç—Ä–∏–º–∞—Ç–∏ ID
        logger.info("üìå –û—Ç—Ä–∏–º–∞–Ω–Ω—è ID...")
        time.sleep(1)  # –î–∞–º–æ AnyDesk —Å–µ–∫—É–Ω–¥—É
        connection_id = self.get_connection_id()

        if not connection_id:
            logger.info("–ü–æ–≤—Ç–æ—Ä–Ω–∞ —Å–ø—Ä–æ–±–∞ –æ—Ç—Ä–∏–º–∞—Ç–∏ ID...")
            time.sleep(3)
            connection_id = self.get_connection_id()

        # –ö—Ä–æ–∫ 6: –ù–∞–¥—ñ—Å–ª–∞—Ç–∏ –≤ Telegram
        try:
            user_name = self.config.get("user_name", "")
            self.telegram.send_anydesk_info(
                self.config.store_location_text,
                user_name,
                socket.gethostname(),
                connection_id if connection_id else "–ù–ï –û–¢–†–ò–ú–ê–ù–û",
                password if password_set else "(–ù–ï –í–°–¢–ê–ù–û–í–õ–ï–ù–û!)"
            )
            logger.info("‚úÖ –¢–µ–ª–µ–≥—Ä–∞–º —Å–ø–æ–≤—ñ—â–µ–Ω–æ")
        except Exception as e:
            logger.error(f"‚ùå –¢–µ–ª–µ–≥—Ä–∞–º –ø–æ–º–∏–ª–∫–∞: {e}")

        logger.info(f"‚úÖ –ì–æ—Ç–æ–≤–æ (ID: {connection_id})")
        return connection_id, password

================================================================================
–§–∞–π–ª 10/21: src\config.py
--------------------------------------------------------------------------------
import os
from pathlib import Path
from dotenv import load_dotenv

# –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ .env
load_dotenv()

APP_NAME = "RemoteHand"
RDP_HOST = "23.88.7.196"
RDP_PORT = 4420
PING_HOST = "23.88.7.196"

# üîí –ó–Ü –ó–ú–Ü–ù–ù–ò–• –°–ï–†–ï–î–û–í–ò–©–ê, –ê –ù–ï –ó .env!
TELEGRAM_TOKEN = os.getenv("TELEGRAM_TOKEN", "")
TELEGRAM_CHAT_ID = os.getenv("TELEGRAM_CHAT_ID", "")

# –§–∞–π–ª–∏
LOCK_FILE = Path.home() / ".remotehand" / "lock"


================================================================================
–§–∞–π–ª 11/21: src\config_manager.py
--------------------------------------------------------------------------------
import json
import os
from pathlib import Path
import logging

logger = logging.getLogger(__name__)


class ConfigManager:
    """–ú–µ–Ω–µ–¥–∂–µ—Ä –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—ó"""

    def __init__(self):
        self.config_dir = Path.home() / ".remotehand"
        self.config_dir.mkdir(exist_ok=True)
        self.config_file = self.config_dir / "config.json"

        self.config = self.load()

    def load(self):
        """–ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –∫–æ–Ω—Ñ—ñ–≥"""
        if self.config_file.exists():
            try:
                with open(self.config_file, 'r', encoding='utf-8') as f:
                    return json.load(f)
            except:
                pass
        return {}

    def save(self):
        """–ó–±–µ—Ä–µ–≥—Ç–∏ –∫–æ–Ω—Ñ—ñ–≥ –≤ JSON —Ñ–∞–π–ª"""
        try:
            with open(self.config_file, 'w', encoding='utf-8') as f:
                json.dump(self.config, f, ensure_ascii=False, indent=2)
        except Exception as e:
            logger.error(f"–ü–æ–º–∏–ª–∫–∞ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –∫–æ–Ω—Ñ—ñ–≥—É: {e}")

    def set(self, key, value):
        """–í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –∑–Ω–∞—á–µ–Ω–Ω—è"""
        self.config[key] = value
        self.save()

    def get(self, key, default=""):
        """–û—Ç—Ä–∏–º–∞—Ç–∏ –∑–Ω–∞—á–µ–Ω–Ω—è"""
        return self.config.get(key, default)

    def is_first_run(self):
        """–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —á–∏ –ø–µ—Ä—à–∏–π –∑–∞–ø—É—Å–∫"""
        store = self.config.get('store', '')
        location = self.config.get('location', '')
        return not store or not location

    @property
    def store_location_text(self):
        """–û—Ç—Ä–∏–º–∞—Ç–∏ —Ç–µ–∫—Å—Ç –º–∞–≥–∞–∑–∏–Ω—É/–ª–æ–∫–∞—Ü—ñ—ó"""
        store = self.config.get('store', '–ù–µ–≤—ñ–¥–æ–º–æ')
        location = self.config.get('location', '–ù–µ–≤—ñ–¥–æ–º–æ')
        return f"{store} / {location}"


================================================================================
–§–∞–π–ª 12/21: src\main.py
--------------------------------------------------------------------------------
import customtkinter as ctk
from tkinter import messagebox
import sys
import os
import threading
import logging
from pathlib import Path
import ctypes
import subprocess
import time

# –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ .env —Ñ–∞–π–ª
from dotenv import load_dotenv

load_dotenv()

# –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –ª–æ–≥—É–≤–∞–Ω–Ω—è
logging.basicConfig(
    level=logging.INFO,
    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s'
)
logger = logging.getLogger(__name__)

# ============ –ü–ï–†–ï–í–Ü–†–ö–ê DEV –†–ï–ñ–ò–ú–£ ============
DEV_MODE = os.getenv('REMOTEHAND_DEV_MODE') == '1'
logger.info(f"{'üîß DEV –†–ï–ñ–òM' if DEV_MODE else '‚úÖ PRODUCTION –†–ï–ñ–ò–ú'}")

if not DEV_MODE:
    # –¢–Ü–õ–¨–ö–ò –í PRODUCTION
    try:
        from updater import check_and_update

        check_and_update()
    except Exception as e:
        logger.warning(f"–ü–æ–º–∏–ª–∫–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –æ–Ω–æ–≤–ª–µ–Ω—å: {e}")

# ============ –Ü–ú–ü–û–†–¢–ò ============
from utils import close_all_rdp_sessions, test_connection
from config import RDP_HOST, RDP_PORT, PING_HOST, APP_NAME

# –ù–æ–≤—ñ —ñ–º–ø–æ—Ä—Ç–∏
from config_manager import ConfigManager
from telegram_api import TelegramAPI
from setup_wizard import SetupWizard
from network_test import NetworkTest

try:
    from rdp_manager import RDPManager

    rdp_manager_available = True
except ImportError as e:
    rdp_manager_available = False
    logger.warning(f"rdp_manager –Ω–µ –¥–æ—Å—Ç—É–ø–Ω–∞: {e}")

try:
    from anydesk_manager import AnyDeskManager

    anydesk_available = True
except ImportError as e:
    anydesk_available = False
    logger.warning(f"anydesk_manager –Ω–µ –¥–æ—Å—Ç—É–ø–Ω–∞: {e}")

# ============ –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —Å—Ç–∏–ª—é iOS ============
IOS_BG_COLOR = "#f2f2f7"  # –°–≤—ñ—Ç–ª–æ-—Å—ñ—Ä–∏–π —Ñ–æ–Ω
IOS_CARD_COLOR = "#ffffff"  # –ë—ñ–ª—ñ –∫–∞—Ä—Ç–∫–∏
IOS_TEXT_COLOR = "#000000"  # –ß–æ—Ä–Ω–∏–π —Ç–µ–∫—Å—Ç
IOS_SUBTEXT_COLOR = "#8A8A8E"  # –°—ñ—Ä–∏–π –ø—ñ–¥–ø–∏—Å
IOS_CARD_BORDER = "#E0E0E0"  # –õ–µ–¥—å –ø–æ–º—ñ—Ç–Ω–∞ —Ä–∞–º–∫–∞ –∫–∞—Ä—Ç–∫–∏
IOS_CARD_RADIUS = 15
IOS_BUTTON_RADIUS = 12


class RemoteHandApp(ctk.CTk):

    def get_resource_path(self, relative_path):
        """ (–ù–û–í–ï) –û—Ç—Ä–∏–º–∞—Ç–∏ –∫–æ—Ä–µ–∫—Ç–Ω–∏–π —à–ª—è—Ö –¥–æ —Ä–µ—Å—É—Ä—Å—É (–¥–ª—è .exe —Ç–∞ DEV) """
        try:
            # PyInstaller —Å—Ç–≤–æ—Ä—é—î —Ç–∏–º—á–∞—Å–æ–≤—É –ø–∞–ø–∫—É _MEIPASS
            base_path = Path(sys._MEIPASS)
        except Exception:
            # –í DEV-—Ä–µ–∂–∏–º—ñ _MEIPASS –Ω–µ —ñ—Å–Ω—É—î, –±–µ—Ä–µ–º–æ –∫–æ—Ä—ñ–Ω—å –ø—Ä–æ—î–∫—Ç—É
            base_path = Path.cwd()

        return base_path / relative_path

    def __init__(self):
        super().__init__()

        # –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –≤—ñ–∫–Ω–∞
        self.title(APP_NAME)
        self.geometry("520x800")
        self.resizable(True, True)

        ctk.set_appearance_mode("light")
        ctk.set_default_color_theme("blue")
        self.configure(fg_color=IOS_BG_COLOR)

        # (–û–ù–û–í–õ–ï–ù–û) –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è —ñ–∫–æ–Ω–∫–∏
        try:
            icon_path = self.get_resource_path("assets/icon.ico")
            if icon_path.exists():
                self.iconbitmap(icon_path)
                logger.info(f"–Ü–∫–æ–Ω–∫—É —É—Å–ø—ñ—à–Ω–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ –∑: {icon_path}")
            else:
                logger.warning(f"–Ü–∫–æ–Ω–∫—É –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ –∑–∞ —à–ª—è—Ö–æ–º: {icon_path}")
        except Exception as e:
            logger.error(f"–ü–æ–º–∏–ª–∫–∞ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è —ñ–∫–æ–Ω–∫–∏: {e}")

        # –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è –º–µ–Ω–µ–¥–∂–µ—Ä—ñ–≤
        self.config = ConfigManager()

        telegram_token = os.getenv("TELEGRAM_TOKEN") or self.config.get("telegram_token")
        telegram_chat_id = os.getenv("TELEGRAM_CHAT_ID") or self.config.get("telegram_chat_id")

        logger.info(f"Telegram token: {'‚úÖ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ' if telegram_token else '‚ùå –ù–ï –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ'}")
        logger.info(f"Telegram chat_id: {'‚úÖ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ' if telegram_chat_id else '‚ùå –ù–ï –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ'}")

        self.telegram = TelegramAPI(telegram_token, telegram_chat_id)

        if rdp_manager_available:
            self.rdp_manager = RDPManager(self.config, self.telegram)
        else:
            self.rdp_manager = None

        if anydesk_available:
            self.anydesk_manager = AnyDeskManager(self.config, self.telegram)
        else:
            self.anydesk_manager = None

        self.network_test = NetworkTest(self.config, self.telegram)

        self.setup_ui()

        if self.config.is_first_run():
            self.show_setup_wizard()

    def get_app_version(self):
        """–û—Ç—Ä–∏–º–∞—Ç–∏ –≤–µ—Ä—Å—ñ—é –ø—Ä–æ–≥—Ä–∞–º–∏ (–∑ –æ–±—Ä–æ–±–∫–æ—é –∫–æ–¥—É–≤–∞–Ω—å)"""
        try:
            # (–ù–û–í–ï) –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ —Ö–µ–ª–ø–µ—Ä
            version_file = self.get_resource_path("version.txt")

            if not version_file.exists():
                logger.warning(f"–ù–µ –∑–Ω–∞–π–¥–µ–Ω–æ version.txt —É {version_file}")
                return "1.0.0"  # Fallback

            try:
                # –°–ø—Ä–æ–±—É–≤–∞—Ç–∏ UTF-8-SIG (—Å—Ç–∞–Ω–¥–∞—Ä—Ç –∑ BOM)
                return version_file.read_text(encoding='utf-8-sig').strip()
            except UnicodeDecodeError:
                try:
                    # –Ø–∫—â–æ –Ω–µ –≤–∏–π—à–ª–æ (byte 0xff), —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ UTF-16
                    logger.warning("version.txt –Ω–µ –≤ UTF-8, –ø—Ä–æ–±—É—é UTF-16...")
                    return version_file.read_text(encoding='utf-16').strip()
                except Exception as e_inner:
                    logger.error(f"–ù–µ –≤–¥–∞–ª–æ—Å—è –ø—Ä–æ—á–∏—Ç–∞—Ç–∏ version.txt –Ω—ñ –≤ UTF-8, –Ω—ñ –≤ UTF-16: {e_inner}")
            except Exception as e_outer:
                logger.error(f"–ü–æ–º–∏–ª–∫–∞ —á–∏—Ç–∞–Ω–Ω—è –≤–µ—Ä—Å—ñ—ó: {e_outer}")

        except Exception as e:
            logger.error(f"–ö—Ä–∏—Ç–∏—á–Ω–∞ –ø–æ–º–∏–ª–∫–∞ get_app_version: {e}")

        return "1.0.0"  # –ó–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º

    def show_setup_wizard(self):
        """–ü–æ–∫–∞–∑–∞—Ç–∏ –≤—ñ–∫–Ω–æ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –ø—Ä–∏ –ø–µ—Ä—à–æ–º—É –∑–∞–ø—É—Å–∫—É"""

        def on_setup_complete(result):
            self.config.set("store", result["store"])
            self.config.set("location", result["location"])
            if result.get("user_name"):
                self.config.set("user_name", result["user_name"])
            self.refresh_ui()

        wizard = SetupWizard(self, on_setup_complete)
        self.wait_window(wizard)

    def refresh_ui(self):
        """–û–Ω–æ–≤–∏—Ç–∏ UI –ø—ñ—Å–ª—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è"""
        user_info = self.config.store_location_text
        user_name = self.config.get("user_name", "")
        if user_name:
            user_info += f" | üë§ {user_name}"

        self.info_label.configure(text=f"üìç {user_info}")

    def setup_ui(self):
        """–°—Ç–≤–æ—Ä–µ–Ω–Ω—è UI –≤ —Å—Ç–∏–ª—ñ iOS (–∫–æ–º–ø–∞–∫—Ç–Ω–æ)"""

        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        title_label = ctk.CTkLabel(
            self,
            text="RemoteHand",
            font=ctk.CTkFont(size=28, weight="bold"),
            text_color=IOS_TEXT_COLOR
        )
        title_label.pack(pady=(10, 0), padx=20, anchor="w")

        # –Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ –º–∞–≥–∞–∑–∏–Ω/–ª–æ–∫–∞—Ü—ñ—é + –ü–Ü–ë
        user_info = self.config.store_location_text
        user_name = self.config.get("user_name", "")
        if user_name:
            user_info += f" | üë§ {user_name}"

        self.info_label = ctk.CTkLabel(
            self,
            text=f"üìç {user_info}",
            font=ctk.CTkFont(size=12),
            text_color=IOS_SUBTEXT_COLOR
        )
        self.info_label.pack(pady=(0, 15), padx=20, anchor="w")

        # ==================== RDP –ë–õ–û–ö (–ö–ê–†–¢–ö–ê 1) ====================
        rdp_frame = ctk.CTkFrame(
            self,
            fg_color=IOS_CARD_COLOR,
            corner_radius=IOS_CARD_RADIUS,
            border_width=1,
            border_color=IOS_CARD_BORDER
        )
        rdp_frame.pack(pady=8, padx=20, fill="x")

        ctk.CTkLabel(
            rdp_frame,
            text="–ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ 1–°",
            font=ctk.CTkFont(size=13, weight="bold"),
            text_color=IOS_TEXT_COLOR
        ).pack(anchor="w", pady=(10, 10), padx=15)

        rdp_btn = ctk.CTkButton(
            rdp_frame,
            text="üñ•Ô∏è –í—ñ–¥–∫—Ä–∏—Ç–∏ 1–° (RDP)",
            command=self.open_rdp,
            height=50,
            font=ctk.CTkFont(size=12, weight="bold"),
            corner_radius=IOS_BUTTON_RADIUS,
            fg_color="#007AFF",
            hover_color="#0051D5"
        )
        rdp_btn.pack(fill="x", pady=(0, 15), padx=15)

        # ==================== ANYDESK –ë–õ–û–ö (–ö–ê–†–¢–ö–ê 2) ====================
        if anydesk_available:
            anydesk_frame = ctk.CTkFrame(
                self,
                fg_color=IOS_CARD_COLOR,
                corner_radius=IOS_CARD_RADIUS,
                border_width=1,
                border_color=IOS_CARD_BORDER
            )
            anydesk_frame.pack(pady=8, padx=20, fill="x")

            ctk.CTkLabel(
                anydesk_frame,
                text="–í—ñ–¥–¥–∞–ª–µ–Ω–∏–π –¥–æ—Å—Ç—É–ø",
                font=ctk.CTkFont(size=13, weight="bold"),
                text_color=IOS_TEXT_COLOR
            ).pack(anchor="w", pady=(10, 10), padx=15)

            anydesk_btn = ctk.CTkButton(
                anydesk_frame,
                text="üöÄ –ó–∞–ø—É—Å—Ç–∏—Ç–∏ AnyDesk",
                command=self.start_anydesk,
                height=50,
                font=ctk.CTkFont(size=12, weight="bold"),
                corner_radius=IOS_BUTTON_RADIUS,
                fg_color="#FF6B35",
                hover_color="#CC5529"
            )
            anydesk_btn.pack(fill="x", pady=(0, 15), padx=15)

        # ==================== –î–Ü–ê–ì–ù–û–°–¢–ò–ö–ê (–ö–ê–†–¢–ö–ê 3) ====================
        test_frame = ctk.CTkFrame(
            self,
            fg_color=IOS_CARD_COLOR,
            corner_radius=IOS_CARD_RADIUS,
            border_width=1,
            border_color=IOS_CARD_BORDER
        )
        test_frame.pack(pady=8, padx=20, fill="x")

        ctk.CTkLabel(
            test_frame,
            text="–î—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —Ç–∞ –£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è",
            font=ctk.CTkFont(size=13, weight="bold"),
            text_color=IOS_TEXT_COLOR
        ).pack(anchor="w", pady=(10, 10), padx=15)

        test_btn = ctk.CTkButton(
            test_frame,
            text="üì° –¢–µ—Å—Ç –∑'—î–¥–Ω–∞–Ω–Ω—è",
            command=self.run_network_test,
            height=50,
            font=ctk.CTkFont(size=12, weight="bold"),
            corner_radius=IOS_BUTTON_RADIUS,
            fg_color="#34C759",
            hover_color="#248A3D"
        )
        test_btn.pack(fill="x", pady=(0, 10), padx=15)

        # –†–æ–∑–¥—ñ–ª—é–≤–∞—á
        separator = ctk.CTkFrame(test_frame, height=1, fg_color=IOS_CARD_BORDER)
        separator.pack(fill="x", padx=15, pady=5)

        close_sessions_btn = ctk.CTkButton(
            test_frame,
            text="‚ùå –ó–∞–∫—Ä–∏—Ç–∏ –≤—Å—ñ RDP —Å–µ—Å—ñ—ó",
            command=self.close_sessions_confirm,
            height=45,
            font=ctk.CTkFont(size=12, weight="bold"),
            corner_radius=IOS_BUTTON_RADIUS,
            fg_color="#FF3B30",
            hover_color="#D70015"
        )
        close_sessions_btn.pack(fill="x", pady=(10, 15), padx=15)

        # ==================== –ù–ê–õ–ê–®–¢–£–í–ê–ù–ù–Ø (–ö–ê–†–¢–ö–ê 4) ====================
        settings_frame = ctk.CTkFrame(
            self,
            fg_color=IOS_CARD_COLOR,
            corner_radius=IOS_CARD_RADIUS,
            border_width=1,
            border_color=IOS_CARD_BORDER
        )
        settings_frame.pack(pady=8, padx=20, fill="x")

        settings_btn = ctk.CTkButton(
            settings_frame,
            text="‚öôÔ∏è –ó–º—ñ–Ω–∏—Ç–∏ –º–∞–≥–∞–∑–∏–Ω/–ª–æ–∫–∞—Ü—ñ—é/–ü–Ü–ë",
            command=self.show_setup_wizard,
            height=40,
            font=ctk.CTkFont(size=11),
            corner_radius=IOS_BUTTON_RADIUS,
            fg_color="#999999",
            hover_color="#666666"
        )
        settings_btn.pack(fill="x", pady=15, padx=15)

        # ==================== –°–¢–ê–¢–£–° (–í–Ω–∏–∑—É) ====================
        self.status_label = ctk.CTkLabel(
            self,
            text="‚úÖ –ì–æ—Ç–æ–≤–æ –¥–æ —Ä–æ–±–æ—Ç–∏",
            font=ctk.CTkFont(size=10),
            text_color=IOS_SUBTEXT_COLOR
        )
        self.status_label.pack(pady=8)

        # ==================== –í–ï–†–°–Ü–Ø (–í–Ω–∏–∑—É) ====================
        version_frame = ctk.CTkFrame(self, fg_color="transparent")
        version_frame.pack(anchor="s", pady=(0, 8))

        version_label = ctk.CTkLabel(
            version_frame,
            text=f"v{self.get_app_version()}",
            font=ctk.CTkFont(size=9, weight="bold"),
            text_color=IOS_SUBTEXT_COLOR
        )
        version_label.pack(side="left", padx=5)

        self.update_status_label = ctk.CTkLabel(
            version_frame,
            text="‚úÖ",
            font=ctk.CTkFont(size=10),
            text_color="green"
        )
        self.update_status_label.pack(side="left", padx=5)

    def open_rdp(self):
        """–í—ñ–¥–∫—Ä–∏—Ç–∏ RDP"""
        if not self.rdp_manager:
            messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "RDP –º–µ–Ω–µ–¥–∂–µ—Ä –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω")
            return

        saved_password = self.rdp_manager.get_credentials(RDP_HOST, "admin")

        if saved_password:
            self.set_status("‚è≥ –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è...", "processing")

            def connect():
                try:
                    if self.rdp_manager.connect_rdp(RDP_HOST, RDP_PORT, "admin", saved_password):
                        self.set_status("‚úÖ –ü—ñ–¥–∫–ª—é—á–µ–Ω–æ", "success")
                    else:
                        self.set_status("‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è", "error")
                except Exception as e:
                    logger.error(f"–ü–æ–º–∏–ª–∫–∞: {e}")
                    self.set_status("‚ùå –ö—Ä–∏—Ç–∏—á–Ω–∞ –ø–æ–º–∏–ª–∫–∞", "error")

            thread = threading.Thread(target=connect, daemon=True)
            thread.start()
        else:
            dialog = ctk.CTkInputDialog(
                text="–í–≤–µ–¥—ñ—Ç—å –ø–∞—Ä–æ–ª—å –¥–ª—è RDP:",
                title="–ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –¥–æ 1–°"
            )
            password = dialog.get_input()

            if password:
                self.set_status("üíæ –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è –ø–∞—Ä–æ–ª—è...", "processing")
                if self.rdp_manager.connect_rdp(RDP_HOST, RDP_PORT, "admin", password):
                    self.rdp_manager.save_credentials(RDP_HOST, "admin", password)
                    self.set_status("‚úÖ –£—Å–ø—ñ—à–Ω–æ –ø—ñ–¥–∫–ª—é—á–µ–Ω–æ", "success")
                else:
                    self.set_status("‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è", "error")

    def close_sessions_confirm(self):
        """–ü—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è –∑–∞–∫—Ä–∏—Ç—Ç—è —Å–µ—Å—ñ–π"""
        result = messagebox.askyesno(
            "–ü—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è",
            "–í–∏ –≤–ø–µ–≤–Ω–µ–Ω—ñ, —â–æ —Ö–æ—á–µ—Ç–µ –∑–∞–∫—Ä–∏—Ç–∏ –≤—Å—ñ RDP —Å–µ—Å—ñ—ó?"
        )
        if result:
            self.set_status("‚è≥ –ó–∞–∫—Ä–∏—Ç—Ç—è —Å–µ—Å—ñ–π...", "processing")
            close_all_rdp_sessions()
            self.set_status("‚úÖ –í—Å—ñ —Å–µ—Å—ñ—ó –∑–∞–∫—Ä–∏—Ç–æ", "success")

    def start_anydesk(self):
        """–ó–∞–ø—É—Å—Ç–∏—Ç–∏ AnyDesk - –ë–ï–ó –ø–æ–∫–∞–∑—É –ø–∞—Ä–æ–ª—è!"""
        if not self.anydesk_manager:
            messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "AnyDesk –º–µ–Ω–µ–¥–∂–µ—Ä –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω")
            return

        self.set_status("‚è≥ –ó–∞–ø—É—Å–∫ AnyDesk...", "processing")

        def anydesk_task():
            try:
                anydesk_id, pwd = self.anydesk_manager.start(None)

                if anydesk_id:
                    self.set_status(f"‚úÖ AnyDesk –∑–∞–ø—É—â–µ–Ω–æ\nüÜî ID: {anydesk_id}", "success")
                    messagebox.showinfo(
                        "‚úÖ AnyDesk –∑–∞–ø—É—â–µ–Ω–æ",
                        f"ID –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è: {anydesk_id}\n\n"
                        f"–î–∞–Ω—ñ –Ω–∞–¥—ñ—Å–ª–∞–Ω—ñ –≤ Telegram\n"
                        f"–ü–∞—Ä–æ–ª—å –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ"
                    )
                else:
                    self.set_status("‚ùå –ü–æ–º–∏–ª–∫–∞ AnyDesk", "error")
                    messagebox.showwarning(
                        "‚ö†Ô∏è –£–≤–∞–≥–∞",
                        "–ù–µ –≤–¥–∞–ª–æ—Å—è –∑–∞–ø—É—Å—Ç–∏—Ç–∏ AnyDesk –∞–±–æ –æ—Ç—Ä–∏–º–∞—Ç–∏ ID."
                    )
            except Exception as e:
                logger.error(f"–ü–æ–º–∏–ª–∫–∞: {e}")
                self.set_status("‚ùå –ü–æ–º–∏–ª–∫–∞ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è", "error")

        thread = threading.Thread(target=anydesk_task, daemon=True)
        thread.start()

    def run_network_test(self):
        """–ó–∞–ø—É—Å—Ç–∏—Ç–∏ —Ç–µ—Å—Ç –º–µ—Ä–µ–∂—ñ"""
        self.set_status("‚è≥ –¢–µ—Å—Ç –º–µ—Ä–µ–∂—ñ...", "processing")

        def test_task():
            try:
                result = self.network_test.run_full_test()
                self.set_status(f"{result['status']}", result['color'])
            except Exception as e:
                logger.error(f"–ü–æ–º–∏–ª–∫–∞ —Ç–µ—Å—Ç—É: {e}")
                self.set_status("‚ùå –ü–æ–º–∏–ª–∫–∞ —Ç–µ—Å—Ç—É", "error")

        thread = threading.Thread(target=test_task, daemon=True)
        thread.start()

    def set_status(self, text, status_type="info"):
        """–í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ —Å—Ç–∞—Ç—É—Å –∑ –∫–æ–ª—å–æ—Ä–æ–º"""
        color_map = {
            "success": "green",
            "error": "red",
            "processing": "blue",
            "info": "gray"
        }
        self.status_label.configure(text=text, text_color=color_map.get(status_type, "gray"))


def run_password_setter(anydesk_path, password):
    """
    (–û–ù–û–í–õ–ï–ù–û)
    –¶—è —Ñ—É–Ω–∫—Ü—ñ—è –≤–∏–∫–æ–Ω—É—î –ª–æ–≥—ñ–∫—É –∑ set_anydesk_password.py.
    –í–æ–Ω–∞ –∑–∞–ø—É—Å–∫–∞—î—Ç—å—Å—è –¢–Ü–õ–¨–ö–ò –∫–æ–ª–∏ –ø—Ä–æ–≥—Ä–∞–º–∞ –∑–∞–ø—É—â–µ–Ω–∞ –∑ –∞–¥–º—ñ–Ω –ø—Ä–∞–≤–∞–º–∏
    —Ç–∞ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–º --set-anydesk-password.
    –°–¢–í–û–†–Æ–Ñ –§–ê–ô–õ-–ü–†–ê–ü–û–†–ï–¶–¨ –ü–Ü–°–õ–Ø –ó–ê–í–ï–†–®–ï–ù–ù–Ø.
    """

    # (–û–ù–û–í–õ–ï–ù–û) –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ C:\ProgramData - —Å–ø—ñ–ª—å–Ω—É –ø–∞–ø–∫—É
    # os.environ['PROGRAMDATA'] - —Ü–µ –Ω–∞–¥—ñ–π–Ω–∏–π —Å–ø–æ—Å—ñ–± –æ—Ç—Ä–∏–º–∞—Ç–∏ 'C:\ProgramData'
    FLAG_FILE_PATH = Path(os.environ.get("PROGRAMDATA", "C:/")) / ".rh_pass_set_flag"

    logger.info(f"[*] –ó–∞–ø—É—Å–∫ –≤ —Ä–µ–∂–∏–º—ñ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –ø–∞—Ä–æ–ª—è –¥–ª—è: {anydesk_path}")
    logger.info(f"[*] –®–ª—è—Ö –¥–æ –ø—Ä–∞–ø–æ—Ä—Ü—è: {FLAG_FILE_PATH}")

    try:
        is_admin = ctypes.windll.shell32.IsUserAnAdmin()
        if not is_admin:
            logger.error("[!] –ü–æ—Ç—Ä—ñ–±–Ω—ñ –∞–¥–º—ñ–Ω –ø—Ä–∞–≤–∞ –¥–ª—è --set-anydesk-password")
            sys.exit(1)
    except Exception as e:
        logger.error(f"[!] –ù–µ –≤–¥–∞–ª–æ—Å—è –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –ø—Ä–∞–≤–∞: {e}")
        sys.exit(1)

    if not anydesk_path or not os.path.exists(anydesk_path):
        logger.error(f"[!] –®–ª—è—Ö AnyDesk –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ: {anydesk_path}")
        sys.exit(1)

    try:
        logger.info(f"[*] –í—Å—Ç–∞–Ω–æ–≤–ª—é—é –ø–∞—Ä–æ–ª—å AnyDesk (—É –∞–¥–º—ñ–Ω —Ä–µ–∂–∏–º—ñ)...")
        time.sleep(1)

        cmd = [anydesk_path, "--set-password", "_full_access"]

        result = subprocess.run(
            cmd,
            input=password + "\n",
            capture_output=True,
            text=True,
            timeout=10,
            creationflags=subprocess.CREATE_NO_WINDOW
        )

        logger.info(f"[CODE] {result.returncode}")
        if result.returncode in [0, 8000]:
            logger.info("[‚úì] –ü–∞—Ä–æ–ª—å –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ!")
        else:
            logger.error(f"[!] –ö–æ–¥ –ø–æ–º–∏–ª–∫–∏: {result.returncode}")
            logger.error(f"[STDOUT] {result.stdout}")
            logger.error(f"[STDERR] {result.stderr}")

        # (–û–ù–û–í–õ–ï–ù–û) –°—Ç–≤–æ—Ä—é—î–º–æ –ø—Ä–∞–ø–æ—Ä–µ—Ü—å, —â–æ —Ä–æ–±–æ—Ç–∞ –≤–∏–∫–æ–Ω–∞–Ω–∞
        try:
            with open(FLAG_FILE_PATH, 'w') as f:
                f.write('ok')
            logger.info(f"–°—Ç–≤–æ—Ä–µ–Ω–æ –ø—Ä–∞–ø–æ—Ä–µ—Ü—å: {FLAG_FILE_PATH}")
        except Exception as e:
            logger.error(f"–ù–µ –≤–¥–∞–ª–æ—Å—è —Å—Ç–≤–æ—Ä–∏—Ç–∏ –ø—Ä–∞–ø–æ—Ä–µ—Ü—å: {e}")

        sys.exit(0)

    except Exception as e:
        logger.error(f"[!] –ö—Ä–∏—Ç–∏—á–Ω–∞ –ø–æ–º–∏–ª–∫–∞: {e}")
        sys.exit(1)


def main():
    """–ì–æ–ª–æ–≤–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è"""
    if len(sys.argv) > 1 and sys.argv[1] == '--set-anydesk-password':
        try:
            anydesk_path = sys.argv[2] if len(sys.argv) > 2 else None
            password = os.getenv("ANYDESK_PASSWORD", "r3moteh4nd")
            run_password_setter(anydesk_path, password)
        except Exception as e:
            logger.error(f"–ü–æ–º–∏–ª–∫–∞ –∑–∞–ø—É—Å–∫—É password_setter: {e}")
            sys.exit(1)
        sys.exit(0)

    logger.info("–ó–∞–ø—É—Å–∫ RemoteHand...")
    app = RemoteHandApp()
    app.mainloop()


if __name__ == "__main__":
    main()

================================================================================
–§–∞–π–ª 13/21: src\network_test.py
--------------------------------------------------------------------------------
import subprocess
import re
import socket
import logging
from pathlib import Path
import tempfile

logger = logging.getLogger(__name__)


class NetworkTest:
    """–¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è –º–µ—Ä–µ–∂—ñ –∑ –∑–≤—ñ—Ç–æ–º"""

    def __init__(self, config_manager, telegram_api):
        self.config = config_manager
        self.telegram = telegram_api

    def run_ping_test(self, host, count=20):
        """–í–∏–∫–æ–Ω–∞—Ç–∏ ping —Ç–µ—Å—Ç –Ω–∞ —Ö–æ—Å—Ç—É"""
        try:
            result = subprocess.run(
                ['ping', host, '-n', str(count)],
                capture_output=True,
                text=True,
                encoding='cp1252',
                timeout=60,
                creationflags=subprocess.CREATE_NO_WINDOW
            )
            return result.stdout
        except Exception as e:
            logger.error(f"–ü–æ–º–∏–ª–∫–∞ ping: {e}")
            return f"–ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—ñ {host}: {str(e)}"

    def parse_ping_loss(self, ping_output):
        """–í–∏—Ç—è–≥—Ç–∏ –≤—ñ–¥—Å–æ—Ç–æ–∫ –≤—Ç—Ä–∞—Ç–∏ –ø–∞–∫–µ—Ç—ñ–≤"""
        try:
            match = re.search(r'(\d+)%\s+(–ø–æ—Ç–µ—Ä—å|loss)', ping_output, re.IGNORECASE)
            if match:
                return int(match.group(1))
            return 0
        except:
            return -1

    def run_full_test(self):
        """(–û–ù–û–í–õ–ï–ù–û) –ó–∞–ø—É—Å—Ç–∏—Ç–∏ –ø–æ–≤–Ω–∏–π —Ç–µ—Å—Ç –º–µ—Ä–µ–∂—ñ"""
        pc_name = socket.gethostname()
        store_location = self.config.store_location_text
        # (–ù–û–í–ï) –û—Ç—Ä–∏–º—É—î–º–æ –ü–Ü–ë
        user_name = self.config.get("user_name", "")

        hosts = {
            "1–° –°–µ—Ä–≤–µ—Ä": "23.88.7.196",
            "Google DNS": "8.8.8.8"
        }

        report_parts = []
        total_loss = 0

        for name, ip in hosts.items():
            ping_output = self.run_ping_test(ip)
            loss = self.parse_ping_loss(ping_output)

            if loss >= 0:
                status = "‚úÖ" if loss == 0 else ("‚ö†Ô∏è" if loss <= 15 else "‚ùå")
                report_parts.append(f"{status} {name} ({ip}): {loss}% –≤—Ç—Ä–∞—Ç–∏")
                total_loss += loss
            else:
                report_parts.append(f"‚ùå {name} ({ip}): –ü–æ–º–∏–ª–∫–∞ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è")

        avg_loss = total_loss / len(hosts) if hosts else 0

        if avg_loss == 0:
            status_text = "‚úÖ –ú–µ—Ä–µ–∂–∞ –≤ –Ω–æ—Ä–º—ñ"
            color = "green"
        elif avg_loss <= 15:
            status_text = "‚ö†Ô∏è –Ñ –Ω–µ–≤–µ–ª–∏–∫—ñ –ø—Ä–æ–±–ª–µ–º–∏"
            color = "orange"
        else:
            status_text = "‚ùå –°–µ—Ä–π–æ–∑–Ω—ñ –ø—Ä–æ–±–ª–µ–º–∏"
            color = "red"

        # (–û–ù–û–í–õ–ï–ù–û) –í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ –≤ Telegram —Ä–∞–∑–æ–º –∑ –ü–Ü–ë
        test_report = "\n".join(report_parts)
        self.telegram.send_network_report(store_location, pc_name, test_report, user_name)

        return {
            "status": status_text,
            "color": color,
            "details": test_report
        }

================================================================================
–§–∞–π–ª 14/21: src\rdp_manager.py
--------------------------------------------------------------------------------
import os
import subprocess
import time
import winreg
import logging
import keyring
from pathlib import Path

logger = logging.getLogger(__name__)


class RDPManager:
    """–ú–µ–Ω–µ–¥–∂–µ—Ä –¥–ª—è RDP –ø—ñ–¥–∫–ª—é—á–µ–Ω—å –∑ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–º –ª–æ–≥—ñ–Ω–æ–º"""

    def __init__(self, config_manager, telegram_api):
        self.config = config_manager
        self.telegram = telegram_api

    def save_credentials(self, host, username, password):
        """–ó–±–µ—Ä–µ–≥—Ç–∏ RDP –¥–∞–Ω—ñ –≤ Windows Credential Manager"""
        try:
            keyring.set_password(f"RDP_{host}", username, password)
            self.config.set("rdp_password", password)
            logger.info(f"‚úÖ –î–∞–Ω—ñ –∑–±–µ—Ä–µ–∂–µ–Ω—ñ –¥–ª—è {host}")
            return True
        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è: {e}")
            return False

    def get_credentials(self, host, username):
        """–û—Ç—Ä–∏–º–∞—Ç–∏ –ø–∞—Ä–æ–ª—å –∑ Credential Manager"""
        try:
            password = keyring.get_password(f"RDP_{host}", username)
            return password
        except:
            return None

    def connect_rdp(self, host, port, username, password=None):
        """–ü—ñ–¥–∫–ª—é—á–∏—Ç–∏—Å—è –¥–æ RDP"""
        try:
            # –ö–æ–¥—É–≤–∞–Ω–Ω—è –ø–∞—Ä–æ–ª—è –¥–ª—è .RDP —Ñ–∞–π–ª—É
            encrypted_password = self._encrypt_rdp_password(password) if password else ""

            rdp_content = f"""screen mode id:i:2
use multimon:i:0
desktopwidth:i:1920
desktopheight:i:1080
session bpp:i:32
connection type:i:7
disable wallpaper:i:0
allow font smoothing:i:1
allow desktop composition:i:1
disable full window drag:i:0
disable menu anims:i:0
disable themes:i:0
disable cursor setting:i:0
bitmapcachepersistenable:i:1
full address:s:{host}:{port}
audiomode:i:0
redirectprinters:i:0
redirectcomports:i:0
redirectsmartcards:i:0
redirectclipboard:i:1
redirectposdevices:i:0
autoreconnection enabled:i:1
authentication level:i:0
prompt for credentials on client:i:0
negotiate security layer:i:1
enablecredsspsupport:i:1
username:s:{username}
password 51:b:{encrypted_password}
"""

            rdp_file = f"{host}_{username}_session.rdp"
            with open(rdp_file, "w") as f:
                f.write(rdp_content)

            subprocess.Popen(f"mstsc {rdp_file}")
            logger.info(f"‚úÖ RDP –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –∑–∞–ø—É—â–µ–Ω–æ")

            # –í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ –≤ Telegram
#            self.telegram.send_rdp_info(
#                self.config.store_location_text,
#                os.environ.get('COMPUTERNAME', 'Unknown')
#            )

            return True
        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è: {e}")
            return False

    def _encrypt_rdp_password(self, password):
        """–ü—Ä–æ—Å—Ç–æ–µ —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è –ø–∞—Ä–æ–ª—è –¥–ª—è .RDP"""
        encrypted = ""
        for char in password:
            encrypted += format(ord(char) ^ 0xAA, '02x')
        return encrypted


================================================================================
–§–∞–π–ª 15/21: src\setup_wizard.py
--------------------------------------------------------------------------------
import customtkinter as ctk
import tkinter.messagebox as messagebox

# (–ù–û–í–ï) –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —Å—Ç–∏–ª—é iOS
IOS_BG_COLOR = "#f2f2f7"
IOS_CARD_COLOR = "#ffffff"
IOS_TEXT_COLOR = "#000000"
IOS_CARD_BORDER = "#E0E0E0"
IOS_CARD_RADIUS = 15
IOS_BUTTON_RADIUS = 12


class SetupWizard(ctk.CTkToplevel):
    def __init__(self, parent, on_complete):
        super().__init__(parent)

        self.title("RemoteHand - –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è")
        self.geometry("450x520")
        self.resizable(False, False)

        # (–û–ù–û–í–õ–ï–ù–û) –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è —Ñ–æ–Ω—É
        self.configure(fg_color=IOS_BG_COLOR)

        self.transient(parent)
        self.grab_set()
        self.protocol("WM_DELETE_WINDOW", self.on_closing)

        self.on_complete = on_complete
        self.setup_complete = False

        ctk.set_appearance_mode("light")
        ctk.set_default_color_theme("blue")

        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        title = ctk.CTkLabel(
            self,
            text="–ü–µ—Ä—à–µ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è",
            font=ctk.CTkFont(size=22, weight="bold"),
            text_color=IOS_TEXT_COLOR
        )
        title.pack(pady=20, padx=20, anchor="w")

        subtitle = ctk.CTkLabel(
            self,
            text="–í–∫–∞–∂—ñ—Ç—å, –¥–µ –∑–Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è —Ü–µ–π –∫–æ–º–ø'—é—Ç–µ—Ä.",
            font=ctk.CTkFont(size=13),
            text_color="#8A8A8E"
        )
        subtitle.pack(pady=(0, 20), padx=20, anchor="w")

        # (–ù–û–í–ï) –ö–∞—Ä—Ç–∫–∞ –¥–ª—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å
        main_frame = ctk.CTkFrame(
            self,
            fg_color=IOS_CARD_COLOR,
            corner_radius=IOS_CARD_RADIUS,
            border_width=1,
            border_color=IOS_CARD_BORDER
        )
        main_frame.pack(fill="x", padx=20)

        # ===== –ú–ê–ì–ê–ó–ò–ù (–í–ò–ë–Ü–†) =====
        ctk.CTkLabel(
            main_frame,
            text="–í–∏–±–µ—Ä—ñ—Ç—å –º–∞–≥–∞–∑–∏–Ω:",
            font=ctk.CTkFont(size=12, weight="bold"),
            text_color=IOS_TEXT_COLOR
        ).pack(anchor="w", padx=15, pady=(15, 5))

        self.store_var = ctk.StringVar(value="")
        store_options = [
            "0 / –û—Ñ—ñ—Å", "1 / –î—ñ–∞–ª–æ–≥", "5 / –ü–æ–ª—Ç–∞–≤–∞", "7 / –û–∞–∑–∏—Å",
            "8 / –•–º–µ–ª—å–Ω–∏—Ü—å–∫–∏–π", "9 / –ß–µ—Ä–Ω—ñ–≤—Ü—ñ", "17 / –ö—Ä–µ–º–µ–Ω—á—É–∫",
            "18 / –ü_–ö–æ—Ç–ª—è—Ä–µ–≤—Å—å–∫–æ–≥–æ", "20 / –©–∞—Å–ª–∏–≤–∏–π", "21 / –°–æ—Ñ—ñ—è –º–æ–ª–ª"
        ]

        self.store_menu = ctk.CTkComboBox(
            main_frame,
            values=store_options,
            variable=self.store_var,
            font=ctk.CTkFont(size=11),
            height=35,
            corner_radius=IOS_BUTTON_RADIUS
        )
        self.store_menu.pack(padx=15, fill="x")

        # ===== –õ–û–ö–ê–¶–Ü–Ø (–í–ò–ë–Ü–†) =====
        ctk.CTkLabel(
            main_frame,
            text="–í–∏–±–µ—Ä—ñ—Ç—å –ª–æ–∫–∞—Ü—ñ—é:",
            font=ctk.CTkFont(size=12, weight="bold"),
            text_color=IOS_TEXT_COLOR
        ).pack(anchor="w", padx=15, pady=(15, 5))

        self.location_var = ctk.StringVar(value="")
        location_options = [
            "–∫–∞—Å–∞", "–∫–∞—Å–∞ 2", "–ø—ñ–¥—Å–æ–±–∫–∞", "–æ—Å–æ–±–∏—Å—Ç–∏–π"
        ]

        self.location_menu = ctk.CTkComboBox(
            main_frame,
            values=location_options,
            variable=self.location_var,
            font=ctk.CTkFont(size=11),
            height=35,
            corner_radius=IOS_BUTTON_RADIUS
        )
        self.location_menu.pack(padx=15, fill="x")

        # ===== –ü–Ü–ë (–û–ü–¶–Ü–ô–ù–û) =====
        ctk.CTkLabel(
            main_frame,
            text="–ü–Ü–ë –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ (–æ–ø—Ü—ñ–π–Ω–æ):",
            font=ctk.CTkFont(size=12, weight="bold"),
            text_color=IOS_TEXT_COLOR
        ).pack(anchor="w", padx=15, pady=(15, 5))

        self.user_name_entry = ctk.CTkEntry(
            main_frame,
            placeholder_text="–ù–∞–ø—Ä–∏–∫–ª–∞–¥: –Ü–≤–∞–Ω –ü–µ—Ç—Ä–µ–Ω–∫–æ",
            height=35,
            font=ctk.CTkFont(size=11),
            corner_radius=IOS_BUTTON_RADIUS
        )
        self.user_name_entry.pack(padx=15, fill="x", pady=(0, 20))

        # –ö–Ω–æ–ø–∫–∞ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è
        btn = ctk.CTkButton(
            self,
            text="‚úÖ –ó–±–µ—Ä–µ–≥—Ç–∏",
            command=self.save_settings,
            height=45,
            font=ctk.CTkFont(size=12, weight="bold"),
            corner_radius=IOS_BUTTON_RADIUS
        )
        btn.pack(padx=20, fill="x", pady=20)

    def on_closing(self):
        """–ó–∞–±–æ—Ä–æ–Ω–∏—Ç–∏ –∑–∞–∫—Ä–∏—Ç—Ç—è –±–µ–∑ –≤–≤–µ–¥–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö"""
        if not self.setup_complete:
            messagebox.showwarning(
                "–ü–æ–º–∏–ª–∫–∞",
                "–í–∏–±–µ—Ä—ñ—Ç—å –º–∞–≥–∞–∑–∏–Ω —ñ –ª–æ–∫–∞—Ü—ñ—é –ø–µ—Ä–µ–¥ –∑–∞–∫—Ä–∏—Ç—Ç—è–º!"
            )
            return
        self.destroy()

    def save_settings(self):
        """–ó–±–µ—Ä–µ–≥—Ç–∏ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è - –æ–±–æ–≤'—è–∑–∫–æ–≤–æ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏"""
        store = self.store_var.get().strip()
        location = self.location_var.get().strip()
        user_name = self.user_name_entry.get().strip()

        if not store:
            messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–í–∏–±–µ—Ä—ñ—Ç—å –º–∞–≥–∞–∑–∏–Ω!")
            return

        if not location:
            messagebox.showerror("–ü–æ–º–∏–ª–∫–∞", "–í–∏–±–µ—Ä—ñ—Ç—å –ª–æ–∫–∞—Ü—ñ—é!")
            return

        self.setup_complete = True
        self.on_complete({
            "store": store,
            "location": location,
            "user_name": user_name
        })
        self.destroy()

================================================================================
–§–∞–π–ª 16/21: src\telegram_api.py
--------------------------------------------------------------------------------
import requests
import logging
import time
import os
from pathlib import Path

logger = logging.getLogger(__name__)


class TelegramAPI:
    """–†–æ–∑—à–∏—Ä–µ–Ω–∞ Telegram API –¥–ª—è –∑–≤—ñ—Ç—É–≤–∞–Ω–Ω—è"""

    def __init__(self, token, chat_id):
        self.token = token
        self.chat_id = chat_id

        # ‚ö†Ô∏è –ü–ï–†–ï–í–Ü–†–ê –¢–û–ö–ï–ù–Ü–í
        if not token:
            logger.error("‚ùå Telegram —Ç–æ–∫–µ–Ω –Ω–µ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ!")
            self.api_url = None
        elif not chat_id:
            logger.error("‚ùå Telegram chat_id –Ω–µ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ!")
            self.api_url = None
        else:
            self.api_url = f"https://api.telegram.org/bot{token}"
            logger.info(f"‚úÖ Telegram –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–æ (—Ç–æ–∫–µ–Ω: {token[:20]}...)")

    def send_message(self, text, parse_mode="HTML"):
        """–í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ —Ç–µ–∫—Å—Ç–æ–≤–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è"""
        if not self.api_url:
            logger.error("‚ùå Telegram –Ω–µ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–æ")
            return False

        try:
            payload = {
                "chat_id": self.chat_id,
                "text": text,
                "parse_mode": parse_mode
            }
            response = requests.post(
                f"{self.api_url}/sendMessage",
                json=payload,
                timeout=10
            )
            response.raise_for_status()
            logger.info("‚úÖ –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –Ω–∞–¥—ñ—Å–ª–∞–Ω–æ –≤ Telegram")
            return True
        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞ –≤—ñ–¥–ø—Ä–∞–≤–∫–∏ Telegram: {e}")
            return False

    def send_file(self, file_path, caption="", file_type="document"):
        """–í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ —Ñ–∞–π–ª (document –∞–±–æ photo)"""
        if not self.api_url:
            logger.error("‚ùå Telegram –Ω–µ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–æ")
            return False

        try:
            with open(file_path, 'rb') as f:
                files = {file_type: f}
                payload = {
                    "chat_id": self.chat_id,
                    "caption": caption,
                    "parse_mode": "HTML"
                }
                endpoint = "sendDocument" if file_type == "document" else "sendPhoto"
                response = requests.post(
                    f"{self.api_url}/{endpoint}",
                    files=files,
                    data=payload,
                    timeout=30
                )
                response.raise_for_status()
            logger.info(f"‚úÖ –§–∞–π–ª –Ω–∞–¥—ñ—Å–ª–∞–Ω–æ –≤ Telegram")
            return True
        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞ –≤—ñ–¥–ø—Ä–∞–≤–∫–∏ —Ñ–∞–π–ª—É: {e}")
            return False

    def send_network_report(self, store_location, pc_name, test_results, user_name=""):
        """(–û–ù–û–í–õ–ï–ù–û) –í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ –∑–≤—ñ—Ç –ø—Ä–æ —Å—Ç–∞–Ω –º–µ—Ä–µ–∂—ñ"""

        # (–ù–û–í–ï) –î–æ–¥–∞—Ç–∏ –ü–Ü–ë —è–∫—â–æ —î
        user_info = f"\n<b>üë§ –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á:</b> {user_name}" if user_name else ""

        report = (
            f"<b>üìä –ó–≤—ñ—Ç –ø—Ä–æ —Å—Ç–∞–Ω –º–µ—Ä–µ–∂—ñ</b>\n\n"
            f"<b>–ú–∞–≥–∞–∑–∏–Ω/–õ–æ–∫–∞—Ü—ñ—è:</b> {store_location}{user_info}\n"  # <-- –û–ù–û–í–õ–ï–ù–û
            f"<b>–ü–ö:</b> <code>{pc_name}</code>\n"
            f"<b>–ß–∞—Å:</b> {time.strftime('%Y-%m-%d %H:%M:%S')}\n\n"
            f"<b>–†–µ–∑—É–ª—å—Ç–∞—Ç–∏:</b>\n"
            f"{test_results}"
        )
        return self.send_message(report)

    def send_anydesk_info(self, store_location, user_name, pc_name, anydesk_id, password):
        """
        –í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ AnyDesk —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é (–ø–æ–∫—Ä–∞—â–µ–Ω–µ —Ñ–æ—Ä–º–∞—Ç—É–≤–∞–Ω–Ω—è)
        """
        user_info = f"\n<b>üë§ –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á:</b> {user_name}" if user_name else ""

        message = (
            f"<b>üåê –ó–∞–ø–∏—Ç –Ω–∞ AnyDesk</b>\n\n"
            f"<b>üìç –ú–∞–≥–∞–∑–∏–Ω:</b> {store_location}\n"
            f"<b>üíª –ö–æ–º–ø'—é—Ç–µ—Ä:</b> <code>{pc_name}</code>"
            f"{user_info}\n\n"
            f"<b>--- –î–∞–Ω—ñ –¥–ª—è –≤—Ö–æ–¥—É ---</b>\n"
            f"<b>üÜî ID:</b> <code>{anydesk_id}</code>\n"
            f"<b>üîê –ü–∞—Ä–æ–ª—å:</b> <code>{password}</code>"
        )
        return self.send_message(message)

    def send_rdp_info(self, store_location, pc_name):
        """–í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è –ø—Ä–æ RDP –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è"""
        message = (
            f"<b>üñ•Ô∏è RDP –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è</b>\n\n"
            f"<b>–ú–∞–≥–∞–∑–∏–Ω/–õ–æ–∫–∞—Ü—ñ—è:</b> {store_location}\n"
            f"<b>–ü–ö:</b> <code>{pc_name}</code>\n"
            f"<b>–ß–∞—Å:</b> {time.strftime('%Y-%m-%d %H:%M:%S')}\n\n"
            f"‚úÖ –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –ø—ñ–¥–∫–ª—é—á–∏–≤—Å—è –¥–æ 1–°"
        )
        return self.send_message(message)

    def send_error_report(self, store_location, pc_name, error_text):
        """–í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ –∑–≤—ñ—Ç –ø—Ä–æ –ø–æ–º–∏–ª–∫—É"""
        message = (
            f"<b>‚ùå –ü–æ–º–∏–ª–∫–∞</b>\n\n"
            f"<b>–ú–∞–≥–∞–∑–∏–Ω/–õ–æ–∫–∞—Ü—ñ—è:</b> {store_location}\n"
            f"<b>–ü–ö:</b> <code>{pc_name}</code>\n"
            f"<b>–ß–∞—Å:</b> {time.strftime('%Y-%m-%d %H:%M:%S')}\n\n"
            f"<b>–î–µ—Ç–∞–ª—ñ:</b>\n<code>{error_text}</code>"
        )
        return self.send_message(message)

================================================================================
–§–∞–π–ª 17/21: src\updater.py
--------------------------------------------------------------------------------
import os
import sys
import requests
import subprocess
import time
import logging
from pathlib import Path

logger = logging.getLogger(__name__)


class UpdaterManager:
    """–ú–µ–Ω–µ–¥–∂–µ—Ä –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ —Ç–∞ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –æ–Ω–æ–≤–ª–µ–Ω—å"""

    GITHUB_REPO = "ShevchukVI/RemoteHand"
    GITHUB_API_URL = f"https://api.github.com/repos/{GITHUB_REPO}/releases/latest"

    def __init__(self):
        if getattr(sys, 'frozen', False):
            self.current_exe_path = Path(sys.executable)
            self.app_dir = self.current_exe_path.parent
        else:
            self.current_exe_path = None
            self.app_dir = Path.cwd()  # –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ Path.cwd() –¥–ª—è DEV

        # (–û–ù–û–í–õ–ï–ù–û) current_version —Ç–µ–ø–µ—Ä –≤–∏–∫–ª–∏–∫–∞—î—Ç—å—Å—è –ø—ñ–∑–Ω—ñ—à–µ,
        # –±–æ get_resource_path –ø–æ—Ç—Ä—ñ–±–µ–Ω –µ–∫–∑–µ–º–ø–ª—è—Ä –∫–ª–∞—Å—É
        self.current_version = self.get_current_version()

    def get_resource_path(self, relative_path):
        """ (–ù–û–í–ï) –û—Ç—Ä–∏–º–∞—Ç–∏ –∫–æ—Ä–µ–∫—Ç–Ω–∏–π —à–ª—è—Ö –¥–æ —Ä–µ—Å—É—Ä—Å—É (–¥–ª—è .exe —Ç–∞ DEV) """
        try:
            # PyInstaller —Å—Ç–≤–æ—Ä—é—î —Ç–∏–º—á–∞—Å–æ–≤—É –ø–∞–ø–∫—É _MEIPASS
            base_path = Path(sys._MEIPASS)
        except Exception:
            # –í DEV-—Ä–µ–∂–∏–º—ñ _MEIPASS –Ω–µ —ñ—Å–Ω—É—î, –±–µ—Ä–µ–º–æ –∫–æ—Ä—ñ–Ω—å –ø—Ä–æ—î–∫—Ç—É
            base_path = Path.cwd()

        return base_path / relative_path

    def get_current_version(self):
        """–û—Ç—Ä–∏–º–∞—Ç–∏ –ø–æ—Ç–æ—á–Ω—É –≤–µ—Ä—Å—ñ—é"""
        # (–û–ù–û–í–õ–ï–ù–û) –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ get_resource_path –¥–ª—è –∫–æ—Ä–µ–∫—Ç–Ω–æ–≥–æ —à–ª—è—Ö—É
        version_file = self.get_resource_path("version.txt")

        if version_file.exists():
            try:
                # –°–ø—Ä–æ–±—É–≤–∞—Ç–∏ UTF-8-SIG (—Å—Ç–∞–Ω–¥–∞—Ä—Ç –∑ BOM)
                return version_file.read_text(encoding='utf-8-sig').strip()
            except UnicodeDecodeError:
                try:
                    # –Ø–∫—â–æ –Ω–µ –≤–∏–π—à–ª–æ (byte 0xff), —Å–ø—Ä–æ–±—É–≤–∞—Ç–∏ UTF-16
                    return self.version_file.read_text(encoding='utf-16').strip()
                except Exception:
                    pass  # –ü–µ—Ä–µ–π–¥–µ–º–æ –¥–æ fallback
            except Exception:
                pass  # –ü–µ—Ä–µ–π–¥–µ–º–æ –¥–æ fallback

        return "1.0.0"  # Fallback

    def get_latest_version(self):
        """–û—Ç—Ä–∏–º–∞—Ç–∏ –Ω–∞–π–Ω–æ–≤—ñ—à—É –≤–µ—Ä—Å—ñ—é –∑ GitHub"""
        try:
            response = requests.get(self.GITHUB_API_URL, timeout=10)
            response.raise_for_status()
            data = response.json()
            tag = data.get('tag_name', 'v1.0.0')
            return tag.lstrip('v')
        except Exception as e:
            logger.warning(f"–ù–µ –≤–¥–∞–ª–æ—Å—è –æ—Ç—Ä–∏–º–∞—Ç–∏ –≤–µ—Ä—Å—ñ—é –∑ GitHub: {e}")
            return None

    def compare_versions(self, current, latest):
        """–ü–æ—Ä—ñ–≤–Ω—è—Ç–∏ –≤–µ—Ä—Å—ñ—ó"""
        try:
            from packaging.version import parse
            return parse(latest) > parse(current)
        except ImportError:
            try:
                current_parts = [int(x) for x in current.split('.')]
                latest_parts = [int(x) for x in latest.split('.')]
                return latest_parts > current_parts
            except:
                return False
        except Exception:
            return False

    def download_update(self, latest_version):
        """–ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –Ω–æ–≤—É –≤–µ—Ä—Å—ñ—é"""
        try:
            logger.info(f"üì• –ó–∞–≤–∞–Ω—Ç–∞–∂—É—é RemoteHand v{latest_version}...")
            download_url = f"https://github.com/{self.GITHUB_REPO}/releases/download/v{latest_version}/RemoteHand.exe"

            response = requests.get(download_url, timeout=60, stream=True)
            response.raise_for_status()

            new_exe_path = self.app_dir / "RemoteHand_new.exe"

            with open(new_exe_path, 'wb') as f:
                for chunk in response.iter_content(chunk_size=8192):
                    f.write(chunk)

            logger.info(f"‚úÖ RemoteHand v{latest_version} –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ: {new_exe_path}")
            return new_exe_path

        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è: {e}")
            return None

    def run_update_vbs_bat(self, new_exe_path: Path):
        """
        (–†–ê–î–ò–ö–ê–õ–¨–ù–û –ù–û–í–ò–ô –ú–ï–¢–û–î: PY -> VBS -> BAT –∑ –ê–ë–°–û–õ–Æ–¢–ù–ò–ú–ò –®–õ–Ø–•–ê–ú–ò)
        –°—Ç–≤–æ—Ä—é—î —Ç–∞ –∑–∞–ø—É—Å–∫–∞—î .bat —á–µ—Ä–µ–∑ .vbs –¥–ª—è 100% –Ω–∞–¥—ñ–π–Ω–æ—ó –∑–∞–º—ñ–Ω–∏ —Ñ–∞–π–ª—É.
        """
        if not self.current_exe_path:
            logger.warning("–ù–µ –º–æ–∂—É –∑–∞–ø—É—Å—Ç–∏—Ç–∏ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –≤ DEV —Ä–µ–∂–∏–º—ñ.")
            return

        # (–û–ù–û–í–õ–ï–ù–û) –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ –∞–±—Å–æ–ª—é—Ç–Ω—ñ —à–ª—è—Ö–∏
        bat_path = self.app_dir / "update.bat"
        vbs_path = self.app_dir / "update.vbs"
        current_exe_abs = str(self.current_exe_path.resolve())
        new_exe_abs = str(new_exe_path.resolve())
        current_exe_name = self.current_exe_path.name

        # --- –°—Ç–≤–æ—Ä—é—î–º–æ .BAT —Ñ–∞–π–ª ---
        # (–û–ù–û–í–õ–ï–ù–û) –í—Å—ñ —à–ª—è—Ö–∏ —Ç–µ–ø–µ—Ä –∞–±—Å–æ–ª—é—Ç–Ω—ñ
        bat_content = f"""@ECHO OFF
TITLE –û–Ω–æ–≤–ª–µ–Ω–Ω—è RemoteHand...
ECHO –ó–∞–∫—Ä–∏–≤–∞—é –ø–æ–ø–µ—Ä–µ–¥–Ω—é –≤–µ—Ä—Å—ñ—é (TASKKILL)...
TASKKILL /F /IM "{current_exe_name}" > nul
ECHO –ß–µ–∫–∞—é 5 —Å–µ–∫—É–Ω–¥, –ø–æ–∫–∏ –ø—Ä–æ—Ü–µ—Å –∑–∞–≤–µ—Ä—à–∏—Ç—å—Å—è...
ping 127.0.0.1 -n 6 > nul

ECHO –û–Ω–æ–≤–ª—é—é —Ñ–∞–π–ª...
MOVE /Y "{new_exe_abs}" "{current_exe_abs}"

ECHO –ó–∞–ø—É—Å–∫–∞—é –æ–Ω–æ–≤–ª–µ–Ω—É –≤–µ—Ä—Å—ñ—é...
START "" "{current_exe_abs}"

ECHO –í–∏–¥–∞–ª—è—é –¥–æ–ø–æ–º—ñ–∂–Ω—ñ —Ñ–∞–π–ª–∏...
DEL "{vbs_path.resolve()}"
(goto) 2>nul & del "%~f0"
"""
        try:
            with open(bat_path, "w", encoding='cp866') as f:
                f.write(bat_content)
            logger.info(f"‚úÖ –°—Ç–≤–æ—Ä–µ–Ω–æ update.bat")
        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è update.bat: {e}")
            return

        # --- –°—Ç–≤–æ—Ä—é—î–º–æ .VBS —Ñ–∞–π–ª ---
        # (–û–ù–û–í–õ–ï–ù–û) –®–ª—è—Ö –¥–æ .bat —Ç–∞–∫–æ–∂ –∞–±—Å–æ–ª—é—Ç–Ω–∏–π
        vbs_content = f"""
Set WshShell = CreateObject("WScript.Shell")
WshShell.Run "cmd /C ""{bat_path.resolve()}""", 0, False


"""
        try:
            with open(vbs_path, "w", encoding='utf-8') as f:
                f.write(vbs_content)
            logger.info(f"‚úÖ –°—Ç–≤–æ—Ä–µ–Ω–æ update.vbs")
        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è update.vbs: {e}")
            return

        # --- –ó–∞–ø—É—Å–∫–∞—î–º–æ VBScript —ñ –∑–∞–∫—Ä–∏–≤–∞—î–º–æ—Å—å ---
        try:
            logger.info(f"üîÑ –ó–∞–ø—É—Å–∫–∞—é update.vbs —Ç–∞ –∑–∞–≤–µ—Ä—à—É—é —Ä–æ–±–æ—Ç—É...")
            subprocess.Popen(
                ['wscript.exe', str(vbs_path.resolve())],
                creationflags=subprocess.DETACHED_PROCESS | subprocess.CREATE_NEW_PROCESS_GROUP,
                close_fds=True,
                shell=False
            )

            # –ù–µ–≥–∞–π–Ω–æ –∑–∞–∫—Ä–∏–≤–∞—î–º–æ –ø–æ—Ç–æ—á–Ω—É –ø—Ä–æ–≥—Ä–∞–º—É
            sys.exit(0)
        except Exception as e:
            logger.error(f"‚ùå –ü–æ–º–∏–ª–∫–∞ –∑–∞–ø—É—Å–∫—É wscript.exe: {e}")


    def check_and_update(self):
        """
–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏
—Ç–∞
–≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏
–æ–Ω–æ–≤–ª–µ–Ω–Ω—è
"""
        if os.getenv('REMOTEHAND_DEV_MODE') == '1' or not getattr(sys, 'frozen', False):
            logger.info("üîß DEV —Ä–µ–∂–∏–º - –ø—Ä–æ–ø—É—Å–∫–∞—î–º–æ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è")
            return False

        logger.info("üîç –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –æ–Ω–æ–≤–ª–µ–Ω—å...")

        latest_version = self.get_latest_version()
        if not latest_version:
            logger.info("‚ö†Ô∏è –ù–µ –≤–¥–∞–ª–æ—Å—è –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è")
            return False

        logger.info(f"üìå –ü–æ—Ç–æ—á–Ω–∞ –≤–µ—Ä—Å—ñ—è: {self.current_version}")
        logger.info(f"üì¶ –û—Å—Ç–∞–Ω–Ω—è –≤–µ—Ä—Å—ñ—è: {latest_version}")

        if self.compare_versions(self.current_version, latest_version):
            logger.info(f"üì¶ –î–æ—Å—Ç—É–ø–Ω–µ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è: {latest_version}")

            new_exe = self.download_update(latest_version)

            if new_exe and new_exe.exists():
                logger.info(f"‚úÖ –ù–æ–≤–∞ –≤–µ—Ä—Å—ñ—è –≥–æ—Ç–æ–≤–∞!")
                # (–û–ù–û–í–õ–ï–ù–û) –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ –Ω–æ–≤–∏–π VBS->BAT –º–µ—Ç–æ–¥
                self.run_update_vbs_bat(new_exe) 
                return True
            else:
                logger.error("‚ùå –ù–µ –≤–¥–∞–ª–æ—Å—è –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è.")

        logger.info(f"‚úÖ –í–µ—Ä—Å—ñ—è –∞–∫—Ç—É–∞–ª—å–Ω–∞: {self.current_version}")
        return False


def check_and_update():
    """
–§—É–Ω–∫—Ü—ñ—è
–¥–ª—è
—ñ–º–ø–æ—Ä—Ç—É
–≤
main.py
"""
    updater = UpdaterManager()
    return updater.check_and_update()

================================================================================
–§–∞–π–ª 18/21: src\utils.py
--------------------------------------------------------------------------------
import os
import sys
import subprocess
import psutil
from pathlib import Path
from config import LOCK_FILE, APP_NAME


class SingleInstance:
    """–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –Ω–∞ —î–¥–∏–Ω–∏–π –µ–∫–∑–µ–º–ø–ª—è—Ä –ø—Ä–æ–≥—Ä–∞–º–∏"""

    def __init__(self):
        self.lock_file = LOCK_FILE
        self.fp = None

    def is_running(self):
        """–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —á–∏ –ø—Ä–æ–≥—Ä–∞–º–∞ –≤–∂–µ –∑–∞–ø—É—â–µ–Ω–∞"""
        if sys.platform == 'win32':
            import win32event
            import win32api
            import winerror

            self.mutex = win32event.CreateMutex(None, False, APP_NAME)
            if win32api.GetLastError() == winerror.ERROR_ALREADY_EXISTS:
                return True
        else:
            try:
                self.fp = open(self.lock_file, 'w')
                import fcntl
                fcntl.flock(self.fp, fcntl.LOCK_EX | fcntl.LOCK_NB)
            except IOError:
                return True
        return False


def open_rdp_connection(host, port):
    """–í—ñ–¥–∫—Ä–∏—Ç—Ç—è RDP –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è"""
    rdp_command = f'mstsc /v:{host}:{port}'
    subprocess.Popen(rdp_command, shell=True)


def close_all_rdp_sessions():
    """–ó–∞–∫—Ä–∏—Ç—Ç—è –≤—Å—ñ—Ö RDP —Å–µ—Å—ñ–π"""
    for proc in psutil.process_iter(['name']):
        try:
            if proc.info['name'].lower() == 'mstsc.exe':
                proc.kill()
        except (psutil.NoSuchProcess, psutil.AccessDenied):
            pass


def test_connection(host):
    """–¢–µ—Å—Ç –∑'—î–¥–Ω–∞–Ω–Ω—è —á–µ—Ä–µ–∑ ping"""
    param = '-n' if sys.platform == 'win32' else '-c'
    command = ['ping', param, '1', host]
    result = subprocess.run(command, capture_output=True, text=True)
    return result.returncode == 0

================================================================================
–§–∞–π–ª 19/21: version.txt
--------------------------------------------------------------------------------
1.0.13

================================================================================
–§–∞–π–ª 20/21: version_info.txt
--------------------------------------------------------------------------------
VSVersionInfo(
  ffi=FixedFileInfo(mask=0x3f,
    mask_values=[(0, 63), (0, 63), (0, 63), (0, 63)],
    CV_VSVersionInfo=[(0, '0'), (0, '3'), (0, '0'), (0, '0')]),
  StringFileInfo([(u'040904B0',
    StringTable(u'040904B0',
      [StringEntry(u'CompanyName', u'RemoteHand'),
       StringEntry(u'FileDescription', u'RemoteHand - RDP & AnyDesk Manager'),
       StringEntry(u'FileVersion', u'1.0.3.0'),
       StringEntry(u'ProductName', u'RemoteHand'),
       StringEntry(u'ProductVersion', u'1.0.3')]))]),
  VarFileInfo([VarEntry(u'Translation', [1033, 1200])])
)


================================================================================
–§–∞–π–ª 21/21: –ê–∫—Ç–∏–≤–∞—Ü—ñ—è —Å–µ—Ä–µ–¥–æ–≤–∏—â–∞.txt
--------------------------------------------------------------------------------
.venvScriptsActivate.ps1

================================================================================
–ö–Ü–ù–ï–¶–¨ –ï–ö–°–ü–û–†–¢–£
================================================================================
